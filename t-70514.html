<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="No Message in AFS Update, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] No Message in AFS Update AFS/DDC/OLE: Function servers" />
	
	<title>No Message in AFS Update [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="index.html">Newbaanboard</a> &gt; <a href="index.html">Baan SIGs</a> &gt; <a href="index.html">AFS/DDC/OLE: Function servers</a> &gt; No Message in AFS Update</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">VishalMistry</div><div class="date">18th October 2017, 17:48</div></div><div class="posttext">Hello,<br />
<br />
I am facing one strange issue in AFS update of sales order line when I try to update warehouse code in sales order line.<br />
<br />
The problem is when I goto session tdsls4102s000 and try to update the desired line, I get the message  Purchase Order Already created for pos 20&quot;. But, when I try to update the line through AFS, the stpapi.update call does not capture proper message in in error.msg variable and the variable remains blank.<br />
<br />
I am attaching screen shot of the error and script. I shall be grateful if anyone can point out the mistake and suggest improvement in the code.<br />
<br />
Vishal</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">19th October 2017, 04:09</div></div><div class="posttext">The message looks like a warning and not a true error.  Have you tried right after the update to do a stpapi.get.mess.code to see if that gets you the message?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">VishalMistry</div><div class="date">23rd October 2017, 16:04</div></div><div class="posttext">Hello Mark,<br />
<br />
You are right but it does not allow changing the warehouse after the message. One thing I have noticed is for some sales order lines, where the delivered qty is zero and sales order line status (tdsls045.ssls) = 3, AFS does not return any error and does not allow changing warehouse.<br />
<br />
Vishal</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">24th October 2017, 00:44</div></div><div class="posttext">Have you tried the stpapi.get.mess.code to see if it gets you any messages at all?  I know it some cases I head the errors off before they can occur in the afs code. So for example before processing I might check the line order status and quantity delivered and give the user a message and not try to process it thru the AFS code.  Sometimes it just depends on the error and how the code reacts(the background baan session).  It seems it works manually, but in the background they sometimes do something different.</div></div><hr />



</div>
</body>
</html>