<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="Printing orderdocuments, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] Printing orderdocuments AFS/DDC/OLE: Function servers" />
	
	<title>Printing orderdocuments [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="index.html">Newbaanboard</a> &gt; <a href="index.html">Baan SIGs</a> &gt; <a href="index.html">AFS/DDC/OLE: Function servers</a> &gt; Printing orderdocuments</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">Pieter van de L</div><div class="date">22nd July 2004, 17:11</div></div><div class="posttext">Hi all,<br />
<br />
I have written a code in afs to print orderdocuments, but nothing is comming out of it. <br />
In the afs.log file the message No data found for selection; hence no action taken is generated.<br />
<br />
Can anyone please tell me waht is wrong<br />
<br />
function do.main()<br />
{<br />
	print.order.documents()<br />
}<br />
<br />
function print.order.documents()<br />
{	<br />
	domain	tcdate	date.f<br />
	domain	tcdate	date.t<br />
<br />
	date.f = 1072970332<br />
	date.t = utc.num() + 43200000<br />
<br />
	hold.pdno.f = pdno.f<br />
	hold.pdno.t = pdno.t<br />
<br />
	string		o.mess(256)<br />
	string		o.mess1(256)<br />
	string		o.mess2(256)<br />
	long		ret.val<br />
	stpapi.put.field( &quot;tisfc0408m000&quot;, &quot;k.of.sel&quot;, str$(etol(tisfc.kosl.manufact)))<br />
	stpapi.put.field( &quot;tisfc0408m000&quot;, &quot;pdno.f&quot;, pdno.f )<br />
	stpapi.put.field( &quot;tisfc0408m000&quot;, &quot;pdno.t&quot;, pdno.t )<br />
	stpapi.put.field( &quot;tisfc0408m000&quot;, &quot;cprj.f&quot;, &quot;&quot; )<br />
	stpapi.put.field( &quot;tisfc0408m000&quot;, &quot;cprj.t&quot;, &quot;ZZZZZZZZZ&quot; )<br />
	stpapi.put.field( &quot;tisfc0408m000&quot;, &quot;opno.f&quot;, str$(0) )<br />
	stpapi.put.field( &quot;tisfc0408m000&quot;, &quot;opno.t&quot;, str$(999) )<br />
|	stpapi.put.field( &quot;tisfc0408m000&quot;, &quot;m.prod.date.f&quot;, str$(date.f) )<br />
	stpapi.put.field( &quot;tisfc0408m000&quot;, &quot;m.prod.date.t&quot;, str$(date.t) )<br />
	stpapi.put.field( &quot;tisfc0408m000&quot;, &quot;citg.f&quot;, &quot;&quot; )<br />
	stpapi.put.field( &quot;tisfc0408m000&quot;, &quot;citg.t&quot;, &quot;ZZZZZZ&quot; )<br />
	stpapi.put.field( &quot;tisfc0408m000&quot;, &quot;cwar.f&quot;, &quot;&quot; )<br />
	stpapi.put.field( &quot;tisfc0408m000&quot;, &quot;cwar.t&quot;, &quot;ZZZZZZ&quot; )<br />
	stpapi.put.field( &quot;tisfc0408m000&quot;, &quot;plid.f&quot;, &quot;&quot; )<br />
	stpapi.put.field( &quot;tisfc0408m000&quot;, &quot;plid.t&quot;, &quot;ZZZZZZ&quot; )<br />
	stpapi.put.field( &quot;tisfc0408m000&quot;, &quot;cpln.f&quot;, &quot;&quot; )<br />
	stpapi.put.field( &quot;tisfc0408m000&quot;, &quot;cpln.t&quot;, &quot;ZZZZZZ&quot; )<br />
	stpapi.put.field( &quot;tisfc0408m000&quot;, &quot;cpcl.f&quot;, &quot;&quot; )<br />
	stpapi.put.field( &quot;tisfc0408m000&quot;, &quot;cpcl.t&quot;, &quot;ZZZZZZ&quot; )<br />
	stpapi.put.field( &quot;tisfc0408m000&quot;, &quot;csel.f&quot;, &quot;&quot; )<br />
	stpapi.put.field( &quot;tisfc0408m000&quot;, &quot;csel.t&quot;, &quot;ZZZ&quot; )<br />
	stpapi.put.field( &quot;tisfc0408m000&quot;, &quot;order.sorted&quot;, str$(etol(tisfc.osrt.order)) )<br />
	stpapi.put.field( &quot;tisfc0408m000&quot;, &quot;document.sorted&quot;, str$(etol(tisfc.dsrt.doc.by.order)) )<br />
|	stpapi.put.field( &quot;tisfc0408m000&quot;, &quot;key.line&quot;, value )<br />
|	stpapi.put.field( &quot;tisfc0408m000&quot;, &quot;key.buffer&quot;, value )<br />
|	stpapi.put.field( &quot;tisfc0408m000&quot;, &quot;sgmt.stdt.f&quot;, str$(value) )<br />
|	stpapi.put.field( &quot;tisfc0408m000&quot;, &quot;sgmt.stdt.t&quot;, str$(value) )<br />
|	stpapi.put.field( &quot;tisfc0408m000&quot;, &quot;line.ref.date&quot;, str$(value) )<br />
|	stpapi.put.field( &quot;tisfc0408m000&quot;, &quot;asln.f&quot;, value )<br />
|	stpapi.put.field( &quot;tisfc0408m000&quot;, &quot;bffr.f&quot;, value )<br />
|	stpapi.put.field( &quot;tisfc0408m000&quot;, &quot;lstn.f&quot;, value )<br />
|	stpapi.put.field( &quot;tisfc0408m000&quot;, &quot;asln.t&quot;, value )<br />
|	stpapi.put.field( &quot;tisfc0408m000&quot;, &quot;bffr.t&quot;, value )<br />
|	stpapi.put.field( &quot;tisfc0408m000&quot;, &quot;lstn.t&quot;, value )<br />
	stpapi.put.field( &quot;tisfc0408m000&quot;, &quot;print.org&quot;, str$(etol(tcyesno.yes)))<br />
	stpapi.put.field( &quot;tisfc0408m000&quot;, &quot;print.dupl&quot;, str$(etol(tcyesno.yes)))<br />
	stpapi.put.field( &quot;tisfc0408m000&quot;, &quot;print.modi&quot;, str$(etol(tcyesno.yes)))<br />
	stpapi.put.field( &quot;tisfc0408m000&quot;, &quot;print.entpr&quot;, str$(etol(tcyesno.yes)))<br />
	stpapi.put.field( &quot;tisfc0408m000&quot;, &quot;entpr.unit&quot;, &quot;HANSEN&quot;)<br />
|	stpapi.put.field( &quot;tisfc0408m000&quot;, &quot;print.atks&quot;, str$(value) )<br />
|	stpapi.put.field( &quot;tisfc0408m000&quot;, &quot;print.planned&quot;, str$(value) )<br />
|	stpapi.put.field( &quot;tisfc0408m000&quot;, &quot;print.wo.oprn&quot;, str$(value) )<br />
	stpapi.put.field( &quot;tisfc0408m000&quot;, &quot;covn.b&quot;, str$(etol(tcyesno.yes)))<br />
	stpapi.put.field( &quot;tisfc0408m000&quot;, &quot;collect.sawl&quot;, str$(etol(tcyesno.no)))<br />
	stpapi.put.field( &quot;tisfc0408m000&quot;, &quot;roul.b&quot;, str$(etol(tcyesno.no)))<br />
	stpapi.put.field( &quot;tisfc0408m000&quot;, &quot;cutl.b&quot;, str$(etol(tcyesno.no)))<br />
	stpapi.put.field( &quot;tisfc0408m000&quot;, &quot;oprn.b&quot;, str$(etol(tcyesno.no)))<br />
	stpapi.put.field( &quot;tisfc0408m000&quot;, &quot;collect.cutl&quot;, str$(etol(tcyesno.no)))<br />
	stpapi.put.field( &quot;tisfc0408m000&quot;, &quot;matl.b&quot;, str$(etol(tcyesno.no)))<br />
	stpapi.put.field( &quot;tisfc0408m000&quot;, &quot;recn.b&quot;, str$(etol(tcyesno.no)))<br />
	stpapi.put.field( &quot;tisfc0408m000&quot;, &quot;matn.b&quot;, str$(etol(tcyesno.no)))<br />
	stpapi.put.field( &quot;tisfc0408m000&quot;, &quot;insn.b&quot;, str$(etol(tcyesno.no)))<br />
	stpapi.put.field( &quot;tisfc0408m000&quot;, &quot;subn.b&quot;, str$(etol(tcyesno.no)))<br />
	stpapi.put.field( &quot;tisfc0408m000&quot;, &quot;arou.b&quot;, str$(etol(tcyesno.no)))<br />
	stpapi.put.field( &quot;tisfc0408m000&quot;, &quot;chel.b&quot;, str$(etol(tcyesno.no)))<br />
	stpapi.put.field( &quot;tisfc0408m000&quot;, &quot;amat.b&quot;, str$(etol(tcyesno.no)))<br />
	stpapi.put.field( &quot;tisfc0408m000&quot;, &quot;sawl.b&quot;, str$(etol(tcyesno.no)))<br />
<br />
	stpapi.set.report(&quot;tisfc0408m000&quot;, &quot;rtisfc040801000&quot;,&quot;PRT44&quot;, o.mess1)<br />
	stpapi.form.command(&quot;tisfc0408m000&quot;, 5 , &quot;print.order.documents&quot;, o.mess2)<br />
	stpapi.end.session(&quot;tisfc0408m000&quot;)<br />
<br />
<br />
}<br />
<br />
<br />
Regards,<br />
<br />
Pieter</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">22nd July 2004, 19:55</div></div><div class="posttext">I see a few things right of the top of my head that could cause it - first is pdno.f and pdno.t string values?  The second thing I see is the dates - since I am on Baan 4 I do not have a clue what those numbers represent.  I typically do the dates by using date.num()-5000, I figure about 5 years is enough.  Not sure how this would look<br />
	stpapi.put.field(&quot;tdpur4410m000&quot;,&quot;date.t&quot;,str$(date.num()+5000))<br />
in baan 5.<br />
<br />
Mark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Pieter van de L</div><div class="date">23rd July 2004, 10:32</div></div><div class="posttext">Mark,<br />
<br />
The date's represent the utc value  seconds since 01-01-1970 <br />
The format you suggest also works within BaanV. but do not give the disered results.<br />
It could be that the problem is the AS400 platform.<br />
<br />
I will test more and let you now the result.<br />
<br />
Pieter,</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Pieter van de L</div><div class="date">23rd July 2004, 17:06</div></div><div class="posttext">In the standard script the reportgroup is set. when called from api the group is not filled correctly. We have to adjust the script.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">23rd July 2004, 17:17</div></div><div class="posttext">I would have thought the error &quot;no data found&quot; was data related and not code related.  The code I used was just about like yours and I did not have that problem.  That is one of the things that make these things so hard to debug at times.<br />
<br />
Mark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Pieter van de L</div><div class="date">1st September 2004, 09:52</div></div><div class="posttext">Hi all,<br />
<br />
Within BaanERP 5.0c several sessions will not work with AFS. I had a problem with printing orderdocuments. The solution for the session tisfc0408m000 is to always open the report for reportgroup 14. Baan has made a solution for this session but if you don't want to install this then this is a nice workaround.<br />
<br />
Another solution is to recomplie the session, several session with a certain date only work after recompiling. Installing a new portinset is not enough.</div></div><hr />



</div>
</body>
</html>