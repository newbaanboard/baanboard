<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="Error Messages, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] Error Messages AFS/DDC/OLE: Function servers" />
	
	<title>Error Messages [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="index.html">Newbaanboard</a> &gt; <a href="index.html">Baan SIGs</a> &gt; <a href="index.html">AFS/DDC/OLE: Function servers</a> &gt; Error Messages</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">aaguiar</div><div class="date">9th June 2004, 15:24</div></div><div class="posttext">Hi all,<br />
<br />
Is there possible retrieve all error messages with stpapi.get.mess.code function ?<br />
<br />
Ex:<br />
-------------------------------------------------------------<br />
while true<br />
        errorCode = stpapi.get.mess.code(&quot;session&quot;,errorMsg)<br />
        if isspace(errorMsg) then<br />
              break<br />
        endif<br />
endwhile<br />
-------------------------------------------------------------<br />
the example is in documentation of SSA Global, but in my program it retrieve only last message..<br />
<br />
Thank's</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">9th June 2004, 15:29</div></div><div class="posttext">I never could figure out how to get all the error messages that might come up.  There might be one, but I do not know how.  Usually I try to generate and trap as many of the errors as possible before calling any of the sessions with stpapi code. <br />
<br />
Mark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">NPRao</div><div class="date">9th June 2004, 20:15</div></div><div class="posttext">Refer to the AFS/API documentation -<br />
Get Messages from session<br />
SYNTAX<br />
string stpapi.get.mess.code(string session [, ref string err.mesg])<br />
ARGUMENTS<br />
session	Name of the session this command is executed on. <br />
err.mesg	Text of the message.<br />
DESCRIPTION<br />
This retrieves the messages generated by the indicated session as a result of an stpapi.* function call. The messages are returned in the opposite order as generated in the session. Messages generated by the AFS or 4GL-Engine are also returned. These messages are generated when the AFS is not used correctly by the programmer (for example, wrong order of function calls).<br />
RETURN VALUES<br />
String that contains code of error message or the empty string if no error message is found or only the error text is filled.<br />
If you make multiple calls to this function, you will get the previous message, here is an example-<br />
	<br />
	stpapi.end.session(subsession.code)<br />
	err.code = stpapi.get.mess.code(session.code, err.mess)<br />
	if pos(err.mess, &quot;Conversion Aborted!&quot;) then<br />
		err.code = stpapi.get.mess.code(session.code, err.mess)<br />
	endif<br />
	if not isspace(err.mess) and not pos(err.mess, &quot;already&quot;)then<br />
		mess(&quot;zmadms0053&quot;, 1, err.mess) 		|* %1$s<br />
	endif<br />
	stpapi.end.session(session.code)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">9th June 2004, 20:45</div></div><div class="posttext">The last time I tried I never could get more than the last message.  I knew there should be two messages, but only could get the last returned.  I will have to try that again sometime. In my case they were warning messages from the manual transfer session.<br />
<br />
Mark</div></div><hr />



</div>
</body>
</html>