<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="AFS from tfacp1100s000, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] AFS from tfacp1100s000 AFS/DDC/OLE: Function servers" />
	
	<title>AFS from tfacp1100s000 [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="index.html">Newbaanboard</a> &gt; <a href="index.html">Baan SIGs</a> &gt; <a href="index.html">AFS/DDC/OLE: Function servers</a> &gt; AFS from tfacp1100s000</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">monica1</div><div class="date">17th March 2005, 14:25</div></div><div class="posttext">I try to create a record in tfacp100 using AFS with the session tfacp1100s000 with this code:<br />
<br />
	stpapi.put.field(&quot;tfacp1100s000&quot;, &quot;tfacp100.ifbp&quot;, catel005.bpid )<br />
	stpapi.put.field(&quot;tfacp1100s000&quot;, &quot;tfacp100.invd&quot;, str$(catel003.fecha))<br />
	stpapi.put.field(&quot;tfacp1100s000&quot;, &quot;tfacp100.isup&quot;, catel003.factura)<br />
	stpapi.put.field(&quot;tfacp1100s000&quot;, &quot;tfacp100.amti&quot;, str$(catel003.pagar))<br />
	stpapi.put.field(&quot;tfacp1100s000&quot;, &quot;fotocopi&quot;, str$(etol(tcyesno.yes)))<br />
	ret = stpapi.insert(&quot;tfacp1100s000&quot;, true, mensaje)<br />
	stpapi.end.session(&quot;tfacp1100s000&quot;)	<br />
	if not ret  then<br />
		return(false)<br />
	endif<br />
<br />
<br />
It always return with 0 and in the variable mensaje it was &quot;It's no possible&quot;.<br />
<br />
I debugger the session and after goes the second time to field.text.yn to section before.display it returns to the caller session and it execute stpapi.end.session.<br />
<br />
This is the AFS.log I have:<br />
<br />
LOGGING STARTED<br />
17-03-2005<br />
8-&gt;get.fields<br />
8&lt;-get.fields0tfacp100.ninv1screen.orno1screen.pono1referencia1tfacp100.ifbp1tfacp100.ptbp1tfacp100.isup1tfacp100.isup.l1tfacp100.doty.l1tfacp100.docn.l1tfacp100.seri.l1tfacp100.bank.l1tfacp100.refr1tfacp100.invd1f.recep1tfacp100.chbk.l1tfacp100.rbkn.l1tfacp100.expd1tfacp100.ccur1tfacp100.rade1tfacp100.amti1form.rate1portes1importe.portes1tfacp100.bimp1tfacp100.cpay1ver.pgi1tfacp100.paym1status.factura1fotocopi1tfacp100.hcod.l1tfacp100.desc.l1<br />
&gt;tfacp1100s000 put.field:tfacp100.ifbp C1216    <br />
&gt;tfacp1100s000 put.field:tfacp100.invd 731978<br />
&gt;tfacp1100s000 put.field:tfacp100.isup 28-B583-337886      <br />
&gt;tfacp1100s000 put.field:tfacp100.amti 2730.44<br />
&gt;tfacp1100s000 put.field:fotocopi 1<br />
&gt;tfacp1100s000 insert<br />
8-&gt;add.set+save<br />
8&lt;-add.set+save10<br />
&lt;tfacp1100s000 No se permite<br />
&gt;tfacp1100s000 get.mess.code<br />
&lt;tfacp1100s000 ttstps0108          <br />
<br />
<br />
Somebody can help me?<br />
<br />
Thank you in advance,</div></div><hr />



</div>
</body>
</html>