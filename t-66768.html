<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="Print sales invoice by AFS, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] Print sales invoice by AFS AFS/DDC/OLE: Function servers" />
	
	<title>Print sales invoice by AFS [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="index.html">Newbaanboard</a> &gt; <a href="index.html">Baan SIGs</a> &gt; <a href="index.html">AFS/DDC/OLE: Function servers</a> &gt; Print sales invoice by AFS</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">baan.kmurali</div><div class="date">22nd August 2014, 16:20</div></div><div class="posttext">Dear Experts,<br />
            We are automated the sales invoice process by AFS. If we select the &quot;Enter specific order&quot; as &quot;NO&quot;, the sales invoice is generated finely. or else if we select the  &quot;Enter specific order&quot; as &quot;YES&quot;, it's not working and not showing any error.<br />
<br />
Please find the below coding and help me to close it....<br />
<br />
Thanks in advance...	<br />
<br />
orno1 = 2908655<br />
inv.date1 = date.num()<br />
                stpapi.put.field(&quot;tdsls4404m000&quot;, &quot;printed&quot;, str$(etol(tcyesno.no)))<br />
                stpapi.put.field(&quot;tdsls4404m000&quot;, &quot;inv.date&quot;, str$(inv.date1))<br />
		stpapi.put.field(&quot;tdsls4404m000&quot;, &quot;selection&quot;, str$(etol(tcyesno.yes)))<br />
                stpapi.put.field(&quot;tdsls4404m000&quot;, &quot;comp.f&quot;, &quot;000&quot;)<br />
                stpapi.put.field(&quot;tdsls4404m000&quot;, &quot;comp.t&quot;, &quot;999&quot;)<br />
                stpapi.put.field(&quot;tdsls4404m000&quot;, &quot;cuno.f&quot;, &quot;&quot;)<br />
                stpapi.put.field(&quot;tdsls4404m000&quot;, &quot;cuno.t&quot;, &quot;ZZZZZZ&quot;)<br />
                stpapi.put.field(&quot;tdsls4404m000&quot;, &quot;orno.f&quot;, str$(orno1))<br />
                stpapi.put.field(&quot;tdsls4404m000&quot;, &quot;orno.t&quot;, str$(orno1))<br />
                stpapi.put.field(&quot;tdsls4404m000&quot;, &quot;cotp.f&quot;, &quot;&quot;)<br />
                stpapi.put.field(&quot;tdsls4404m000&quot;, &quot;cotp.t&quot;, &quot;ZZZ&quot;)<br />
                stpapi.put.field(&quot;tdsls4404m000&quot;, &quot;amount.f&quot;, &quot;0&quot;)<br />
                stpapi.put.field(&quot;tdsls4404m000&quot;, &quot;amount.t&quot;, &quot;99999999999.00&quot;)<br />
                stpapi.put.field(&quot;tdsls4404m000&quot;, &quot;definite&quot;, str$(etol(tcyesno.yes)))<br />
                stpapi.put.field(&quot;tdsls4404m000&quot;, &quot;direct.process&quot;, str$(etol(tcyesno.no)))<br />
                stpapi.put.field(&quot;tdsls4404m000&quot;, &quot;exci.inv&quot;, str$(etol(tcyesno.no)))<br />
                stpapi.put.field(&quot;tdsls4404m000&quot;, &quot;totals&quot;, str$(etol(tcyesno.no)))<br />
                stpapi.put.field(&quot;tdsls4404m000&quot;, &quot;prnt.options&quot;, str$(etol(tcyesno.no)))<br />
                stpapi.put.field(&quot;tdsls4404m000&quot;, &quot;prnt.sellpr&quot;, str$(etol(tcyesno.no)))<br />
                stpapi.set.report(&quot;tdsls4404m000&quot;, &quot;rtdsls440401000&quot;, &quot;D&quot; , error.mess)                <br />
                if not isspace(error.mess) then<br />
                                message(error.mess)<br />
                endif<br />
                stpapi.handle.subproc(&quot;tdsls4404m000&quot;,&quot;tdsls4820s000&quot;, &quot;add&quot;)<br />
		stpapi.continue.process(&quot;tdsls4404m000&quot;, error.mess)<br />
                if not isspace(error.mess) then<br />
                                message(error.mess)<br />
                endif<br />
		stpapi.handle.subproc(&quot;tdsls4404m000&quot;,&quot;tdsls4820s000&quot;, &quot;add&quot;)<br />
                stpapi.put.field( &quot;tdsls4820s000&quot;, &quot;orno.select&quot;, str$(orno1),1)<br />
                stpapi.put.field( &quot;tdsls4820s000&quot;, &quot;orno.select&quot;, str$(orno2),2)<br />
                stpapi.put.field( &quot;tdsls4820s000&quot;, &quot;orno.select&quot;, str$(orno3),3)<br />
                stpapi.put.field( &quot;tdsls4820s000&quot;, &quot;orno.select&quot;, str$(orno4),4)<br />
                stpapi.put.field( &quot;tdsls4820s000&quot;, &quot;orno.select&quot;, str$(orno5),5)<br />
                stpapi.put.field( &quot;tdsls4820s000&quot;, &quot;orno.select&quot;, str$(orno6),6)<br />
                stpapi.put.field( &quot;tdsls4820s000&quot;, &quot;orno.select&quot;, str$(orno7),7)<br />
                stpapi.put.field( &quot;tdsls4820s000&quot;, &quot;orno.select&quot;, str$(orno8),8)<br />
                stpapi.put.field( &quot;tdsls4820s000&quot;, &quot;orno.select&quot;, str$(orno9),9)<br />
                stpapi.put.field( &quot;tdsls4820s000&quot;, &quot;orno.select&quot;, str$(orno10),10)<br />
		stpapi.continue.process(&quot;tdsls4820s000&quot;, error.mess)  <br />
                stpapi.end.session( &quot;tdsls4820s000&quot;, error.mess ) <br />
                stpapi.end.session(&quot;tdsls4404m000&quot;)<br />
<br />
Thanks and Regards,<br />
Murali</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bhushanchanda</div><div class="date">22nd August 2014, 16:36</div></div><div class="posttext">Hi,<br />
<br />
Declare one variable like orno.temp like<br />
<br />
<br />
<br />
<br />
<br />
Now pass this orno.temp without str$() to your code.<br />
<br />
Also, check if the domain for inv.date1 is correct. I dont have any idea about this session.<br />
<br />
So it will be like:-<br />
<br />
extern domain tcorno orno.temp<br />
orno1 = 2908655<br />
orno.temp = str$(orno1)<br />
inv.date1 = date.num()<br />
stpapi.put.field(&quot;tdsls4404m000&quot;, &quot;printed&quot;, str$(etol(tcyesno.no)))<br />
stpapi.put.field(&quot;tdsls4404m000&quot;, &quot;inv.date&quot;, str$(inv.date1))<br />
stpapi.put.field(&quot;tdsls4404m000&quot;, &quot;selection&quot;, str$(etol(tcyesno.yes)))<br />
stpapi.put.field(&quot;tdsls4404m000&quot;, &quot;comp.f&quot;, &quot;000&quot;)<br />
stpapi.put.field(&quot;tdsls4404m000&quot;, &quot;comp.t&quot;, &quot;999&quot;)<br />
stpapi.put.field(&quot;tdsls4404m000&quot;, &quot;cuno.f&quot;, &quot;&quot;)<br />
stpapi.put.field(&quot;tdsls4404m000&quot;, &quot;cuno.t&quot;, &quot;ZZZZZZ&quot;)<br />
stpapi.put.field(&quot;tdsls4404m000&quot;, &quot;orno.f&quot;, orno.temp)<br />
stpapi.put.field(&quot;tdsls4404m000&quot;, &quot;orno.t&quot;, orno.temp)<br />
stpapi.put.field(&quot;tdsls4404m000&quot;, &quot;cotp.f&quot;, &quot;&quot;)<br />
stpapi.put.field(&quot;tdsls4404m000&quot;, &quot;cotp.t&quot;, &quot;ZZZ&quot;)<br />
stpapi.put.field(&quot;tdsls4404m000&quot;, &quot;amount.f&quot;, &quot;0&quot;)<br />
stpapi.put.field(&quot;tdsls4404m000&quot;, &quot;amount.t&quot;, &quot;99999999999.00&quot;)<br />
stpapi.put.field(&quot;tdsls4404m000&quot;, &quot;definite&quot;, str$(etol(tcyesno.yes)))<br />
stpapi.put.field(&quot;tdsls4404m000&quot;, &quot;direct.process&quot;, str$(etol(tcyesno.no)))<br />
stpapi.put.field(&quot;tdsls4404m000&quot;, &quot;exci.inv&quot;, str$(etol(tcyesno.no)))<br />
stpapi.put.field(&quot;tdsls4404m000&quot;, &quot;totals&quot;, str$(etol(tcyesno.no)))<br />
stpapi.put.field(&quot;tdsls4404m000&quot;, &quot;prnt.options&quot;, str$(etol(tcyesno.no)))<br />
stpapi.put.field(&quot;tdsls4404m000&quot;, &quot;prnt.sellpr&quot;, str$(etol(tcyesno.no)))<br />
stpapi.set.report(&quot;tdsls4404m000&quot;, &quot;rtdsls440401000&quot;, &quot;D&quot; , error.mess) <br />
if not isspace(error.mess) then<br />
message(error.mess)<br />
endif<br />
stpapi.handle.subproc(&quot;tdsls4404m000&quot;,&quot;tdsls4820s000&quot;, &quot;add&quot;)<br />
stpapi.continue.process(&quot;tdsls4404m000&quot;, error.mess)<br />
if not isspace(error.mess) then<br />
message(error.mess)<br />
endif<br />
<br />
|*** DO THE SIMILAR CHANGES IN THE FOLLOWING CODE AS WELL<br />
stpapi.handle.subproc(&quot;tdsls4404m000&quot;,&quot;tdsls4820s000&quot;, &quot;add&quot;)<br />
stpapi.put.field( &quot;tdsls4820s000&quot;, &quot;orno.select&quot;, str$(orno1),1)<br />
stpapi.put.field( &quot;tdsls4820s000&quot;, &quot;orno.select&quot;, str$(orno2),2)<br />
stpapi.put.field( &quot;tdsls4820s000&quot;, &quot;orno.select&quot;, str$(orno3),3)<br />
stpapi.put.field( &quot;tdsls4820s000&quot;, &quot;orno.select&quot;, str$(orno4),4)<br />
stpapi.put.field( &quot;tdsls4820s000&quot;, &quot;orno.select&quot;, str$(orno5),5)<br />
stpapi.put.field( &quot;tdsls4820s000&quot;, &quot;orno.select&quot;, str$(orno6),6)<br />
stpapi.put.field( &quot;tdsls4820s000&quot;, &quot;orno.select&quot;, str$(orno7),7)<br />
stpapi.put.field( &quot;tdsls4820s000&quot;, &quot;orno.select&quot;, str$(orno8),8)<br />
stpapi.put.field( &quot;tdsls4820s000&quot;, &quot;orno.select&quot;, str$(orno9),9)<br />
stpapi.put.field( &quot;tdsls4820s000&quot;, &quot;orno.select&quot;, str$(orno10),10)<br />
stpapi.continue.process(&quot;tdsls4820s000&quot;, error.mess) <br />
stpapi.end.session( &quot;tdsls4820s000&quot;, error.mess ) <br />
stpapi.end.session(&quot;tdsls4404m000&quot;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">24th August 2014, 00:26</div></div><div class="posttext">I tried a few times to get this working in print purchase orders.  I don't think it matters but you could try not putting the orno.f and orno.t ranges at all.  The problem the way I see it is the sub-session does not get activated until the continue and then it is too late cause the main session is already running. I played with it a little bit, but never really worried about it too much.<br />
<br />
My solution was to just make the print process a function and pass all 10 of the orders to it one at a time.  As a matter of fact one of the function servers I wrote asks for 10 orders - then just prints them 1 at a time.  Save me some the trouble of trying to figure it out.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">baan.kmurali</div><div class="date">25th August 2014, 07:32</div></div><div class="posttext">Thanks mark and bhushanchanda, I need to generate single invoice for a packing slip(for multiple orders). <br />
<br />
If we select the &quot;Enter specific order&quot; as &quot;NO&quot;, the sales invoice is generated finely. or else if we select the &quot;Enter specific order&quot; as &quot;YES&quot;, it's not working and not showing any error.<br />
<br />
Please advice us...<br />
<br />
Regards,<br />
Murali</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">25th August 2014, 16:19</div></div><div class="posttext">Like I said this is like print purchase orders. When you enter yes in print specific order it zooms automatically to the session that lets you enter the specific order, then in that session the continue returns you to the print session.  Once there you can hit print.  And it generates only those orders. <br />
<br />
Now when you are writing a function server - when you do a put on the enter specific order of yes, it does not activate the subsession.  It does not occur until you hit continue on the print session.  By then I believe it is too late. The orders are not filled for it to print.  I do not believe the orders get passed back to the print session.  If you have source code you can probably trace through all of this.  That might help you see if you can control it - or maybe you have to add code to get it to work in AFS.<br />
<br />
You can try this but I am not sure it will work:<br />
<br />
extern domain tcorno orno.select(10)<br />
<br />
orno.select(1) = orno(1)<br />
....<br />
orno.select(10 = orno(10)<br />
export(orno.select, &quot;orno.select&quot;)<br />
inv.date1 = date.num()<br />
stpapi.put.field(&quot;tdsls4404m000&quot;, &quot;printed&quot;, str$(etol(tcyesno.no)))<br />
stpapi.put.field(&quot;tdsls4404m000&quot;, &quot;inv.date&quot;, str$(inv.date1))<br />
stpapi.put.field(&quot;tdsls4404m000&quot;, &quot;selection&quot;, str$(etol(tcyesno.yes)))<br />
stpapi.put.field(&quot;tdsls4404m000&quot;, &quot;comp.f&quot;, &quot;000&quot;)<br />
stpapi.put.field(&quot;tdsls4404m000&quot;, &quot;comp.t&quot;, &quot;999&quot;)<br />
stpapi.put.field(&quot;tdsls4404m000&quot;, &quot;cuno.f&quot;, &quot;&quot;)<br />
stpapi.put.field(&quot;tdsls4404m000&quot;, &quot;cuno.t&quot;, &quot;ZZZZZZ&quot;)<br />
stpapi.put.field(&quot;tdsls4404m000&quot;, &quot;cotp.f&quot;, &quot;&quot;)<br />
stpapi.put.field(&quot;tdsls4404m000&quot;, &quot;cotp.t&quot;, &quot;ZZZ&quot;)<br />
stpapi.put.field(&quot;tdsls4404m000&quot;, &quot;amount.f&quot;, &quot;0&quot;)<br />
stpapi.put.field(&quot;tdsls4404m000&quot;, &quot;amount.t&quot;, &quot;99999999999.00&quot;)<br />
stpapi.put.field(&quot;tdsls4404m000&quot;, &quot;definite&quot;, str$(etol(tcyesno.yes)))<br />
stpapi.put.field(&quot;tdsls4404m000&quot;, &quot;direct.process&quot;, str$(etol(tcyesno.no)))<br />
stpapi.put.field(&quot;tdsls4404m000&quot;, &quot;exci.inv&quot;, str$(etol(tcyesno.no)))<br />
stpapi.put.field(&quot;tdsls4404m000&quot;, &quot;totals&quot;, str$(etol(tcyesno.no)))<br />
stpapi.put.field(&quot;tdsls4404m000&quot;, &quot;prnt.options&quot;, str$(etol(tcyesno.no)))<br />
stpapi.put.field(&quot;tdsls4404m000&quot;, &quot;prnt.sellpr&quot;, str$(etol(tcyesno.no)))<br />
stpapi.set.report(&quot;tdsls4404m000&quot;, &quot;rtdsls440401000&quot;, &quot;D&quot; , error.mess) <br />
if not isspace(error.mess) then<br />
message(error.mess)<br />
endif<br />
stpapi.continue.process(&quot;tdsls4404m000&quot;, error.mess)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">baan.kmurali</div><div class="date">26th August 2014, 13:26</div></div><div class="posttext">Mark.. I tried what you suggested. It's not working... <br />
<br />
Please advice...<br />
<br />
Thanks,<br />
Murali</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">26th August 2014, 14:48</div></div><div class="posttext">About the only thing I can think of to try.  Do you have source code you can trace thru?</div></div><hr />



</div>
</body>
</html>