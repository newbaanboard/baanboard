<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="AFS Problem device window not appering, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] AFS Problem device window not appering AFS/DDC/OLE: Function servers" />
	
	<title>AFS Problem device window not appering [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="index.html">Newbaanboard</a> &gt; <a href="index.html">Baan SIGs</a> &gt; <a href="index.html">AFS/DDC/OLE: Function servers</a> &gt; AFS Problem device window not appering</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">loveneesh</div><div class="date">18th May 2004, 13:36</div></div><div class="posttext">We have two server one has baanc4 sp9 and other one have baanc4 sp14<br />
I am trying to print report using afs call  but it is not working in sp14 server but same code is woring in sp9 .<br />
<br />
Is there any change in stpapi.set.report() function between service pack 9 and service pack 14 ?<br />
<br />
 Iam using these lines in my program<br />
<br />
		stpapi.set.report(P.SESSION,&quot;rtdilc4202010004&quot;, spool.device, error.msg)<br />
		if isspace(recover.msg) then	<br />
|			stpapi.print.report(P.SESSION, error.msg)	|lk.o<br />
			stpapi.continue.process(P.SESSION, error.msg)<br />
		endif				<br />
       		stpapi.end.session(P.SESSION)<br />
<br />
<br />
In sp9  device window prompt and wait for user selection  but in sp14 it dont wait or even if I dont assign any value to  spool.device it gives error no data selected and don't do any think<br />
<br />
Regards<br />
Lovnish</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">18th May 2004, 15:30</div></div><div class="posttext">I notice you are on Baan V, we are on Baan IV.  I have never had the device open session (ttstpsplopen) come up for a report.  I usually do something like this:<br />
<br />
<br />
	spool.device = &quot;&quot;<br />
	rpt = spool.open(&quot;&quot;,spool.device,2)<br />
	if not rpt then<br />
		choice.again()<br />
	endif<br />
                spool.close()<br />
<br />
<br />
The I set the device and call the report.  Maybe Baan V is different, but I would not expect it to be.  If you set spool.device and call the report after setting a valid range, I would not expect - &quot;no data found&quot;.  There may be other problems with SP14.  You may need another stpapi patch.  I have seen tools patches and session patches start causing the function server code to act differently.<br />
<br />
Mark</div></div><hr />



</div>
</body>
</html>