<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="stpapi.change.view  returnkode 2 ?, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] stpapi.change.view  returnkode 2 ? AFS/DDC/OLE: Function servers" />
	
	<title>stpapi.change.view  returnkode 2 ? [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="index.html">Newbaanboard</a> &gt; <a href="index.html">Baan SIGs</a> &gt; <a href="index.html">AFS/DDC/OLE: Function servers</a> &gt; stpapi.change.view  returnkode 2 ?</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">croezen</div><div class="date">1st April 2011, 16:02</div></div><div class="posttext">hi guys,<br />
I am using &quot;stpapi.change.view&quot; when i want to check if the bom already exists and i want to insert.<br />
<br />
<br />
stpapi.put.field(l.ses, &quot;tibom010.mitm&quot;, i.mitm)<br />
stpapi.put.field(l.ses, &quot;tibom010.opno&quot;, &quot;0&quot;)<br />
<br />
l.ret = stpapi.change.view(l.ses, o.errmess)<br />
<br />
if l.ret &lt;&gt; 1 then<br />
      o.OK = false<br />
      o.errmess = &quot;BOM present&quot;<br />
      goto EndSession<br />
endif<br />
<br />
<br />
returnvalue :  my docu says :<br />
 0 = no view found or error occurred and err.mesg is filled<br />
 1 = view found and err.mesg is empty<br />
 2 = another view found and err.mesg is empty<br />
<br />
Now i have an item without BOM and when i use change.view it always returns 2 ????<br />
<br />
Is my docu not correct or am i reading it wrong !?  what's happening here ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">4th April 2011, 15:59</div></div><div class="posttext">If you want to check if the bom exists prior to inserting - just check the bom table directory.  There is no reason for the overhead of stpapi calling a session.  Just do a quick select on tibom010 and be done with it.<br />
<br />
Besides if you have an item that does not have a BOM - then a return code of 2 is what I would expect.  The reason being when I do a find manually - baan returns the first item after the one I entered.  So 2 is the code I would expect to be returned.</div></div><hr />



</div>
</body>
</html>