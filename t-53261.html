<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="Problem with AFS for tfgld4410m000, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] Problem with AFS for tfgld4410m000 AFS/DDC/OLE: Function servers" />
	
	<title>Problem with AFS for tfgld4410m000 [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="index.html">Newbaanboard</a> &gt; <a href="index.html">Baan SIGs</a> &gt; <a href="index.html">AFS/DDC/OLE: Function servers</a> &gt; Problem with AFS for tfgld4410m000</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">ap2203</div><div class="date">7th August 2008, 22:46</div></div><div class="posttext">I try write AFS for tfgld4410m000, but I can not do it. I put field ocom, tror, fitr, trdt and on the second form field index.<br />
Whatewer i do i can do it corrert because when I put field trdt and I control from debug field is correct and when I start session I get data which I dont set in field.<br />
Can anyone help me<br />
Where I make a mistake<br />
Thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">8th August 2008, 14:42</div></div><div class="posttext">Post you code for tfgld4410m000 and we might see the problem.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ap2203</div><div class="date">11th August 2008, 15:58</div></div><div class="posttext">Post you code for tfgld4410m000 and we might see the problem.<br />
<br />
Here is my code:<br />
<br />
trdtfroms=date.to.inputstr$(trdtfrom,&quot;%D002,3&quot;,8)<br />
trdttos  =date.to.inputstr$(trdtto,&quot;%D002,3&quot;,8)<br />
stpapi.put.field(&quot;tfgld4410m000&quot;,&quot;ocom.f&quot;,&quot;000&quot;)<br />
stpapi.put.field(&quot;tfgld4410m000&quot;,&quot;ocom.t&quot;,&quot;999&quot;)<br />
stpapi.put.field(&quot;tfgld4410m000&quot;,&quot;tror.f&quot;,str$(etol(tctror.prd)))<br />
stpapi.put.field(&quot;tfgld4410m000&quot;,&quot;tror.t&quot;,str$(etol(tctror.prd)))<br />
stpapi.put.field(&quot;tfgld4410m000&quot;,&quot;fitr.f&quot;,str$(etol(tcfitr.transfer)))<br />
stpapi.put.field(&quot;tfgld4410m000&quot;,&quot;fitr.t&quot;,str$(etol(tcfitr.transfer)))<br />
stpapi.put.field(&quot;tfgld4410m000&quot;,&quot;trdt.f&quot;,trdtfromx)<br />
stpapi.put.field(&quot;tfgld4410m000&quot;,&quot;trdt.t&quot;,trdttox)<br />
stpapi.put.field(&quot;tfgld4410m000&quot;,&quot;screen.ccur&quot;,&quot;HRK&quot;)<br />
|stpapi.put.field(&quot;tfgld4410m000&quot;,&quot;fyer.f&quot;,str$(year.ff))<br />
|stpapi.put.field(&quot;tfgld4410m000&quot;,&quot;fyer.t&quot;,str$(year.tt))<br />
|stpapi.put.field(&quot;tfgld4410m000&quot;,&quot;fprd.f&quot;,str$(prod.ff))<br />
|stpapi.put.field(&quot;tfgld4410m000&quot;,&quot;fprd.t&quot;,str$(prod.tt))<br />
stpapi.put.field(&quot;tfgld4410m000&quot;,&quot;auto.index&quot;,str$(etol(tcyesno.yes)))<br />
stpapi.put.field(&quot;tfgld4410m000&quot;,&quot;index.choice&quot;,&quot;1&quot;)<br />
i=stpapi.find(&quot;tfgld4410m000&quot;)<br />
stpapi.set.report(&quot;tfgld4410m000&quot;,&quot;rtfgld441012000&quot;,printer1,err.msg)<br />
stpapi.continue.process(&quot;tfgld4410m000&quot;,err.cont)	<br />
stpapi.end.session(&quot;tfgld4410m000&quot;)<br />
last.mess.sess.tfgld4410=stpapi.get.mess.code(sess.tfgld4410)<br />
stpapi.end.session(&quot;tfgld4410m000&quot;)<br />
<br />
Whatever I put in the field tror.f and fitr.f program begins with tctror.pur and<br />
tcfitr.receipt, but I dont wont that<br />
Can you help me what is not correct<br />
Thanks for help</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">11th August 2008, 16:18</div></div><div class="posttext">Elminate the stpapi.find - not necessary.  See if that works.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ap2203</div><div class="date">11th August 2008, 16:45</div></div><div class="posttext">I try, but it doesnt work.<br />
Nothing happend<br />
Any new idea</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">11th August 2008, 18:11</div></div><div class="posttext">No new ideas, but tomorrow when I get a chance I will test the code on our test system.  I do not see anything that should reset those two fields.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">12th August 2008, 15:15</div></div><div class="posttext">Okay this worked for me:<br />
<br />
	domain	tcdate	somedate<br />
	somedate = date.num() <br />
	stpapi.put.field(&quot;tfgld4410m000&quot;,&quot;ocom.f&quot;,&quot;701&quot;)<br />
	stpapi.put.field(&quot;tfgld4410m000&quot;,&quot;ocom.t&quot;,&quot;701&quot;)<br />
	stpapi.put.field(&quot;tfgld4410m000&quot;,&quot;tror.f&quot;,str$(etol(tctror.prd)))<br />
	stpapi.put.field(&quot;tfgld4410m000&quot;,&quot;tror.t&quot;,str$(etol(tctror.prd)))<br />
	stpapi.put.field(&quot;tfgld4410m000&quot;,&quot;fitr.f&quot;,str$(etol(tcfitr.p.mat.isu.hrd.a)))<br />
	stpapi.put.field(&quot;tfgld4410m000&quot;,&quot;fitr.t&quot;,str$(etol(tcfitr.p.mat.isu.hrd.a)))<br />
	stpapi.put.field(&quot;tfgld4410m000&quot;,&quot;trdt.f&quot;,str$(somedate - 30))<br />
	stpapi.put.field(&quot;tfgld4410m000&quot;,&quot;trdt.t&quot;,str$(somedate))<br />
	stpapi.set.report(&quot;tfgld4410m000&quot;, &quot;rtfgld441012000&quot;,&quot;D66&quot;, err)<br />
	stpapi.continue.process(&quot;tfgld4410m000&quot;,err) <br />
	err = stpapi.get.mess.code(&quot;tfgld4410m000&quot;)<br />
	mess(err,1)<br />
	stpapi.end.session(&quot;tfgld4410m000&quot;)<br />
<br />
Note you need to move the stpapi.get.mess.code to right before you end the session.  Make sure you are not getting any messages. In my case I put only the fields I needed.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ap2203</div><div class="date">12th August 2008, 23:39</div></div><div class="posttext">Okay this worked for me:<br />
<br />
	domain	tcdate	somedate<br />
	somedate = date.num() <br />
	stpapi.put.field(&quot;tfgld4410m000&quot;,&quot;ocom.f&quot;,&quot;701&quot;)<br />
	stpapi.put.field(&quot;tfgld4410m000&quot;,&quot;ocom.t&quot;,&quot;701&quot;)<br />
	stpapi.put.field(&quot;tfgld4410m000&quot;,&quot;tror.f&quot;,str$(etol(tctror.prd)))<br />
	stpapi.put.field(&quot;tfgld4410m000&quot;,&quot;tror.t&quot;,str$(etol(tctror.prd)))<br />
	stpapi.put.field(&quot;tfgld4410m000&quot;,&quot;fitr.f&quot;,str$(etol(tcfitr.p.mat.isu.hrd.a)))<br />
	stpapi.put.field(&quot;tfgld4410m000&quot;,&quot;fitr.t&quot;,str$(etol(tcfitr.p.mat.isu.hrd.a)))<br />
	stpapi.put.field(&quot;tfgld4410m000&quot;,&quot;trdt.f&quot;,str$(somedate - 30))<br />
	stpapi.put.field(&quot;tfgld4410m000&quot;,&quot;trdt.t&quot;,str$(somedate))<br />
	stpapi.set.report(&quot;tfgld4410m000&quot;, &quot;rtfgld441012000&quot;,&quot;D66&quot;, err)<br />
	stpapi.continue.process(&quot;tfgld4410m000&quot;,err) <br />
	err = stpapi.get.mess.code(&quot;tfgld4410m000&quot;)<br />
	mess(err,1)<br />
	stpapi.end.session(&quot;tfgld4410m000&quot;)<br />
<br />
Note you need to move the stpapi.get.mess.code to right before you end the session.  Make sure you are not getting any messages. In my case I put only the fields I needed.<br />
<br />
I'll try do identical as you write and I expect success (at then begining write code I also write only fileds I need but doesnt work, after that I put another fields from form1 and also from form2, but without effects ) <br />
Thanks for help</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">13th August 2008, 04:38</div></div><div class="posttext">It could be as simple as needing library update or a session update.  Have you contacted support?  Do you have the source code for tfgld4410m000?  If you do you could put it in debug mode and see what is happening.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ap2203</div><div class="date">28th August 2008, 18:05</div></div><div class="posttext">I'll try do identical as you write and I expect success (at then begining write code I also write only fileds I need but doesnt work, after that I put another fields from form1 and also from form2, but without effects ) <br />
Thanks for help<br />
<br />
Now it work<br />
Thanks</div></div><hr />



</div>
</body>
</html>