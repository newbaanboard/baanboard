<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="Newbie OLE/AFS Questions, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] Newbie OLE/AFS Questions AFS/DDC/OLE: Function servers" />
	
	<title>Newbie OLE/AFS Questions [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="index.html">Newbaanboard</a> &gt; <a href="index.html">Baan SIGs</a> &gt; <a href="index.html">AFS/DDC/OLE: Function servers</a> &gt; Newbie OLE/AFS Questions</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">vinceco252</div><div class="date">10th May 2002, 18:38</div></div><div class="posttext">I have some really basic, and possibly stupid, questions, so please bear with me.<br />
<br />
My environment is NT 4.0, SQL Server 7, and Baan IVc3.  <br />
<br />
I am designing a VB based shop floor control program to integrate to a Baan Distribution customization that designed at our original implementation.  I have full access to all of the code involved in the customization, but no standard Baan source code.  Baan will no longer distribute BCK, and purchasing OpenWorld is not an option.<br />
<br />
So, my questions are:<br />
<br />
How does an AFS work with non-Baan programming?<br />
<br />
To utiliize Baan's OLE interface, does a session have to have an AFS?<br />
<br />
If not, how does the OLE interface work?  I have tried several of the samples in this forum, and I cannot get them to work right.  Does anyone have a sample of using OLE/VB to insert an item into ttiitm001100 or a sales/ purchase order header?  A sample like that would be really helpful.<br />
<br />
Also, please comment on anything I don't seem to understand from reading my post.  Also, any general comments on VB to Baan integration would be appreciated.  Thank you all ahead of time for your help.<br />
<br />
Vince</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">10th May 2002, 20:18</div></div><div class="posttext">Hello Vince!<br />
<br />
To use OLE you do not have to use a session. You can query and update tables.  I have done a vew queries, but I have not updated any tables.  So you do not have to use the AFS functionality.<br />
<br />
BUT I recommend using AFS type function servers, UNLESS you know all tables that need to be updated.  So for example on tiitm001 if you update it then there maybe some supporting tables that you also need to update. Since I do not know these type of things, I almost always use AFS type function servers.  This way the session updates all the appropriate tables.  Our conversion to Baan was done using function servers and I must admit(at least at my site) it was very successful(Thanks to Gordon Fasbender and his AFS routines).<br />
<br />
Sorry I do not have any update samples and for the function server piece it appears you have already tried some of the other posts. It seems to me that all the others eventually had their code working. Maybe in another post you could attach some of your code and what the problem is.  Then one of the real gurus(not me) could help you.<br />
<br />
Good Luck!<br />
<br />
Mark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">vinceco252</div><div class="date">10th May 2002, 20:26</div></div><div class="posttext">Thanks for the response Mark.<br />
<br />
2 things:<br />
<br />
I know the tables I am inserting/updating very well.<br />
<br />
I think I am missing the part of AFS from where you create it with the create dll session to how you integrate that with an outside programming language.  If anyone has any input on this, I would greatly appreciate it.<br />
<br />
Thanks,<br />
<br />
Vince</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">10th May 2002, 21:40</div></div><div class="posttext">Vince said:<br />
I think I am missing the part of AFS from where you create it with the create dll session to how you integrate that with an outside programming language. <br />
<br />
Not sure what you meant by this.  Are you talking about ttstpcreatdll?  You do not really need to use that if you use the stpapi commands directly.<br />
Maybe we are not understanding each other?<br />
<br />
Anyway I am going to attach some same VB code for calling a DLL that I developed.  I did not clean up these scripts and this is not in production, but it does work.  What I did was take a function server session and changed it to a dll.  This DLL accepts the variables from excel, then calls the FS session.  So in your case you could have a DLL for the update on which ever table(s) you are using.<br />
<br />
Hope this helps!!!<br />
<br />
Mark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">vinceco252</div><div class="date">10th May 2002, 23:01</div></div><div class="posttext">Mark,<br />
<br />
I think it is finally starting to sink through my skull.  I appreciate your help and examples.<br />
<br />
Thanks,<br />
<br />
Vince</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Dwallace</div><div class="date">18th December 2002, 05:53</div></div><div class="posttext">I too am trying to understand these functions....<br />
<br />
? --&gt;  Does the ttstpoledaem have to be running for all this to work?  <br />
<br />
D</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">19th December 2002, 04:23</div></div><div class="posttext">I think when the connect is made to baan from VB it starts this daemon.  I will have to check when I get to work tomorrow.<br />
<br />
Mark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">20th December 2002, 22:33</div></div><div class="posttext">The answer is yes - it should be running.<br />
<br />
Mark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Dwallace</div><div class="date">20th December 2002, 23:32</div></div><div class="posttext">Thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">cherokee</div><div class="date">28th August 2013, 17:57</div></div><div class="posttext">Hello Mark,<br />
<br />
I am looking at your VB and put it in a macro(excel) but, obviously this VBS doesn't connect. What do I need at the Windows/BaaN side to this VB connects. <br />
<br />
We have AIX IVc3.<br />
<br />
Thanks and sorry if I am way too lost...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">28th August 2013, 21:38</div></div><div class="posttext">You need the baan client.  Then you need to load at the automation tab on the client under configure.  Then the class name from the client is what you use to connect with in the code.  When I originally posted this code the automation tab did not exist on the baan client.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">28th August 2013, 21:43</div></div><div class="posttext">Now they usually look something like this:<br />
<br />
    On Error GoTo CannotCreateBaan<br />
    <br />
'run Baan Application<br />
    Set BaanObj = CreateObject(&quot;Baan4.Application.701&quot;)<br />
    ThisWorkbook.Sheets(&quot;PO&quot;).Activate<br />
    BaanObj.Timeout = 10<br />
    On Error GoTo BaanAutomationError<br />
<br />
You should be able to find baan4.application.701 in the registry.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">cherokee</div><div class="date">30th August 2013, 14:40</div></div><div class="posttext">Thanks worked.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">hteixeira</div><div class="date">6th May 2015, 19:35</div></div><div class="posttext">I need to connect to ERP LN 7  the same way dll from Baan IV, but now in LN somebody know how?<br />
<br />
Thanks,<br />
Helena Teixeira</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bhushanchanda</div><div class="date">7th May 2015, 10:47</div></div><div class="posttext">Hi,<br />
<br />
Do not double post. <br />
<br />
Similar thread (http://www.baanboard.com/baanboard/showthread.php?p=194465&amp;posted=1#post194465)</div></div><hr />



</div>
</body>
</html>