<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="Problem manipulating the session tdcotd201m000, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] Problem manipulating the session tdcotd201m000 AFS/DDC/OLE: Function servers" />
	
	<title>Problem manipulating the session tdcotd201m000 [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="index.html">Newbaanboard</a> &gt; <a href="index.html">Baan SIGs</a> &gt; <a href="index.html">AFS/DDC/OLE: Function servers</a> &gt; Problem manipulating the session tdcotd201m000</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">arthur_info</div><div class="date">24th February 2010, 22:15</div></div><div class="posttext">Hello, <br />
<br />
I was searching by the threads, and, I'm thinking that the code below should works. But the system don't shows any error but also don't choose any supplier. P.S: I've tested manually and works.<br />
<br />
(...) put the fields of the indice...<br />
&quot;stpapi.find(&quot;tdcotd201m000&quot;,&quot;                                                  &quot;)&quot;<br />
the function above returns 1<br />
&quot;stpapi.mark(&quot;tdcotd201m000&quot;,&quot;                                                  &quot;)&quot;<br />
the function above mark the current record, ok?<br />
&quot;stpapi.application.option(&quot;tdcotd201m000&quot;,0,1,&quot;                                                  &quot;)&quot;<br />
the function above chooses the current record... I think...<br />
&quot;stpapi.enum.answer(&quot;tdcotd201m000&quot;,&quot;tdcot00005.d&quot;,1)&quot;<br />
the function above says &quot;Yes&quot; for the question... This works, I've tested.<br />
<br />
<br />
So... What I'm doing wrong? The screenshot is attached.<br />
<br />
And other problem. Where I found the command line to activate the AFSLOG like the manual says:<br />
&quot;For bw:  -- -set AFSLOG=1 in the Command field &quot;<br />
<br />
Thanks a lot...<br />
<br />
Arthur</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bdittmar</div><div class="date">25th February 2010, 09:50</div></div><div class="posttext">Hello, <br />
<br />
I was searching by the threads, and, I'm thinking that the code below should works. But the system don't shows any error but also don't choose any supplier. P.S: I've tested manually and works.<br />
<br />
(...) put the fields of the indice...<br />
&quot;stpapi.find(&quot;tdcotd201m000&quot;,&quot;                                                  &quot;)&quot;<br />
the function above returns 1<br />
&quot;stpapi.mark(&quot;tdcotd201m000&quot;,&quot;                                                  &quot;)&quot;<br />
the function above mark the current record, ok?<br />
&quot;stpapi.application.option(&quot;tdcotd201m000&quot;,0,1,&quot;                                                  &quot;)&quot;<br />
the function above chooses the current record... I think...<br />
&quot;stpapi.enum.answer(&quot;tdcotd201m000&quot;,&quot;tdcot00005.d&quot;,1)&quot;<br />
the function above says &quot;Yes&quot; for the question... This works, I've tested.<br />
<br />
<br />
So... What I'm doing wrong? The screenshot is attached.<br />
<br />
And other problem. Where I found the command line to activate the AFSLOG like the manual says:<br />
&quot;For bw:  -- -set AFSLOG=1 in the Command field &quot;<br />
<br />
Thanks a lot...<br />
<br />
Arthur<br />
<br />
Hello,<br />
<br />
start bw, choose configure, use command at the last line.<br />
<br />
Regards</div></div><hr />


<div class="post"><div class="posttop"><div class="username">goooch</div><div class="date">25th February 2010, 13:39</div></div><div class="posttext">Hi Arthur,<br />
I think in AFS you should answer first, then start option</div></div><hr />


<div class="post"><div class="posttop"><div class="username">arthur_info</div><div class="date">25th February 2010, 13:47</div></div><div class="posttext">Hum... About the debug, I've found it here, but the error below appeared...<br />
<br />
process 1 - Error : Can't read session or object (set)<br />
message_loop_nesting error, nesting level = 2 (should be 1)<br />
message_loop_nesting error, nesting level = 1 (should be 0)<br />
Windows Sockets error 10053<br />
Connection with server broken<br />
<br />
I've write &quot;set AFSLOG=1&quot; in the command field. Is it correct?<br />
<br />
Any suggestion?<br />
<br />
Regards<br />
<br />
Arthur</div></div><hr />


<div class="post"><div class="posttop"><div class="username">arthur_info</div><div class="date">25th February 2010, 14:59</div></div><div class="posttext">I changed the order, with the answer first, but the supplier is still not chosen ... <br />
<br />
Any other idea?<br />
<br />
Thanks a lot...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">25th February 2010, 15:39</div></div><div class="posttext">Bernd is correct the answer to the question should be before the question is asked.  My questions is why are you using stpapi.application and not stpapi.continue.process?  They are the same thing in this case from the looks of your form - try that.  Second what happens after you answer yes?  If it runs another session you might have to account for it also.  I also assume your stpapi.find actually a parameter in it for the message that find returns - along with some of the other commands.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">arthur_info</div><div class="date">9th March 2010, 20:30</div></div><div class="posttext">I'm trying to use this command but also don't works...<br />
stpapi.continue.process(&quot;tdcotd201m000&quot;)<br />
It's weird because don't appear any error message, but don't mark and choose the correct supplier...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">arthur_info</div><div class="date">9th March 2010, 21:20</div></div><div class="posttext">In fact, the routine is like that:<br />
<br />
<br />
        Public Shared Function ProcessaRotinaBaan(ByRef BaanObj As Object, ByVal sSession As String, ByVal iForm As Integer, ByVal iOption As Integer, Optional ByVal sReferencia1 As String = &quot;&quot;, Optional ByVal sReferencia2 As String = &quot;&quot;, Optional ByVal sReferencia3 As String = &quot;&quot;) As String<br />
            Dim sErrMsg = Space(50)<br />
            BaanObj.ParseExecFunction(&quot;ottstpapihand&quot;, &quot;stpapi.continue.process(&quot; &amp; Chr(34) &amp; sSession &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; sErrMsg &amp; Chr(34) &amp; &quot;)&quot;)<br />
            'BaanObj.ParseExecFunction(&quot;ottstpapihand&quot;, &quot;stpapi.application.option(&quot; &amp; Chr(34) &amp; sSession &amp; Chr(34) &amp; &quot;,&quot; &amp; CStr(iForm) &amp; &quot;,&quot; &amp; CStr(iOption) &amp; &quot;,&quot; &amp; Chr(34) &amp; sErrMsg &amp; Chr(34) &amp; &quot;)&quot;)<br />
            If BaanObj.Error &lt;&gt; 0 Or BaanObj.ReturnValue &lt;&gt; &quot;1&quot; Or sErrMsg &lt;&gt; &quot;&quot; Then<br />
                Return sReferencia1 &amp; vbCr &amp; vbLf &amp; _<br />
                       sReferencia2 &amp; vbCr &amp; vbLf &amp; _<br />
                       sReferencia3 &amp; vbCr &amp; vbLf &amp; _<br />
                       &quot;Erro: &quot; &amp; BaanObj.FunctionCall.ToString().Substring(InStr(BaanObj.FunctionCall, &quot;,1,&quot;) + 3, BaanObj.FunctionCall.ToString().Length - InStr(BaanObj.FunctionCall, &quot;,1,&quot;) - 6)<br />
            Else<br />
                Return String.Empty<br />
            End If<br />
        End Function<br />
<br />
<br />
The &quot;option&quot; command is disabled, because don't works too...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">9th March 2010, 23:13</div></div><div class="posttext">Here is my best guess on what I would expect to see:<br />
<br />
stpapi.put  &lt;-- Put the fields to find.<br />
stpapi.find &lt;-- this will find the record and usually mark the record as current<br />
stpapi.enum.answer &lt;-- answer to the question.<br />
stpapi.continue &lt;-- continue to start processing <br />
<br />
Can't speculate what the continue might require.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">arthur_info</div><div class="date">10th March 2010, 22:30</div></div><div class="posttext">Mark<br />
<br />
I don't have words to express my gratitude. The only problem was the order of commands and instead of using the other command, the right was to use &quot;continue&quot;. It worked perfectly.<br />
<br />
Thank you very much,<br />
<br />
Arthur</div></div><hr />



</div>
</body>
</html>