<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="How can I change the company, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] How can I change the company AFS/DDC/OLE: Function servers" />
	
	<title>How can I change the company [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="index.html">Newbaanboard</a> &gt; <a href="index.html">Baan SIGs</a> &gt; <a href="index.html">AFS/DDC/OLE: Function servers</a> &gt; How can I change the company</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">anthony peiris</div><div class="date">5th January 2011, 23:32</div></div><div class="posttext">I need to switch the company using switch.to.company(nnn) before Print Sales Order Acknowledgement session.<br />
<br />
When I invoke this function through 'ottstpapihand' it tells me that the<br />
switch.to.company() function is not found <br />
<br />
<br />
How can I change the company while in the session</div></div><hr />


<div class="post"><div class="posttop"><div class="username">VishalMistry</div><div class="date">6th January 2011, 05:32</div></div><div class="posttext">Hi,<br />
<br />
Try to use function compnr.check() and check if it works.<br />
<br />
Vishal</div></div><hr />


<div class="post"><div class="posttop"><div class="username">thieuf</div><div class="date">6th January 2011, 14:25</div></div><div class="posttext">Why would you want to switch to company using API?, just program it directly.Make sure the other company is in the same package combination....<br />
<br />
regards</div></div><hr />


<div class="post"><div class="posttop"><div class="username">anthony peiris</div><div class="date">6th January 2011, 15:28</div></div><div class="posttext">Why would you want to switch to company using API?, just program it directly.Make sure the other company is in the same package combination....<br />
<br />
regards<br />
I have following xml input file which is read by the ole automation and execute verbs (commands) with given parameters.<br />
<br />
Based on the Salesorder number I need to switch the company (which is supplied as an arg[uement]) to the verb 'switchtocompany' before remainder of the program (xml declarations) could run.<br />
<br />
Hope this clarify.<br />
Thanks - Anthony<br />
<br />
<br />
&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; ?&gt;<br />
&lt;!-- Primarily deviced to invoke BaaN sessions <br />
     Last Modified <br />
--&gt;<br />
&lt;session name =&quot;tdsls4401m000&quot; domain=&quot;baan&quot;&gt;<br />
  &lt;args&gt;<br />
    &lt;!-- any of the verbs/verb/arg  can be specified as an arg <br />
    : target axis are replaced from specified session/args<br />
    un specified args are taken from verb/verbs/parametr defaut value<br />
   --&gt;<br />
    &lt;arg target=&quot;/session/verbs/verb[@action='switchtocompany']/parameter[@name='comp']&quot; type =&quot;int&quot; &gt;200&lt;/arg&gt;<br />
    &lt;arg target=&quot;/session/verbs/verb[@action='put']/parameter[@name='orno.f']&quot; type =&quot;string&quot; &gt;141527&lt;/arg&gt;<br />
    &lt;arg target=&quot;/session/verbs/verb[@action='put']/parameter[@name='orno.t']&quot; type =&quot;string&quot; &gt;141527&lt;/arg&gt;<br />
    &lt;arg target=&quot;/session/verbs/verb[@action='put']/parameter[@name='comp.f']&quot; type =&quot;string&quot; &gt;000&lt;/arg&gt;<br />
    &lt;arg target=&quot;/session/verbs/verb[@action='put']/parameter[@name='comp.t']&quot; type =&quot;string&quot; &gt;999&lt;/arg&gt;<br />
    &lt;arg target=&quot;/session/verbs/verb[@action='setreport']/arg[@name='device']&quot; type =&quot;string&quot; &gt;105&lt;/arg&gt;<br />
  &lt;/args&gt;<br />
  &lt;verbs&gt;<br />
    &lt;verb action=&quot;switchtocompany&quot;&gt;<br />
      &lt;parameter name=&quot;comp&quot; debug=&quot;true&quot;&gt;200&lt;/parameter&gt;<br />
    &lt;/verb&gt;<br />
    &lt;verb action=&quot;put&quot;&gt;<br />
      &lt;parameter name=&quot;orno.f&quot; debug=&quot;true&quot;&gt;141527&lt;/parameter&gt;<br />
    &lt;/verb&gt;<br />
    &lt;verb action=&quot;put&quot;&gt;<br />
      &lt;parameter name=&quot;orno.t&quot;&gt;141527&lt;/parameter&gt;<br />
    &lt;/verb&gt;<br />
    &lt;verb action=&quot;put&quot;&gt;<br />
      &lt;parameter name=&quot;comp.f&quot;&gt;000&lt;/parameter&gt;<br />
    &lt;/verb&gt;<br />
    &lt;verb action=&quot;put&quot;&gt;<br />
      &lt;parameter name=&quot;comp.t&quot;&gt;999&lt;/parameter&gt;<br />
    &lt;/verb&gt;<br />
    &lt;verb action=&quot;put&quot;&gt;<br />
      &lt;parameter name=&quot;prnt.discount&quot; type=&quot;int&quot;&gt;1&lt;/parameter&gt;<br />
    &lt;/verb&gt;<br />
    &lt;verb action=&quot;put&quot;&gt;<br />
      &lt;parameter name=&quot;printed&quot; type=&quot;int&quot;&gt;1&lt;/parameter&gt;<br />
    &lt;/verb&gt;<br />
    &lt;verb action=&quot;put&quot;&gt;<br />
      &lt;parameter name=&quot;quan.to.print&quot;&gt;1&lt;/parameter&gt;<br />
    &lt;/verb&gt;<br />
    &lt;verb action=&quot;put&quot;&gt;<br />
      &lt;parameter name=&quot;prnt.options&quot;&gt;2&lt;/parameter&gt;<br />
    &lt;/verb&gt;<br />
    &lt;verb action=&quot;put&quot;&gt;<br />
      &lt;parameter name=&quot;prnt.sellpr&quot; type=&quot;int&quot;&gt;2&lt;/parameter&gt;<br />
    &lt;/verb&gt;<br />
    &lt;verb action=&quot;put&quot;&gt;<br />
      &lt;parameter name=&quot;num.copies&quot;&gt;1&lt;/parameter&gt;<br />
    &lt;/verb&gt;<br />
    &lt;verb action=&quot;put&quot;&gt;<br />
      &lt;parameter name=&quot;selection&quot; type=&quot;int&quot;&gt;2&lt;/parameter&gt;<br />
    &lt;/verb&gt;<br />
    &lt;verb action=&quot;setreport&quot;&gt;<br />
      &lt;parameter name=&quot;reportname&quot;&gt;rtdsls440101000&lt;/parameter&gt;<br />
      &lt;parameter name=&quot;device&quot;&gt;105&lt;/parameter&gt;<br />
    &lt;/verb&gt;<br />
    &lt;verb action=&quot;continue&quot;/&gt;<br />
    &lt;verb action=&quot;endsession&quot; /&gt;<br />
  &lt;/verbs&gt;<br />
&lt;/session&gt;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">6th January 2011, 15:55</div></div><div class="posttext">I am not sure if there is a library with switch.to.company in it.  As a work around you can write your own library in baan to execute the switch.to.company then execute the follow on commands in ottstpapihand.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">thieuf</div><div class="date">6th January 2011, 17:19</div></div><div class="posttext">Hy,<br />
<br />
I am not to familiar with the ole automation, but you could perhaps try some things:<br />
invoke session ttdsk2003m000 using api command...which is the switch to company from the menu session.<br />
<br />
We had a similar challenge once when importing data into baan from an excel file/macro.<br />
We created a session which was &quot;started&quot; from excell but we used 2 different &quot;users&quot; to get the data in the correct company.<br />
<br />
If the &quot;seperation trigger&quot; is in the file itself, then perhaps you could &quot;split&quot; the files before import into to 2 different files and use this split to start it up in a different company...<br />
<br />
just some ideas. hope it helps...<br />
<br />
regards...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Al Smith</div><div class="date">9th January 2011, 03:05</div></div><div class="posttext">switch.to.company is in ottstp_stddll.<br />
C# call:<br />
BaanObj.ParseExecFunction(&quot;ottstp_stddll&quot;, &quot;switch.to.company(&quot; + 200 + &quot;)&quot;);<br />
<br />
Al.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">anthony peiris</div><div class="date">10th January 2011, 16:50</div></div><div class="posttext">Hi Al,<br />
<br />
Thanks a lot for the lead.. I was about to go the way Mark Suggested. Your's will save me creating dll.</div></div><hr />



</div>
</body>
</html>