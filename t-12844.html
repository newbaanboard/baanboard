<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="Problem with OLE, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] Problem with OLE AFS/DDC/OLE: Function servers" />
	
	<title>Problem with OLE [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="index.html">Newbaanboard</a> &gt; <a href="index.html">Baan SIGs</a> &gt; <a href="index.html">AFS/DDC/OLE: Function servers</a> &gt; Problem with OLE</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">zardoz</div><div class="date">4th September 2003, 17:25</div></div><div class="posttext">I've a VB application that calls a Baan IV DLL via OLE. This application works well till the last month. Now (sometimes) I find the Option Dialog hanged and the BW message &quot;Loop nesting error&quot;. After killing the option dialog and run again the VB application, it works. No message are logged in $BSE/log files. I suppose it's a network related problem, but I have no idea how to solve it. <br />
Someone has found this problem before?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">5th September 2003, 16:13</div></div><div class="posttext">I have seen the option dialog hang, but not like this.  Has there been a tools update?  At one time a tools patch completely broke the OLE piece on our system.<br />
<br />
Mark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">zardoz</div><div class="date">11th September 2003, 16:10</div></div><div class="posttext">I received the response from the BaaN Support. I enclose the case description and the response, just for fun:<br />
<br />
Case description: <br />
I have an application written in Visual Basic that runs through OLE automation an application function server DLL written in BaaN Tools.<br />
Sometimes the Option Dialog button hangs and the following messages appears in BW: <br />
1: message_loop_nesting error, nesting level = 2 (should be 1)<br />
2: message_loop_nesting error, nesting level = 1 (should be 0)<br />
No errors are logged in the .log files of the $BSE/log directories of the server.<br />
If the option dialog is killed and the VB application run again, all is ok.<br />
 <br />
Solution description: <br />
Unfortunately we were not able to reach you by telephone.<br />
<br />
Unfortunately, the OLE integration to BaanIV is not officially supported. At the time, it had been created as a proof of concept. Over time, the technology has changed so much that we cannot guarantee the proper operation of this integration.<br />
<br />
However, this change of technology allows for new, better and supported integration methods. All new integrations are available at following solutions:<br />
<br />
- iBaan Integration Pack 2.0 for ERP 5 - MS Office BOI2.0 Office Integration 2.0) - Solution No: 127466 <br />
<br />
- Generic Solution for Office Integration based on Open World technology - Solution No: 126530 <br />
<br />
Easy solution, isn't it? I am based on BaaN IV C4 and the solution seems to be to move to BaaN ERP and Open World!<br />
:D</div></div><hr />


<div class="post"><div class="posttop"><div class="username">p.cole</div><div class="date">11th September 2003, 19:43</div></div><div class="posttext">I am also developing an OLE based integration between Baan IVc4 and MS Excel 97.  In the latest version of Baan Windows (bw.072) Baan include the mpsole.xls (or similar) spreadsheets. The OLE integration was also touted as one of the improvements in the release notes of Baan IVc. <br />
<br />
Please let me know the case number you raised so that I can investigate this further with our local support office (UK).<br />
<br />
Suffice to say I will be most upset if they have stopped supporting this functionality and will not support it if a future service pack/solution/porting set breaks it.<br />
<br />
Please private message me if you want.<br />
<br />
Thanks<br />
<br />
Phil Cole<br />
:confused:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">11th September 2003, 21:14</div></div><div class="posttext">Hi zardoz!<br />
<br />
Your response brought back memories that I had suppressed.  I believe I even have a post on the board about it.  But basically I was told the same thing you were - except I was left with the impression that baan open world technology was available for 4c4.  <br />
<br />
My problem was the client software.  The new version we rolled out caused my OLE stuff to stop working.  It took Baan support a few days to give me the same answer they gave you.  I was lucky in the fact that I never rolled out what I had done into production - and I still will not do that.  The only place that it is used is on my PC. I was able to keep the old client, manipulate some registry entries and keep it working on my PC.  Somewhere along the way it started working with our current client - I still do not trust putting it into production.<br />
<br />
Also please let us know what you find out Phil.<br />
<br />
Mark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">p.cole</div><div class="date">11th September 2003, 22:29</div></div><div class="posttext">I'm currently developing with Baan IVc4 SP12 using Bw.067 and above.  I haven't encountered any problems like you mention yet.<br />
<br />
bw has had some OLE/COM updates in it because it is started by worktop with the /automation command line parameter. e.g. &quot;bw.exe &lt;bwcfile&gt; /automation&quot; - or similar - so it is not totally orphaned.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Al Smith</div><div class="date">13th September 2003, 15:11</div></div><div class="posttext">Hi,<br />
I have seen Loop nesting errors occur when a second OLE is started against a dll that is already running by the first OLE connection.<br />
Al.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">zardoz</div><div class="date">16th September 2003, 12:05</div></div><div class="posttext">Al, I think you have got it.<br />
I have in fact 5 different VB objects that all interacts with the same DLL that have 5 different functions in it. <br />
It seems that the problem is that one of this ones doesn't terminate correctly, because of locks on the table ticst002, so the program terminates (after 10 retries) and leaves the Option Dialog (and the BW messages) open with the 107 error in it, so when I try to run another VB program it finds the option dialog open.<br />
My question now is: how can I kill automatically the previous &quot;Option Dialog&quot; from my other program, so others programs can continue? Or - how can I avoid the error raising of the previous program, so the option dialog closes?<br />
Thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Al Smith</div><div class="date">16th September 2003, 15:26</div></div><div class="posttext">Hi,<br />
Here's what I use to detect for an open &quot;Option Dialog&quot;.<br />
<br />
Place this in the declarations section of your VB project: Private Declare Function FindWindow Lib &quot;user32&quot; Alias &quot;FindWindowA&quot; (ByVal _<br />
lpClassName As String, ByVal lpWindowName As String) As LongThen, in the Sub and prior to creating the BaanObj, place this loop:w = 1<br />
Do While w &lt;&gt; 0<br />
w = FindWindow(vbNullString, &quot;Option Dialog&quot;)<br />
DoEvents<br />
LoopI use this to prevent a second OLE to a dll before the first has finished.<br />
I hope this helps.<br />
Al.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">zardoz</div><div class="date">18th September 2003, 19:41</div></div><div class="posttext">Al, thanks - this function works perfectly.<br />
But the problem still remains. For some reason an OLE doesn't close correclty, due network problems or other (maybe the complexity - the DLL closes the production orders, writing the lots received and backflushes hours and materials, calling a lot of DLL's and sessions).<br />
How about a function that kills automatically the option dialog found opened, maybe after a certain timeout, just before starting the DLL? I think that somewhere in the standard windows DLL's can be such a function, but I havent idea how to search that information.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">p.cole</div><div class="date">18th September 2003, 23:40</div></div><div class="posttext">I have received a reply from Baan Support UK. Case number: 1053646<br />
<br />
Basically, Baan do not support any external scripts that use OLE, nor the example spreadsheets distributed with the bw client - fair enough.  However, if a third party solution/script is created that uses OLE functionality and Baan subsequently release a software upgrade/patch that causes the script to break then Baan would look at the problem and try to help solve it.<br />
<br />
Hope this helps you.  It is enough for me to be assured that we can develop our OLE based solution and it not be &quot;broken&quot; at some point in the future. :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">19th September 2003, 00:02</div></div><div class="posttext">Phil,<br />
<br />
What qualifies as third party product?  This answer still worries me.  In my case a new porting set and client caused my OLE stuff to break.  Baan support spent very little time on it before telling me it was no longer supported - I will try to find the case number, but it has been over a year now.<br />
<br />
Mark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">p.cole</div><div class="date">19th September 2003, 00:31</div></div><div class="posttext">When I say &quot;Third party&quot; I mean anything non-standard Baan.  If we as customers (or an external company) developed a VB script, for instance then I would class it as &quot;Third party&quot;.  <br />
<br />
&quot;Third party&quot; was probably the wrong term to use, &quot;non standard baan&quot; would have been better.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">19th September 2003, 16:28</div></div><div class="posttext">That is what I thought.  I am not sure if you can see all the details on the case, but here it is:<br />
<br />
<br />
Mark<br />
Case 952727<br />
Customer Case Feedback Form (CCFF) details<br />
<br />
OLE Implementation Problem<br />
Organization UDLP - ASD Baan Case#: 952727 <br />
2nd Organization: ASD Cust Case#:   <br />
Contact: Ryan T Creation Date: 17 Jun 2002  <br />
Product A&amp;D Tools Last Modified / Sol. Proposed: 31 Jul 2002 /12 Jul 2002  <br />
Sub Product: 22b0 Installation:   <br />
Session:   Reopened: 0 <br />
Customization: No  Sol. Type: KR: Question <br />
Priority: 30 - Problem Status: Solution A <br />
Support Center: BGS-Americas Handled by: Curtiss J <br />
Case description: <br />
<br />
SITUATION DESCRIPTION:<br />
Please see &quot;OLE Implementation Problem.doc&quot; attached for a description of the problem.<br />
<br />
<br />
CASE ANALYSIS: <br />
Solution description: <br />
.<br />
VERSION(S):<br />
IVc3<br />
<br />
SITUATION IDENTIFIED IN: <br />
OLE<br />
<br />
ATTACHMENTS: <br />
n/a<br />
<br />
SITUATION DESCRIPTION: <br />
Connection lost with server<br />
<br />
SOLUTION DESCRIPTION: <br />
This functionality is not going to be supported. Please see email sent to customer - (attached to case). <br />
<br />
EXAMPLE(S): <br />
n/a<br />
<br />
WORK-AROUND:<br />
Use the .044BW client until you have to upgrade. Then utilize the ttstpconv for what you are trying to accomplish. If you upgrade to BaanV, the functionality of openworld for office integration is introduced.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">zardoz</div><div class="date">24th September 2003, 13:18</div></div><div class="posttext">Now it works without the error. <br />
Because I have two different VBA process, and both are using the same Automation Class Name and the same DLL, I've created a different BW configuration, so a new class name, so every program creates a different Baan Object and it seems (for now) there arent no more conflicts....<br />
Thanks to all ;)</div></div><hr />



</div>
</body>
</html>