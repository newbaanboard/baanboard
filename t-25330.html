<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="What's wrong, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] What's wrong AFS/DDC/OLE: Function servers" />
	
	<title>What's wrong [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="index.html">Newbaanboard</a> &gt; <a href="index.html">Baan SIGs</a> &gt; <a href="index.html">AFS/DDC/OLE: Function servers</a> &gt; What's wrong</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">wilsonphilips</div><div class="date">11th October 2005, 23:24</div></div><div class="posttext">Hi Everybody:<br />
<br />
Excuseme but I don't have enough expertise of using AFS.<br />
<br />
I made a test script from VB, I created a form and capture some data and then made a buttom that call a rutine.<br />
<br />
The process runs ok, but when I login to Baan and go to the Maintain Sales Orders, the process can´t create any record.<br />
<br />
Bellow is the script.<br />
<br />
<br />
What must I do bad?.<br />
<br />
<br />
Thanks. <br />
<br />
<br />
<br />
Wilson<br />
<br />
<br />
Private Sub CommandButton1_Click()<br />
' Correr_sesion_de_baan Macro<br />
'<br />
<br />
Dim ssql As String<br />
Dim erreur As String<br />
Dim errmess As String<br />
Dim baanobj As Object<br />
Dim seriew As String<br />
Dim clientew As String<br />
Dim tordenw As String<br />
Dim fechaw As String<br />
Dim fechaw1 As String<br />
Dim refew As String<br />
Dim monew As String<br />
Dim fpagow As String<br />
Dim paisw As String<br />
Dim idiomaw As String<br />
Dim ciudadw As String<br />
<br />
Dim i As Integer<br />
Dim error As String<br />
<br />
cRow = 4<br />
cColumn = 3<br />
dRow = 4<br />
dColumn = 4<br />
<br />
    do_update = &quot;1&quot;<br />
    seriew = serie.Value<br />
    clientew = Cliente.Value<br />
    tordenw = Torden.Value<br />
    fechaw = FechaOrden.Value<br />
    fechaw1 = FechaEntrega.Value<br />
    refew = Referencia.Value<br />
    monew = Moneda.Value<br />
    fpagow = FormaPago.Value<br />
    paisw = Pais.Value<br />
    idiomaw = Idioma.Value<br />
    ciudadw = Ciudad.Value<br />
    <br />
    <br />
    Set baanobj = CreateObject(&quot;Baan4.Application.sun_bogota&quot;)<br />
'    baanobj.Timeout = 30<br />
'    baanobj.ParseExecFunction &quot;otcmcszonas&quot;, &quot;zonas.put.tcmcs045.creg(seriew)&quot;<br />
'baanobj.Quit<br />
<br />
    <br />
    <br />
    ssql = &quot;stpapi.put.Field(&quot; &amp; Chr(34) &amp; &quot;tdsls4101m000&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot;tdsls040.orno&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; seriew &amp; Chr(34) &amp; &quot;)&quot;<br />
    erreur = baanobj.ParseExecFunction(&quot;ottstpapihand&quot;, ssql)<br />
    ssql = &quot;stpapi.put.Field(&quot; &amp; Chr(34) &amp; &quot;tdsls4101m000&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot;tdsls040.cuno&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; clientew &amp; Chr(34) &amp; &quot;)&quot;<br />
    erreur = baanobj.ParseExecFunction(&quot;ottstpapihand&quot;, ssql)<br />
    ssql = &quot;stpapi.put.Field(&quot; &amp; Chr(34) &amp; &quot;tdsls4101m000&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot;tdsls040.cotp&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; tordenw &amp; Chr(34) &amp; &quot;)&quot;<br />
    erreur = baanobj.ParseExecFunction(&quot;ottstpapihand&quot;, ssql)<br />
    ssql = &quot;stpapi.put.Field(&quot; &amp; Chr(34) &amp; &quot;tdsls4101m000&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot;tdsls040.odat&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; fechaw &amp; Chr(34) &amp; &quot;)&quot;<br />
    erreur = baanobj.ParseExecFunction(&quot;ottstpapihand&quot;, ssql)<br />
    ssql = &quot;stpapi.put.Field(&quot; &amp; Chr(34) &amp; &quot;tdsls4101m000&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot;tdsls040.prdt&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; fechaw1 &amp; Chr(34) &amp; &quot;)&quot;<br />
    erreur = baanobj.ParseExecFunction(&quot;ottstpapihand&quot;, ssql)<br />
    ssql = &quot;stpapi.put.Field(&quot; &amp; Chr(34) &amp; &quot;tdsls4101m000&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot;tdsls040.refa&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; refew &amp; Chr(34) &amp; &quot;)&quot;<br />
    erreur = baanobj.ParseExecFunction(&quot;ottstpapihand&quot;, ssql)<br />
    ssql = &quot;stpapi.put.Field(&quot; &amp; Chr(34) &amp; &quot;tdsls4101m000&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot;tdsls040.ccur&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; monew &amp; Chr(34) &amp; &quot;)&quot;<br />
    erreur = baanobj.ParseExecFunction(&quot;ottstpapihand&quot;, ssql)<br />
    ssql = &quot;stpapi.put.Field(&quot; &amp; Chr(34) &amp; &quot;tdsls4101m000&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot;tdsls040.cpay&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; fpagow &amp; Chr(34) &amp; &quot;)&quot;<br />
    erreur = baanobj.ParseExecFunction(&quot;ottstpapihand&quot;, ssql)<br />
    ssql = &quot;stpapi.put.Field(&quot; &amp; Chr(34) &amp; &quot;tdsls4101m000&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot;tdsls040.ccty&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; paisw &amp; Chr(34) &amp; &quot;)&quot;<br />
    erreur = baanobj.ParseExecFunction(&quot;ottstpapihand&quot;, ssql)<br />
    ssql = &quot;stpapi.put.Field(&quot; &amp; Chr(34) &amp; &quot;tdsls4101m000&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot;tdsls040.clan&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; idiomaw &amp; Chr(34) &amp; &quot;)&quot;<br />
    erreur = baanobj.ParseExecFunction(&quot;ottstpapihand&quot;, ssql)<br />
    ssql = &quot;stpapi.put.Field(&quot; &amp; Chr(34) &amp; &quot;tdsls4101m000&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot;tdsls040.ccit.o&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; ciudadw &amp; Chr(34) &amp; &quot;)&quot;<br />
    erreur = baanobj.ParseExecFunction(&quot;ottstpapihand&quot;, ssql)<br />
    <br />
    ssql = &quot;stpapi.put.Field(&quot; &amp; Chr(34) &amp; &quot;tdsls4101m000&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot;tdsls040.corg&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; Str$(4) &amp; Chr(34) &amp; &quot;)&quot;<br />
    erreur = baanobj.ParseExecFunction(&quot;ottstpapihand&quot;, ssql)<br />
    ssql = &quot;stpapi.put.Field(&quot; &amp; Chr(34) &amp; &quot;tdsls4101m000&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot;tdsls040.fcrt&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; Str$(1) &amp; Chr(34) &amp; &quot;)&quot;<br />
    erreur = baanobj.ParseExecFunction(&quot;ottstpapihand&quot;, ssql)<br />
    ssql = &quot;stpapi.put.Field(&quot; &amp; Chr(34) &amp; &quot;tdsls4101m000&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot;tdsls040.cvyn&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; Str$(2) &amp; Chr(34) &amp; &quot;)&quot;<br />
    erreur = baanobj.ParseExecFunction(&quot;ottstpapihand&quot;, ssql)<br />
    ssql = &quot;stpapi.put.Field(&quot; &amp; Chr(34) &amp; &quot;tdsls4101m000&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot;tdsls040.futo&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; Str$(2) &amp; Chr(34) &amp; &quot;)&quot;<br />
    erreur = baanobj.ParseExecFunction(&quot;ottstpapihand&quot;, ssql)<br />
    ssql = &quot;stpapi.put.Field(&quot; &amp; Chr(34) &amp; &quot;tdsls4101m000&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot;tdsls040.bkyn&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; Str$(2) &amp; Chr(34) &amp; &quot;)&quot;<br />
    erreur = baanobj.ParseExecFunction(&quot;ottstpapihand&quot;, ssql)<br />
    ssql = &quot;stpapi.put.Field(&quot; &amp; Chr(34) &amp; &quot;tdsls4101m000&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot;tdsls040.scom&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; Str$(2) &amp; Chr(34) &amp; &quot;)&quot;<br />
    erreur = baanobj.ParseExecFunction(&quot;ottstpapihand&quot;, ssql)<br />
    ssql = &quot;stpapi.put.Field(&quot; &amp; Chr(34) &amp; &quot;tdsls4101m000&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot;tdsls040.rats(1)&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot;1&quot; &amp; Chr(34) &amp; &quot;)&quot;<br />
    erreur = baanobj.ParseExecFunction(&quot;ottstpapihand&quot;, ssql)<br />
    ssql = &quot;stpapi.put.Field(&quot; &amp; Chr(34) &amp; &quot;tdsls4101m000&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot;tdsls040.rats(2)&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot;1&quot; &amp; Chr(34) &amp; &quot;)&quot;<br />
    erreur = baanobj.ParseExecFunction(&quot;ottstpapihand&quot;, ssql)<br />
    ssql = &quot;stpapi.put.Field(&quot; &amp; Chr(34) &amp; &quot;tdsls4101m000&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot;tdsls040.rats(3)&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot;1&quot; &amp; Chr(34) &amp; &quot;)&quot;<br />
    erreur = baanobj.ParseExecFunction(&quot;ottstpapihand&quot;, ssql)<br />
    ssql = &quot;stpapi.put.Field(&quot; &amp; Chr(34) &amp; &quot;tdsls4101m000&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot;tdsls040.ratf(1)&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot;1&quot; &amp; Chr(34) &amp; &quot;)&quot;<br />
    erreur = baanobj.ParseExecFunction(&quot;ottstpapihand&quot;, ssql)<br />
    ssql = &quot;stpapi.put.Field(&quot; &amp; Chr(34) &amp; &quot;tdsls4101m000&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot;tdsls040.ratf(2)&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot;1&quot; &amp; Chr(34) &amp; &quot;)&quot;<br />
    erreur = baanobj.ParseExecFunction(&quot;ottstpapihand&quot;, ssql)<br />
    ssql = &quot;stpapi.put.Field(&quot; &amp; Chr(34) &amp; &quot;tdsls4101m000&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot;tdsls040.ratf(3)&quot; &amp; Chr(34) &amp; &quot;, &quot; &amp; Chr(34) &amp; &quot;1&quot; &amp; Chr(34) &amp; &quot;)&quot;<br />
    erreur = baanobj.ParseExecFunction(&quot;ottstpapihand&quot;, ssql)<br />
    <br />
    baanobj.ParseExecFunction &quot;ottstpapihand&quot;, &quot;stpapi.insert(&quot; &amp; Chr(34) &amp; &quot;tdsls4101m000&quot; &amp; Chr(34) &amp; &quot;,&quot; &amp; do_update &amp; &quot;,&quot; &amp; Chr(34) &amp; &quot;errmess&quot; &amp; Chr(34) &amp; &quot;)&quot;<br />
    ssql = &quot;stpapi.get.mess.code(&quot; &amp; Chr(34) &amp; &quot;tdsls4101m000&quot; &amp; Chr(34) &amp; &quot;)&quot;<br />
    erreur = baanobj.ParseExecFunction(&quot;ottstpapihand&quot;, ssql)<br />
   <br />
    errmess = Val(baanobj.ReturnValue)<br />
    If baanobj.error = 0 Then<br />
        MsgBox &quot;Registro &quot; &amp; codigo &amp; &quot; añadido&quot;<br />
    End If<br />
    erreur = baanobj.ParseExecFunction(&quot;ottstpapihand&quot;, &quot;stpapi.end.session(&quot; &amp; Chr(34) &amp; &quot;tdsls4101m000&quot; &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; &quot;errmess&quot; &amp; Chr(34) &amp; &quot;)&quot;)<br />
End Sub</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">12th October 2005, 15:26</div></div><div class="posttext">Do you get any error from the stpapi.insert?  You can search on this forum for how to handle errors in the VB code.  I can't help much with VB coding since I do everything in baan.  <br />
<br />
Also if you have source code you can put tdsls4101m000 in debug mode.  Then when your VB code launches the session you can see what is happening.</div></div><hr />



</div>
</body>
</html>