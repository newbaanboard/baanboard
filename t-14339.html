<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="Session freeze, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] Session freeze AFS/DDC/OLE: Function servers" />
	
	<title>Session freeze [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="index.html">Newbaanboard</a> &gt; <a href="index.html">Baan SIGs</a> &gt; <a href="index.html">AFS/DDC/OLE: Function servers</a> &gt; Session freeze</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">bpolajnar</div><div class="date">29th January 2004, 15:28</div></div><div class="posttext">Hello,<br />
<br />
I tried to insert a record into session  tfacp1110s000.<br />
I get all data from tfacp1100m000 and then insert with<br />
put.field. At the end  want to commint with function insert but<br />
bw.exe freeze and I have to kill it in task manager. <br />
All fun is that the data is in the database,<br />
<br />
but I would be happy if  somebody tell me why bw. freeze.<br />
<br />
:(</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DStroud</div><div class="date">29th January 2004, 15:43</div></div><div class="posttext">Did you end the session(s)?  Example: stpapi.end.session(&quot;tdsls4102s000&quot;)<br />
<br />
Please post your code so that we can try to help you resolve your problem. It is dificult to determine the problem with seeing the code.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bpolajnar</div><div class="date">29th January 2004, 15:52</div></div><div class="posttext">dllName = &quot;ottstpapihand&quot;<br />
	Call BaanObj.ParseExecFunction (&quot;ottstp_stddll&quot;, &quot;switch.to.company(602)&quot;)<br />
	<br />
	Call putfield (dllName , &quot;tfacp1100m000&quot; , &quot;tfacp100.ninv&quot; , &quot;23000265&quot; , BaanObj)<br />
	BaanObj.ParseExecFunction dllName, &quot;stpapi.find(&quot; &amp; Chr(34) &amp; &quot;tfacp1100m000&quot; &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; &quot;                                                     &quot; &amp; Chr(34) &amp; &quot;)&quot;<br />
<br />
	valList(&quot;suno&quot;) = getFieldValue(dllname,&quot;tfacp1100m000&quot;,&quot;tfacp100.suno&quot;,BaanObj)<br />
	valList(&quot;isup&quot;) = getFieldValue(dllname,&quot;tfacp1100m000&quot;,&quot;tfacp100.isup&quot;,BaanObj)<br />
	valList(&quot;refr&quot;) = getFieldValue(dllname,&quot;tfacp1100m000&quot;,&quot;tfacp100.refr&quot;,BaanObj)<br />
	valList(&quot;ccur&quot;) = getFieldValue(dllname,&quot;tfacp1100m000&quot;,&quot;tfacp100.ccur&quot;,BaanObj)<br />
	valList(&quot;amnt&quot;) = getFieldValue(dllname,&quot;tfacp1100m000&quot;,&quot;tfacp100.amnt&quot;,BaanObj)<br />
	<br />
	BaanObj.ParseExecFunction &quot;ottstpapihand&quot;, &quot;stpapi.end.session(&quot; &amp; Chr(34) &amp; &quot;tfacp1100m000&quot; &amp; Chr(34) &amp; &quot;)&quot;<br />
	<br />
	BaanObj.ParseExecFunction &quot;ottstpapihand&quot;, &quot;stpapi.put.field(&quot; &amp; Chr(34) &amp; &quot;tfgld1101m000&quot; &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; &quot;tfgld101.year&quot; &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; &quot;2003&quot; &amp; Chr(34) &amp; &quot;)&quot;<br />
	BaanObj.ParseExecFunction &quot;ottstpapihand&quot;, &quot;stpapi.put.field(&quot; &amp; Chr(34) &amp; &quot;tfgld1101m000&quot; &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; &quot;tfgld101.btno&quot; &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; &quot;670&quot; &amp; Chr(34) &amp; &quot;)&quot;<br />
	BaanObj.ParseExecFunction &quot;ottstpapihand&quot;, &quot;stpapi.put.field(&quot; &amp; Chr(34) &amp; &quot;tfgld1101m000&quot; &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; &quot;tfgld101.ttyp&quot; &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; &quot;201&quot; &amp; Chr(34) &amp; &quot;)&quot;<br />
	<br />
	BaanObj.ParseExecFunction &quot;ottstpapihand&quot;, &quot;stpapi.find(&quot; &amp; Chr(34) &amp; &quot;tfgld1101m000&quot; &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; &quot;                                                     &quot; &amp; Chr(34) &amp; &quot;)&quot;<br />
	<br />
	BaanObj.ParseExecFunction &quot;ottstpapihand&quot;, &quot;stpapi.mark(&quot; &amp; Chr(34) &amp; &quot;tfgld1101m000&quot; &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; &quot;                                                     &quot; &amp; Chr(34) &amp; &quot;)&quot;<br />
	<br />
	BaanObj.ParseExecFunction &quot;ottstpapihand&quot;, &quot;stpapi.handle.subproc(&quot; &amp; Chr(34) &amp; &quot;tfgld1101m000&quot; &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; &quot;tfacp1110s000&quot; &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; &quot;send&quot; &amp; Chr(34) &amp; &quot;)&quot;<br />
	Call putfield (dllName , &quot;tfacp1110s000&quot; , &quot;tfacp200.ninv&quot; , Fulltrim(Cstr(valList(&quot;ninv&quot;))) , BaanObj)<br />
	Call putfield (dllName , &quot;tfacp1110s000&quot; , &quot;tfacp200.suno&quot; , Fulltrim(Cstr(valList(&quot;suno&quot;))) , BaanObj)<br />
	Call putfield (dllName , &quot;tfacp1110s000&quot; , &quot;tfacp200.isup&quot; , Fulltrim(Cstr(valList(&quot;isup&quot;))) , BaanObj)<br />
	Call putfield (dllName , &quot;tfacp1110s000&quot; , &quot;tfacp200.refr&quot; , Fulltrim(Cstr(valList(&quot;refr&quot;))) , BaanObj)<br />
	Call putfield (dllName , &quot;tfacp1110s000&quot; , &quot;tfacp200.invd&quot; , Fulltrim(Cstr(valList(&quot;invd&quot;))) , BaanObj)<br />
	Call putfield (dllName , &quot;tfacp1110s000&quot; , &quot;tfacp200.ccur&quot; , Fulltrim(Cstr(valList(&quot;ccur&quot;))) , BaanObj)<br />
	Call putfield (dllName , &quot;tfacp1110s000&quot; , &quot;tfacp200.amnt&quot; , Fulltrim(Cstr(valList(&quot;amnt&quot;))) , BaanObj)<br />
	<br />
	Messagebox &quot;inserting...&quot;<br />
	BaanObj.ParseExecFunction dllName, &quot;stpapi.insert(&quot; &amp; Chr(34) &amp; &quot;tfacp1110s000&quot; &amp; Chr(34) &amp; &quot;,1,&quot; &amp; Chr(34) &amp; &quot;                                                     &quot; &amp; Chr(34) &amp; &quot;)&quot;<br />
	<br />
	Here is everything stops. Next msgbox doesn't appear, but data is in database. <br />
	<br />
	Messagebox  BaanObj.FunctionCall<br />
	Messagebox  BaanObj.ReturnValue<br />
	<br />
	BaanObj.ParseExecFunction dllName, &quot;stpapi.get.mess.code(&quot; &amp; Chr(34) &amp; &quot;tfacp1110s000&quot; &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; &quot;                                                     &quot; &amp; Chr(34) &amp; &quot;)&quot;<br />
	Messagebox  BaanObj.ReturnValue<br />
	<br />
	BaanObj.ParseExecFunction &quot;ottstpapihand&quot;, &quot;stpapi.end.session(&quot; &amp; Chr(34) &amp; &quot;tfacp1110s000&quot; &amp; Chr(34) &amp; &quot;)&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Andreas</div><div class="date">29th January 2004, 16:40</div></div><div class="posttext">I had the same problem using AFS. bw hangs.<br />
<br />
Solved this problem by installing patch for ttstpstandard.<br />
<br />
Have a look at Solution 132907 on Baan Support Site.<br />
<br />
Hope this helps,<br />
<br />
Andreas</div></div><hr />



</div>
</body>
</html>