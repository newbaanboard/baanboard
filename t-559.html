<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="DEV: Extend Baan code without sources, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] DEV: Extend Baan code without sources Code &amp; Utilities" />
	
	<title>DEV: Extend Baan code without sources [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="index.html">Newbaanboard</a> &gt; <a href="index.html">Baan SIGs</a> &gt; <a href="index.html">Code &amp; Utilities</a> &gt; DEV: Extend Baan code without sources</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">~Vamsi</div><div class="date">6th December 2001, 08:02</div></div><div class="posttext">Trying to work without Baan code has been an issue for quite a while. Those who discovered QKEY (http://www.redklay.com) know that 4GL sessions can be customized to a good extent without the source code. The idea of creating an equivalent has been in my mind for quite a while now. About a year ago I wrote a little bit of code as a proof of concept. And it has been stagnating ever since. I made an attempt to create a list of volunteer developers through this thread (http://www.baanboard.com/baanboard/showthread.php?s=&amp;threadid=355) without much success. People just did not say anything after receiving the code. I just do not know if they did not understand what the code did (very possible - I sent it out with practically no documentation - just like now) or they expected me to give a fully working script (this is not true even now - notice the DEV in the heading).<br />
<br />
However inadequate the two scripts that I am posting may be, they do work (or atleast did before I made changes :)).<br />
<br />
Deliverables expected at the end of this project:<br />
<br />
 a name for this project/product<br />
 documentation<br />
 technical design so that the maintenace can be easy<br />
 added features like ease of use / being not affected by changes to Baan standard object<br />
<br />
<br />
Please try this program and post changes. Thanks to Krishna Eranki / Praveen Ambekar / Patrick Van der Veken (in chronological order of their contributions) for making this possible.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">KlayVessel</div><div class="date">30th December 2001, 05:59</div></div><div class="posttext">Hmmm...interesting.  <br />
<br />
I don't think I could contribute to this project...I'm sure that would taint it!  Ha!<br />
<br />
Don't know whether to be happy about this or not...but I am always glad to see people working on innovative code.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">evesely</div><div class="date">3rd January 2002, 23:20</div></div><div class="posttext">I have updated the code for ~Vamsi's main.bc file.  I had a couple of problems running the original version.  This now works well for me on IVc4.  The following changes were made:<br />
<br />
  Extended to handle a larger number of functions (it died trying to handle tdsls4102 before)<br />
  Now works with functions that return values (e.g., function extern domain tcmcs.long tcedi0052.get.next.btno())<br />
  Added missing &quot;functions:&quot; statement<br />
  Fixed problem that occurred when parent had a &quot;before.program&quot; section<br />
  It is now skipping functions that seemed to be added as part of the compilation process (and hence caused the original compilation to fail) like g.check.input.funcs()<br />
<br />
<br />
My compliments to MohanaVamsi Potluru and Praveen Ambekar on the original code.  Also my apologies regarding my efforts to modify the copyright, disclaimer, etc.  I was unsure how to put in my changes and still fit under the protection of the disclaimer.  If I should fix this, please let me know -- I will be happy to do so.<br />
<br />
A brief test seems to indicate that this works on Baan 5c, too, but I didn't do a lot of testing there.  I'm sure others will have more features to add...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">~Vamsi</div><div class="date">7th January 2002, 21:24</div></div><div class="posttext">Ed,<br />
<br />
Could you post the revised main.bc file? The &quot;disclaimers&quot; apply to all authors. If you feel you have rewritten the code you can put your name in the author field while acknowledging the original author(s). Alternatively leave the original authors as such and add your name to the &quot;contributors&quot; (which is not present in the template at this moment).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">evesely</div><div class="date">8th January 2002, 17:23</div></div><div class="posttext">I obviously forgot to attach this last time.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">toolswizard</div><div class="date">16th January 2002, 21:52</div></div><div class="posttext">I tried to compile the sources and have many errors.  Is the a compilable version?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">~Vamsi</div><div class="date">16th January 2002, 22:46</div></div><div class="posttext">Toolswizard,<br />
<br />
Thanks for trying the code. I have not worked on this code for a long time. My client does not have a need for such a product as they have source code. Hence it is not a priority on my list of things right now :(. I have posted the code I have in hopes that others will be able to extend it further and make it useful.<br />
<br />
Since Ed posted revisions to main.bc I think he must have been successful in compiling the code. Please post your compilation errors to the thread and may be we can find out what the problem is.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">toolswizard</div><div class="date">16th January 2002, 23:02</div></div><div class="posttext">I am taking a chance and changing the &quot;options&quot; variable and changing it to opt.  It would seem baan has a macro (#define) for the work options and it is trying to expand it.  It now compiles with a unrelated warning.<br />
<br />
BTY did you get an email from me in the last few days asking more questions?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">toolswizard</div><div class="date">16th January 2002, 23:22</div></div><div class="posttext">ok, I have it compiled and did run it against a small display session.  I have a new file created by rush.  Now does this file take place of the user script in the session, replacing the original script?  Is it supposed to run stand alone?  Please explain how I should test this out.  Once I have a working model, I should be able to continue on more advanced development.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">evesely</div><div class="date">16th January 2002, 23:56</div></div><div class="posttext">This file that is generated should be used as the program script for the session in question.  It can be modified just like any other Baan 4GL program script.  The one caveat is that you can't have the same section name as an external function call.  For example, this is not allowed:<br />
choice.cont.process:<br />
on.choice:<br />
	code<br />
...<br />
function extern on.choice.cont.process()<br />
{<br />
	other code<br />
}<br />
<br />
You can put things in either place, but not both.<br />
<br />
Once you have attached this program script to the session, you should be able to run that session and access all of the functionality of the parent (i.e., standard Baan) script plus or minus any changes you desire.  Unfortunately, you don't have the ability to modify the underlying functionality, but rather only decide if and when that code runs.  If you want more flexibility, getting the Baan source code would help. ;-)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">toolswizard</div><div class="date">17th January 2002, 00:28</div></div><div class="posttext">Thanks ED,<br />
<br />
I am not trying this for my regular job.  This is more of a curiosity.  I would like to help get this into a usefull open source  product.  As your post states, you can use the call in either syntax, but not in both.  I was already thinking of how this can be used to make the code more readable for the user.<br />
<br />
I have access to development systems and source code to test all of this out.  I can see where knowing the fuctionality of the standard is going to be needed to do any kind of development.  Expecially to test it out fully.  A programmers guide is surely going to be needed for those new to Baan.<br />
<br />
If anyone is planning to try a development effort please let me know.<br />
<br />
Bill Prokurat<br />
aka toolswizard@spire.com</div></div><hr />


<div class="post"><div class="posttop"><div class="username">klixy23</div><div class="date">20th February 2002, 17:27</div></div><div class="posttext">I tested the program. I made the changes from toolswizard in this thread (variable &quot;options&quot; to &quot;opt&quot;). I compiled and run it.<br />
<br />
<br />
<br />
IT WORKS. <br />
<br />
Thanks for this great idea.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">klixy23</div><div class="date">22nd February 2002, 17:16</div></div><div class="posttext">In my last post I wrote &quot;IT WORKS&quot;, but somthing is wrong.<br />
I tested the session tisfc0202m000 (Report Complete Order and Adjust Stock) and add an information field.<br />
The session did the work, but the field tisfc001.cmdt wasn't update correctly, it was blank. This is always happen, if the form field cmdt.frm leave blank and the user press the continue button.<br />
If the user fill the field, then all is ok.<br />
<br />
So I changed back to the original session. I tested in the same way and the field is updated correctly. I think there is something in the original baan code, that fill the field automatically if it is blank or there is an internal function call.<br />
<br />
Can someone check this? Or do you need more information?<br />
<br />
Thanks.<br />
<br />
klixy</div></div><hr />


<div class="post"><div class="posttop"><div class="username">~Vamsi</div><div class="date">22nd February 2002, 21:09</div></div><div class="posttext">What version of Baan? Once klixy responds could someone who has that version with code check to see what is really happening. I have access only to Baan 5b.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">toolswizard</div><div class="date">22nd February 2002, 22:24</div></div><div class="posttext">I have access to almost all versions of source.  But I really would like to see his code also.  klixy can you please post your source for that field.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">klixy23</div><div class="date">25th February 2002, 10:35</div></div><div class="posttext">Hi ~Vamsi, toolswizard<br />
<br />
Thanks for reply.<br />
<br />
We work with BaaN IV c4. I attach the output file of program &quot;rush&quot;.<br />
It is the original output without any changes.<br />
I insert following lines:<br />
<br />
<br />
extern domain tcmcs.str80 txt_str(1) <br />
...<br />
field.txt_str:<br />
before.display:<br />
text.to.buf(&quot;tisfc001.txta&quot;, &quot;3&quot;, 1, txt_str)<br />
<br />
I copy the form to the current VRC and add the field txt_str as the last field.<br />
<br />
klixy</div></div><hr />


<div class="post"><div class="posttop"><div class="username">klixy23</div><div class="date">25th February 2002, 10:38</div></div><div class="posttext">Oooops, here is the file:<br />
<br />
klixy</div></div><hr />


<div class="post"><div class="posttop"><div class="username">toolswizard</div><div class="date">27th February 2002, 22:15</div></div><div class="posttext">I have not tested this out myself, but I do have an idea.  The field you are talking about is a form field and not part of the table.  In the original code it is declared as external, form fields have to be declared as external to be used in the code.  It may not be getting passed through the new program from the form to the old program.  Declare the form field in the new program as external and see if that helps.  Please give us feed back to it is part of this post.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">klixy23</div><div class="date">4th March 2002, 12:25</div></div><div class="posttext">Toolswizard, thanks for your idea.<br />
I tested the following:<br />
	extern	domain	tcdate	cmdt.frm<br />
	extern	domain	tcyesno	comp.frm<br />
I think, these are the original form variables and get part with my problem. But the result is the same.<br />
Is it possible that the functions check.input.cmdt.frm() or check.input.comp.frm() are the reason for fail?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">toolswizard</div><div class="date">4th March 2002, 21:42</div></div><div class="posttext">I looked at several versions of the source and found that if comp.frm is tcyesno.yes then cmdt.ftm is set to todays date.  If comp.frm is tcyesno.no then the cmdt.ftm is set to 0.  I would try the test again maing sure that the comp.frm is set the same for both tests.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">EDIguru</div><div class="date">6th March 2002, 21:24</div></div><div class="posttext">Hi,<br />
<br />
This is great !! I find this extremely useful. Works perfectly. The only question i have is - has anyone tried this and extended the functionality for any tools sessions ?? I have a requirement where i need to do this but i am having difficulties copying the forms and sessions form the actual tools VRCs to the development packages and VRCs. Any suggestions / comments will be greatly appreciated !!<br />
<br />
Regards<br />
<br />
EDIguru.<br />
<br />
|*********************|<br />
|* Been There, Done That *|<br />
|*********************|</div></div><hr />


<div class="post"><div class="posttop"><div class="username">KlayVessel</div><div class="date">9th March 2002, 22:14</div></div><div class="posttext">Originally posted by EDIguru <br />
The only question i have is - has anyone tried this and extended the functionality for any tools sessions ?? I have a requirement where i need to do this but i am having difficulties copying the forms and sessions form the actual tools VRCs to the development packages and VRCs.<br />
You won't be able to copy the components for development because Baan does not authorize access to the standard VRC and, even more rarely, the tt package.  In addition, this package is not part of your package combination so when your development pacc was created, there was no dev VRC created for the tt package (if you used &quot;one step&quot;)....manually you cannot create a tools VRC either (no security rights).  You can manually compile and install your code (I've experimented with the idea myself), but I would not recommend this as Baan may say that you have voided your support with them.  They do not, in any way, support a customer (or consultant) changing anything in the tt package.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">EDIguru</div><div class="date">10th March 2002, 09:18</div></div><div class="posttext">Thanks for your reply Kevin.<br />
<br />
I am fully aware of the facts you have outlined in your response. What i was referring to was, has anyone tried copying the tools forms, reports, sessions, scripts to any other package in any other VRC or maybe even at the file level / UNIX level and played around with them and tried to mimic the functionality. I was trying some stuff the other day, but was runnign into issues and did not want to invest too much time / reinvent the wheel in case someone has already done it successfully. <br />
<br />
Regards<br />
<br />
EDIGuru <br />
<br />
|*************************************************|<br />
|Engineering is fun, but Reverse Engineering is even more fun |<br />
|*************************************************|</div></div><hr />


<div class="post"><div class="posttop"><div class="username">vladimir</div><div class="date">20th March 2003, 16:47</div></div><div class="posttext">Hello.<br />
<br />
Thanks MohanaVamsi Potluru for idea.<br />
Thanks Mark Holland for Sample Qkey script.<br />
<br />
#!/usr/local/bin/perl<br />
use strict;<br />
<br />
my $OBJ = shift @ARGV;<br />
<br />
my $BIC_INFO = &quot;bic_info6.1 -e &quot;;<br />
<br />
#==============================================================================<br />
print q{<br />
|******************************************************************************<br />
<br />
declaration:<br />
<br />
    long    _p_dll_id<br />
    long    _p_func_id<br />
    long    _p_err<br />
<br />
    #define _p_exe0(a)   _p_err = exec_function(_p_dll_id, a)<br />
    #define _p_exe1(a)<br />
^       _p_func_id = get_function(_p_dll_id, a)<br />
^       _p_err     = exec_function(_p_dll_id, _p_func_id)<br />
    #define _p_exe2(a)<br />
^       _p_func_id = get_function(_p_dll_id, a)<br />
^       _p_err     = exec_function(_p_dll_id, _p_func_id, ret_val)<br />
<br />
<br />
|****************************** PROGRAM     SECTION ***************************<br />
<br />
before.program:<br />
    _p_dll_id = load_dll(&quot;} . $OBJ . q{&quot;,0)<br />
    if (_p_dll_id &lt;= 0) then<br />
        message(&quot;Unable to load parent object dll!&quot;)<br />
        stop()<br />
    endif<br />
    _p_exe1(&quot;before.program&quot;)<br />
|******************************************************************************<br />
<br />
<br />
} ;<br />
<br />
#==============================================================================<br />
<br />
my @IGNORE_FUNCTIONS = (<br />
    'long\s+g_check_input_funcs',<br />
    'long\s+library_has_maintable',<br />
    'before.program'<br />
    );<br />
<br />
sub get_object_functions {<br />
    local *BI;<br />
    my @f;<br />
 <br />
1. Run <br />
    perl gen_wrap.pl baan_object &gt;new_object.bc<br />
2. Create new empty baan script (ttadv2131m000) then paste code from new_object.bc <br />
3. Change Program Script for original session to new_object</div></div><hr />


<div class="post"><div class="posttop"><div class="username">baanfan</div><div class="date">9th April 2003, 16:12</div></div><div class="posttext">Hello All,<br />
          Can we say that we can use this script for almost all the<br />
types of sessions.Is it possible that sum sections of the baan<br />
session wont get executed by using this method.cuz i have<br />
a reqt of putting sum field level checks on standard sessions like<br />
Mntn. production orders and wud like to know if it is safe to <br />
implement it.<br />
Thank You</div></div><hr />


<div class="post"><div class="posttop"><div class="username">~Vamsi</div><div class="date">10th April 2003, 04:43</div></div><div class="posttext">Baanfan,<br />
<br />
I do not know how many people are using this solution. I do not. It was a fun project to code.<br />
<br />
If you need assurance then should look to www.redklay.com or www.rmcis.com as they both have similar products with support.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">klixy23</div><div class="date">10th April 2003, 09:17</div></div><div class="posttext">We use the solution with &quot;rushdll&quot; in session tisfc0202m000. I had some trouble with the form field &quot;cmdt.frm&quot;. See my earlier posts in this thread. <br />
<br />
Have a nice day.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">vladimir</div><div class="date">10th April 2003, 11:03</div></div><div class="posttext">Klixy,<br />
<br />
The problem may be in function g_check_input_funcs which is generated by std_gen for all subsections of check.input.<br />
Try to run attached script generated by gen_wrap.pl<br />
<br />
Regards.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">vladimir</div><div class="date">10th April 2003, 12:01</div></div><div class="posttext">Script</div></div><hr />


<div class="post"><div class="posttop"><div class="username">~Vamsi</div><div class="date">10th April 2003, 19:07</div></div><div class="posttext">Vladimir,<br />
<br />
All I can say is 'duh'.  People have consistently reported problems of check.input not firing and I had not a clue. Thanks for running with the idea and fixing the problems.<br />
<br />
Thanks for rewriting the code in Perl. Sigh! So many languages to learn and so little time.<br />
<br />
This is the kind of improvements that we envisaged when we started the Code and Utilities forum. It was to have been a forum for people to share ideas and collaboratively develop solutions that the populace would be interested in. So far it has been a forum for one person writes and everyone downloads :). Glad things are changing for the better.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">r_nagu</div><div class="date">7th May 2003, 17:36</div></div><div class="posttext">Hi,<br />
	I've used this code extender for some sessions with considerable success. I was able to pretty much get done what I wanted with this but, here's is a requirement I ran into today. <br />
<br />
	I created an extended code using this dll for a session in order to make some process changes after the fact the standard process is done. In order to do that I need to know what is been entered into some of the form field (not table fields) in this session. Now, is it possible to retrieve/catch those values entered on the form fields? <br />
<br />
Thanks,<br />
NS</div></div><hr />


<div class="post"><div class="posttop"><div class="username">baanfan</div><div class="date">24th June 2003, 10:49</div></div><div class="posttext">hello ,<br />
    I have used the code extension successfully for sum finance<br />
sessions like tfacp1120s000 by changing the program script <br />
entry with that of my customized script.Now the problem is when<br />
i maintain the session tfacp1120s000 in maintain trans. types<br />
it gives an invalid session message.Looking at the code i found<br />
that the field level check is using the function tt.session.present()<br />
and it is giving the error.Can anybody please tell me what must <br />
be the problem<br />
<br />
Thank you.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">vladimir</div><div class="date">24th June 2003, 12:22</div></div><div class="posttext">Function tt.session.present() search record for object in ttiex330000. You may insert record into table or run session ttiex3226m000 (Patch Objects after Error Solving) for new object.<br />
<br />
Best regards</div></div><hr />


<div class="post"><div class="posttop"><div class="username">baanfan</div><div class="date">24th June 2003, 13:32</div></div><div class="posttext">Thanks for the quick response vladmir.well the entry is present<br />
in the session.what really im not able to understand is that<br />
if i just execute the step ret = tt.sessio.present(&quot;tfacp1120s000&quot;).<br />
it gives me a return value of 2.But somehow when the standard<br />
session executes the instruction it doesnt get the return value2.<br />
<br />
Any suggestions why it might be happening.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">vladimir</div><div class="date">24th June 2003, 14:39</div></div><div class="posttext">Solution 152148 from Baan Knowledge Base<br />
<br />
<br />
Best regards.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">baanfan</div><div class="date">24th June 2003, 17:34</div></div><div class="posttext">Thanks Vladmir ur soln. worked after i maintained the entry for<br />
the customized script in the table ttiex330.But shudnt creating<br />
a runtime dd for the sessions shud take care of this.and also<br />
one question still remains in my mind..that why i was getting<br />
a return value of 2 when using tt.session.present<br />
('tfacp1120s000&quot;).and behaving differently for the standard <br />
session...<br />
<br />
Thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Punitha</div><div class="date">6th May 2004, 21:39</div></div><div class="posttext">Hello,<br />
<br />
First of all, thanks to MohanaVamsi Potluru, Praveen Ambekar, Vladimir for the great idea!!<br />
<br />
I tried it and it's excellent!<br />
<br />
I have a question though.  <br />
<br />
I would like to use this idea for the standard Baan &quot;PRINT&quot; session &quot;ticst0401m000&quot;.  The standard script for this session selects by &quot;prod order&quot;.  What I would like to do is also provide a selection criteria by &quot;item&quot;.   But, I do not know how to force the SQL to include the selection criteria.  Is this possible?  <br />
<br />
Thanks in advance,<br />
<br />
Punitha.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">6th May 2004, 21:52</div></div><div class="posttext">You really can not change the actual selects, but you can re-write the sections and use your own code. I usually use the report to provide the filters like you are talking about.  I am not familiar with this report, but usually you can just add a check in the detail layout to see if the item is in the selected range then skip the record using lattr.print=false.  Yes, the session still does a lot of processing, but it beats the heck out of duplicating the code.<br />
<br />
Mark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Punitha</div><div class="date">6th May 2004, 22:06</div></div><div class="posttext">Thank You Mark.   <br />
<br />
You are right.  I didn't want to use the report script to filter the records because it would take all the time in the world to get the data when the user selects by &quot;item&quot; and gives an open range of the &quot;prod order&quot;.  <br />
<br />
I was hoping to do the selection by using ideas like query.extension(which would have worked if I had a main table) or something like that.  Do the other wrappers like RMC, QKEY have the same restriction?<br />
<br />
Thanks, <br />
<br />
Punitha</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">6th May 2004, 22:16</div></div><div class="posttext">Yes - we actually use Qkey.  The worst one I had to do was add main work center to the print production order priority report.  The users still complains about it to this day - when they run it manually.  Since we did not own source code I really could not do it any better.  It works, but slow as a snail.  The final solution was to run this in batch to a file at night.  Then I wrote a session that literally read thru the file looking for the only the work centers the user requested.  Not sure if something like this is feasible in your case.<br />
<br />
In a couple of cases I forced them to enter another range just so it did not get bogged down on running everything in the world.<br />
<br />
Mark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Punitha</div><div class="date">6th May 2004, 22:20</div></div><div class="posttext">Thanks again Mark!  I guess I just have to rewrite the code or have it customized(again!) by a Baan Partner.  I wanted to avoid the customization as it is a hassle everytime I put in service packs.  You know the story.... <br />
<br />
I appreciate your input.<br />
<br />
<br />
Punitha</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Punitha</div><div class="date">6th May 2004, 23:53</div></div><div class="posttext">Mark,<br />
<br />
I made a workaround that works great for me.  By logical reasoning it should work and I did just a quick test now and it works  for me without affecting performance and without affecting the code.  Of course, I need to do extensive testing.   Based on what you said about the main work center on the &quot;prod priority code&quot;, I think it'll work for you too...<br />
<br />
What I did was as follows:<br />
I used the &quot;rush&quot; to get the dll's(thanks again to the authors, Vamsi and Ambekar).  I then redid the selection criteria based on my requirement ie. based on item.  I did so by building an additional select query and redefined the selection criteria variables with these new values.<br />
<br />
In my case, Baan had the standard selection criteria variables &quot;pdno.f&quot; and &quot;pdno.t&quot;.<br />
I created two new variables &quot;item.f&quot; and &quot;item.t&quot; for my requirement.  <br />
I reset pdno.f and pdno.t to the min and max values of the prod order with my SQL based on the selected range for &quot;item.f&quot; and &quot;item.t&quot;.  <br />
<br />
Now, everything works as I required.<br />
<br />
Thanks Mark, Baanboard and to everyone who contributed to this <br />
thread,<br />
<br />
Punitha</div></div><hr />


<div class="post"><div class="posttop"><div class="username">~Vamsi</div><div class="date">7th May 2004, 07:31</div></div><div class="posttext">Punitha,<br />
<br />
Please post final code as an example if you can.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Punitha</div><div class="date">7th May 2004, 15:38</div></div><div class="posttext">Vamsi,<br />
<br />
I'll certainly post my sample code here before the end of the day today or by Mon morning.<br />
<br />
<br />
Punitha</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">7th May 2004, 15:51</div></div><div class="posttext">I think I see what you are saying.  Do a like a pre-select and run an event or DLL routine inside the selectdo.  Sounds like a good solution and much better than using the report.<br />
<br />
Mark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Punitha</div><div class="date">7th May 2004, 15:53</div></div><div class="posttext">You are right Mark!  &quot;pre-select&quot; is the idea...<br />
<br />
<br />
Punitha</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Punitha</div><div class="date">7th May 2004, 23:47</div></div><div class="posttext">I have attached here,  my modifications to the template generated by &quot;RUSH&quot;.<br />
<br />
I have highlighted in &quot;YELLOW&quot; on my modifications.<br />
<br />
Thanks everybody,<br />
<br />
Punitha</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mostrightfuture</div><div class="date">13th July 2004, 12:16</div></div><div class="posttext">hi all,<br />
<br />
All discussion looks great and really worthwile. One thing that is confusing for me. The library (4GL Programm) generated by the RUSH, how I use it? I mean where that library (4GL Program) will be add/use, with the actual session or where ? for example I want to extended the functionaliy of a print session (cisli2405m000). Can I add the generated library (4GL program) to a device script to load the print session in the bakgroud and print the report?<br />
<br />
Thanks in advance<br />
Mahmood</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dorleta</div><div class="date">20th July 2004, 10:29</div></div><div class="posttext">I never have tested it but this maybe another solution.<br />
<br />
bic_cstub6.1 [-s] [-a] -d &lt;library&gt; -o &lt;object&gt;<br />
<br />
this function converts a baan dll ( I suppose and program script too ) in a c source. Of this way ( if this works like help says ) let you have  the source of all object of baan and changes their funcionality.<br />
<br />
Anybody have tested something about?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">goooch</div><div class="date">27th July 2004, 14:02</div></div><div class="posttext">Hi All!<br />
Could you describe all problems and solutions  with check.input functions and g_check_input_funcs?<br />
I saw the one (but there are several):<br />
<br />
The original script:<br />
<br />
<br />
declaration:<br />
 extern	domain tcdsca	one,two<br />
 long error<br />
before.program:<br />
  error=true<br />
choice.cont.process:<br />
before.choice:<br />
 check.all.input()<br />
on.choice:<br />
  message(&quot;Are you here? How could you manage this?&quot;)<br />
after.choice:<br />
  error=true<br />
field.two:<br />
check.input:<br />
     error=false<br />
field.one:<br />
check.input:<br />
   if error then<br />
    message(&quot;Something wrong&quot;)<br />
    set.input.error(&quot;&quot;)<br />
   endif<br />
<br />
In this case you'll see the questions<br />
<br />
The Rush script (only part!)<br />
before.program:<br />
  parent.object.function.id = get_function(parent.object.dll.id,&quot;before.program&quot;)<br />
  parent.object.error = exec_function(parent.object.dll.id, parent.object.function)<br />
field.one:<br />
check.input:<br />
  parent.object.function.id = get_function(parent.object.dll.id,&quot;check.input.one&quot;)<br />
  parent.object.error = exec_function(parent.object.dll.id, parent.object.function)<br />
field.two:<br />
check.input:<br />
  parent.object.function.id = get_function(parent.object.dll.id,&quot;check.input.two&quot;)<br />
  parent.object.error = exec_function(parent.object.dll.id, parent.object.function)<br />
choice.cont.process:<br />
before.choice:<br />
  parent.object.function.id = get_function(parent.object.dll.id,&quot;before.choice.cont.process&quot;)<br />
  parent.object.error = exec_function(parent.object.dll.id, parent.object.function)<br />
on.choice:<br />
  parent.object.function.id = get_function(parent.object.dll.id,&quot;on.choice.cont.process&quot;)<br />
  parent.object.error = exec_function(parent.object.dll.id, parent.object.function)<br />
after.choice:<br />
  parent.object.function.id = get_function(parent.object.dll.id,&quot;after.choice.cont.process&quot;)<br />
  parent.object.error = exec_function(parent.object.dll.id, parent.object.function)<br />
<br />
In this case you'll see the message &quot;Something wrong&quot;<br />
<br />
The sample is simple, but the idea was, can i recognize the check.input's order?<br />
Maybe I did some mistakes, sorry</div></div><hr />


<div class="post"><div class="posttop"><div class="username">lbencic</div><div class="date">27th July 2004, 18:34</div></div><div class="posttext">I may be missing something too, but I think this would depend on the Form Field Order.  If the field 'one' is first on the field order, it would generate this message.  If it is after the field 'two',  it should not.<br />
<br />
Did not test this though, is that true?  If not, maybe you can trace the calls and see when that variable is set to false.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">goooch</div><div class="date">28th July 2004, 07:55</div></div><div class="posttext">Hi Lisa!<br />
The Field order is not responsible for check.input order while check.all.input works<br />
I think the order of sections check.input in the program is responsible (if I change the order of the sections in the last sample and the result will be the same as the first).<br />
The function g_check_input_funcs has this order, and this function is used<br />
where check.all.input happens<br />
Ok, I can manage the order of  check.input sections<br />
but how can I be sure that the order is true (the same as the original)?<br />
Of course, i can follow the field order, but if the originator did not followed this way?<br />
<br />
I met this problem with tdilc1122 program. I' ve done the rush script with the alphabet order and has an unexpected result. Restoring section in the field order I have it Ok. I (Everybody?) need the universal remedy<br />
Thank you</div></div><hr />


<div class="post"><div class="posttop"><div class="username">hydbaan</div><div class="date">10th August 2004, 18:29</div></div><div class="posttext">did any one try extending a DAL using rush dll</div></div><hr />


<div class="post"><div class="posttop"><div class="username">SriksAdi</div><div class="date">28th August 2004, 09:43</div></div><div class="posttext">Hi All,<br />
I am on BaanIVc4 - SP15.<br />
I tried to use RUSH with Sales Orders and Display Customers List.<br />
In both the cases, I could successfully generate the script. But on compiling the generated script, I am facing these compilation errors:<br />
ptccom1510010(  56): Error: Function 'before.program' already declared.<br />
ptccom1510010(  65): Error: Missing RETURN(..) in function 'g_check_input_funcs'<br />
ptccom1510010(  77): Error: Missing RETURN(..) in function 'library_has_maintable'<br />
ptccom1510010(  89): Error: Missing RETURN(..) in function 'tcedi0052.get.next.btno'<br />
ptccom151001g( 116): Error: Function 'library_has_maintable' already declared.<br />
ptccom151001g( 121): Error: Inconsistent number of args function 'g_check_input_funcs' line ptccom1510010(61)<br />
ptccom151001g( 122): Error: Function 'g_check_input_funcs' already declared.<br />
ptccom151001g( 123): Error: 'count' not declared<br />
<br />
<br />
I have commented a few functions before.program(), g_check_input_funcs(), library_has_maintable(), tcedi0052.get.next.btno and g_check_input_funcs and it went through.<br />
<br />
Does it have a fix or shall I continue to comment the script ?<br />
On problem I forsee in commenting is the before.program of the parent would not be executed.<br />
<br />
Regadrs<br />
Sriks<br />
<br />
PS: Attached is the script generated by RUSH</div></div><hr />


<div class="post"><div class="posttop"><div class="username">vktonk</div><div class="date">6th March 2007, 10:35</div></div><div class="posttext">Hi...<br />
I tried using the extended code, I create a dll - tccomdllrushwith rushdll.bc<br />
and 3gl program script tccomrush3gl,compiled, create run time dd.<br />
Now when i try to run that 3gl through Run Program / Session in menu browser, message : cannot start session appears.<br />
<br />
Please help me out.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">7th March 2007, 18:14</div></div><div class="posttext">The session script should still be a 4gl script - so I am not sure what you are referring to.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kysersoze12</div><div class="date">26th March 2007, 12:02</div></div><div class="posttext">Highly useful utility .Excellent work buddy .<br />
I was confused when first time I saw your scripts .I had to think really deep to understand what you did .I now realise when we compile 4gl script .It is compiled into 3gl .In 3gl object our session choices and field sections are stored as functions .Great work .<br />
<br />
I also wanted to inform you that I got an error &quot;array index out of bound&quot; while creating decompiled script of tdsls4101m000 .</div></div><hr />


<div class="post"><div class="posttop"><div class="username">david7</div><div class="date">12th April 2007, 15:58</div></div><div class="posttext">This part of code did not work for me :(. I am trying it on LN and my server is on NT.<br />
<br />
temp.file = creat.tmp.file$(bse.tmp.dir$())<br />
options = &quot;-e &quot; &amp; strip$(directory) &amp;  &quot; -qo &quot; &amp; temp.file<br />
ret = run.baan.prog(&quot;bic_info&quot;, options, RP_WAIT)<br />
|hopefully the above works on NT!<br />
run.baan.prog returns 1 (ret=1)<br />
<br />
I have read some threads and understood that you have to be physically on the NT server. Is there a solution for this problem?<br />
<br />
Any ideas?<br />
<br />
- David</div></div><hr />


<div class="post"><div class="posttop"><div class="username">george7a</div><div class="date">24th April 2007, 11:55</div></div><div class="posttext">I have read some threads and understood that you have to be physically on the NT server. Is there a solution for this problem?<br />
<br />
Any ideas?<br />
<br />
- David<br />
Hi,<br />
<br />
The following thread solves your problem:<br />
http://www.baanboard.com/baanboard/showthread.php?t=34138<br />
<br />
- George</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Nad2006</div><div class="date">24th October 2007, 22:42</div></div><div class="posttext">Hi ~VAMSI,<br />
<br />
I am copying a standard baan form into my dev VRC then I am adding a new field to it .And I am including this into the program script (Qkey). <br />
However at the execution at the form level the field is not recognised and I get &quot; unknown form field refb.f&quot; error message.<br />
<br />
The question is it possible to add new fields to the original baan session?<br />
Then how to do it?<br />
<br />
Thanks for your Help!<br />
<br />
Nad</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">24th October 2007, 23:32</div></div><div class="posttext">Yes - that is exactly what this is for.  Wait are you using Qkey and not ~Vamsi solution?  It you are using Qkey post your script in a new post in the tools forum - not on this thread.  I suggest compiling it in debug mode to make sure it is running the correct script.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rmarles</div><div class="date">17th June 2008, 21:52</div></div><div class="posttext">Hi All,<br />
<br />
Firstly, thanks to ~vamsi and the other supporters of this project; it's an excellent contribution.  Also, thanks to mark_h, getting me going on another issue I had (http://www.baanboard.com/baanboard/showthread.php?t=52666), utilizing these routines.<br />
<br />
After some guidance from mark_h, I was able to compile both the RUSH DLL and the RUSH program script.<br />
<br />
I am running into one more issue however;  when trying to solve my problem, I was getting some errors invoking the RUSH program script, errors below.<br />
<br />
Upon debugging, I found that it was the section of code that read <br />
<br />
input.string(&quot;Get Parent Object&quot;, &quot;parent object&quot;, 16, 16, parent.object)<br />
<br />
does not work.<br />
<br />
I could hardcode the variable values into the program script, comment out the input strings, and recompile everytime I wanted to use RUSH, but I'd rather get things working correctly moving forward.<br />
<br />
We're running ASCII mode, Mark wasn't quite sure if &quot;input.string&quot; was unsupported in ASCII mode - can anyone provide any advise?<br />
<br />
Thanks.<br />
<br />
Error Messages:<br />
Error [BaFindObjectInProcess    ]: Process 196: object 379 not found<br />
Error [BaChangeMainWindow       ]: Main window 379 doesn't exists in process 196<br />
<br />
Error [BaFindObjectInProcess    ]: Process 196: object 379 not found<br />
Error [BaGetMainWindowData      ]: Main window 379 doesn't exists in process 196<br />
<br />
Error [BaFindObjectInProcess    ]: Process 196: object 379 not found<br />
Error [BaChangeMainWindow       ]: Main window 379 doesn't exists in process 196<br />
<br />
Error [BaFindObjectInProcess    ]: Process 196: object 379 not found<br />
Error [BaChangeMainWindow       ]: Main window 379 doesn't exists in process 196</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rmarles</div><div class="date">18th June 2008, 20:39</div></div><div class="posttext">Quick update; the program script worked fine when I hardcoded the variable values;<br />
<br />
If anyone has any recommendations for getting input.string working, or an alternative, please let me know. (ASCII mode)<br />
<br />
Thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">litrax</div><div class="date">19th June 2008, 11:02</div></div><div class="posttext">I saw some code here or elsewhere and have it running.<br />
You first have to determine if you are in graphical mode:<br />
<br />
if graphical.mode then<br />
   input.ok = input.string(formname, &quot;target company&quot;, 3, 3, s_comp_t)<br />
else<br />
   input.ok = ascii.input.string(formname, &quot;target company&quot;, 3, s_comp_t)<br />
endif<br />
<br />
Then you need to put in the function for ascii.input.string:<br />
<br />
function long ascii.input.string(string mwindow.title(80),<br />
				 string label(80),<br />
				 long p.width,<br />
			     ref string s_comp_t() )<br />
{<br />
	long win_id<br />
	long height, width, row, col <br />
	long attrs(WINMAXSIZE)<br />
<br />
	long new_color, red_int, green_int, blue_int<br />
<br />
	mwindow.title = strip$(mwindow.title)<br />
	label = strip$(label)<br />
<br />
<br />
	new_color = rgb(0,0,0)<br />
	red_int	= red.component( new_color )		| 46<br />
	green_int = green.component( new_color )	| 139<br />
	blue_int = blue.component( new_color )		| 87<br />
<br />
	height = 5<br />
	width = max(len(mwindow.title), len(label) + p.width + 2) + 4<br />
<br />
	win_id = current.window()<br />
<br />
	get.window.attrs(win_id, attrs)<br />
	row = win.height(attrs)<br />
	col = win.width(attrs)<br />
	row = int(row / 2.0) - int(height / 2.0)<br />
	col = int(col / 2.0) - int(width  / 2.0)<br />
<br />
	win_id = sub.window(win_id, height, width, row, col )<br />
<br />
	box(1, 1, width, height, 1)<br />
<br />
	row = 1<br />
	col = 3<br />
	if not isspace( mwindow.title) then<br />
		print cp$(col, row) &amp; &quot; &quot; &amp; mwindow.title &amp; &quot; &quot;<br />
	endif<br />
<br />
	row = 3<br />
	if not isspace(label) then<br />
		print cp$(col, row) &amp; label<br />
		col = col + len(label) + 2<br />
	endif<br />
	data.input(sprintf$(&quot;%d %d 0 %d L='\E'&quot;, col, row, p.width),<br />
		   s_comp_t,<br />
		   s_comp_t)<br />
<br />
	cl.screen(1, 1, width, height)<br />
	del.window(win_id)<br />
	refresh()<br />
	<br />
	return (s_comp_t &lt;&gt; chr$(27)) <br />
}<br />
<br />
Perhaps this is useful for you.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">indian_sumesh</div><div class="date">7th November 2008, 10:38</div></div><div class="posttext">Dear Baan Friends,<br />
<br />
I wants to use Rush Technique to extend the func. of a Session so how I can get started with the rushdll and main.<br />
<br />
some doubts<br />
<br />
1) rushdll - in dllusage info it is mentioned that tccomdllrush is used in this dll<br />
    from where i can find this tccomdllrush dll?<br />
<br />
2) Then I have to create the rushdll ? by copy the contens of the given rushdll script ?<br />
<br />
3) Then from where I can run the main script to generate the file showing all the extern functions in the standard session?<br />
<br />
Pl. help or explain the steps to use this.<br />
<br />
Thanks &amp; regards<br />
Umesh</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rmarles</div><div class="date">7th November 2008, 14:59</div></div><div class="posttext">Hi There,<br />
<br />
I meant to do up some documentation but never got around to it.  The long and short of it.<br />
<br />
Grab the code for the tccomrush and tccomrushdll program scripts in post #1 (http://www.baanboard.com/baanboard/showpost.php?p=2475&amp;postcount=1) and post #5 (http://www.baanboard.com/baanboard/showpost.php?p=3239&amp;postcount=5).  You'll want the rushdll.bc from post #1 and the main.bc code from post #5.<br />
<br />
In ttadv2131m000, Maintain Libraries, create the library tccomdllrush.  Copy and paste the contents of the rushdll.bc file from post #1 into here.<br />
<br />
In ttadv2130m00, Maintain Program Scripts, create a program script tccomrush. It is a 3GL - Program without Main Table script type (&quot;3GL (Without Stnd.Prgr.)&quot;). Copy and paste the main.bc code in the program script from post #5.  Compile.<br />
<br />
To run the rush code, run the program &quot;ottcomrush&quot;.<br />
<br />
It was about 5 months ago when I did this so I hope I remembered all the steps correctly!! :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">7th November 2008, 15:10</div></div><div class="posttext">The main.bc program will create a script.  Put this script in your development VRC.  At this point you can make code changes inside the script for the changes you need.  I also recommend reading very carefully all of the posts in this thread.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">indian_sumesh</div><div class="date">10th November 2008, 06:03</div></div><div class="posttext">Dear Marles,<br />
<br />
Thanks for the details.<br />
<br />
I tried by copy the rushdll.bc code to a new library but while complile got the attached error.<br />
<br />
Pl. help.<br />
<br />
Thanks &amp; Regards<br />
Umesh</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">10th November 2008, 17:11</div></div><div class="posttext">The attached compiles cleanly in our environment.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">indian_sumesh</div><div class="date">12th November 2008, 06:31</div></div><div class="posttext">The attached compiles cleanly in our environment.<br />
<br />
Hi Mark,<br />
<br />
What are the latest stpapi patches needs to be install ?<br />
<br />
and the error 33 occurs for the line <br />
<br />
options = &quot;-e &quot; &amp; strip$(directory) &amp;  &quot; -qo &quot; &amp; temp.file<br />
<br />
My environment is<br />
 OS - Sun solaris<br />
Baan4C4  SP -15 porting - 7<br />
<br />
Thanks &amp; Regards<br />
Umesh</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">13th November 2008, 16:45</div></div><div class="posttext">DId you change the script?  My version has <br />
<br />
option_rush = &quot;-e &quot; &amp; strip$(directory) &amp;  &quot; -qo &quot; &amp; temp.file<br />
<br />
I am not sure I would use the variable name &quot;options&quot;.  That might be the problem.<br />
<br />
In this case you do not need to worry about stpapi patches - that is my matra for the API function servers and is not related to this.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kmcinc</div><div class="date">28th April 2009, 23:22</div></div><div class="posttext">Hi All,<br />
<br />
I was quite excited to find this thread and have the opportunity to include custom code in standard Baan business processes.  Compiling the script and DLL worked fine but I don't get any output file.  I<br />
1. specify the object, such as 'otiitm0101' and <br />
2. specify the output file, such as 'pitm0101.c'.<br />
<br />
I searched the entire server but did not find the output file.  Any suggestions as to what the problem might be?  We are working on a Windows platform with Baan IVc4 on SP25.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">1st May 2009, 19:57</div></div><div class="posttext">I recommend putting the scripts in debug mode and just tracing thru it to see what directory is getting set.  I noticed from the original post several comments in the code about nt.  Not sure how much that helps.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">simonngou</div><div class="date">28th November 2009, 20:31</div></div><div class="posttext">Hi All,<br />
<br />
This idea is very very very Great! It help me so much.<br />
<br />
Up to the latest version I got, I found some problems when I was trying to extend code of standard object whinh3512.<br />
<br />
The problems:<br />
1. Parsing Extern Function with return value will always return false<br />
    Reason is:<br />
<br />
    Funtion extern domain tcbool somefunction() <br />
<br />
    will be transferred to<br />
<br />
parent.object.function.id = get_function(parent.object.dll.id, &quot;domain tcbool somefunction&quot; )<br />
parent.object.error = exec_function(parent.object.dll.id, parent.object.function.id, ret_val)<br />
return(ret_val)<br />
<br />
This problem is fixed after I enchaned the logic of processing return value and function name<br />
<br />
2. Missing arguments, I have found some extern function need argument<br />
sunch as when.synchronized.with.child, and it will cause a fatal error at function execution<br />
<br />
This problem is not yet fixed but I also have an idea. Extract the arguments and put it behind the ret value at exec_function. But the logic is not yet implemented<br />
<br />
3. And I also did a little change :P, I pass the object path directly to the load_dll function, and then i don't need to include otccomdllrush and the extened version (it is just personal style)<br />
<br />
	WRITELN(&quot;	parent.object.dll.id = load_dll(&quot;&quot;&quot; &amp; path &amp; &quot;&quot;&quot;,0)&quot;)<br />
	WRITELN(&quot;	if (parent.object.dll.id &lt;= 0) then&quot;)<br />
	WRITELN(&quot;		message(&quot;&quot;Unable to load parent object dll!&quot;&quot;)&quot;)<br />
	WRITELN(&quot;		stop()&quot;)<br />
	WRITELN(&quot;	endif&quot;)<br />
<br />
Thks so much for this great idea, and i help me to solve so many problems<br />
<br />
Regards<br />
Simon</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">1st December 2009, 14:20</div></div><div class="posttext">Nice update! Thanks Simon.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Senthil Kumar R</div><div class="date">31st December 2010, 10:54</div></div><div class="posttext">Hi<br />
<br />
I tried these programs and noticed the result is fine, as per the authors statement, here with attached the functional document with step by step procedure. As I am a functional consultant I not made the technical document. Also I am attaching the two files dllrush &amp; main which I used for my customization. Please any Technical (Tools) consultant who used these programs provide technical document for the same.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rajib.koley</div><div class="date">31st December 2010, 11:41</div></div><div class="posttext">Dear Senthil,<br />
<br />
I have used this excellent creativity by Mohana Vamsi and Praveen Ambekar. Its very useful, please find the attachment for details. I have also attached the generated script.<br />
<br />
Thanks &amp; Regards-<br />
Rajib Koley</div></div><hr />


<div class="post"><div class="posttop"><div class="username">joepte</div><div class="date">5th November 2012, 20:57</div></div><div class="posttext">Hi, I know this is a little old now but is the first post in this thread still the latest version for the code wrapper?  Thanks...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">5th November 2012, 21:02</div></div><div class="posttext">As far as I know it is still the latest version.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">~Vamsi</div><div class="date">5th November 2012, 22:32</div></div><div class="posttext">There are issues with the original code to which other users have contributed fixes. You will need to read through all the posts in this thread to get the most benefit.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">eric.dizon</div><div class="date">29th November 2012, 00:30</div></div><div class="posttext">I followed the instructions from Senthill Kumar; I created the tccomdllrush - General Library, tccomrush - 3GL (Without 4GL engine) and session to start the program from the files posted from his thread.   But when I try to generate otdsls4100 nothing gets generated ? Any help will be greatly appreciated</div></div><hr />


<div class="post"><div class="posttop"><div class="username">eric.dizon</div><div class="date">29th November 2012, 00:31</div></div><div class="posttext">Does this wrapper DLL work in ERP LN FP 7 ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">29th November 2012, 01:03</div></div><div class="posttext">Can't answer the &quot;if it works in ERP LN FP 7&quot;.  But can you put the script in debug mode and watch it run?  See if it is generating anything at all or where the break down might be. You should be able to see it creating the file.  This would confirm the object is being read and if not where the issue might be.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bhushanchanda</div><div class="date">9th January 2014, 21:30</div></div><div class="posttext">Does this wrapper DLL work in ERP LN FP 7 ?<br />
<br />
Yes it works!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">FrenkR</div><div class="date">9th March 2014, 21:08</div></div><div class="posttext">..........</div></div><hr />


<div class="post"><div class="posttop"><div class="username">benito</div><div class="date">25th March 2014, 20:21</div></div><div class="posttext">i'm in 8.2.1 (fp8) and have 2 sessions built on that.<br />
<br />
Does this wrapper DLL work in ERP LN FP 7 ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kevalghelani</div><div class="date">26th August 2014, 11:06</div></div><div class="posttext">hi..All<br />
<br />
i have write wrapper on script whinh3512<br />
<br />
but at time of closing detail view of session:whinh3512m100 , it gives fatal error as:<br />
 <br />
ILLegal number of arg(0) for function when.synchronized.child.exists expected 1<br />
<br />
<br />
I can't understand which value to be passed to following function after ret..<br />
<br />
long ret<br />
	parent.object.function.id = get_function(parent.object.dll.id, &quot;when.synchronized.child.exits&quot;)<br />
	parent.object.error = exec_function(parent.object.dll.id, parent.object.function.id,ret,?)<br />
	return(ret)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bhushanchanda</div><div class="date">26th August 2014, 11:43</div></div><div class="posttext">Hi,<br />
<br />
Have you tried with 3 arguments?<br />
<br />
parent.object.error = exec_function(parent.object.dll.id, parent.object.function.id,ret)<br />
<br />
e.g.<br />
<br />
#define func(X)<br />
^		parent.object.function.id = get_function(parent.object.dll.id,&quot;X&quot;)<br />
^		if parent.object.function.id &lt;&gt; 0 then<br />
^			parent.object.function.return = 0<br />
^			parent.object.error = exec_function(parent.object.dll.id,<br />
^						parent.object.function.id,<br />
^						parent.object.function.return)<br />
^		else<br />
^			message(&quot;Function %s not found&quot;, &quot;X&quot;)<br />
^		endif</div></div><hr />


<div class="post"><div class="posttop"><div class="username">giggty</div><div class="date">21st August 2018, 16:00</div></div><div class="posttext">Hello,<br />
not long ago I faced a task which would require altering the behavior of the standard session which Extensibility wouldn't help with. As I had stumbled upon this thread already I thought the time has come at last, time to test this inventive tool that is (I pay deepest respect to MohanaVamsi Potluru and Praveen Ambekar for the original idea). While I was messing around with it I became familiar with the internals of rush and I thought I could try making it even better. So here's my attempt at improving^W fiddling with rush!<br />
Details:<br />
1. I moved all the wrapper-forging code to the dll, so it returns the array of function no more: tccom.dllrush.get.parent.functions() became tccom.dllrush.generate.wrapper.script(). The main reason for that relates to the next point:<br />
2. All string manipulation (file reading and writing) now uses dynamic arrays which grow when needed so no hardcoded limits anymore!<br />
3. This tool now supports wrapping of report objects (can't tell whether this can really be useful, please let me know :))<br />
4. The biggest improvement: functions with arguments are now properly wrapped with the arguments being accurately forwarded.<br />
5. Some refinemnets here and there (path.* functions utilisation for example)<br />
6. main() now shows a dialog where one can pick an object type and zoom into ttadv2539m000 (or ttadv3536m000) to select the object instead of typing its name.<br />
<br />
I would love to hear some feedback.<br />
<br />
P.S. The question posed by authors is still open: how are the paths inside fd-file separated in case there are drive letters? And what about unix-like systems?<br />
<br />
P.P.S. One of the first things that got my attention was the fact that rush parses fd-file to search for parent object. There are standard functions for this, like pathname() (http://www.baanboard.com/programmers_manual_baanerp_help_functions_directory_file_operations_pathname) and search.path.object from ttdllsrch_path. I even rewrote most of the code for using pathname() before I realised that pathname() couldn't tell the difference between standard object and customized one, so it would return &quot;the top&quot; one in terms of the VRC derivation structure which is obviously not gonna work in all cases! So don't step on the same rake :P</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Ajesh</div><div class="date">30th August 2018, 14:50</div></div><div class="posttext">I was just checking it out and no need for me to point out that, its an excellent utlity.I was checking out for a standard Session tdsls4401m000 and generated the Code Print Sales Order Acknowledgement/RMAs but one thing i found out that the program never goes to this specific part,function extern on.choice.print.data().<br />
<br />
Any Clues??</div></div><hr />


<div class="post"><div class="posttop"><div class="username">giggty</div><div class="date">31st August 2018, 11:33</div></div><div class="posttext">What do you mean by &quot;the program never goes to this specific part,function extern on.choice.print.data()&quot;? Had you generated wrapper script, customized on.choice.print.data event and it didn't work?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Ajesh</div><div class="date">1st September 2018, 19:23</div></div><div class="posttext">Yes.. It never hit the on.choice.print data event...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">giggty</div><div class="date">17th September 2018, 14:35</div></div><div class="posttext">Sorry for the late reply. Now I can't really remember what was on my mind, when I asked you for a clarification :)<br />
Have you seen this (http://www.baanboard.com/baanboard/showthread.php?t=58974) thread?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">vinceco252</div><div class="date">17th September 2018, 17:48</div></div><div class="posttext">I would expect that to mean that the choice.print.data is not present in the original script...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">giggty</div><div class="date">18th September 2018, 09:57</div></div><div class="posttext">But why does osls4401 export choice.print.data() then?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">18th September 2018, 14:27</div></div><div class="posttext">It could simply be because that is an option on the form - I have seen some qkey sessions export events that never get hit either. It would be nice if you owned source and could look at it to debug exactly what happens.  My best guess is that on some of the 4c4 sessions one event launches something so you never hit some of the events that you expect to hit.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">tmannais</div><div class="date">16th January 2019, 12:17</div></div><div class="posttext">I am interested in this software but I can't figure out how to use it.<br />
I downloaded main.bc and rushdll.bc files from giggty's post, which I think is the latest version of this.<br />
Also, I use LN 10.5 and 10.6 so I want to know if it will work with those versions.<br />
Please advice.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">benito</div><div class="date">16th January 2019, 15:43</div></div><div class="posttext">I use LN10.5 and the wrapper still works. Just go through the discussion and you should be able to make it to work.<br />
<br />
I am interested in this software but I can't figure out how to use it.<br />
I downloaded main.bc and rushdll.bc files from giggty's post, which I think is the latest version of this.<br />
Also, I use LN 10.5 and 10.6 so I want to know if it will work with those versions.<br />
Please advice.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">16th January 2019, 16:06</div></div><div class="posttext">I am interested in this software but I can't figure out how to use it.<br />
I downloaded main.bc and rushdll.bc files from giggty's post, which I think is the latest version of this.<br />
Also, I use LN 10.5 and 10.6 so I want to know if it will work with those versions.<br />
Please advice.<br />
<br />
See posts on page 5 http://www.baanboard.com/baanboard/showthread.php?t=559&amp;page=5 I think post 65/66 it describes high level steps of what do do.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">BaaNovva</div><div class="date">2nd June 2020, 21:21</div></div><div class="posttext">In your wrapper class script you did not declare your form field &quot;refb.f'' as &quot;extern''.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">BaaNovva</div><div class="date">2nd June 2020, 21:24</div></div><div class="posttext">In your wrapper class script you did not declare your form field &quot;refb.f'' as &quot;extern''. <br />
<br />
Hi ~VAMSI,<br />
<br />
I am copying a standard baan form into my dev VRC then I am adding a new field to it .And I am including this into the program script (Qkey). <br />
However at the execution at the form level the field is not recognised and I get &quot; unknown form field refb.f&quot; error message.<br />
<br />
The question is it possible to add new fields to the original baan session?<br />
Then how to do it?<br />
<br />
Thanks for your Help!<br />
<br />
Nad</div></div><hr />



</div>
</body>
</html>