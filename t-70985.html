<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="[AFS] stpapi.form.command returns no error message, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] [AFS] stpapi.form.command returns no error message AFS/DDC/OLE: Function servers" />
	
	<title>[AFS] stpapi.form.command returns no error message [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="index.html">Newbaanboard</a> &gt; <a href="index.html">Baan SIGs</a> &gt; <a href="index.html">AFS/DDC/OLE: Function servers</a> &gt; [AFS] stpapi.form.command returns no error message</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">tmannais</div><div class="date">6th April 2018, 10:41</div></div><div class="posttext">Hi,<br />
<br />
I am trying to make it click &quot;Confirm&quot; form command in session &quot;whinh4130m000&quot;.<br />
<br />
The part that is having an issue is here:<br />
<br />
stpapi.put.field(session.code, &quot;whinh430.shpm&quot;, i.tdcrm412.shpm)<br />
if stpapi.find(session.code, error.msg) = 1 then<br />
	if stpapi.mark(session.code, error.msg) = 1 then<br />
		stpapi.set.report(session.code, &quot;rdtfsa140111000&quot;, &quot;ASCIF&quot;, error.msg)<br />
		if isspace(error.msg) then<br />
			stpapi.form.command(session.code, 5, &quot;confirm.shipment&quot;, error.msg)<br />
		else<br />
			error.msg = &quot;Cannot set report: &quot; &amp; error.msg<br />
		endif<br />
	else<br />
		error.msg = &quot;Cannot mark record: &quot; &amp; error.msg<br />
	endif<br />
else<br />
	error.msg = &quot;Record not found: &quot; &amp; error.msg<br />
endif<br />
<br />
<br />
To be precise, the problem is on this line:<br />
<br />
<br />
stpapi.form.command(session.code, 5, &quot;confirm.shipment&quot;, error.msg)<br />
<br />
<br />
It just does not return error message even when there is actually an error message from clicking the form command on a specific record manually.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Ajesh</div><div class="date">7th April 2018, 05:53</div></div><div class="posttext">Try dal.get.error.message</div></div><hr />


<div class="post"><div class="posttop"><div class="username">tmannais</div><div class="date">9th April 2018, 04:52</div></div><div class="posttext">I tried it.<br />
<br />
<br />
stpapi.form.command(session.code, 5, &quot;confirm.shipment&quot;, error.msg)<br />
dal.get.error.message(error.msg)<br />
show.dal.messages(MSG.ALL)<br />
<br />
<br />
I also tried this.<br />
<br />
<br />
stpapi.form.command(session.code, 5, &quot;confirm.shipment&quot;, error.msg)<br />
stpapi.get.mess.code(session.code, error.msg)<br />
message(error.msg)<br />
<br />
<br />
Still, the functions give me no errors at all.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">tmannais</div><div class="date">9th April 2018, 08:01</div></div><div class="posttext">I think I got some more clues about this.<br />
The error message that shows when I manually click the form command has a title code &quot;tcstl0002&quot; with the only clickable button is &quot;OK&quot;.<br />
So, I searched the messages in the system. Found nothing related to it.<br />
Then I searched the questions in the system. Found the exact code in there -- &quot;tcstl0002&quot;.<br />
It is a warning-type question, with domain tcstl.message in Language-Independent Data section.<br />
However, I tried answering the question but still it gives no errors.<br />
<br />
stpapi.enum.answer(session.code, &quot;tcstl0002&quot;, tcstl.message.ok)<br />
<br />
Actually, I want to capture the message from that since the confirm process is done with no problem. I just want to capture and then display the error whenever it occurs.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">9th April 2018, 20:14</div></div><div class="posttext">I have always use stpapi.get.mess.code to retrieve messages.  Check both the return value(which is a string with the code) and the message value.  See if anything is in either value.  The help reads like the below - but I think I have only ever gone back for just the last message.  If it is working it may be working without generating that warning.  Seems to me I had that once and I just coded to check what I needed before running the AFS code. <br />
<br />
From AFS document I have:<br />
This retrieves the messages generated by the indicated session as a result of an stpapi.* function call. The messages are returned in the opposite order as generated in the session. Messages generated by the AFS or 4GL-Engine are also returned.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">tmannais</div><div class="date">10th April 2018, 05:08</div></div><div class="posttext">I tried this as you suggested.<br />
<br />
<br />
mess.code = stpapi.get.mess.code(session.code, error.msg)<br />
message(mess.code)<br />
message(error.msg)<br />
stpapi.form.command(session.code, 5, &quot;confirm.shipment&quot;, error.msg)<br />
mess.code = stpapi.get.mess.code(session.code, error.msg)<br />
message(mess.code)<br />
message(error.msg)<br />
<br />
<br />
But all of the messages are empty.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">10th April 2018, 14:52</div></div><div class="posttext">Without source code I am not sure what else you could do to try to trap the message.  That is assuming the api actually hits the warning message.   If you know what causes the message you could check those things first. I have done that a few times just to prevent warnings or error messages.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Ajesh</div><div class="date">10th April 2018, 16:48</div></div><div class="posttext">What if you tried commenting <br />
<br />
		stpapi.set.report(session.code, &quot;rdtfsa140111000&quot;, &quot;ASCIF&quot;, error.msg)<br />
<br />
?<br />
I have a funny feeling, this is causing problem...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">tmannais</div><div class="date">11th April 2018, 04:22</div></div><div class="posttext">@Ajesh<br />
I tried commenting that command but the problem still persists.<br />
<br />
@mark_H<br />
I will try what you suggested and I will update in here soon.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">tmannais</div><div class="date">20th August 2018, 09:08</div></div><div class="posttext">Checking the conditions that will cause the form command to return errors will work because then we can detect the cause of it and decide not to execute the form command. However, I use AFS because I do not know how the form command works including its conditions, which are a lot. So I still try to find a way to capture the error from executing the form command using AFS. If anyone has any more clues, please help.</div></div><hr />



</div>
</body>
</html>