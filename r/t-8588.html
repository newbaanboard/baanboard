<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="How to change cp1251 to cp866 ?, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] How to change cp1251 to cp866 ? Tools Development" />
	
	<title>How to change cp1251 to cp866 ? [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="../index.html">Newbaanboard</a> &gt; <a href="../index.html">Baan Quick Support: Functional &amp; Technical</a> &gt; <a href="../index.html">Tools Development</a> &gt; How to change cp1251 to cp866 ?</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">Svetlana</div><div class="date">24th January 2003, 12:33</div></div><div class="posttext">Hello,<br />
I moved bhsd01.txt to the c:\mpp with function server2client(...).<br />
Now, I have  bhsd01.txt containing cp1251. How to change it to cp866 ?<br />
Thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">klesch</div><div class="date">24th January 2003, 15:09</div></div><div class="posttext">Do you want to do this programmaly or manualy?<br />
<br />
If programmaly, then before moving, read a file line by line, scan the string for characters in cp1251 and change it to cp866.<br />
<br />
If manualy, use your favorite text editor and do a search for characters in cp1251 and change them to correct characters in cp866.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">NPRao</div><div class="date">24th January 2003, 20:32</div></div><div class="posttext">I am not sure if you have this tools dll - ttdllstring in your BaaN version.<br />
<br />
You can use - the function - <br />
<br />
void  search.and.replace( ref string line(), const string srch(), const string replace() )</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Svetlana</div><div class="date">27th January 2003, 09:16</div></div><div class="posttext">Hello,<br />
I have not librarie ttdllstring. <br />
I want to do this programmaly.<br />
I do not know how scan the string for characters in cp1251 and change it to cp866.<br />
Sorry.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">NPRao</div><div class="date">27th January 2003, 09:48</div></div><div class="posttext">Svetlana,<br />
<br />
As klesch suggeested - <br />
<br />
If programmaly, then before moving, read a file line by line, scan the string for characters in cp1251 and change it to cp866.<br />
<br />
You can use the seq functions to read the file and then use the pos() (http://www.baanboard.com/programmers_manual_baanerp_help_functions_string_operations_pos_rpos) command to find the pattern and replace it. You can make a generic find/search &amp; replace program yourself and put it in a dll.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">klesch</div><div class="date">27th January 2003, 09:57</div></div><div class="posttext">Svetlana, do you want an example how to do it?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Svetlana</div><div class="date">27th January 2003, 10:20</div></div><div class="posttext">Thanks, NPRao, Klesch.<br />
I know how work function seq.*.<br />
My problem:<br />
I have string for characters in cp1251.<br />
How to change it to cp866? <br />
<br />
Yes, I want an example how to do it. :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">klesch</div><div class="date">27th January 2003, 10:40</div></div><div class="posttext">Here is a simple example:<br />
<br />
<br />
function change.char(string s(1024), string original.char(1), string substitute.char(1))<br />
{<br />
	long	i<br />
	<br />
	for i = 1 to len(strip$(s))<br />
		if s(i;1) = original.char then<br />
			s(i;1) = substitute.char<br />
		endif<br />
	endfor<br />
}</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Svetlana</div><div class="date">27th January 2003, 11:04</div></div><div class="posttext">Sorry, sorry, sorry!<br />
I told problam not right.<br />
Sorry! :-)<br />
I have string encoded of OC DOC (cp1251).<br />
I want to have string encoded of OC Windows (cp866).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">klesch</div><div class="date">27th January 2003, 11:41</div></div><div class="posttext">Are you saying that you don't know which characters need to be replaced with which characters in order to get conversion from cp1251 tp cp866?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Svetlana</div><div class="date">27th January 2003, 11:58</div></div><div class="posttext">So, I do not know it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">klesch</div><div class="date">27th January 2003, 12:16</div></div><div class="posttext">Are you from Russia? Are cp866 and cp1251 cyrilic codepages? If so, I believe that a lot of conversions will have to be done. I'm sure that you'll be able to find some conversion tables on the web.<br />
<br />
Or, you can use one of programs listed here (http://home.swipnet.se/~w-59166/slavrec/spis.htm)  and try to find out what you need to convert.<br />
<br />
I hope this helps.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Svetlana</div><div class="date">27th January 2003, 12:47</div></div><div class="posttext">Yes, I am a Russian. Cp866 and cp1251 are cyrilic codepages.<br />
I  think this help.<br />
Thank you very much.</div></div><hr />



</div>
</body>
</html>