<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="Why hang up in Purchase receipt?, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] Why hang up in Purchase receipt? AFS/DDC/OLE: Function servers" />
	
	<title>Why hang up in Purchase receipt? [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="index.html">Newbaanboard</a> &gt; <a href="index.html">Baan SIGs</a> &gt; <a href="index.html">AFS/DDC/OLE: Function servers</a> &gt; Why hang up in Purchase receipt?</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">alibaba</div><div class="date">15th December 2003, 14:04</div></div><div class="posttext">hi all:<br />
When i develope a  afs function for Purchase receipt, the AFS-dll hang up at stpapi.handle.subproc function! below is my script:<br />
<br />
stpapi.put.field(&quot;tdpur4120m000&quot;, &quot;tdpur045.reno&quot;, &quot;1&quot;)<br />
stpapi.put.field(&quot;tdpur4120m000&quot;, &quot;form.dino&quot;, &quot;dino.no&quot;)<br />
|-------------------------------------------------------------<br />
stpapi.handle.subproc(&quot;tdpur4120m000&quot;, &quot;tdpur4131s000&quot;, &quot;add&quot;)<br />
|-----------------------------------------------------------------<br />
stpapi.put.field(&quot;tdpur4131s000&quot;, &quot;tdpur045.suno&quot;, strip$(shiftl$(ret.suno))) 	<br />
stpapi.put.field(&quot;tdpur4131s000&quot;, &quot;tdpur045.orno&quot;, strip$(shiftl$(orno.no)))			<br />
stpapi.put.field(&quot;tdpur4131s000&quot;, &quot;tdpur045.pono&quot;, strip$(shiftl$(pono.no)))		<br />
stpapi.continue.process(&quot;tdpur4131s000&quot;, err)<br />
stpapi.put.field(&quot;tdpur4120m000&quot;, &quot;tdpur045.diqu&quot;, strip$(shiftl$(oqua.no)))<br />
stpapi.put.field(&quot;tdpur4120m000&quot;, &quot;tdpur045.data&quot;, strip$(shiftl$(current.time)))<br />
stpapi.put.field(&quot;tdpur4120m000&quot;, &quot;tdpur045.dqua&quot;, strip$(shiftl$(oqua.no)))<br />
stpapi.update(&quot;tdpur4120m000&quot;, true, err)<br />
<br />
In debug mode ,step to &quot;stpapi.handle.subproc&quot; function the program was hang up!what worng of mine?why the function hung up?<br />
<br />
please help me ! thanks<br />
<br />
BTW. how to set AFS.LOG in windows environment?<br />
my BaaN environment is 4c4 DB is SQL 7 OS:W2K</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">15th December 2003, 15:28</div></div><div class="posttext">Not sure if they got post (http://www.baanboard.com/baanboard/showthread.php?s=&amp;threadid=13698&amp;highlight=Receipt) to work or not.  You may want to send them a PM.<br />
<br />
Here are somethings to check:<br />
(1) Make sure you have the latest objects for sessions.<br />
(2) Make sure you have latest objects for the sessions.<br />
<br />
A stpapi.handle.subproc should not hang.  Does it hang as soon as you step to the stpapi.handle.subproc command or when you try to step from it to the next stpapi.put.field?  You may want to check to see what is running in your shell as soon as you step past stpapi.put.field(&quot;tdpur4120m000&quot;, &quot;form.dino&quot;, &quot;dino.no&quot;) this line.  Just to make sure nothing else is running.<br />
<br />
Mark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DStroud</div><div class="date">16th December 2003, 00:04</div></div><div class="posttext">To turn on the AFS log, go to your BW Configuration and in the Command field insert -- -set AFSLOG=1.</div></div><hr />



</div>
</body>
</html>