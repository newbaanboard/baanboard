<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="Logo in BaaN report not showed when converting to postscript/PDF, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] Logo in BaaN report not showed when converting to postscript/PDF Tools Administration &amp; Installation" />
	
	<title>Logo in BaaN report not showed when converting to postscript/PDF [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="../index.html">Newbaanboard</a> &gt; <a href="../index.html">Baan Quick Support: Functional &amp; Technical</a> &gt; <a href="../index.html">Tools Administration &amp; Installation</a> &gt; Logo in BaaN report not showed when converting to postscript/PDF</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">iiparrag</div><div class="date">21st July 2011, 16:46</div></div><div class="posttext">Hello.<br />
<br />
In our company we use BaanIVc4 over Windows2008 Server and SQLserver2008.<br />
<br />
In one hand we print some reports in BaaN with company's logo. We don't have problems to show the logo in BaaN reportrs.<br />
<br />
In the other hand, some other BaaN reports (who don't have logo) are converted to PDF an saved to a folder with no user interaction. We do it through a postscript device defined as cointinues:<br />
<br />
Device:   PDFDISCO<br />
Device type:  Rewrite file<br />
4GL program: ttstpconv<br />
Argument:  postscript\E:/convert.bat %s<br />
Path: E:\baan\tmp\topdf<br />
Change allowed: V<br />
Page length: 66<br />
<br />
In the batch file used in argument line we use a Ghostscript (9.02) executable:<br />
ps2pdf -dTTFDEBUG -dBATCH -dNOPAUSE -sFONTPATH#c:\Windows\Fonts  -sPAPERSIZE#a4 -I#c:\Windows\Fonts %1 %1.pdf<br />
<br />
It works fine if the baan report have NO logos or user defined fonts (Truetype).<br />
<br />
So now we need to do the same we do with no-logo-reports, with logo-containing-reports: save them to disk as PDF.<br />
<br />
I installed (test server) several solutions from Infor to solve different postscript known problems, but nothing. So I uninstalled them again (test server). I realised that the postscript document generated during the conversion process doesn't support highest language level (3) that a postscript can support and &quot;understand&quot;. It generates postscript with languagelevel 1.<br />
<br />
We use Adobe Reader 9. <br />
The portingset is recent: 6.1c.14<br />
<br />
SP17 for Tools but tried to install up to solution 248784 (new code 22914243).<br />
<br />
I've read about type 42 fonts and so on (our Ghostscript version support them), but if BaaN doesn't care about this, no much to do... :(<br />
<br />
Maybe I should check the Device argument (poscript parameter...)<br />
<br />
Did anybody deal with a similar situation?<br />
<br />
Thank you so much.<br />
<br />
Ione</div></div><hr />


<div class="post"><div class="posttop"><div class="username">iiparrag</div><div class="date">21st July 2011, 16:55</div></div><div class="posttext">Hello again.<br />
I only wanted to explain that, for me, the main problem is that the batch file mentioned before just takes an incorrect source as input, or an older version that it should.<br />
<br />
This input postscript code is created by BaaN. That's the problem!!!<br />
<br />
Thank you again.<br />
Ione</div></div><hr />


<div class="post"><div class="posttop"><div class="username">iiparrag</div><div class="date">29th July 2011, 12:58</div></div><div class="posttext">Hello one more time.<br />
<br />
Now I'm writting to explain you the workaround.<br />
<br />
After installing all the solutions related to postscript ot ttstpconv (not necessary), we proceeded in other way.<br />
<br />
First of all, a Generic Postscript printer for Windows must be installed:<br />
http://www.princeton.edu/~cavalab/tutorials/public/PostscriptPrinterTutorial.pdf<br />
<br />
And it's port must be a file name (for example:  C:\temp.ps). This file will be generated by the Windows postscript printer. To use it in BaaN, we create a new windows-printer-type device in BaaN.<br />
<br />
Device: NEWDEVICE<br />
Device type: Windows Printer<br />
Device Queue: Generic Color PS for Commercial Printing<br />
Paper Type: A4<br />
Page length: 66<br />
<br />
Now, the session that generates the report must contain in it's program-file a line like:<br />
app_start(&quot;E:\convert.bat C:\temp.ps&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;)<br />
<br />
We solved it!!! <br />
<br />
Now we have a file C:\temp.ps.PDF (with the LOGO!!!). In this case, left margin is &quot;eaten&quot; by the to-postscript conversion, so I had to change the report's left-margin in BaaN from 0 to 2 (for example) and recompile it.<br />
<br />
I hope this helps to other users with a similar problem.<br />
<br />
Ione</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jatin_sanghi</div><div class="date">22nd September 2012, 07:40</div></div><div class="posttext">Hi Ione,<br />
<br />
Could you provide the text for convert.bat file..<br />
<br />
Thanks,<br />
Jatin</div></div><hr />


<div class="post"><div class="posttop"><div class="username">iiparrag</div><div class="date">24th September 2012, 09:14</div></div><div class="posttext">Hello Jatin.<br />
I already posted the main command at the beginning, but this is the complete files' content:<br />
<br />
set path=%path%;c:\gs9_02\bin;c:\gs9_02\lib<br />
set<br />
c:<br />
ps2pdf -dTTFDEBUG -dBATCH -dNOPAUSE -sFONTPATH#c:\Windows\Fonts  -sPAPERSIZE#a4 -I#c:\Windows\Fonts %1 %1.pdf<br />
del %1<br />
exit<br />
<br />
Ione</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rams141</div><div class="date">14th March 2013, 16:36</div></div><div class="posttext">We tried this but it did not work for us.<br />
The only thing i miss here is my logo comes from a new Font. When we print from BW Print, i right click and tell the system to use a different Custom Font(which contains logo).<br />
Where and how is this supposed to look at the custom font when there is no user intervention?<br />
Thanks<br />
Ram</div></div><hr />



</div>
</body>
</html>