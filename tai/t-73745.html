<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="Send email from LN session after specific actions, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] Send email from LN session after specific actions Tools Administration &amp; Installation" />
	
	<title>Send email from LN session after specific actions [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="../index.html">Newbaanboard</a> &gt; <a href="../index.html">Baan Quick Support: Functional &amp; Technical</a> &gt; <a href="../index.html">Tools Administration &amp; Installation</a> &gt; Send email from LN session after specific actions</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">mvanta</div><div class="date">23rd February 2021, 12:46</div></div><div class="posttext">Hello all.<br />
We have a request and we need your expertise since we have never done something similar.<br />
<br />
We are using LN 10.5 and from Order session (tdpur4100m000-tdpur4100m900) when an order is submitted (there is a change in the status) we want to send an email to specific users so as to let them know.Is it possible?If yes, using which LN functionality?<br />
<br />
Any ideas?Please advice.<br />
Thank you in advance!<br />
Maria</div></div><hr />


<div class="post"><div class="posttop"><div class="username">srkndnsn</div><div class="date">26th February 2021, 07:23</div></div><div class="posttext">Hello,<br />
<br />
You can send a mail in the ue script of tdpur400.<br />
<br />
I guess , ue.after.after.save.object would be work for you<br />
<br />
Best regards<br />
Serkan Danışan</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mvanta</div><div class="date">26th February 2021, 08:37</div></div><div class="posttext">Hello srkndnsn!<br />
Can you be more specific?It is really a black box for us.We need to use extension for sure but do we need to configure ES emessage?Or there is no need?<br />
<br />
Thank you,<br />
mvanta</div></div><hr />


<div class="post"><div class="posttop"><div class="username">srkndnsn</div><div class="date">26th February 2021, 10:41</div></div><div class="posttext">UE means User Exit, you can use for every table in your LN system. For detailed information, you should check this thread : <br />
<br />
http://www.baanboard.com/baanboard/showthread.php?t=70710<br />
<br />
You can use also Extensions but I have not experienced yet. So I cant say anything about that.<br />
<br />
For your second question, we are using our mail server and send mail via shell script.<br />
<br />
Best,<br />
Serkan Danışan</div></div><hr />


<div class="post"><div class="posttop"><div class="username">vahdani</div><div class="date">26th February 2021, 11:50</div></div><div class="posttext">Hi,<br />
<br />
I know that there is a complex internal functionality for sending emails from an ERPLN program. I had tested the functionality a long time ago and it did work!<br />
Programmers can find the information hier: Emessage Connector Overview (http://www.baanboard.com/programmers_manual_baanerp_help_emessage_connector_overview) <br />
<br />
To Maria: I don't know if there is another more user freindly way to send emails but the Emessage Connector method mentioned above needs a real expirienced programmer to write a program to register the status change of orders  -say per user exit as mentioned per serkan- and then create another program to  create and send the emails for the registered orders. As said real programming!:rolleyes:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mvanta</div><div class="date">26th February 2021, 17:11</div></div><div class="posttext">Hi,<br />
<br />
I know that there is a complex internal functionality for sending emails from an ERPLN program. I had tested the functionality a long time ago and it did work!<br />
Programmers can find the information hier: Emessage Connector Overview (http://www.baanboard.com/programmers_manual_baanerp_help_emessage_connector_overview) <br />
<br />
To Maria: I don't know if there is another more user freindly way to send emails but the Emessage Connector method mentioned above needs a real expirienced programmer to write a program to register the status change of orders  -say per user exit as mentioned per serkan- and then create another program to  create and send the emails for the registered orders. As said real programming!:rolleyes:<br />
<br />
vahdani,<br />
you make it sound really scary!<br />
:-)<br />
<br />
You have sent the emails using the emessager functionality?<br />
<br />
mvanta</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bhushanchanda</div><div class="date">27th February 2021, 08:09</div></div><div class="posttext">Check out this thread. (http://www.baanboard.com/baanboard/showthread.php?t=67769) Or just google &quot;send email baanboard&quot; and you will find a lot of answers. E-message connector is pretty straight forward solution. Just configure the service you want to use (SMTP..etc), use the sample program in the prog guide to test..customize as per need. You can also use external programs like Blat (http://www.blat.net/) (Thread (http://www.baanboard.com/baanboard/showthread.php?p=183097#poststop)) and run them from LN. A lot of different ways to achieve what you are looking for.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rochus</div><div class="date">7th March 2021, 13:10</div></div><div class="posttext">cmf.sendMail() is available from TIV2370</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ee05220</div><div class="date">8th March 2021, 10:50</div></div><div class="posttext">Use this code example from Programmers Guide Manual. It worked for me :)<br />
<br />
|******************************************************************************<br />
|* CMF Sample Code<br />
|******************************************************************************<br />
|* Script Type: 0<br />
|******************************************************************************<br />
<br />
DLLUSAGE<br />
Desc:   This code sample demonstrates the use of some of the <br />
        Infor LN eMessage Connector commands described in the <br />
        CMF 4GL Functional Design. <br />
        It accepts a filename (which points to an RTF document), <br />
        Infor LN eMessage Connector service name, <br />
        recipient name and recipient address (SMTP only) <br />
        as input arguments. <br />
        It then uses the Infor LN eMessage Connector commands <br />
        to construct a message then send it to the indicated<br />
        recipients.<br />
Pre:    None.<br />
Post:   The file is sent to the appropriate Infor LN eMessage<br />
        Connector service.<br />
In:     The four program arguments accepted are:<br />
        sourcefile:	The name of the file (RTF format) to be sent.<br />
        service:    This is the name of the service that will<br />
                    be used to send the message. <br />
                    This must be name of a valid Infor LN <br />
                    eMessage Connector service<br />
        name:       This is the (human readable) name of the recipient.<br />
        address:    This the address where the file should be sent. <br />
                    This could be an email address, a fax number, <br />
                    etc.<br />
Out:    None.<br />
ENDDLLUSAGE<br />
<br />
        string recipient.address(80)    |Recipient address<br />
        string recipient.name(80)       <br />
                        | Human readable name of the recipient<br />
        string sourcefile(256)          <br />
                        |Filename of the source file<br />
<br />
function main()<br />
{<br />
        domain ttcmf.prov service       <br />
                        |Infor LN eMessage Connector service for <br />
                        |transporting messages<br />
        long stat       |Variable to hold return values<br />
        long mid        |CMF message id<br />
<br />
        |Switch to company 0<br />
        compnr.check(0)<br />
        <br />
        |Get program arguments<br />
        sourcefile = strip$(argv$(1))<br />
        service = strip$(argv$(2))<br />
        recipient.name = strip$(argv$(3))<br />
        recipient.address = strip$(argv$(4))<br />
        <br />
        |Build message XML header<br />
        mid = create.xml.header()       <br />
        <br />
        |Send message<br />
        if mid &lt;&gt;0 then<br />
                stat = cmf.startService(service,2)<br />
                if stat&lt;&gt;0 then<br />
                        message(&quot;Message could not be sent &quot;&amp;<br />
                        	&quot;(Infor LN eMessage Connector&quot;&amp;<br />
                        	&quot; service did not start)&quot;)<br />
                        exit()<br />
                endif<br />
                stat = cmf.send(mid,service)<br />
                if stat&lt;&gt;0 then<br />
                        message(&quot;Message could not be sent &quot;&amp;<br />
                        	(Infor LN eMessage Connector &quot;&amp;<br />
                        	&quot;service refused message)&quot;)<br />
                        cmf.stopService(service,2)<br />
                        exit()<br />
                endif<br />
                stat = cmf.stopService(service,2)<br />
        endif<br />
}<br />
<br />
function long create.xml.header() <br />
{<br />
        long    message.ID<br />
        long    from.ID<br />
        long    to.ID<br />
        long    attachment.ID<br />
        long    ret<br />
        <br />
        message.ID = cmf.create()<br />
        <br />
        ret = cmf.setClass(message.ID, &quot;CMF.NOTE&quot;)<br />
        ret = cmf.setSubject(message.ID, &quot;Sample CMF Message&quot;)<br />
<br />
        |Set FROM recipient<br />
        from.ID = cmf.createRecipient(message.ID, ttcmf.role.from)<br />
        ret = cmf.setRecipientName(from.ID, &quot;John Doe&quot;)<br />
        ret = cmf.setRecipientAddress(from.ID,&quot;jdoe@example.com&quot;)<br />
        ret = cmf.setRecipientType(from.ID, &quot;SMTP&quot;)<br />
        |In reality of course the from address could be filled from<br />
		|the Address book.<br />
<br />
        |Set TO recipient <br />
        to.ID = cmf.createRecipient(message.ID, ttcmf.role.to)  <br />
        ret = cmf.setRecipientName(to.ID, recipient.name)<br />
        ret = cmf.setRecipientAddress(to.ID, recipient.address)<br />
        ret = cmf.setRecipientType(to.ID, &quot;SMTP&quot;)<br />
        ret = cmf.setRecipientResponsibility(to.ID, &quot;TRUE&quot;)<br />
<br />
        |Set attachment <br />
        attachment.ID = cmf.createAttachment(message.ID)<br />
        ret = cmf.setAttachmentBody(attachment.ID, &quot;TRUE&quot;)<br />
        ret = cmf.setAttachmentMIME(attachment.ID,<br />
				&quot;application/rtf&quot;<br />
        ret = cmf.setAttachmentFileName(attachment.ID,sourcefile,<br />
				&quot;Sample Attachment&quot;)<br />
<br />
        return(message.ID)<br />
}</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mvanta</div><div class="date">13th June 2021, 14:00</div></div><div class="posttext">Hello all.<br />
Thank you for your answers!They were very helpful.<br />
ee05220 did as you suggested and email was sent but we cannot add body.<br />
How you did it?Please advice!<br />
Thank you a lot!<br />
<br />
Maria</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ee05220</div><div class="date">14th June 2021, 11:03</div></div><div class="posttext">To add an email body you can use this function used in code example &quot;cmf.setAttachmentFileName(attachment.ID,sourcefile)&quot;, where &quot;sourcefile&quot; is a temporary file you create and write text using LN functions.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mvanta</div><div class="date">14th June 2021, 11:09</div></div><div class="posttext">To add an email body you can use this function used in code example &quot;cmf.setAttachmentFileName(attachment.ID,sourcefile)&quot;, where &quot;sourcefile&quot; is a temporary file you create and write text using LN functions.<br />
<br />
Good morning ee05220!<br />
Can you help me, how you create and write the file?<br />
<br />
Maria</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ee05220</div><div class="date">14th June 2021, 11:22</div></div><div class="posttext">I have this in my script<br />
<br />
|This opnes a temp file and I write a header record to it.<br />
	temp.itm = creat.tmp.file$(bse.tmp.dir$())<br />
	output.itm = seq.open(temp.itm,&quot;w&quot;)<br />
<br />
buff(1,1) = &quot;&lt;bold&gt;Production Order: &lt;/bold&gt;&quot;&amp;i.pdno&amp;chr$(10)&amp;chr$(13)&amp;chr$(10)&amp;chr$(13)&amp;<br />
		&quot;&lt;bold&gt;Production Item: &lt;/bold&gt;&quot;&amp;i.mitm&amp;chr$(10)&amp;chr$(13)&amp;chr$(10)&amp;chr$(13)&amp;<br />
		&quot;&lt;bold&gt;Project: &lt;/bold&gt;&quot;&amp;i.cprj&amp;chr$(10)&amp;chr$(13)&amp;chr$(10)&amp;chr$(13)&amp;<br />
		&quot;&lt;bold&gt;Client: &lt;/bold&gt;&quot;&amp;i.bpid&amp;&quot; &quot;&amp;i.nama&amp;chr$(10)&amp;chr$(13)<br />
<br />
ret = seq.puts(buff(1,1), output.itm)<br />
ret = seq.flush(output.itm)<br />
ret = seq.close(output.itm)<br />
<br />
sourcefile = temp.itm<br />
<br />
 <br />
<br />
<br />
After send the email you can delete the temporary file using<br />
<br />
ret = seq.unlink(temp.itm)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mvanta</div><div class="date">14th June 2021, 11:36</div></div><div class="posttext">I have this in my script<br />
<br />
|This opnes a temp file and I write a header record to it.<br />
	temp.itm = creat.tmp.file$(bse.tmp.dir$())<br />
	output.itm = seq.open(temp.itm,&quot;w&quot;)<br />
<br />
buff(1,1) = &quot;&lt;bold&gt;Production Order: &lt;/bold&gt;&quot;&amp;i.pdno&amp;chr$(10)&amp;chr$(13)&amp;chr$(10)&amp;chr$(13)&amp;<br />
		&quot;&lt;bold&gt;Production Item: &lt;/bold&gt;&quot;&amp;i.mitm&amp;chr$(10)&amp;chr$(13)&amp;chr$(10)&amp;chr$(13)&amp;<br />
		&quot;&lt;bold&gt;Project: &lt;/bold&gt;&quot;&amp;i.cprj&amp;chr$(10)&amp;chr$(13)&amp;chr$(10)&amp;chr$(13)&amp;<br />
		&quot;&lt;bold&gt;Client: &lt;/bold&gt;&quot;&amp;i.bpid&amp;&quot; &quot;&amp;i.nama&amp;chr$(10)&amp;chr$(13)<br />
<br />
ret = seq.puts(buff(1,1), output.itm)<br />
ret = seq.flush(output.itm)<br />
ret = seq.close(output.itm)<br />
<br />
sourcefile = temp.itm<br />
<br />
 <br />
<br />
<br />
After send the email you can delete the temporary file using<br />
<br />
ret = seq.unlink(temp.itm)<br />
<br />
ee05220 thank you!<br />
Can I make something clear?<br />
You use this code to write the file but how you attach it to the email?<br />
We could not attach a file that was placed on a specific location.<br />
<br />
Regards,<br />
Maria</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ee05220</div><div class="date">14th June 2021, 13:11</div></div><div class="posttext">When you create this file extension (I think it is a .txt file) the email body shows Its content and It was the unique solution I have found to do that, so the reason I delete from the server, after send the email.<br />
<br />
I don´t think if LN has another standard solution to do this...<br />
<br />
This txt file doesn't shows as attached but as html body.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mvanta</div><div class="date">30th June 2021, 16:22</div></div><div class="posttext">Hello all.<br />
Did as you suggested but instead of the text to appear as body it is placed as attachment.<br />
Find code used below.<br />
<br />
How can we add text in the body??<br />
<br />
Maria</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mvanta</div><div class="date">5th July 2021, 12:49</div></div><div class="posttext">We manage to find the error!<br />
Thank you for your help!<br />
We were really helpful!<br />
<br />
Have a nice day!<br />
Maria</div></div><hr />



</div>
</body>
</html>