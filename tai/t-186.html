<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="pdaemon eating cpu, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] pdaemon eating cpu Tools Administration &amp; Installation" />
	
	<title>pdaemon eating cpu [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="../index.html">Newbaanboard</a> &gt; <a href="../index.html">Baan Quick Support: Functional &amp; Technical</a> &gt; <a href="../index.html">Tools Administration &amp; Installation</a> &gt; pdaemon eating cpu</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">muraty</div><div class="date">18th September 2001, 12:40</div></div><div class="posttext">Hi,<br />
according to the solution 78072 , every printdaemon cycle a &quot;full table scan&quot; occurs.Why does pdaemon purge the tttaad320000 table in every cycle.Another quesiton why does pdaemon check the printqueue every moment again and again, I am sure a more efficient method could be taken in consideration.<br />
At least it is possible to change the interval of the cycle and sleeptime :)<br />
<br />
Murat <br />
<br />
VERSION(S):<br />
B40x<br />
<br />
SITUATION IDENTIFIED IN:<br />
pdaemon6.1, Printer Daemon<br />
<br />
SITUATION DESCRIPTION:<br />
The printer daemon is excessively purging jobs so the pdaemon6.1 process uses excessive CPU time.<br />
The result is that it takes extremly long for a print job to get to the printer.<br />
<br />
SOLUTION DESCRIPTION:<br />
When many users are printing jobs via the printer daemon, every print job has to be purged and each job has a delay time. The result is that the printer daemon runs in a cycle and in every cycle a purge action is done.<br />
This means that in every cycle of the daemon, the printer daemon tests every print job in the queue (executes a full table scan) for the purge time. When the delay time has passed the record will be purged.<br />
This takes a long time when there are many print jobs.<br />
<br />
In the new portingset (6.1c.03.02 and higher) a new variable (purge_interval) is added to the printer daemon to set the purge interval. This is the number of cycles in which one purge action takes place.<br />
This variable can be set in the file 'pdaemon6.1' in the directory '${BSE}/lib/defaults'<br />
If a value between 200 and 400 is used the purge action will be done 3 to 6 times per hour.<br />
The default setting of purge_interval is 1 when the parameter is not set.<br />
<br />
Additional to purge_interval, the parameter sleeptime (default = 10) can be set.<br />
Sleeptime is the time between every printer daemon cycle<br />
<br />
The syntax for setting these parameters is :<br />
purge_interval:200<br />
sleeptime:10<br />
<br />
After setting the variable, the printer daemon has to be restarted.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Gerhard</div><div class="date">21st September 2001, 16:13</div></div><div class="posttext">For me the question is, whether you need pdaemon at all. You only need it, when you use printers configured as &quot;Printer&quot;. This is usally only done, when you want to use the Baan internal &quot;queue management&quot;. If you only use printers configured as direct, Windows Printer ore any output to files, you can remove the start- and stop-sequences from $BSE/etc/rc.start (....stop) and thereby get rid of any performance issues which are caused by the pdaemon.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">patvdv</div><div class="date">21st September 2001, 16:22</div></div><div class="posttext">Gerhard,<br />
<br />
Is the pdaemon not also responsible for cleaning up files from $BSE/tmp (and not only ones generated by print requests)? Obviously this can also be done by a simple UX shell script etc.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">JamesV</div><div class="date">21st September 2001, 18:08</div></div><div class="posttext">Many of our accounts do not use the pdaemon at all.  <br />
<br />
The pdaemon does flag print jobs as &quot;removed&quot; in Maintain Device Queue.  However, the files are not removed from $BSE_TMP until the 'Purge device queue' (ttaad3221m000) is run.<br />
<br />
Normally we just set a cron job to delete old tmp files from this directory.  This includes the qp files and other process temp files. <br />
<br />
For example, the baanFS.log in $BSE_TMP is from the maintain hours accounting via DDC in ERP 5.  This file remains open and growing while DDC is running.  This is not cleaned up by the pdaemon if DDC dies.  (However you can disable the use of this log with the DDC_FS_LOG=0 environment variable).  <br />
<br />
The jobdaemon cleans up some temp files but every account I know of has to manually clean up $BSE_TMP on a regular basis.</div></div><hr />



</div>
</body>
</html>