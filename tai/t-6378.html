<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="How to send a message in Windows?, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] How to send a message in Windows? Tools Administration &amp; Installation" />
	
	<title>How to send a message in Windows? [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="../index.html">Newbaanboard</a> &gt; <a href="../index.html">Baan Quick Support: Functional &amp; Technical</a> &gt; <a href="../index.html">Tools Administration &amp; Installation</a> &gt; How to send a message in Windows?</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">markom</div><div class="date">22nd August 2002, 21:26</div></div><div class="posttext">How can I send message to all baan users? We have a winNT system</div></div><hr />


<div class="post"><div class="posttop"><div class="username">evesely</div><div class="date">22nd August 2002, 21:43</div></div><div class="posttext">See this thread (http://www.baanboard.com/baanboard/showthread.php?threadid=440)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">markom</div><div class="date">23rd August 2002, 09:31</div></div><div class="posttext">Where can I get all bshell pid for all users. <br />
I now command licmon-w.<br />
<br />
where can i find script?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">NPRao</div><div class="date">23rd August 2002, 09:38</div></div><div class="posttext">Please refer to the link -<br />
<br />
http://www.baanboard.com/baanboard/showthread.php?s=&amp;postid=22517#post22517</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Old Vens</div><div class="date">23rd August 2002, 10:18</div></div><div class="posttext">Hi Marcom,<br />
<br />
In Unix you can use ps -ef|grep bshell|grep -v grep - this will show you information about current bshell connections. Examine man  ps for detailed information what differnet columns in the output mean.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">markom</div><div class="date">23rd August 2002, 10:27</div></div><div class="posttext">I need for windows NT</div></div><hr />


<div class="post"><div class="posttop"><div class="username">markom</div><div class="date">3rd September 2002, 15:03</div></div><div class="posttext">Can anyone send me script for getting bshell.ID on windows NT<br />
sistem not on Unix. <br />
If someone have program for sending massage to all baan users on NT I will be very happy if hi would send mi<br />
<br />
Thanks<br />
<br />
marko.markic@elan-line.si</div></div><hr />


<div class="post"><div class="posttop"><div class="username">klesch</div><div class="date">3rd September 2002, 17:56</div></div><div class="posttext">Hey Markom!<br />
<br />
I quess, that Nazdaq's baan2baan product is exactly what you need. And it's quite cheap, too, I think.<br />
<br />
ITS is a representative of Nazdaq for Slovenia. Call or email me if you want a demo version.<br />
<br />
Aleksander, ITS.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Darren Phillips</div><div class="date">3rd September 2002, 19:08</div></div><div class="posttext">Just tried this, seems to work ok instead of picking up the pid and using bshcmd I get the username and use net send which will work ok if each NT user has their own Baan account . if you wanted to return the pid instead change the tokens=3 to 4 and your own command instead of net send<br />
<br />
usage is batname.bat &quot;message to baan user ??????&quot;<br />
<br />
<br />
<br />
%$BSE%\bin\licmon -w  &gt; c:\users.txt<br />
set mess=%1<br />
for /f &quot;skip=1  tokens=3 delims=. &quot; %%i in (c:\users.txt) do net send %%i %mess%</div></div><hr />


<div class="post"><div class="posttop"><div class="username">muheeb</div><div class="date">4th September 2002, 12:15</div></div><div class="posttext">Hi Darren<br />
<br />
I want to ask you about the code you posted...<br />
<br />
you pass to &quot;net send&quot; the user login name in baan?!<br />
<br />
and how it works?... it didn't work in our system.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Darren Phillips</div><div class="date">4th September 2002, 12:33</div></div><div class="posttext">%$BSE%\bin\licmon -w &gt; c:\users.txt<br />
set mess=%1<br />
for /f &quot;skip=1 tokens=3 delims=. &quot; %%i in (c:\users.txt) do net send %%i %mess%<br />
<br />
<br />
the %$BSE% picks up the enviroment variable for the baan installation directory (note need to run this on the server) or you could hardcode the location eg d:\baan\bin\licmon -w &gt; c:\users.txt<br />
<br />
the licmon -w &gt; c:\users.txt outputs the following information to the users.txt file<br />
<br />
eg<br />
SERVER         TYPE    USER           SYSTEM         DATE       TIME<br />
XXXXXX       bx/bw   XXX.537     XXXXXX       03-09-2002 07:53<br />
XXXXXX       bx/bw   XXXXXX.427   XXXXXX        03-09-2002 08:56<br />
XXXXXX       bx/bw   XXXX.474   XXXXXX        03-09-2002 09:50<br />
<br />
when you run the bat file say you call it message.bat <br />
message.bat &quot;this is a message to users&quot;<br />
the &quot;this is a message to users&quot; gets passed to the bat file as %1<br />
so the set mess=%1 sets the mess variable to the message you want to send to the users.<br />
<br />
the last line takes the text file users.txt and looks for blocks of text seperated by a space or a . and then takes the 3rd block of text it finds and passes it to the net send command which also picks up the variable mess as the message to send to the users.<br />
the skip=1 tells it to skip the first line as it is the header.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">muheeb</div><div class="date">4th September 2002, 13:49</div></div><div class="posttext">Hi,<br />
<br />
I know how the code works but my question was:<br />
<br />
the fact that this don't do what we want... sending the <br />
<br />
message to the right PC according to the username. <br />
<br />
that the script passes to the &quot;net send&quot;. <br />
<br />
We tried it manually in our server and it didn't work<br />
<br />
(sending message to the user XXXX we found in licmon <br />
<br />
in block 3 &quot;XXXX.ID&quot;)<br />
<br />
Thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Darren Phillips</div><div class="date">4th September 2002, 16:26</div></div><div class="posttext">So I take it that the first part is working ok it produces the text file.<br />
<br />
when you test it manually <br />
<br />
eg<br />
net send username message to all users<br />
<br />
what is the error message.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">muheeb</div><div class="date">4th September 2002, 16:30</div></div><div class="posttext">Hi,<br />
<br />
I try the concept of using &quot;net send&quot; with username,<br />
<br />
and it didn't work... I mean the spicific username <br />
<br />
didn't get any message to his local PC.<br />
<br />
So I guess it doesn't work always using &quot;net send&quot;<br />
<br />
by &quot;username&quot;... then we need the computer name itself.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Darren Phillips</div><div class="date">4th September 2002, 17:40</div></div><div class="posttext">%$BSE%\bin\licmon -w  &gt; c:\users.txt<br />
set mess=%1<br />
<br />
for /f &quot;skip=1 tokens=4 delims=. &quot; %%i in (c:\users.txt) do %$BSE%\bin\bshcmd -M %mess% %%i<br />
<br />
changed it to use PID and bshcmd instead.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">OmeLuuk</div><div class="date">4th September 2002, 17:51</div></div><div class="posttext">Service Messenger needs to be running...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">markom</div><div class="date">5th September 2002, 15:23</div></div><div class="posttext">Thanks all</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Han Brinkman</div><div class="date">5th September 2002, 17:11</div></div><div class="posttext">If you want to send every baan user a message why not edit the file systemmess in $BSE\lib?<br />
<br />
This normally works, if not than you have to add ottstppollmess in bms_mask.<br />
<br />
Han</div></div><hr />


<div class="post"><div class="posttop"><div class="username">cracked egg</div><div class="date">14th April 2003, 22:58</div></div><div class="posttext">I can see this is an old thread but I have been trying unsuccessfully to get this to work.  I have two bat files; 1 with the message and one with the script as below.  Can someone please point out what I might have wrong.  Thanks.<br />
<br />
1st file - sendmsg.bat<br />
<br />
e:\baan\bin\licmon -w &gt; c:\users.txt<br />
set mess=%1<br />
for /f &quot;skip=1 tokens=4 delims=. &quot; %%i in (c:\users.txt) do e:\baan\bin\bshcmd -M c:\msg.bat%%i<br />
<br />
2nd file - msg.bat<br />
<br />
message test</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Darren Phillips</div><div class="date">15th April 2003, 14:44</div></div><div class="posttext">I wrote this script some time ago, nice to see it is still of use, I no longer work on baan so cannot test it but this should work<br />
<br />
e:\baan\bin\licmon -w &gt; c:\users.txt<br />
for /f &quot; tokens=1 delims=.&quot; %%i in (c:\msg.bat) do set mess= %%i<br />
<br />
<br />
<br />
for /f &quot;skip=1 tokens=4 delims=. &quot; %%i in (c:\users.txt) do e:\baan\bin\bshcmd -M %mess% %%i</div></div><hr />


<div class="post"><div class="posttop"><div class="username">OmeLuuk</div><div class="date">16th April 2003, 12:07</div></div><div class="posttext">Darren,<br />
What is in (c:\msg.bat)?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Darren Phillips</div><div class="date">16th April 2003, 12:44</div></div><div class="posttext">the message that you want to send to the users.</div></div><hr />



</div>
</body>
</html>