<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="Problem with stpapi.insert, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] Problem with stpapi.insert AFS/DDC/OLE: Function servers" />
	
	<title>Problem with stpapi.insert [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="index.html">Newbaanboard</a> &gt; <a href="index.html">Baan SIGs</a> &gt; <a href="index.html">AFS/DDC/OLE: Function servers</a> &gt; Problem with stpapi.insert</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">dbinderbr</div><div class="date">18th September 2002, 23:55</div></div><div class="posttext">Hello there,<br />
<br />
I designed two simple sessions and a table to test the AFS functions.<br />
<br />
But, I had some problems. It always inserts a blank record !! <br />
<br />
I have created a table with the fields listed bellow:<br />
- table: tudcb900<br />
-&gt; Code: tudcb900.codi.o - tcmcs.long<br />
-&gt; Name: tudcb900.nome.o - tcmcs.str50<br />
-&gt; Phone: tudcb900.fone - tcmcs.str15<br />
<br />
There are only these fields, no relations, no conditions, no mandatory fields, nothing special at all.<br />
<br />
The sessions: one that calls the maintain session of the table mentioned above containing the AFS functions. There are nothing special used in these sessions, the maintain session of the table tudcb900 has a script only with the table declaration, nothing else.<br />
<br />
The script that has the AFS functions I have posted as an attachment with the log file generated by the execution.<br />
<br />
I dont know what to do... I've tried everything, apparently I wrote the script following percfectly the AFS manual.<br />
<br />
Thanks in advance.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">23rd September 2002, 16:25</div></div><div class="posttext">Just wondering if you got it working yet?  One suggestion I have is for you to put some sections in the tudcbo291m000 session. Compile it in debug mode and see what happens when you run the function server.  It may give some clues as to why the table fields are empty. Just a thought.<br />
<br />
Mark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dbinderbr</div><div class="date">23rd September 2002, 17:15</div></div><div class="posttext">Thanks Mark !<br />
<br />
I couldnt make it work yet, but I will try to debug the called session and look for errors.<br />
<br />
Have a nice week.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dbinderbr</div><div class="date">24th September 2002, 00:04</div></div><div class="posttext">Hello Mark,<br />
<br />
Unfortunatelly I couldnt make it works... it keeps inserting just a blank record. I have tried with another sessions, but it didnt work. I have reviewed the Baan AFS manual many times and I was not able to find any mistake in my code !! It's almost equal to the manual.<br />
<br />
I will try to call a friend of mine that works in Baan Support Team and ask her if she have already heard something about this kind of problem with AFS.<br />
<br />
Thanks for attention.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">24th September 2002, 15:28</div></div><div class="posttext">Yes your AFS code does look okay.  I was just wondering what happens when you start your maintain session. That why I recommended adding sections to it, that way you could see what your table fields had in them during the insert process(when they became empty).  Contacting Baan support is a good idea.  Have you loaded the latest tools package for the stpapi commands?<br />
<br />
Good Luck!<br />
<br />
Mark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dbinderbr</div><div class="date">24th September 2002, 21:30</div></div><div class="posttext">Hello Mark, Hello Gordon...<br />
<br />
Mark, I tried to create some sections like check input to debug the called session by the stpapi functions. I couldnt get anything special... I just could certify that the fields were really empty.<br />
<br />
I believe the tools objects are up-to-date because we have just finished replace the Baan IV C3 by the C4 with the latest updates.<br />
<br />
I have posted a zip file containing everything about the sessions: sessions definitions, table definition, the screen captured of the forms, the afs log file and both program scripts.<br />
<br />
I believe there is just a small detail wrong.. but small enough to make it not to work right.<br />
<br />
Thanks for your attention.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">25th September 2002, 00:41</div></div><div class="posttext">Gordon and Daniel,<br />
<br />
Did I miss something? From his documentation it looks like a form type 1 - not form type 3. Anyway I still think Gordons' answer may solve the problem. <br />
<br />
<br />
Mark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Guillaume.G</div><div class="date">25th September 2002, 10:31</div></div><div class="posttext">Hi Daniel,<br />
<br />
I try your script (with the same table and same script) and the result is good. <br />
The AFS insert the record ans in the second pass the message is &quot;the record already exist&quot;<br />
<br />
I think that you have not the good version of ttstpapihand.<br />
When i start to work with AFS, i'm the same problem.<br />
<br />
The minimum solution for use the AFS without bugg is : 126067 and the last solution is 127443.<br />
<br />
I have the solution 126067 in my system and is very good.<br />
<br />
For know your version of ttstpapihand, you can use the bic_info utility.<br />
<br />
Best regard<br />
<br />
Guillaume Gillet.<br />
Technical Consultant &amp; Development<br />
France - Lyon</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dbinderbr</div><div class="date">25th September 2002, 18:01</div></div><div class="posttext">Hello there !!<br />
<br />
Well...<br />
<br />
First of all I would like to say that I am grateful for the help of each one of you.<br />
<br />
I have tried everything you guys told me...<br />
<br />
- Gordon, the form is really of type 1, but even so I tried the change.view and it kept not working.<br />
- Mark &amp; Guillaume I installed the latest solution 127433 and... it's still not working.<br />
<br />
Guillaume, are you sure that it didnt added just a blank record? Because in my script, when you run it, it adds 100 records, if you have received the message &quot;Record already exists&quot; in the first execution probably you had the same problem, it should give this message only in a second execution because on this time the records would really exist.<br />
<br />
The table has no conditions, so it accepts a key filled with zero, if I change the field &quot;code&quot; to mandatory it will not insert even this blank record (I tried this with a more complex session).<br />
<br />
What makes me confused is that the log shows the values are being sent to the called session by the stpapi functions !! I dont know what else I can do.<br />
<br />
Thanks in advance.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Guillaume.G</div><div class="date">25th September 2002, 18:57</div></div><div class="posttext">Hi daniel,<br />
<br />
I'm retry your script.<br />
My scenario :<br />
A - create sessions<br />
------------------------<br />
- Create the table with the same fields<br />
- Generate a sample session (type 1) with a sample script (with only the declaration of the table, not other section)<br />
- Create a session for testing AFS with your script<br />
<br />
B - testing with data<br />
--------------------------<br />
- I'm insert several record in the maintain session<br />
- I'm run the AFS session ==&gt; it's ok and i have not blank record<br />
 and i have the message of your script &quot;Record Inserted Sucessfully.&quot;<br />
- In the second execution : no insert but the message &quot;Record already exist&quot;<br />
<br />
You can see in the attach file :<br />
- AFS.log (you can see that it's not the same of your test)<br />
- the version of ttstpapihand wtih the command <br />
bic_info6.1 -w ottstpapihand<br />
<br />
For information : i'm in Baan IV c4, Unix(AIX 4.3) and Oracle 7.3<br />
<br />
Good Luck<br />
<br />
Guillaume G.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dbinderbr</div><div class="date">25th September 2002, 20:31</div></div><div class="posttext">Hello my friends...<br />
<br />
Yes, It's working !!!<br />
What did I?<br />
<br />
I was almost giving up when I decided to navigate in the Baan site and look for a last chance of solution for my problem in the knowledge base.<br />
<br />
So, I reached the topic &quot;Problems solved in function server&quot;. It's the solution 115279. I downloaded it and some other dependencies that I hadnt installed in my environment like the solutions 128282 and 159592.<br />
<br />
After these updates the session started to work right !!!<br />
<br />
:cool: Thank you very much Mark, Gordon and Guillaume !!  :cool:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">25th September 2002, 21:17</div></div><div class="posttext">Glad you got it working and thanks for posting the solution.  This may help someone else resolve a problem.  Even the Baan Support Center has problems suggesting solutions at times. :)<br />
<br />
Mark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Guillaume.G</div><div class="date">26th September 2002, 10:31</div></div><div class="posttext">Hi Daniel,<br />
<br />
it's very good<br />
<br />
For information, the solution 157719 its the first patch that i install when i start to work with AFS.<br />
it's the version of ttstpapihand which finalized and officialized the AFS project.<br />
After this solution (2001-09) the function server will be part of the standard program solution (10923 for B40 c)<br />
<br />
So the last version of AFS is in solution 127443 (2002-09-09)<br />
<br />
But, actually i run the afs with the version of 2002-06 (sol 126067)<br />
<br />
good Work with AFS<br />
<br />
Best Regard<br />
<br />
Guillaume G.</div></div><hr />



</div>
</body>
</html>