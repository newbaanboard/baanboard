<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="CODE: AWKward Script for Baan Reports' passage to MS Excel, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] CODE: AWKward Script for Baan Reports' passage to MS Excel Code &amp; Utilities" />
	
	<title>CODE: AWKward Script for Baan Reports' passage to MS Excel [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="index.html">Newbaanboard</a> &gt; <a href="index.html">Baan SIGs</a> &gt; <a href="index.html">Code &amp; Utilities</a> &gt; CODE: AWKward Script for Baan Reports' passage to MS Excel</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">sitarammani</div><div class="date">29th March 2002, 18:07</div></div><div class="posttext">The attached script e.awk will provide an easy way for your <br />
    Baan report to MS Excel.<br />
<br />
Benefits:<br />
    With full respects to all who suggested the direct excel.exe<br />
    solution, this script will save the user from doing the <br />
    operations required to convert delimited text to columns.	     <br />
<br />
1&gt; You will need AWK MS-DOS version to use this. <br />
   (I have selected the MS dos Route, I leave it to the reader to<br />
     try out the UNIX route).<br />
   AWK.exe ideally should reside in c:\windows\command <br />
    (windows will easily find it).<br />
    The version of awk suggested consists of just one file awk.exe.<br />
    Source[s] to obtain get awk.exe for MS-DOS: <br />
    Check the sources listed below <br />
    Why AWK?<br />
    The distribution suggested has a very small footprint.<br />
    It is lightweight. Only one exe file. ..........................(A)<br />
<br />
    If your company policy prevents you from using awk.exe <br />
    from the  the net, simply translate the logic to WSH to <br />
    use it with  wscript.exe or cscript.exe <br />
<br />
2&gt; You will need to define a device in Baan.<br />
   You may be familiar, but described below. .......................(B)<br />
<br />
3&gt; You will need to create excel.bat in <br />
     c:\windows\ ( not c:\windows\command) directory<br />
     This should contain just one line as follows<br />
     awk -f c:\baan\e.awk %1<br />
     (Modify the path of e.awk if you have to)<br />
<br />
4&gt; You should agree to the script e.awk removing all <br />
     occurance of ',' in the Baan report's character, numeric <br />
     and any other fields. <br />
<br />
5&gt; You should agree to the script e.awk deleting <br />
     BaanReport.txt (file coming from Baan) and accept to view <br />
     the newly created file BaanReport.csv in  MS Excel.<br />
     So also if BaanReport.csv exists it will be overwritten.<br />
<br />
6&gt; You will ensure CSV files are associated with MS Excel <br />
     in Windows. (most likely they are)<br />
<br />
7&gt; Download the script e.awk and let it reside in <br />
     c:\baan (suitably change the path if baan directory is different)<br />
<br />
<br />
(A)...................................    Source you can get awk.exe free<br />
<br />
http://cm.bell-labs.com/who/bwk/awk95.exe<br />
ftp://ftp.oxy.edu/public/mawk113exe.zip <br />
<br />
I prefer the distribution from <br />
     http://cm.bell-labs.com/who/bwk/awk95.exe<br />
    This accepts long file names.<br />
    copy awk95 exe c:\windows\command\awk.exe<br />
<br />
    Do retain a copy awk95.exe <br />
   (in case windows is reloaded it will be handy)<br />
    Please Maintain a backup of :<br />
        e.awk<br />
        excel.bat<br />
    along with awk95.exe<br />
<br />
If you need awk documentation, it is available in UNIX Man.<br />
For MS-DOS version search for MAWK.DOC in the net, others <br />
also available.<br />
<br />
.......................................................................................<br />
<br />
(B)...................................    Define Device using Maintain Devices Session<br />
Device			: MSEXCEL<br />
Description		: MS Office Excel<br />
Device Type		: Rewrite File<br />
....<br />
....<br />
..........Skip these fields......<br />
....<br />
....<br />
4GL Program		: ottstpconv<br />
Argument 		: ascii:c:\windows\excel.bat %s<br />
path 			:/tmp/<br />
change allowed 		:YES<br />
Page Length 		:72<br />
......................................       <br />
<br />
Ensure the path mentioned in excel.bat is correct. Change the path in excel.bat if you need to.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Bob Ino</div><div class="date">8th April 2002, 22:31</div></div><div class="posttext">It's not working, nothing produced in temp directory.<br />
no ms excel fired pu after completion of script.<br />
<br />
I'll try a C program...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">8th April 2002, 23:06</div></div><div class="posttext">If I get a chance I will give this a try tomorrow and get back to you.<br />
<br />
Mark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">9th April 2002, 15:15</div></div><div class="posttext">Not a bad idea. It worked for me.  A couple of things I did to get it to work for me.  I downloaded awk95 and then renamed it under the c:\windows directory - same place I put the excel.bat file.  For the e.awk script I had to move it from the directory it was unzipped in, into the c:\baan directory.  Then I just created the device and it worked.<br />
<br />
A good example of how people solve the same problem different ways.<br />
<br />
Mark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Ravenscross</div><div class="date">9th April 2002, 15:42</div></div><div class="posttext">Sounds like I shall have to recommend this to a few people if it works, could help sort out loads of problems!<br />
<br />
I normally find that creating a device with 999 lines for page length makes life even easier for execl documents (fewer page breaks)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sitarammani</div><div class="date">9th April 2002, 16:59</div></div><div class="posttext">Please check the following:<br />
<br />
a)Awk should be available in the Dos path<br />
<br />
  From the dos prompt <br />
     (some other directory, <br />
      not where you copied awk.exe)<br />
     execute the command<br />
     awk &quot;BEGIN{print \&quot;Hello World\&quot;}&quot;<br />
     Did you see a &quot;Hello World&quot;  on the DOS Screen?<br />
  <br />
b) Csv should be associated with some program (pref Excel)<br />
	Create a file xyz.csv say &quot;ABC,54321&quot;<br />
	From the dos prompt (at where you created<br />
                xyz.csv ) execute start xyz.csv<br />
<br />
	Does this start excel?<br />
	is the file xyz.csv loaded in (excel or another program)<br />
<br />
<br />
c) Match the path stated in excel.bat and location of e.awk.<br />
<br />
d) The file created by Baan report should be found:<br />
    Can you locate the file (say abc.txt) you created from  Baan <br />
        in the Baan client directory.<br />
<br />
        The Baan client  directory could be c:\baan   <br />
        At the dos prompt 	 <br />
        execute c:\windows\excel.bat c:\baan\abc.txt<br />
        Does this work?<br />
 <br />
       if the baan client directory is under program files <br />
       execute c:\windows\excel.bat c:\progra~1\baan\abc.txt<br />
<br />
If you are not disappointed in a..d<br />
   BW.exe should be able to deliver the goods!<br />
<br />
Sitaram Mani</div></div><hr />


<div class="post"><div class="posttop"><div class="username">p.cole</div><div class="date">11th July 2002, 15:24</div></div><div class="posttext">Here's a shell script which does what the above does but is slightly improved with the following features:<br />
<br />
* Joins lines ending with \ together, allowing reports to output big lists for excel<br />
* Handles numbers with a trailing minus sign, moves minus sign to front for excel import<br />
* Trims whitespace from start and end of each field<br />
<br />
Phil</div></div><hr />


<div class="post"><div class="posttop"><div class="username">NPRao</div><div class="date">11th July 2002, 21:28</div></div><div class="posttext">Hi Phil and Mani,<br />
<br />
I have a question for this utility if it can handle the Header kind of Text on the report layouts.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sitarammani</div><div class="date">12th July 2002, 05:00</div></div><div class="posttext">the awk script removes any occurance of comma in any input line.<br />
subsequently it replaces pipe [|] with comma.<br />
<br />
sitarammani</div></div><hr />


<div class="post"><div class="posttop"><div class="username">NPRao</div><div class="date">6th August 2002, 00:20</div></div><div class="posttext">Hi Mani,<br />
<br />
I guess my question was - <br />
<br />
If the output is more than 1 page, would you have the repeating header?<br />
<br />
(or)<br />
<br />
would you have a single header on the top of the excel sheet and the columns/data printed below ?<br />
<br />
I was also wondering if you considered developing it in the BaaN Tools itself, without using, awk, sed. If so, you can achieve, portability across different operating systems.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">~Vamsi</div><div class="date">6th August 2002, 01:10</div></div><div class="posttext">Prashanth,<br />
<br />
There is more than one way to skin a cat. As a user you have choices. And choices are good :). If you need a Baan tools solution look at my posting on BaanXL (http://www.baanboard.com/baanboard/showthread.php?s=&amp;threadid=5880).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sitarammani</div><div class="date">9th August 2002, 07:00</div></div><div class="posttext">Hi Prashant:<br />
The awk script does not distinguish an input line as header or detail.<br />
<br />
Given a line the script removes any occurance of comma in any input line. Subsequently it replaces pipe [|] with comma.<br />
<br />
I went in for this solution since Baan uses '|' as a separator in all its reports. <br />
	?? can Pipe Separator be changed to comma?<br />
	!! if changed will spoil the presentation of the report to view on screen with D(isplay) device.<br />
<br />
As regards your second suggestion, we can use Vamsi's solution :BaanXL.<br />
<br />
I also liked p.cole's  rpt2csv.sh. This solution was very useful in breaking the 255Chars barrier.<br />
Sitaram Mani</div></div><hr />


<div class="post"><div class="posttop"><div class="username">NPRao</div><div class="date">9th August 2002, 08:12</div></div><div class="posttext">Well Mani,<br />
<br />
As Vamsi said...<br />
&quot;There is more than one way to skin a cat&quot;. <br />
I checked yours, Cole's as well as Vamsi's solutions and few others from Nazdaq etc.<br />
<br />
I made the Excel utility and set it up as &quot;Excel&quot; device. The user just chooses it and it doesnt ask any questions (Vamsi had good feature of that, but our users liked less user intervention). I cant publish my solution here (due to copyright etc issues). Hence I was giving you hints so that you can build it or Vamsi can improvise it.<br />
<br />
Here is a sample output of what can be done with the BaaN Tools without any other additional awk.exe etc files so that it can be portable across any OS installation.<br />
<br />
So something for you have to take the path which is not treaded... as described perfectly in the poem &quot;IF&quot; by Rudyard Kipling or Robert Frost.<br />
<br />
It was an interesting experience to get this working... :p<br />
<br />
I dont know why those smileys are not working here.. :-(</div></div><hr />


<div class="post"><div class="posttop"><div class="username">patvdv</div><div class="date">9th August 2002, 10:01</div></div><div class="posttext">Smilies are disabled in the CODE &amp; Utilities forum to avoid unwanted smilies when members post code snippets. Voila.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">markom</div><div class="date">30th August 2002, 15:39</div></div><div class="posttext">I got repotr in excel but it looks like in attachment</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">30th August 2002, 15:53</div></div><div class="posttext">Have you made sure the .csv extension is associated with Excel and that the default delimiter is a &quot;,&quot;?  I know on my system when I double click a .csv file it pops up in excel and formats it.  From your display it looks like the formatting piece did not take place, it seems like it was something in the system setup.  I can not remember where you set this up, hopefully someone else will know this.<br />
<br />
I also deleted the other post - the one with the .doc attachment. My system really choked on it.<br />
<br />
Good Luck!<br />
<br />
Mark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sitarammani</div><div class="date">30th August 2002, 17:38</div></div><div class="posttext">MyComputer<br />
Tools<br />
Folder Options<br />
FileTypes</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">30th August 2002, 18:14</div></div><div class="posttext">What I was thinking was that his Excel needed to know how to process the comma delimited file. Not really the file association.  I was thinking that maybe there was a system parameter(or maybe excel) that needed to be set so it new it was a comma delimited file.  It seems to me I read something somewhere that showed you how to set a default delimiter for the system.  Then when you saved a file as .csv it saved it with that delimiter and not the &quot;,&quot; delimiter.  I was thinking his maybe set to something else.  I wish I could find that post. Hope I am explaining it better.<br />
<br />
Mark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">30th August 2002, 18:26</div></div><div class="posttext">It was under the control panel on regional settings and is called the list separator. When I changed it to |, my CSV files opened like markoms.<br />
See attached. Where you see the pipe it should be a comma - under list separator.<br />
<br />
Mark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sitarammani</div><div class="date">31st August 2002, 17:50</div></div><div class="posttext">You are right Mark!!</div></div><hr />



</div>
</body>
</html>