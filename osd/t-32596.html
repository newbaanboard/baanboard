<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="Replication Problem!!, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] Replication Problem!! Operating Systems &amp; Databases" />
	
	<title>Replication Problem!! [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="../index.html">Newbaanboard</a> &gt; <a href="../index.html">Baan Quick Support: Functional &amp; Technical</a> &gt; <a href="../index.html">Operating Systems &amp; Databases</a> &gt; Replication Problem!!</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">sukesh75</div><div class="date">13th March 2007, 09:05</div></div><div class="posttext">Hi Guys,<br />
   Ran into some problems the other day while running database replication on our baan database. The type of replication used was Transactional Replication and the problem encountered was that there were no primary keys found on any of the baan tables and hence replication fails at the publication step. For Transactional Replication, it says a table needs to have atleast one primary key. Tried with Snapshot Replication and it worked but our requirement is for Transactional Replication. Has anyone over here encountered this issue or come up with a work around for this?<br />
 <br />
With our existing setup, we have baan and our reporting app on the same server. This causes a lot of problem in performance and so we decided to have it on different servers by replicating the baan database. <br />
<br />
can anyone help me out on this? <br />
<br />
sk</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sukesh75</div><div class="date">18th March 2007, 07:39</div></div><div class="posttext">Come on guys, hasn't anyone done replication on baan database? <br />
<br />
sk</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Francesco</div><div class="date">19th March 2007, 13:36</div></div><div class="posttext">I do use DTS to replicate baan data for reporting purposes however. Maybe this is an option?<br />
<br />
The question on everybody's mind must be: &quot;Do you really not have any indexes on your Baan table?&quot;<br />
Because if that's the case then your performance issues aren't just coming from the reporting tool.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sukesh75</div><div class="date">20th March 2007, 16:38</div></div><div class="posttext">Aaah reply at last!!! <br />
Well Francesco, there are indexes on Baan Tables..The problem i faced while using Transactional Replication was that it didnt find any primary keys in the table. When you go into the design of any table in Baan, you wouldnt find any primary keys defined. Transactional Replication doesnt work without primary keys...<br />
<br />
Coming to DTS... are you using it on the same server or different. Would like to know more about this if you could share some pointers...i.e if your reporting environment is on a different server....<br />
<br />
sk</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dave_23</div><div class="date">21st March 2007, 06:54</div></div><div class="posttext">you'd have to specify index1 as a primary key.<br />
<br />
and you'd lose that after any reconfig..<br />
<br />
It's the only way.<br />
<br />
Dave</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sukesh75</div><div class="date">21st March 2007, 08:31</div></div><div class="posttext">Thanks Dave for your input. As you said, any reconfig would take the primary keys off flushing the tedious task of assigning them in the first place. Apart from that, i am apprehensive about doing any changes to any of the baan tables for fear of starting a chain reaction of errors elsewhere. <br />
<br />
Quite surprisingly, i didnt find any documents on replication from Baan. There was one about Multisites but i failed to see any sort of database replication in it. Is it that Baan doesnt support transactional based replication? <br />
<br />
Leaving all that aside...Is there any other way to do this splitup of Baan and the Reporting Environment? How are 24/7 organizations working on multisites? Third party software? <br />
<br />
sk</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dave_23</div><div class="date">21st March 2007, 16:12</div></div><div class="posttext">I believe most sites use clusters for that. I believe that there are docs for setting that up..<br />
<br />
dave</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sukesh75</div><div class="date">24th March 2007, 08:42</div></div><div class="posttext">So, bottomline...without cluster i wouldnt be able to do daabase replication? I know you used the word &quot;most sites&quot; but what setup does the other sites employ to work it out? <br />
<br />
sk</div></div><hr />


<div class="post"><div class="posttop"><div class="username">tuple9i</div><div class="date">25th March 2007, 00:37</div></div><div class="posttext">I usually run multiple iterations of the BaaN database on various servers for Production, Test, Development and Scratchpad purposes. I have split the BaaN application from the BaaN database successfully a few times.<br />
<br />
I use BaaN 5c on Win2000 with Oracle 8i databases.<br />
<br />
Create your additional instance using either a Hot backup or Cold backup of the database.<br />
<br />
If you need additional info, just respond and I will be happy to help you. If you have other requirements that are not evident in your request, sorry for the extraneous info,<br />
<br />
Tuple9i<br />
<br />
:o</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sukesh75</div><div class="date">25th March 2007, 09:43</div></div><div class="posttext">hi Tuple,<br />
   Yes i would indeed like to get additional info on this...<br />
<br />
We are running Baan4c4 on SQL 2000/Win2003...Therefore my first question would be, with this existing environment of ours, is it possible to do what you suggested?<br />
Secondly, How do i keep the second database online with the Live one? How much time does it take to backup and restore using the &quot;Hot &amp; Cold&quot; backup method?<br />
Last but not least, Have you succesfully done Transactional Replication on Baan database? If yes, how did you handle the lack of primary keys?<br />
<br />
Looking forward to your reply..<br />
sk</div></div><hr />


<div class="post"><div class="posttop"><div class="username">tuple9i</div><div class="date">25th March 2007, 20:38</div></div><div class="posttext">Hi Sukesh. I just noticed that you are using SQL Server database. My solution is with Oracle, but databases are databases.<br />
<br />
First, I am not familiar with a &quot;Transactional&quot; replication. Possibly confusion with terminology.<br />
<br />
In my Oracle environment, I shutdown the Application, stop the database and then I copy the BaaN environment and Oracle datafiles to the new servers - one for the Application and one for the Database.<br />
<br />
I am using the Win2000 operating system for both (unfortunately, but there is nothing I can do about that ;-) , so I have already set the servers to the same environment that I have throughout my BaaN Application sphere, including the database binary structures.<br />
<br />
Now it is simply a matter of:<br />
1) copying the BaaN application data, overlaying the existing files that are there<br />
2)copy the datafiles to the proper locations as documented by the Production controlfile<br />
3) bring up the database and check for Oracle errors<br />
4) startup the BaaN application<br />
5) check for errors in the BaaN application itself.<br />
<br />
I do this about every 60 days to keep a Test region within a couple months of Production. I do use the Test region to test solutions and changes to BaaN or the Database. After the testing, I move the changes to Production. I am sure you do the same.<br />
<br />
Background information - <br />
<br />
I have a medium database - about 180 Gbytes, running Oracle 8.1.7.4<br />
BaaN Porting set is 7.1.02: BaaN 5c, but highly customized<br />
I run BaaN on 4 server spheres - 1 Production, 1 Test, 1 Development and 1 Scratchpad<br />
<br />
Additional - it takes about 1 1/2 hours to do the overlay from Production to any of the other three spheres. As far as Primary Keys, I never run into that problem. Guess that is a SQL Server thing.<br />
<br />
To create an environment that would run live with Production, you could rename the database and make the appropriate changes in the BaaN settings. I would suggest that you use different servers for each of the spheres - one for Production and one for Test.<br />
<br />
<br />
Hope I answered your questions. If not, you know where to find me  ;-)<br />
<br />
Tuple9i</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sukesh75</div><div class="date">26th March 2007, 08:46</div></div><div class="posttext">First thing first...<br />
Transactional Replication is one of the three choices you have in Replicating Databases(In MS Sql), the other two being Snapshot and Merge. Transactional Replication creates a snapshot or a copy of the original databases and as and when the tables(in the source db) are being updated, it updates the second copy with whats updated. This seemed to be perfect fit for our requirement untill we ran into the primary key issue..<br />
<br />
I dont know what similar choice you have in Oracle(last time i worked on Oracle was around 1997-98). <br />
<br />
Coming back to your solution: It is suitable for a test server environment and not for a time critical reporting environment. Most of our reports are critical of data to the last few minutes if not seconds...<br />
<br />
The end result we like to see is <br />
<br />
Two servers<br />
Server A (Baan and Baandb/MS Sql)<br />
Server B (Reports and Baandb/MS Sql)<br />
Server B.Baandb should be updated by Server A.Baandb to the last minute. All the reports users would be using Server B while Server A could be free of reporting overload...<br />
<br />
Any idea how to achieve this? Transactional Replication was promising untill the P.key issue..<br />
<br />
sk</div></div><hr />


<div class="post"><div class="posttop"><div class="username">tuple9i</div><div class="date">26th March 2007, 17:50</div></div><div class="posttext">Hi Sukesh, I remember the limitations with SQL Server from my last contract. The poor database Administrator ran into the same problem. It seems Developers for SQL databases don't like to use primary keys - an offshoot of the Access database development I guess. I don't know why, seems that they would be important to assure correct data, but just my theory. Oracle does not have that particular issue, but it has it's own quirks  ;-)<br />
<br />
You may try to cluster your database. I have never seen a Microsoft cluster work well, so I have limited knowledge on how to effectively help you with that - sorry.<br />
<br />
In the Oracle realm, I would use a Logical Standby database as my Reports environment. That refreshes by applying a commited query to the standby from the Primary at almost real time.<br />
<br />
I know that probably doesn't help, but I hope you find your solution. Let me know the results when you finally resolve your issue.<br />
<br />
Good Luck,<br />
<br />
Tuple9i</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sukesh75</div><div class="date">27th March 2007, 10:14</div></div><div class="posttext">Hi,<br />
  In my ongoing search for a solution i came across something called as &quot;Log Shipping&quot;. The idea behind this is simple that you would want to see it work before you beleive it. For those who are not familiar with this technique, it goes something like this<br />
Live Server Job 1: Main Database is backed up and then copied to the standby server where a stored procedure is fired to restore it on to that server<br />
Live Server Job 2: The Transaction Log is then backed up and copied in similar fashion to the standby server where another stored procedure is fired to restore the log to that server..<br />
<br />
Both these are two different jobs where in the first job is executed once in a day while the second one is executed every 15 minutes. The stored procedures are restore database and restore log commands created in the master database of the standby server. <br />
<br />
It all went well till the restore log part when it gave an error: &quot;The log in this backup set cannot be applied because it is on a recovery path inconsistent with the database.&quot;<br />
<br />
Has anyone done this before?<br />
<br />
sk</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sukesh75</div><div class="date">27th March 2007, 12:00</div></div><div class="posttext">Please ignore the earlier post as further investigation reveals that ..<br />
&quot;Log-shipping can't usually allow the secondary server to be used for reporting as it requires an exclusive lock on the database to restore the log i.e. during the restore users will be forcibly removed, or the log-shipping job will fail.&quot;<br />
So there goes the effort in the drain...<br />
<br />
Still looking for a way....<br />
<br />
sk</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Darren Phillips</div><div class="date">27th March 2007, 16:53</div></div><div class="posttext">in log shipping you have two options to put the logged shipped database into either  No recovery mode or Standby mode if it is in standby mode you can run queries on the database except when the logs are being written to the database</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sukesh75</div><div class="date">27th March 2007, 17:16</div></div><div class="posttext">Could you ellaborate on the Restore Log part. <br />
First time along with the database restore, it(restore log) goes all ok. But then when i tried the restore log after 10 minutes, it gave out an error which read <br />
&quot;The preceeding restore operation did not specify WITH NORECOVERY or WITH STANDBY. Restart the restore sequence, specifying WITH NORECOVERY or WITH STANDBY for all but the final step&quot;<br />
<br />
This is the command i am running<br />
///****<br />
RESTORE LOG database_name<br />
FROM DISK = 'path\dbname_log.bak'<br />
WITH <br />
DBO_ONLY,<br />
STANDBY = 'path\undo_dbname.ldf'<br />
****////<br />
<br />
I am all at sea on this...What am i doing wrong?<br />
<br />
sk</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Darren Phillips</div><div class="date">27th March 2007, 20:01</div></div><div class="posttext">I setup log shipping for another INFOR product syteline 7 but on sql 2000 enterprise you get a nice wizard to set this stuff up for you under covers for you. but your problem could be that when you did the full database restore did you have norecovery selected as if you did you cannot restore any further logs.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">David Eagar</div><div class="date">28th March 2007, 00:40</div></div><div class="posttext">Can we keep this going. I also have had these same issues trying to do exactly the same thing. Any tips on how to make this work greatfully accepted</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sukesh75</div><div class="date">28th March 2007, 09:17</div></div><div class="posttext">Thats what i thought when i saw the phrase &quot;preceeding restore operation&quot; but then i was confused about which restore it was talking about Restore Database or Restore Log(first time)..Technically the first Restore Log qualifies as the preceeding restore operation...<br />
Anyways.. i checked my Restore Database command and found out that there was no mention of NORECOVERY..<br />
<br />
I am including the command below..<br />
///*****<br />
Restore Database DbName<br />
From Disk = 'Path\Filename'<br />
WITH DBO_ONLY, <br />
REPLACE,<br />
StandBy = 'Path\Undo_DbName.ldf',<br />
MOVE = 'Data Logical Name' TO 'Path\DBName.mdf',<br />
MOVE = 'Log Logical Name' TO 'Path\DBName_Log. ldf'<br />
*****///<br />
<br />
So which of those settings up there do you think is responsible for the restore log error?<br />
<br />
Appreciate all the help..<br />
<br />
sk<br />
<br />
P.S: True that Log Shipping is available in the enterprise edition as a neat wizard but that shouldnt deter users of standard edition to use it with the help sql scripts and jobs. Not only that the underlying technique(behind log shipping) is just the same as what we are doing.... with the &quot;minor&quot; exception that this one isnt working yet...</div></div><hr />



</div>
</body>
</html>