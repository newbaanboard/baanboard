<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="Windows Event Log, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] Windows Event Log Operating Systems &amp; Databases" />
	
	<title>Windows Event Log [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="../index.html">Newbaanboard</a> &gt; <a href="../index.html">Baan Quick Support: Functional &amp; Technical</a> &gt; <a href="../index.html">Operating Systems &amp; Databases</a> &gt; Windows Event Log</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">Eddie Monster</div><div class="date">15th January 2014, 18:33</div></div><div class="posttext">I would like to create a Event Log filter to see how many times users have requested a license but were unable to because none were available:<br />
<br />
Event Log Window:<br />
<br />
Log Name:      Application<br />
Source:        Infor ES<br />
Date:          1/13/2014 1:14:01 PM<br />
Event ID:      1000<br />
Task Category: bshell<br />
Level:         Error<br />
Keywords:      Classic<br />
User:          &lt;domain&gt;\batchjob<br />
Computer:      &lt;server&gt;<br />
Description:<br />
Env	: baan4 (E:\Baan4\bse)<br />
Program	: bshell file \logic\mir\mir\bclm.c # 941<br />
Keyword	: bclmRequestLicense()<br />
User	: batchjob type:N language:2<br />
Process	: 5384<br />
Proc.Set	: batchjob@baanserver:7412<br />
Lasterror	: 0<br />
Errno	: 0<br />
BdbErrno	: 0<br />
ExtraInfo	: session: &quot;ottstpstdlib &quot;;object: &quot;ottstpstdlib&quot;; function: &quot;&lt;1&gt;&quot; bclm.requestlicense; company number: 0<br />
Message	: Request licence failed: 'out of licenses for product'<br />
<br />
Event Xml:<br />
&lt;Event xmlns=&quot;http://schemas.microsoft.com/win/2004/08/events/event&quot;&gt;<br />
  &lt;System&gt;<br />
    &lt;Provider Name=&quot;Infor ES&quot; /&gt;<br />
    &lt;EventID Qualifiers=&quot;0&quot;&gt;1000&lt;/EventID&gt;<br />
    &lt;Level&gt;2&lt;/Level&gt;<br />
    &lt;Task&gt;16&lt;/Task&gt;<br />
    &lt;Keywords&gt;0x80000000000000&lt;/Keywords&gt;<br />
    &lt;TimeCreated SystemTime=&quot;2014-01-13T18:14:01.000000000Z&quot; /&gt;<br />
    &lt;EventRecordID&gt;2027180&lt;/EventRecordID&gt;<br />
    &lt;Channel&gt;Application&lt;/Channel&gt;<br />
    &lt;Computer&gt;svrapp34.oberg.com&lt;/Computer&gt;<br />
    &lt;Security UserID=&quot;S-1-5-21-329068152-706699826-1801674531-1561&quot; /&gt;<br />
  &lt;/System&gt;<br />
  &lt;EventData&gt;<br />
    &lt;Data&gt;Env	: baan4 (E:\Baan4\bse)<br />
Program	: bshell file \logic\mir\mir\bclm.c # 941<br />
Keyword	: bclmRequestLicense()<br />
User	: batchjob type:N language:2<br />
Process	: 5384<br />
Proc.Set	: batchjob@SVRAPP34:7412<br />
Lasterror	: 0<br />
Errno	: 0<br />
BdbErrno	: 0<br />
ExtraInfo	: session: &quot;ottstpstdlib &quot;;object: &quot;ottstpstdlib&quot;; function: &quot;&amp;lt;1&amp;gt;&quot; bclm.requestlicense; company number: 0<br />
Message	: Request licence failed: 'out of licenses for product'<br />
&lt;/Data&gt;<br />
  &lt;/EventData&gt;<br />
&lt;/Event&gt;<br />
<br />
<br />
I have tried several variations of queries to try to extract:<br />
<br />
&lt;QueryList&gt;<br />
  &lt;Query Id=&quot;0&quot; Path=&quot;Application&quot;&gt;<br />
    &lt;Select Path=&quot;Application&quot;&gt;*[EventData[Data and Data='out of licenses for product']]&lt;/Select&gt;<br />
  &lt;/Query&gt;<br />
&lt;/QueryList&gt;<br />
<br />
<br />
I've read a few posts on other 'non-Baan' forums on writing queries for Event Viewer, but their events seem to have some tags which they use to refine queries that the Infor/Baan events lack.  Any assistance would be appreciated.<br />
<br />
Thank you!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bhushanchanda</div><div class="date">15th January 2014, 20:40</div></div><div class="posttext">Hi,<br />
<br />
This is a VB script which gives you event log file from &quot;Security&quot; log with some Event ID: 5038.<br />
<br />
Just edit and make some changes according to your requirement. It gives you a log file.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">GaryEd</div><div class="date">16th January 2014, 17:06</div></div><div class="posttext">I had played around with something similar using powershell.</div></div><hr />



</div>
</body>
</html>