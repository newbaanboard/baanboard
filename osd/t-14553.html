<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="Stored procedures / MSSQL 2000 error, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] Stored procedures / MSSQL 2000 error Operating Systems &amp; Databases" />
	
	<title>Stored procedures / MSSQL 2000 error [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="../index.html">Newbaanboard</a> &gt; <a href="../index.html">Baan Quick Support: Functional &amp; Technical</a> &gt; <a href="../index.html">Operating Systems &amp; Databases</a> &gt; Stored procedures / MSSQL 2000 error</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">andrew.page</div><div class="date">21st February 2004, 12:12</div></div><div class="posttext">Since re-installing our BaaN server I can no longer have stored procedures switched on.<br />
<br />
There is a setting in %BSE%\lib\defaults\db_resource:<br />
msql_use_sp:0<br />
<br />
Which disables stored procedures which I have set to work around the problem.<br />
<br />
However if I remove this setting then I get the following 4 errors in the event log <br />
Event Type:	Error<br />
Event Source:	Baan<br />
Event Category:	Msql7_srv <br />
Event ID:	1000<br />
Date:		2/21/2004<br />
Time:		10:57:19 AM<br />
User:		ESHQBAN01\baan<br />
Computer:	ESHQBAN01<br />
Description:<br />
Env	 Baan (D:\Baan)<br />
Prog	 msql7_srv file \db\servers\MSQL\msql_odbc.c # 325<br />
Keyword	 MSQL Error<br />
Username	 baan	type S	language 2<br />
Process	 0x8e8<br />
Lasterror	 997 (Overlapped I/O operation is in progress.)<br />
Errno	 0<br />
bdberrno	 0<br />
Message	 <br />
dbs_errno = 510 Error 510 occurred:  <br />
Cannot open new ODBC connection for session bshell(main) <br />
Flushed at \db\servers\MSQL\msql_odbc.c : #326.<br />
 <br />
when trying to log into BaaN.<br />
<br />
Event Type:	Error<br />
Event Source:	Baan<br />
Event Category:	Msql7_srv <br />
Event ID:	1000<br />
Date:		2/21/2004<br />
Time:		10:57:19 AM<br />
User:		ESHQBAN01\baan<br />
Computer:	ESHQBAN01<br />
Description:<br />
Env	 Baan (D:\Baan)<br />
Prog	 msql7_srv file \db\servers\MSQL\msql_error.c # 573<br />
Keyword	 MSQL Messages<br />
Username	 baan	type S	language 2<br />
Process	 0x8e8<br />
Lasterror	 0<br />
Errno	 0<br />
bdberrno	 0<br />
Message	 <br />
dbs_errno = 510 Error 510 occurred:  <br />
Error sqlcode 18456 (sqlstate: 28000, Return code: -1, diagRecNum: 1) during SQLConnect.<br />
[Microsoft][ODBC SQL Server Driver][SQL Server]Login failed for user 'baandb'. <br />
Flushed at \db\servers\MSQL\msql_error.c : #578.<br />
 <br />
and<br />
<br />
Event Type:	Error<br />
Event Source:	Baan<br />
Event Category:	Msql7_srv <br />
Event ID:	1000<br />
Date:		2/21/2004<br />
Time:		10:57:19 AM<br />
User:		ESHQBAN01\baan<br />
Computer:	ESHQBAN01<br />
Description:<br />
Env	 Baan (D:\Baan)<br />
Prog	 msql7_srv file \db\servers\MSQL\msql_error.c # 619<br />
Keyword	 Suggestion<br />
Username	 baan	type S	language 2<br />
Process	 0x8e8<br />
Lasterror	 0<br />
Errno	 0<br />
bdberrno	 0<br />
Message	 <br />
dbs_errno = 510 Error 510 occurred:  <br />
Check MSQL_INSTANCE='eshqban01'.<br />
Check MSQL_SERVERHOST. <br />
Flushed at \db\servers\MSQL\msql_error.c : #624.<br />
 <br />
and <br />
<br />
Event Type:	Error<br />
Event Source:	Baan<br />
Event Category:	Msql7_srv <br />
Event ID:	1000<br />
Date:		2/21/2004<br />
Time:		10:57:19 AM<br />
User:		ESHQBAN01\baan<br />
Computer:	ESHQBAN01<br />
Description:<br />
Env	 Baan (D:\Baan)<br />
Prog	 msql7_srv file \db\servers\MSQL\msql_odbc.c # 325<br />
Keyword	 MSQL Error<br />
Username	 baan	type S	language 2<br />
Process	 0x8e8<br />
Lasterror	 997 (Overlapped I/O operation is in progress.)<br />
Errno	 0<br />
bdberrno	 0<br />
Message	 <br />
dbs_errno = 510 Error 510 occurred:  <br />
Cannot open new ODBC connection for session bshell(main) <br />
Flushed at \db\servers\MSQL\msql_odbc.c : #326.<br />
 <br />
and <br />
<br />
Event Type:	Error<br />
Event Source:	Baan<br />
Event Category:	Msql7_srv <br />
Event ID:	1000<br />
Date:		2/21/2004<br />
Time:		10:57:19 AM<br />
User:		ESHQBAN01\baan<br />
Computer:	ESHQBAN01<br />
Description:<br />
Env	 Baan (D:\Baan)<br />
Prog	 msql7_srv file \db\servers\MSQL\msql_table.c # 359<br />
Keyword	 MSQL Error<br />
Username	 baan	type S	language 2<br />
Process	 0x8e8<br />
Lasterror	 183 (Cannot create a file when that file already exists.)<br />
Errno	 0<br />
bdberrno	 0<br />
Message	 <br />
dbs_errno = 510 Error 850 occurred:  <br />
Executing Create Procedure failed.<br />
See fatal SQL statement in 'D:/Baan/log/log.msql.mesg'.<br />
Create Procedure failed for table 'dbo.tttadv450000'.<br />
Driver reconfigured to prevent use of SPs! <br />
Flushed at \db\servers\MSQL\msql_row.c : #264.<br />
 <br />
Any ideas?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Olaf vd Sanden</div><div class="date">22nd February 2006, 09:32</div></div><div class="posttext">Hi Andrew,<br />
<br />
Did you get any answer on your problem?<br />
Bye Olaf</div></div><hr />


<div class="post"><div class="posttop"><div class="username">andrew.page</div><div class="date">22nd February 2006, 10:02</div></div><div class="posttext">The problem was caused by the fact that baandb was not the database owner of the baandb database.<br />
<br />
Ultimately it was solved with this SQL statement<br />
<br />
USE baandb<br />
GO<br />
EXEC sp_changedbowner 'baandb'<br />
GO</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pokitlok</div><div class="date">9th May 2007, 06:28</div></div><div class="posttext">Recently I came across the same problem and found it is because BaaN application server cannot log in MS SQL database via BaaN User Group account (usually, as baandb in BaaN Doc). As creating stored proc and table, BaaN makes use of the BaaN User Group account to complete database works. Thus, the resolution is as below:<br />
<br />
1. On MS SQL server, create database login, e.g. baandb, on local and other database instance with same password<br />
2. Create user account for login baandb in BaaN's database and grant the user account the rights of [dbowner].<br />
3. Login BaaN client with superuser and open session Maintain Database Groups (ttdba0120m000)<br />
4. Add Database User Group &quot;baandb&quot; and set Create Group as &quot;Externally&quot;<br />
5. Click [Create and Dump] and input database administrator and password to confirm<br />
6. Repeat Step 5 under each company code<br />
<br />
Please note the names of MS SQL login, database user and database are same, i.e. baandb.<br />
:rolleyes:</div></div><hr />



</div>
</body>
</html>