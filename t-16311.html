<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="Code : use gbf browser to display bom, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] Code : use gbf browser to display bom Code &amp; Utilities" />
	
	<title>Code : use gbf browser to display bom [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="index.html">Newbaanboard</a> &gt; <a href="index.html">Baan SIGs</a> &gt; <a href="index.html">Code &amp; Utilities</a> &gt; Code : use gbf browser to display bom</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">pconde</div><div class="date">18th August 2004, 13:04</div></div><div class="posttext">This is a short example using the gbf function of tgbrgsrvlib. This display the bom of an item (standard or specific) in the browser. each manufactured item by dubble cliking it  display its component.<br />
<br />
The form contains only two field project code (cprj.f) and the item code (mitm.f)<br />
<br />
You must create a library ($BSE/gif/bom) and set therein the icon that you want to use (see function init_data_gbf)<br />
<br />
Two librairies must be included in this script : tggbfsrvlib and tgcomlogging<br />
<br />
Developped with baanIV c4 SP7<br />
<br />
I have attached a zip file with the icon that i have created<br />
<br />
<br />
|******************************************************************************<br />
|* spbom0719  0  VRC B40O c4 expl<br />
|* Impression graphique Nomenclatures spécifiques<br />
|* Philippe Condé                <br />
|* 2004-08-16<br />
|******************************************************************************<br />
|* Main table tipcs022 Nomenclatures spécifiques, Form Type 4<br />
|******************************************************************************<br />
|* License	:<br />
|* Copyright 2001 by &lt;Philippe Conde&gt;<br />
|* <br />
|* All Rights Reserved <br />
|* <br />
|* Permission to use, copy, modify, and distribute this software and its<br />
|* documentation for any purpose and without fee is hereby granted,<br />
|* provided that the above copyright notice appear in all copies and that<br />
|* both that copyright notice and this permission notice appear in<br />
|* supporting documentation. <br />
|* <br />
|* Philippe Conde and Baanboard.com DISCLAIM ALL WARRANTIES WITH REGARD TO THIS<br />
|* SOFTWARE, INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY<br />
|* AND FITNESS, IN NO EVENT SHALL &lt;author&gt; nor Baanboard.com BE LIABLE FOR ANY<br />
|* SPECIAL, INDIRECT OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES <br />
|* WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, <br />
|* WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER <br />
|* TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE<br />
|* OR PERFORMANCE OF THIS SOFTWARE.<br />
|*                                                                               <br />
|****************************** declaration section ***************************<br />
declaration:<br />
<br />
	table	ttipcs022	|* Nomenclatures spécifiques<br />
	table	ttcmcs003	|* Magasins<br />
	table	ttibom010	|* Nomenclatures de fabrication<br />
	table	ttiitm001	|* Articles<br />
	table	ttipcs021	|* Articles spécifiques<br />
	<br />
	#include &quot;itggbfdefs&quot; 	|* <br />
	#include &quot;itgcomlogging&quot; 	|* <br />
<br />
<br />
		long		rc<br />
	extern	domain	tcyesno       	txta.yn<br />
		domain	tcmcs.str60	gbf_key<br />
		domain	tcmcs.str60	gbf_desc<br />
		domain	tcmcs.str60	head_key<br />
		domain	tcdate		mydate<br />
	extern	domain	tccprj        	cprj.f	fixed<br />
	extern	domain	tcitem        	mitm.f	fixed<br />
		long		int.iconset1<br />
		long		int.iconset2<br />
		long		leaf.iconset1<br />
		long		leaf.iconset2<br />
<br />
|****************************** form section **********************************<br />
<br />
form.1:<br />
init.form:<br />
	mydate = date.num()<br />
	get.screen.defaults()<br />
<br />
|****************************** choice section ********************************<br />
<br />
choice.cont.process:<br />
on.choice:<br />
	read.main.table()<br />
<br />
<br />
|****************************** field section *********************************<br />
field.mitm.f:<br />
check.input:<br />
	if isspace(cprj.f) then<br />
		select tiitm001.* from tiitm001<br />
		where tiitm001._index1 = {:mitm.f}<br />
		as set with 1 rows<br />
		selectdo		<br />
		   if tiitm001.kitm &lt;&gt; tckitm.manufacture then<br />
		   	set.input.error(&quot;spbom07191&quot;)<br />
		   	|* Article non fabriqué<br />
		   endif<br />
		selectempty<br />
			set.input.error(&quot;spbom07192&quot;)<br />
			|* Article inconnu<br />
		endselect<br />
	else<br />
		select tipcs021.* from tipcs021<br />
		where tipcs021._index1={:cprj.f, :mitm.f}<br />
		as set with 1 rows<br />
		selectdo		<br />
		   if tipcs021.kitm &lt;&gt; tcpuma.manufacture then<br />
		   	set.input.error(&quot;spbom07191&quot;)<br />
		   	|* Article non fabriqué<br />
		   endif<br />
		selectempty<br />
			set.input.error(&quot;spbom07192&quot;)<br />
			|* Article inconnu<br />
		endselect<br />
	endif	<br />
			<br />
|****************************** function section ******************************<br />
<br />
functions:<br />
<br />
function read.main.table()<br />
{<br />
	rc = init_data_gbf()<br />
	<br />
}<br />
<br />
<br />
function long read.pcs022( domain tccprj mycprj, domain tcitem myitem, domain tcmcs.str3 level )<br />
{<br />
	select	tipcs022.* from	tipcs022<br />
	where   tipcs022._index1 = {:mycprj, :myitem}<br />
	order by tipcs022._index1<br />
	selectdo<br />
		gbf_key(1;3) = edit$(tipcs022.pono,&quot;999&quot;)<br />
		gbf_key(10;16) = tipcs022.sitm(1;16)<br />
		gbf_key(4;6) = &quot;      &quot;<br />
		gbf_desc(1;3)=edit$(tipcs022.pono,&quot;999&quot;)<br />
		gbf_desc(4;1) = &quot; &quot;<br />
		gbf_desc(5;6)=&quot;      &quot;<br />
		gbf_desc(11;2) = &quot;  &quot;<br />
		gbf_desc(13;16)=tipcs022.sitm(1;16)<br />
		gbf_desc(29;2)=&quot;  &quot;<br />
	        if tipcs022.opol = tcittb.customized then<br />
			gbf_desc(5;6) = tipcs022.cprj(1;6)<br />
			gbf_key(4;6) = tipcs022.cprj(1;6)<br />
			select tipcs021.* from tipcs021<br />
			where tipcs021._index1 = {:mycprj, :tipcs022.sitm}<br />
			as set with 1 rows<br />
			selectdo<br />
				gbf_desc(31;30)=tipcs021.dsca(1;30)<br />
				if tipcs021.kitm = tcpuma.manufacture then<br />
					rc = gbf.add.interior(gbf_key, gbf_desc, 0)  |node<br />
				else<br />
					rc = gbf.add.object(gbf_key, gbf_desc, 1, true, leaf.iconset2) |leaf<br />
				endif<br />
			endselect	<br />
	        else<br />
	        	select tiitm001.* from tiitm001<br />
	        	where tiitm001._index1= {:tipcs022.sitm}<br />
	        	as set with 1 rows<br />
	        	selectdo<br />
	        		gbf_desc(31;30) = tiitm001.dsca(1;30)<br />
	        		if tiitm001.kitm = tckitm.manufacture then<br />
					rc = gbf.add.object(gbf_key, gbf_desc, 1, false, int.iconset2) | node<br />
	        		else<br />
					rc = gbf.add.leaf(gbf_key, gbf_desc, 0)  | leaf<br />
				endif<br />
			endselect<br />
	        endif<br />
	endselect<br />
	return(0)<br />
}<br />
function long read.bom010(domain tcitem myitem, domain tcmcs.str3 level)<br />
{<br />
	select	tibom010.*<br />
	from	tibom010<br />
	where   tibom010._index1 inrange {:myitem, 0}<br />
	                             and {:myitem, 999}<br />
	and (tibom010.exdt = 0 or<br />
	     tibom010.exdt &gt; :mydate ) <br />
	order by tibom010._index1<br />
	selectdo<br />
		gbf_key(1;3) = edit$(tibom010.pono,&quot;999&quot;)<br />
		gbf_key(4;6) = &quot;      &quot;<br />
		gbf_key(10;16) = tibom010.sitm(1;16)<br />
		gbf_desc(1;3)=edit$(tibom010.pono,&quot;999&quot;)<br />
		gbf_desc(4;1) = &quot; &quot;<br />
		gbf_desc(5;6)=&quot;      &quot;<br />
		gbf_desc(11;2) = &quot;  &quot;<br />
		gbf_desc(13;16)=tibom010.sitm(1;16)<br />
		gbf_desc(29;2)=&quot;  &quot;<br />
	        select tiitm001.* from tiitm001<br />
	        where tiitm001._index1 = {:tibom010.sitm}<br />
	        as set with 1 rows<br />
	    	selectdo<br />
	        	gbf_desc(31;30) = tiitm001.dsca(1;30)<br />
	    		if tiitm001.kitm = tckitm.manufacture then<br />
				rc = gbf.add.object(gbf_key, gbf_desc, 1, false, int.iconset2) |node<br />
	    		else<br />
				rc = gbf.add.leaf(gbf_key, gbf_desc,  0)  | leaf<br />
	    		endif<br />
	        endselect<br />
	endselect<br />
	return(0)<br />
}<br />
function extern long init_data_gbf()<br />
{<br />
<br />
	long	def.options<br />
	long	ret_start<br />
	long	retval<br />
<br />
<br />
	<br />
	head_key(1;6) = cprj.f(1;6)<br />
	head_key(8;16) = mitm.f(1;16)<br />
	retval = gbf.init(gbf.current.library(), head_key,<br />
			bit.or(GBF.MENU.ALL  , GBF.MENU.FILE.OPEN),<br />
			bit.or(GBF.BUTTON.ALL, GBF.BUTTON.FILE.QUIT),<br />
			def.options)<br />
	LogExecErrorReturn(retval, &quot;gbf.init()&quot;)<br />
<br />
	int.iconset1 = gbf.set.interior.icon( &quot;bom&quot;,<br />
				&quot;specm.normal&quot;,		|unselected.closed<br />
				&quot;specm.open&quot;,		|unselected.open<br />
				&quot;specm.closed&quot;,		|selected.closed<br />
				&quot;specm.open&quot;,		|selected.open<br />
				true )			|Défault<br />
	int.iconset2 = gbf.set.interior.icon( &quot;bom&quot;,<br />
				&quot;standm.normal&quot;,	|unselected.closed<br />
				&quot;standm.normal&quot;,	|unselected.open<br />
				&quot;standm.select&quot;,	|selected.closed<br />
				&quot;standm.select&quot;,	|selected.open<br />
				false )<br />
	leaf.iconset1 = gbf.set.leaf.icon( &quot;bom&quot;,<br />
			 &quot;purs.normal&quot;,<br />
			 &quot;purs.select&quot;,<br />
			 TRUE)<br />
	leaf.iconset2 = gbf.set.leaf.icon( &quot;bom&quot;,<br />
			 &quot;pursp.normal&quot;,<br />
			 &quot;pursp.select&quot;,<br />
			 false)<br />
			 <br />
<br />
	retval = gbf.set.key.desc.length(60, 30)<br />
	LogExecErrorReturn(retval, &quot;gbf.set.key.desc.length(%d, %d)&quot;,<br />
				60, 30)<br />
<br />
	retval =  gbf.set.sort.strategy(  GBF.SORT.DESC<br />
					+ GBF.SORT.ASCENDING<br />
					+ GBF.SORT.INSENSITIVE)<br />
	LogExecError(retval, &quot;gbf.set.sort.strategy()&quot;)<br />
<br />
	retval =  gbf.set.open.strategy(  GBF.OPEN.AGAIN<br />
					+ GBF.OPEN.CURSEL<br />
					+ GBF.OPEN.READALL)<br />
	LogExecError(retval, &quot;gbf.set.open.strategy()&quot;)<br />
<br />
	ret_start = gbf.start(1, 1) <br />
	<br />
	return (0)<br />
}<br />
<br />
<br />
function long find.bom(const string key.c())<br />
{<br />
	long	retval<br />
	domain	tcitem	item.c<br />
	domain	tccprj	cprj.c<br />
	domain   tcmcs.str3	level<br />
<br />
<br />
	level(1;3) = key.c(1;3)<br />
	cprj.c = key.c(4;6)<br />
	item.c = key.c(10;16)<br />
	if isspace(cprj.c) then<br />
		retval = read.bom010(item.c,level)<br />
	else<br />
		retval = read.pcs022(cprj.c,item.c, level)<br />
	endif<br />
	<br />
	return (0)<br />
}<br />
<br />
function extern long gbf.get.top.level()<br />
{<br />
	head_key(1;3) = &quot;   &quot;<br />
	head_key(4;6) = cprj.f(1;6)<br />
	head_key(10;16) = mitm.f(1;16)<br />
	return (find.bom(head_key))<br />
}<br />
<br />
function extern long gbf.get.children(const string key(),<br />
					long value,<br />
					long level)<br />
{<br />
	return (find.bom(key))<br />
}<br />
<br />
function extern long gbf.save(<br />
	const	long	object.id,<br />
	const	string	object.key(),<br />
	const	long	object.value,<br />
	const	long	menu.value)<br />
{<br />
| Doesn't need save already in tables :-)<br />
	return (0)<br />
}</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pconde</div><div class="date">30th September 2004, 16:31</div></div><div class="posttext">Here an example of  a bom. (bmp file) and the zip file with the icons used</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Xikkos</div><div class="date">30th September 2004, 21:29</div></div><div class="posttext">Hi,<br />
<br />
How can I read the files that are include in the file bsegif.zip ? For exemple the file &quot;Thumbs.db&quot;.<br />
<br />
<br />
Xikkos.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pconde</div><div class="date">1st October 2004, 15:49</div></div><div class="posttext">Hello,<br />
<br />
you can edit them with baan (session ttdsk6200m000) or copy them to windows and use paint<br />
<br />
Regards<br />
Philippe</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jroberts</div><div class="date">6th October 2004, 16:52</div></div><div class="posttext">Thanks so much for this post,<br />
<br />
Our Engineering Staff have been asking for a tool like this for a long time, and I had no idea of how to meet their requirement.<br />
<br />
I am deploying it today, and early feedback says that this will be a very valuable tool for us.<br />
<br />
Thank you for sharing your knowledge, and for helping me to solve a very real problem in an elegant fashion.<br />
<br />
John.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Juergen</div><div class="date">7th October 2004, 16:12</div></div><div class="posttext">Hello Philippe,<br />
<br />
respect for this nice and very useful code!<br />
<br />
Thanks for your posting,<br />
Juergen</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Juergen</div><div class="date">11th October 2004, 13:03</div></div><div class="posttext">Hello Philippe,<br />
<br />
do you have any idea why on our system the item descriptions will not be displayed?<br />
<br />
I have checked it with the debugger. The field gbf_desc is filled correctly with the descriptions, but only the first 30 characters for field gbf_desc will be displayed (the description starts at position 31).<br />
<br />
Thanks in advance,<br />
Juergen</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pconde</div><div class="date">11th October 2004, 14:49</div></div><div class="posttext">Hello,<br />
<br />
I checked my code, (i have do some update therein since the initial post) I think that the problem is is the routine  init_data_gbf.<br />
<br />
here is the correct code<br />
<br />
	retval = gbf.set.key.desc.length(60, 60)<br />
	LogExecErrorReturn(retval, &quot;gbf.set.key.desc.length(%d, %d)&quot;,<br />
				60, 60)<br />
<br />
Regards<br />
Philippe Conde</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Juergen</div><div class="date">11th October 2004, 15:14</div></div><div class="posttext">problem solved!<br />
<br />
thanks for your quick respone.<br />
Regards,<br />
Juergen</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mr_suleyman</div><div class="date">8th September 2006, 09:31</div></div><div class="posttext">Hi Dear Friends,<br />
We use Baan IV C3 and I couldn't find those include files. How can I get them ? and <br />
Does it works for c3 version. <br />
<br />
Thanks...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pconde</div><div class="date">18th September 2006, 14:40</div></div><div class="posttext">Hello,<br />
<br />
On my system (BIV c4) the 2 includes are also present in BIV c1, so I think that it should wotk in c3. The include files can be asked to SSA support.<br />
<br />
Regards<br />
Philippe</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mr_suleyman</div><div class="date">18th September 2006, 15:45</div></div><div class="posttext">Thanks I solved the problem . Only How can I print GBF ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pconde</div><div class="date">18th September 2006, 17:15</div></div><div class="posttext">Print GBF.  Good question! tggbfsrvlib doesn't include a print function. But I think that it should be possible because in the DEM they print something that like to a gbf tree.<br />
<br />
Maybe a bic_info6.1 on all libraries in tgeis or tgbrg could give info?<br />
<br />
Regards<br />
Philippe</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bdittmar</div><div class="date">22nd September 2006, 17:20</div></div><div class="posttext">Print GBF.  Good question! tggbfsrvlib doesn't include a print function. But I think that it should be possible because in the DEM they print something that like to a gbf tree.<br />
<br />
Maybe a bic_info6.1 on all libraries in tgeis or tgbrg could give info?<br />
<br />
Regards<br />
Philippe<br />
<br />
Hello,<br />
<br />
it's posible to print the gbf tree as pure ascii tree.<br />
<br />
Regards</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mr_suleyman</div><div class="date">22nd September 2006, 17:55</div></div><div class="posttext">I couldn't find this object (Baan IV c3) . I search my sistem I got only followings files.<br />
$ <br />
/baan/bse/lib/printinf<br />
/baan/bse/application/tgB40_c1/otgbrg/obrggprint<br />
/baan/bse/application/tgB40_c1/otgbrg/obrgprint<br />
/baan/bse/application/tgB40U_c4_stnd/otgbrg/obrggprint<br />
/baan/bse/application/tgB40_c3/otgbrg/obrggprint<br />
/baan/bse/application/tgB40U_c3_stnd/otgbrg/obrgprint<br />
/baan/bse/application/tgB40U_c3_stnd/otgbrg/obrggprint<br />
/baan/bse/application/tgB40_c4/otgbrg/obrggprint<br />
/baan/bse/application/tgB40_c4/otgbrg/obrgprint<br />
/baan/bse/tools/ttB40_c4/ottstp/ostpprofprint<br />
/baan/bse/tools/ttB40_c4/ottdll/odllprintscr<br />
/baan/bse/include6.1/bic_gprint<br />
/baan/bse/include6.1/bic_gprinth<br />
/baan/bse/include6.1/bic_print<br />
/baan/bse/tools_220404/ttB40_c4/ottstp/ostpprofprint<br />
/baan/bse/tools_220404/ttB40_c4/ottdll/odllprintscr<br />
/baan/bse/include6.1_220404/bic_gprint<br />
/baan/bse/include6.1_220404/bic_gprinth<br />
/baan/bse/include6.1_220404/bic_print<br />
<br />
That is all.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bdittmar</div><div class="date">23rd September 2006, 16:13</div></div><div class="posttext">I couldn't find this object (Baan IV c3) . I search my sistem I got only followings files.<br />
<br />
<br />
That is all.<br />
<br />
<br />
Hello,<br />
<br />
look at this thread.<br />
<br />
http://www.baanboard.com/baanboard/showthread.php?t=28160<br />
<br />
It's my own DLL, so can't find it in your system.<br />
<br />
Regards</div></div><hr />


<div class="post"><div class="posttop"><div class="username">skorc123</div><div class="date">20th November 2006, 14:42</div></div><div class="posttext">what seems to be the problem?<br />
<br />
see attachement<br />
<br />
thank you for your reply, Zoran</div></div><hr />


<div class="post"><div class="posttop"><div class="username">skorc123</div><div class="date">20th November 2006, 15:51</div></div><div class="posttext">never mind, got it working.<br />
<br />
Thank you for the code.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">skorc123</div><div class="date">21st November 2006, 14:54</div></div><div class="posttext">Hi, loved your post on gbf for BOM.<br />
<br />
Could you tell me how can I make my top level item (the search item) to be the first node. See attachement.<br />
<br />
item 229285 to become top node<br />
<br />
Thank you</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bdittmar</div><div class="date">21st November 2006, 18:32</div></div><div class="posttext">Hi, loved your post on gbf for BOM.<br />
<br />
Could you tell me how can I make my top level item (the search item) to be the first node. See attachement.<br />
<br />
item 229285 to become top node<br />
<br />
Thank you<br />
<br />
Hello,<br />
do you have function for top level ?<br />
<br />
function extern long gbf.get.top.level()<br />
{<br />
	long act.set<br />
   string gbf.desc.tl(100)<br />
<br />
   gbf.desc.tl = &quot;&quot;<br />
   act.set = int.iconset2<br />
<br />
   head_key(1;3) = &quot;   &quot;<br />
	head_key(4;6) = cprj.f(1;6)<br />
	head_key(10;16) = mitm.f(1;16)<br />
   if isspace(cprj.f) then<br />
      act.set = int.iconset1<br />
   endif<br />
   if not isspace(cprj.f) then<br />
      select   tipcs021.*<br />
      from     tipcs021<br />
      where    tipcs021._index1 = {:cprj.f, :mitm.f}<br />
      selectdo<br />
      endselect<br />
      gbf.desc.tl(5)= ADJUST.ITEM(tipcs021.item,tipcs021.cprj)&amp;&quot;-&quot;&amp;strip$(shiftl$(tipcs021.dsca)) &amp; &quot;-&quot; &amp;<br />
                         strip$(edit$(tipcs021.unom,&quot;ZZ9VD9999&quot;)) &amp; &quot; &quot; &amp; tipcs021.cuni<br />
   else<br />
      select   tiitm001.*<br />
      from     tiitm001<br />
      where    tiitm001._index1 = {:mitm.f}<br />
      selectdo<br />
      endselect<br />
      gbf.desc.tl(4)= ADJUST.ITEM(tiitm001.item)&amp;&quot;-&quot;&amp;strip$(shiftl$(tiitm001.dsca))&amp;&quot;-&quot;&amp;edit$(tiitm001.unom,&quot;ZZ9VD9999&quot;) &amp;<br />
                                        &quot; &quot; &amp; tiitm001.cuni<br />
   endif<br />
<br />
   rc = gbf.add.object(head_key,<br />
                       strip$(shiftl$(gbf.desc.tl)),<br />
                       1,<br />
                       false,<br />
                       act.set,<br />
                       0,<br />
                       0,<br />
                       0,<br />
                       0,<br />
                       rgb.black)<br />
	return(0)<br />
}<br />
<br />
Regards</div></div><hr />


<div class="post"><div class="posttop"><div class="username">skorc123</div><div class="date">22nd November 2006, 13:54</div></div><div class="posttext">Thanks, did it, had top level, just didn't write the way it should be.<br />
<br />
Can anyone tell me if there is a way to perform any action/function/session after doubleclicking leaf in tree structure, i've debugged it but nothing seems to happen after double-clickind the leaf.<br />
<br />
Thank you</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bdittmar</div><div class="date">22nd November 2006, 15:04</div></div><div class="posttext">Thanks, did it, had top level, just didn't write the way it should be.<br />
<br />
Can anyone tell me if there is a way to perform any action/function/session after doubleclicking leaf in tree structure, i've debugged it but nothing seems to happen after double-clickind the leaf.<br />
<br />
Thank you<br />
<br />
<br />
Hello,<br />
yes it is possible with logic in :<br />
<br />
function extern long gbf.menu.selected( long obj.id, const string object.key(), long object.value, long menu.option)<br />
<br />
for example .<br />
<br />
            zoom.to$(&quot;dhitm0501m001&quot;,z.session,prog.name$,&quot;&quot;,0)<br />
            #pragma used session dhitm0501m001<br />
<br />
I've added some screendumps, to show what is posible !<br />
<br />
Regards</div></div><hr />


<div class="post"><div class="posttop"><div class="username">skorc123</div><div class="date">23rd November 2006, 11:19</div></div><div class="posttext">Hey bditmar,<br />
<br />
if posible could you post code where you define custom buttons and assign icons to it and how you call various functions.<br />
<br />
entire code would be better.<br />
<br />
I am new to Baan, only month and a half and therefor I am still having troubles with it. i am doing my best :)<br />
<br />
I appologies if I went too far with the request about posting entire code.<br />
You can mail it to zoran.skorc@email.si if preferable.<br />
<br />
Thank you, Zoran</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bdittmar</div><div class="date">23rd November 2006, 20:17</div></div><div class="posttext">Hey bditmar,<br />
<br />
if posible could you post code where you define custom buttons and assign icons to it and how you call various functions.<br />
<br />
entire code would be better.<br />
<br />
I am new to Baan, only month and a half and therefor I am still having troubles with it. i am doing my best :)<br />
<br />
I appologies if I went too far with the request about posting entire code.<br />
You can mail it to zoran.skorc@email.si if preferable.<br />
<br />
Thank you, Zoran<br />
<br />
Hello Zoran,<br />
<br />
after 6 weeks in BaaN - Tools such a project ?<br />
The shown possible functions are built in an own Module.<br />
My employer is owner of the code, so i'm able to give you some ideas for your own concept, but not the entire code, functions, graphics a.s.o.<br />
<br />
Regards</div></div><hr />


<div class="post"><div class="posttop"><div class="username">skorc123</div><div class="date">24th November 2006, 10:45</div></div><div class="posttext">You all already did a lot, thank you for all your replays and posts.<br />
I learned so much from you guys in this month and a half.<br />
<br />
Have a nice day bdittmar and thanks again for your help<br />
<br />
Regards, Zoran</div></div><hr />


<div class="post"><div class="posttop"><div class="username">skorc123</div><div class="date">24th November 2006, 10:48</div></div><div class="posttext">Hello Zoran,<br />
<br />
after 6 weeks in BaaN - Tools such a project ?<br />
The shown possible functions are built in an own Module.<br />
My employer is owner of the code, so i'm able to give you some ideas for your own concept, but not the entire code, functions, graphics a.s.o.<br />
<br />
Regards<br />
<br />
I have been working as a developer for a company that developed its own ERP (VisualStudio, Borland), it's just that Baan is a little diffrent and i have to get used to it.<br />
Besides the bigger the challenge the better<br />
<br />
Regards</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mr_suleyman</div><div class="date">24th November 2006, 13:14</div></div><div class="posttext">If you evaluate the source of GBF, it is really enough for your other wishes.<br />
And you should have little baan programming logic.<br />
<br />
Good luck !</div></div><hr />


<div class="post"><div class="posttop"><div class="username">solepeder</div><div class="date">27th November 2006, 19:50</div></div><div class="posttext">I think the problem is that the libraries tggbfsvrlib and tgcomlogging weren't added to the script.<br />
Try adding these libraries.<br />
<br />
Good Luck..<br />
<br />
Soledad</div></div><hr />


<div class="post"><div class="posttop"><div class="username">solepeder</div><div class="date">27th November 2006, 20:00</div></div><div class="posttext">I think the problem is that the libraries tggbfsvrlib and tgcomlogging weren't added to the script.<br />
Try adding these libraries.<br />
<br />
Good Luck..<br />
<br />
Soledad<br />
<br />
Sorry, I didin't see the rest of the messages... I wanted to answer to:<br />
skorc123 what seems to be the problem?<br />
<br />
see attachement<br />
<br />
thank you for your reply, Zoran</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Fridolin</div><div class="date">14th April 2008, 16:14</div></div><div class="posttext">Hello,<br />
<br />
Im just checking out the example of the tree object provided by pconde.<br />
<br />
As compilation I receive always the error message indicating that the librairies tggbfsrvlib and tgcomlogging are not found.<br />
<br />
I suggest that this librairies are not on my Baan IVc system!<br />
<br />
What have I to do to install this livrairies on my system?<br />
<br />
Regards<br />
<br />
Fridolin</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pconde</div><div class="date">14th April 2008, 17:40</div></div><div class="posttext">Hi,<br />
<br />
In the script use option libraries to maintain the libraries that the compilation process must use<br />
<br />
Regards<br />
Philippe</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bdittmar</div><div class="date">15th April 2008, 14:43</div></div><div class="posttext">Hello,<br />
<br />
Im just checking out the example of the tree object provided by pconde.<br />
<br />
As compilation I receive always the error message indicating that the librairies tggbfsrvlib and tgcomlogging are not found.<br />
<br />
I suggest that this librairies are not on my Baan IVc system!<br />
<br />
What have I to do to install this livrairies on my system?<br />
<br />
Regards<br />
<br />
Fridolin<br />
<br />
Hello Fridolin,<br />
<br />
tggbfsrvlib and tgcomlogging are standard libs from 1998, so i can not understand that these libs are not on your system ?<br />
<br />
Have a look at my attachment.<br />
<br />
Regards</div></div><hr />


<div class="post"><div class="posttop"><div class="username">moianix</div><div class="date">28th May 2008, 16:04</div></div><div class="posttext">Hi to all.<br />
<br />
i want to add other menu with functions ( i.e. run a baan prgram )<br />
in a GBF screen ( Baan IV c4 ).<br />
How can i do it ? <br />
<br />
Thx</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pconde</div><div class="date">29th May 2008, 12:28</div></div><div class="posttext">Hi here an example with function linked to menu<br />
See code marked PCE 2 and variable hwnd.func<br />
<br />
|******************************************************************************<br />
|* spbom0719  0  VRC B40O c4 expl<br />
|* Impression graphique Nomenclatures spécifiques<br />
|* Philippe Condé                <br />
|* 2004-08-16<br />
|<br />
|* PCE2, Philippe Conde<br />
|* add menu option and support dbl click on purchased item(=leaf)<br />
|<br />
|* PCE 3 Philippe Conde, 2004-10-07, B40O_c4_expl<br />
|* add dll for function done for leaf<br />
|<br />
|* PCE 4 Philippe Conde, 2004-11-16, B40O_c4_expl<br />
|* change dll for function add parameter type from screen<br />
|<br />
|******************************************************************************<br />
|* Main table tipcs022 Nomenclatures spécifiques, Form Type 4<br />
|******************************************************************************<br />
|* License	:<br />
|* Copyright 2001 by &lt;Philippe Conde&gt;<br />
|* <br />
|* All Rights Reserved <br />
|* <br />
|* Permission to use, copy, modify, and distribute this software and its<br />
|* documentation for any purpose and without fee is hereby granted,<br />
|* provided that the above copyright notice appear in all copies and that<br />
|* both that copyright notice and this permission notice appear in<br />
|* supporting documentation. <br />
|* <br />
|* Philippe Conde and Baanboard.com DISCLAIM ALL WARRANTIES WITH REGARD TO THIS<br />
|* SOFTWARE, INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY<br />
|* AND FITNESS, IN NO EVENT SHALL Philippe conde nor Baanboard.com BE LIABLE FOR ANY<br />
|* SPECIAL, INDIRECT OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES <br />
|* WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, <br />
|* WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER <br />
|* TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE<br />
|* OR PERFORMANCE OF THIS SOFTWARE.<br />
|*                                                                               <br />
|****************************** declaration section ***************************<br />
declaration:<br />
#ident &quot;PCE3, Philippe Conde, 2004-10-07, B40O_c4_expl&quot;<br />
<br />
	table	ttipcs022	|* Nomenclatures spécifiques<br />
	table	ttcmcs003	|* Magasins<br />
	table	ttibom010	|* Nomenclatures de fabrication<br />
	table	ttiitm001	|* Articles<br />
	table	ttipcs021	|* Articles spécifiques<br />
	table  	tttgfd400<br />
<br />
<br />
		long		rc<br />
	extern	domain	tcyesno       	txta.yn<br />
		domain	tcmcs.str40	gbf_key<br />
		domain	tcmcs.str80	gbf_desc<br />
		domain	tcmcs.str40	head_key<br />
		domain	tcdate		mydate<br />
	extern	domain	tccprj        	cprj.f	fixed<br />
	extern	domain	tcitem        	mitm.f	fixed<br />
	extern	domain	tcdsca		dsca.f	fixed<br />
	extern  domain	tcmcs.long	type.help<br />
		long		int.iconset1<br />
		long		int.iconset2<br />
		long		leaf.iconset1<br />
		long		leaf.iconset2<br />
		long		hwnd.func<br />
		long		menu.id<br />
	extern	domain	tccprj		zoom.cprj<br />
	extern	domain	tcitem		zoom.item<br />
		<br />
	#include &quot;itggbfdefs&quot; 	|* <br />
	#include &quot;itgcomlogging&quot; 	|* <br />
		<br />
		<br />
|****************************** form section **********************************<br />
<br />
form.1:<br />
init.form:<br />
	mydate = date.num()<br />
	get.screen.defaults()<br />
<br />
|****************************** choice section ********************************<br />
<br />
choice.cont.process:<br />
on.choice:<br />
	read.main.table()<br />
<br />
<br />
|****************************** field section *********************************<br />
field.mitm.f:<br />
check.input:<br />
	dsca.f = &quot;&quot;<br />
	if isspace(cprj.f) then<br />
		select tiitm001.* from tiitm001<br />
		where tiitm001._index1 = {:mitm.f}<br />
		as set with 1 rows<br />
		selectdo		<br />
		   if tiitm001.kitm &lt;&gt; tckitm.manufacture then<br />
		   	set.input.error(&quot;spbom07191&quot;)<br />
		   	|* Article non fabriqué<br />
		   else<br />
		   	dsca.f = tiitm001.dsca<br />
		   endif<br />
		selectempty<br />
			set.input.error(&quot;spbom07192&quot;)<br />
			|* Article inconnu<br />
		endselect<br />
	else<br />
		select tipcs021.* from tipcs021<br />
		where tipcs021._index1={:cprj.f, :mitm.f}<br />
		as set with 1 rows<br />
		selectdo		<br />
		   if tipcs021.kitm &lt;&gt; tcpuma.manufacture then<br />
		   	set.input.error(&quot;spbom07191&quot;)<br />
		   	|* Article non fabriqué<br />
		   else<br />
		   	dsca.f = tipcs021.dsca<br />
		   endif<br />
		selectempty<br />
			set.input.error(&quot;spbom07192&quot;)<br />
			|* Article inconnu<br />
		endselect<br />
	endif	<br />
	display(dsca.f)			<br />
<br />
before.zoom:<br />
	if isspace(cprj.f) then<br />
		attr.zoomsession$ =&quot;tiitm0502s000&quot;<br />
		attr.zoomreturn$ = &quot;tiitm001.item&quot;<br />
		zoom.item = mitm.f<br />
	else<br />
		attr.zoomsession$ = &quot;tipcs2522s000&quot;<br />
		attr.zoomreturn$ = &quot;tipcs021.item&quot;<br />
		tipcs021.cprj = cprj.f<br />
		zoom.cprj = cprj.f<br />
	endif<br />
	<br />
|****************************** function section ******************************<br />
<br />
functions:<br />
<br />
function read.main.table()<br />
{<br />
	rc = init_data_gbf()<br />
	<br />
}<br />
<br />
<br />
function long read.pcs022( domain tccprj mycprj, domain tcitem myitem )<br />
{<br />
	select	tipcs022.* from	tipcs022<br />
	where   tipcs022._index1 = {:mycprj, :myitem}<br />
	order by tipcs022._index1<br />
	selectdo<br />
		gbf_key(1;3) = edit$(tipcs022.pono,&quot;999&quot;)<br />
		gbf_key(10;16) = tipcs022.sitm(1;16)<br />
		gbf_key(4;6) = &quot;      &quot;<br />
		gbf_desc(1;3)=edit$(tipcs022.pono,&quot;999&quot;)<br />
		gbf_desc(4;1) = &quot; &quot;<br />
		gbf_desc(5;6)=&quot;      &quot;<br />
		gbf_desc(11;2) = &quot;  &quot;<br />
		gbf_desc(13;16)=tipcs022.sitm(1;16)<br />
		gbf_desc(29;2)=&quot;  &quot;<br />
		gbf_desc(31;10) = edit$(tipcs022.qana, &quot;ZZZZ9.VD999&quot;)<br />
		gbf_desc(41;4)=&quot;   #&quot;<br />
		if tipcs022.opol = tcittb.customized then<br />
			gbf_desc(5;6) = tipcs022.cprj(1;6)<br />
			gbf_key(4;6) = tipcs022.cprj(1;6)<br />
			select tipcs021.* from tipcs021<br />
			where tipcs021._index1 = {:mycprj, :tipcs022.sitm}<br />
			as set with 1 rows<br />
			selectdo<br />
				gbf_desc(45;30)=tipcs021.dsca(1;30)<br />
				if tipcs021.kitm = tcpuma.manufacture then<br />
					rc = gbf.add.interior(gbf_key, gbf_desc, 1)  |node<br />
				else<br />
|PCE2.o					rc = gbf.add.object(gbf_key, gbf_desc, 2, true, leaf.iconset2) |leaf<br />
					rc = gbf.add.object(gbf_key, gbf_desc, 2,<br />
					        true, leaf.iconset2, hwnd.func) |leaf<br />
				endif<br />
			endselect	<br />
	        else<br />
	        	select tiitm001.* from tiitm001<br />
	        	where tiitm001._index1= {:tipcs022.sitm}<br />
	        	as set with 1 rows<br />
	        	selectdo<br />
	        		gbf_desc(45;30) = tiitm001.dsca(1;30)<br />
	        		if tiitm001.kitm = tckitm.manufacture then<br />
					rc = gbf.add.object(gbf_key, gbf_desc, 1,<br />
					            false, int.iconset2) | node<br />
	        		else<br />
|#PCE2.o				rc = gbf.add.object(gbf_key, gbf_desc, 2, true, leaf.iconset1) |leaf<br />
 					rc = gbf.add.object(gbf_key, gbf_desc, 2, <br />
 						true, leaf.iconset1, hwnd.func) |#PCE2.n<br />
				endif<br />
			endselect<br />
	        endif<br />
	endselect<br />
	return(0)<br />
}<br />
function long read.bom010(domain tcitem myitem)<br />
{<br />
	select	tibom010.*<br />
	from	tibom010<br />
	where   tibom010._index1 inrange {:myitem, 0}<br />
	                             and {:myitem, 999}<br />
	and (tibom010.exdt = 0 or<br />
	     tibom010.exdt &gt; :mydate ) <br />
	order by tibom010._index1<br />
	selectdo<br />
		gbf_key(1;3) = edit$(tibom010.pono,&quot;999&quot;)<br />
		gbf_key(4;6) = &quot;      &quot;<br />
		gbf_key(10;16) = tibom010.sitm(1;16)<br />
		gbf_desc(1;3)=edit$(tibom010.pono,&quot;999&quot;)<br />
		gbf_desc(4;1) = &quot; &quot;<br />
		gbf_desc(5;6)=&quot;      &quot;<br />
		gbf_desc(11;2) = &quot;  &quot;<br />
		gbf_desc(13;16)=tibom010.sitm(1;16)<br />
		gbf_desc(29;2)=&quot;  &quot;<br />
		gbf_desc(31;10) = edit$(tibom010.qana, &quot;ZZZZ9.VD999&quot;)<br />
		gbf_desc(41;4)=&quot;   #&quot;<br />
	        select tiitm001.* from tiitm001<br />
	        where tiitm001._index1 = {:tibom010.sitm}<br />
	        as set with 1 rows<br />
	    	selectdo<br />
	        	gbf_desc(45;30) = tiitm001.dsca(1;30)<br />
	    		if tiitm001.kitm = tckitm.manufacture then<br />
				rc = gbf.add.object(gbf_key, gbf_desc, 1,<br />
				          false, int.iconset2) |node<br />
	    		else<br />
|#PCE2.o			rc = gbf.add.object(gbf_key, gbf_desc, 2, true, leaf.iconset1) |leaf<br />
 				rc = gbf.add.object(gbf_key, gbf_desc, 2, <br />
 				         true, leaf.iconset1, hwnd.func) |#PCE2.n<br />
	    		endif<br />
	        endselect<br />
	endselect<br />
	return(0)<br />
}<br />
function extern long init_data_gbf()<br />
{<br />
<br />
	long font.def(10), mwin1<br />
	long	def.options<br />
	long	ret_start<br />
	long	retval<br />
<br />
	head_key(1;10) =form.text$(&quot;spbom07196&quot;)<br />
	|* Article<br />
	head_key(10;6) = cprj.f(1;6)<br />
	head_key(20;16) = mitm.f(1;16)<br />
	<br />
	def.options = GBF.OPT.DEFAULT   + GBF.OPT.DEBUG |+ GBF.OPT.UNSELECT<br />
<br />
|	retval = gbf.init(gbf.current.library(), head_key,<br />
|			bit.or(GBF.MENU.ALL  , GBF.MENU.FILE.OPEN),<br />
|			bit.or(GBF.BUTTON.ALL, GBF.BUTTON.FILE.QUIT),<br />
|			def.options)<br />
	retval = gbf.init(gbf.current.library(), head_key,<br />
			  GBF.MENU.ALL, GBF.BUTTON.ALL, def.options)<br />
	LogExecErrorReturn(retval, &quot;gbf.init()&quot;)<br />
<br />
	int.iconset1 = gbf.set.interior.icon( &quot;bom&quot;,<br />
				&quot;specm.normal&quot;,		|unselected.closed<br />
				&quot;specm.open&quot;,		|unselected.open<br />
				&quot;specm.closed&quot;,		|selected.closed<br />
				&quot;specm.open&quot;,		|selected.open<br />
				true )			|Défault<br />
	int.iconset2 = gbf.set.interior.icon( &quot;bom&quot;,<br />
				&quot;standm.normal&quot;,	|unselected.closed<br />
				&quot;standm.normal&quot;,	|unselected.open<br />
				&quot;standm.select&quot;,	|selected.closed<br />
				&quot;standm.select&quot;,	|selected.open<br />
				false )<br />
	leaf.iconset1 = gbf.set.leaf.icon( &quot;bom&quot;,<br />
			 &quot;purs.normal&quot;,<br />
			 &quot;purs.select&quot;,<br />
			 TRUE)<br />
	leaf.iconset2 = gbf.set.leaf.icon( &quot;bom&quot;,<br />
			 &quot;pursp.normal&quot;,<br />
			 &quot;pursp.select&quot;,<br />
			 false)<br />
	<br />
|	rc = gbf.get.resource(DsNfontset, dummy )<br />
	mwin1 = current.mwindow()<br />
<br />
|	obj_id = create.object(DsCfontSet, mwin1, font.def)<br />
	<br />
|	rc = gbf.set.resource(DsNfontset, dummy )<br />
	<br />
	retval = gbf.set.key.desc.length(40, 80)<br />
	LogExecErrorReturn(retval, &quot;gbf.set.key.desc.length(%d, %d)&quot;,<br />
				40, 80)<br />
<br />
	retval =  gbf.set.sort.strategy(  GBF.SORT.DESC<br />
					+ GBF.SORT.ASCENDING<br />
					+ GBF.SORT.INSENSITIVE)<br />
	LogExecError(retval, &quot;gbf.set.sort.strategy()&quot;)<br />
<br />
	retval =  gbf.set.open.strategy(  GBF.OPEN.AGAIN<br />
					+ GBF.OPEN.CURSEL<br />
					+ GBF.OPEN.READALL)<br />
	LogExecError(retval, &quot;gbf.set.open.strategy()&quot;)<br />
|#PCE2.sn 	1. Create menu<br />
|		2. add function linked to menu<br />
|		3. add item menu linked to menu and to fucntion<br />
	menu.id = gbf.set.menu.head(form.text$(&quot;spbom07194&quot;), 0,0)<br />
	|* Nomenclature<br />
	hwnd.func = gbf.set.menu.function(gbf.current.library(), &quot;myfunc.leaf&quot;, TRUE )  | only for leaf<br />
	rc = gbf.set.menu.item( menu.id, form.text$(&quot;spbom07195&quot;),&quot;&quot;,true, hwnd.func, 0 ,0)<br />
	|* Detail stock &amp; Prix<br />
|#PCE2.en	<br />
	<br />
	ret_start = gbf.start(1, 1) <br />
<br />
	return (0)<br />
}<br />
<br />
<br />
function long find.bom(const string key.c())<br />
{<br />
	long	retval<br />
	domain	tcitem	item.c<br />
	domain	tccprj	cprj.c<br />
<br />
	cprj.c = key.c(4;6)<br />
	item.c = key.c(10;16)<br />
	<br />
	if isspace(cprj.c) then<br />
		retval = read.bom010(item.c)<br />
	else<br />
		retval = read.pcs022(cprj.c,item.c)<br />
	endif<br />
	<br />
	return (0)<br />
}<br />
<br />
|************************************************************************<br />
|* call back function : is called in tggbfsrvlib<br />
|************************************************************************<br />
function extern long gbf.get.top.level()<br />
{<br />
	head_key(1;3) = &quot;   &quot;<br />
	head_key(4;6) = cprj.f(1;6)<br />
	head_key(10;16) = mitm.f(1;16)<br />
	return (find.bom(head_key))<br />
}<br />
<br />
|************************************************************************<br />
|* call back function : is called in tggbfsrvlib<br />
|************************************************************************<br />
function extern long gbf.get.children(const string key(),<br />
					long value,<br />
					long level)<br />
{<br />
	return (find.bom(key))<br />
}<br />
<br />
|************************************************************************<br />
|* call back function : is called in tggbfsrvlib<br />
|************************************************************************<br />
function extern long gbf.save(<br />
	const	long	object.id,<br />
	const	string	object.key(),<br />
	const	long	object.value,<br />
	const	long	menu.value)<br />
{<br />
| Doesn't need save already in tables :-)<br />
	return (0)<br />
}<br />
<br />
|#PCE2.sn<br />
|************************************************************************<br />
|* call back function : would be  called in tggbfsrvlib (Not working)<br />
|************************************************************************<br />
function extern long 	gbf.menu.selected(<br />
	const	long	object.id,<br />
	const	string	object.key(),<br />
	const	long	object.value,<br />
	const	long	menu.value)<br />
{<br />
	rc = gbf.set.label1(&quot;BOM&quot;)<br />
	return (0)<br />
}<br />
<br />
|************************************************************************<br />
|* call back function : is called in tggbfsrvlib<br />
|* back here if a) line selected and <br />
|*              b) help on this item  <br />
|************************************************************************<br />
function extern long 	gbf.help.selected(<br />
	const	long	object.id,<br />
	const	string	object.key(),<br />
	const	long	object.value,<br />
	const	long	help.type)<br />
{<br />
	domain	tcitem 	item.l		|#PCE3.n<br />
	domain	tccprj	cprj.l		|#PCE3.n<br />
	<br />
	if not isspace(object.key) then<br />
		|#PCE3.sn<br />
		cprj.l = object.key(4;6)<br />
		item.l = object.key(10;16)<br />
		message(spbom.dll0719.item.mess(cprj.l, item.l,type.help))<br />
		|#PCE3.en<br />
	endif<br />
	return (0)<br />
}<br />
<br />
|#PCE3.so<br />
|function string spbom0719.item.mess(const string key.l())<br />
|{<br />
|	if isspace(cprj.l) then<br />
|		select tiitm001.* from tiitm001<br />
|		where tiitm001._index1 = {:item.l}<br />
|		as set with 1 rows<br />
|		selectdo<br />
|			if tiitm001.kitm = tckitm.manufacture then<br />
|				return( sprintf$(form.text$(&quot;spbom07193&quot;),<br />
|				|* Stock = %d \n Prix = %d \n Poids = %d<br />
|				tiitm001.stoc, tiitm001.copr, tiitm001.wght))<br />
|			else<br />
|				return( sprintf$(form.text$(&quot;spbom07193&quot;),<br />
|				|* Stock = %d \n Prix = %d \n Poids = %d<br />
|-				tiitm001.stoc, tiitm001.avpr, tiitm001.wght))<br />
|			endif<br />
|		endselect<br />
|	else<br />
|		select tipcs021.* from tipcs021<br />
|		where tipcs021._index1 = {:cprj.l, :item.l}<br />
|		as set with 1 rows<br />
|		selectdo<br />
|-			return( sprintf$(form.text$(&quot;spbom07193&quot;),<br />
|			|* Stock = %d \n Prix = %d \n Poids = %d<br />
|				tipcs021.stoc, tipcs021.cpra, tipcs021.wght))<br />
|		endselect<br />
|	endif<br />
|	return(&quot;No message&quot;)<br />
|}<br />
|#PCE3.eo<br />
<br />
function extern long myfunc.leaf(const long obj.id,<br />
			    const string obj.key(),<br />
			    const long obj.value,<br />
			    const long obj.menu)<br />
{<br />
	domain	tcitem 	item.l		|#PCE3.n<br />
	domain	tccprj	cprj.l		|#PCE3.n<br />
	<br />
	if not isspace(obj.key) then<br />
		|#PCE3.sn<br />
		cprj.l = obj.key(4;6)<br />
		item.l = obj.key(10;16)<br />
		message(spbom.dll0719.item.mess(cprj.l, item.l,type.help))<br />
		|#PCE3.en<br />
|#PCE3.o	message(spbom0719.item.mess(obj.key))<br />
	endif<br />
	return(0)<br />
}<br />
|#PCE2.en</div></div><hr />


<div class="post"><div class="posttop"><div class="username">moianix</div><div class="date">29th May 2008, 12:58</div></div><div class="posttext">Hi Philippe or Bonjour Philippe<br />
<br />
thx for your quick reply ...<br />
<br />
i solved in another way ... surely is not the best ... but it run<br />
<br />
Now i have another problem ... how can i refresh GBF screen when i cange something on BOM data ? see the markup &quot;Question&quot;<br />
<br />
Thx for your help.<br />
Best regards from Italy<br />
<br />
<br />
function extern long init_data_gbf()<br />
{<br />
	long	def.options<br />
	long	ret_start<br />
	<br />
	head_key(1;16) = mitm.f(1;16)<br />
	retval = gbf.init(gbf.current.library(), head_key,<br />
			bit.or(GBF.MENU.ALL  , GBF.MENU.FILE.OPEN),<br />
			bit.or(GBF.BUTTON.ALL, GBF.BUTTON.FILE.QUIT),<br />
			def.options)<br />
	LogExecErrorReturn(retval, &quot;gbf.init()&quot;)<br />
<br />
	int.iconset1 = gbf.set.interior.icon( &quot;bom&quot;,<br />
				&quot;specm.normal&quot;,		|unselected.closed<br />
				&quot;specm.open&quot;,		|unselected.open<br />
				&quot;specm.closed&quot;,		|selected.closed<br />
				&quot;specm.open&quot;,		|selected.open<br />
				true )			|Défault<br />
	<br />
	int.iconset2 = gbf.set.interior.icon( &quot;bom&quot;,<br />
				&quot;standm.normal&quot;,	|unselected.closed<br />
				&quot;standm.normal&quot;,	|unselected.open<br />
				&quot;standm.select&quot;,	|selected.closed<br />
				&quot;standm.select&quot;,	|selected.open<br />
				false )<br />
	<br />
	int.iconset3 = gbf.set.interior.icon( &quot;bom&quot;,<br />
				&quot;ghost.normal&quot;,	|unselected.closed<br />
				&quot;ghost.normal&quot;,	|unselected.open<br />
				&quot;ghost.select&quot;,	|selected.closed<br />
				&quot;ghost.select&quot;,	|selected.open<br />
				false )<br />
				<br />
	leaf.iconset1 = gbf.set.leaf.icon( &quot;bom&quot;,<br />
			 &quot;purs.normal&quot;,<br />
			 &quot;purs.select&quot;,<br />
			 TRUE)<br />
	leaf.iconset2 = gbf.set.leaf.icon( &quot;bom&quot;,<br />
			 &quot;pursp.normal&quot;,<br />
			 &quot;pursp.select&quot;,<br />
			 false)<br />
<br />
	retval = gbf.set.key.desc.length(60, 60)<br />
    LogExecErrorReturn(retval, &quot;gbf.set.key.desc.length(%d, %d)&quot;,60, 60)<br />
	retval =  gbf.set.sort.strategy(  GBF.SORT.DESC<br />
					+ GBF.SORT.ASCENDING<br />
					+ GBF.SORT.INSENSITIVE)<br />
	LogExecError(retval, &quot;gbf.set.sort.strategy()&quot;)<br />
<br />
	retval =  gbf.set.open.strategy(  GBF.OPEN.AGAIN<br />
					+ GBF.OPEN.CURSEL<br />
					+ GBF.OPEN.READALL)<br />
	LogExecError(retval, &quot;gbf.set.open.strategy()&quot;)<br />
<br />
|--- Custom menu<br />
|-- Title<br />
	menu.text = &quot;Action&quot;<br />
	menu.id = gbf.set.menu.head(menu.text,0,GBF.ZERO.DISABLE)<br />
	LogExecError(menu.id, &quot;gbf.set.menu.head()&quot;)<br />
|-- Menu selection	<br />
	menu.text = &quot;Maintain Item Data&quot;<br />
	keystroke = &quot;&quot;<br />
	set.menu.item()<br />
	menu.text = &quot;Maintain BOM Data&quot;<br />
	keystroke = &quot;&quot;<br />
	set.menu.item()<br />
|*******	<br />
	ret_start = gbf.start(1, 1) <br />
	<br />
	return (0)<br />
}<br />
<br />
function set.menu.item()<br />
{<br />
	retval = gbf.set.menu.item(menu.id,menu.text,keystroke,0,menu.function.id,0,GBF.ZERO.DISABLE)<br />
	LogExecError(retval, &quot;gbf.set.menu.item()&quot;)<br />
}<br />
<br />
|--- Action selected<br />
function extern long gbf.menu.selected( long obj.id, <br />
										const string object.key(), <br />
										long object.value, <br />
										long menu.option)<br />
{<br />
|--- Value of menu.option<br />
| 			41 = &quot;Maintain Item Data&quot;<br />
|			42 = &quot;Maintain BOM Data&quot;<br />
<br />
	ON CASE menu.option<br />
		CASE 41:<br />
				zoom.item = object.key(4;16)<br />
				export(&quot;zoom.item&quot;,zoom.item)<br />
				zoom.to$(&quot;tppdm0110s000&quot;,z.session,prog.name$,&quot;&quot;,0)<br />
				break<br />
		CASE 42:<br />
				zoom.item = object.key(4;16)<br />
				export(&quot;zoom.item&quot;,zoom.item)<br />
				zoom.to$(&quot;tibom1110s000&quot;,z.session,prog.name$,&quot;&quot;,0)<br />
|***Question<br />
|How to refresh data ?????	init_data_gbf()<br />
				break<br />
<br />
		DEFAULT:<br />
				message(&quot;Invalid selection&quot;)<br />
	ENDCASE<br />
	return (0)<br />
}</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pconde</div><div class="date">29th May 2008, 14:46</div></div><div class="posttext">Hello,<br />
<br />
I think that this is not so easy because the GBF tree is in memory and it is not refreshed.<br />
It is the same problem as when you change a menu in the browser. If the menu was displayed in your browser before the change you can only see the change after exit bw and reload it.<br />
So I  have 2 ideas<br />
a) redo a gbf.init and reload all.<br />
b) use function gbf.delete.object + gbf.add.object<br />
not sure that this should do the trick.<br />
<br />
Regards<br />
Philippe</div></div><hr />


<div class="post"><div class="posttop"><div class="username">moianix</div><div class="date">29th May 2008, 15:23</div></div><div class="posttext">Hello<br />
<br />
i go to try your ideas.<br />
<br />
Thx.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ctarton1</div><div class="date">6th March 2010, 22:00</div></div><div class="posttext">Hi Philippe or Bonjour Philippe<br />
<br />
thx for your quick reply ...<br />
<br />
i solved in another way ... surely is not the best ... but it run<br />
<br />
Now i have another problem ... how can i refresh GBF screen when i cange something on BOM data ? see the markup &quot;Question&quot;<br />
<br />
Thx for your help.<br />
Best regards from Italy<br />
<br />
<br />
function extern long init_data_gbf()<br />
{<br />
	long	def.options<br />
	long	ret_start<br />
	<br />
	head_key(1;16) = mitm.f(1;16)<br />
	retval = gbf.init(gbf.current.library(), head_key,<br />
			bit.or(GBF.MENU.ALL  , GBF.MENU.FILE.OPEN),<br />
			bit.or(GBF.BUTTON.ALL, GBF.BUTTON.FILE.QUIT),<br />
			def.options)<br />
	LogExecErrorReturn(retval, &quot;gbf.init()&quot;)<br />
<br />
	int.iconset1 = gbf.set.interior.icon( &quot;bom&quot;,<br />
				&quot;specm.normal&quot;,		|unselected.closed<br />
				&quot;specm.open&quot;,		|unselected.open<br />
				&quot;specm.closed&quot;,		|selected.closed<br />
				&quot;specm.open&quot;,		|selected.open<br />
				true )			|Défault<br />
	<br />
	int.iconset2 = gbf.set.interior.icon( &quot;bom&quot;,<br />
				&quot;standm.normal&quot;,	|unselected.closed<br />
				&quot;standm.normal&quot;,	|unselected.open<br />
				&quot;standm.select&quot;,	|selected.closed<br />
				&quot;standm.select&quot;,	|selected.open<br />
				false )<br />
	<br />
	int.iconset3 = gbf.set.interior.icon( &quot;bom&quot;,<br />
				&quot;ghost.normal&quot;,	|unselected.closed<br />
				&quot;ghost.normal&quot;,	|unselected.open<br />
				&quot;ghost.select&quot;,	|selected.closed<br />
				&quot;ghost.select&quot;,	|selected.open<br />
				false )<br />
				<br />
	leaf.iconset1 = gbf.set.leaf.icon( &quot;bom&quot;,<br />
			 &quot;purs.normal&quot;,<br />
			 &quot;purs.select&quot;,<br />
			 TRUE)<br />
	leaf.iconset2 = gbf.set.leaf.icon( &quot;bom&quot;,<br />
			 &quot;pursp.normal&quot;,<br />
			 &quot;pursp.select&quot;,<br />
			 false)<br />
<br />
	retval = gbf.set.key.desc.length(60, 60)<br />
    LogExecErrorReturn(retval, &quot;gbf.set.key.desc.length(%d, %d)&quot;,60, 60)<br />
	retval =  gbf.set.sort.strategy(  GBF.SORT.DESC<br />
					+ GBF.SORT.ASCENDING<br />
					+ GBF.SORT.INSENSITIVE)<br />
	LogExecError(retval, &quot;gbf.set.sort.strategy()&quot;)<br />
<br />
	retval =  gbf.set.open.strategy(  GBF.OPEN.AGAIN<br />
					+ GBF.OPEN.CURSEL<br />
					+ GBF.OPEN.READALL)<br />
	LogExecError(retval, &quot;gbf.set.open.strategy()&quot;)<br />
<br />
|--- Custom menu<br />
|-- Title<br />
	menu.text = &quot;Action&quot;<br />
	menu.id = gbf.set.menu.head(menu.text,0,GBF.ZERO.DISABLE)<br />
	LogExecError(menu.id, &quot;gbf.set.menu.head()&quot;)<br />
|-- Menu selection	<br />
	menu.text = &quot;Maintain Item Data&quot;<br />
	keystroke = &quot;&quot;<br />
	set.menu.item()<br />
	menu.text = &quot;Maintain BOM Data&quot;<br />
	keystroke = &quot;&quot;<br />
	set.menu.item()<br />
|*******	<br />
	ret_start = gbf.start(1, 1) <br />
	<br />
	return (0)<br />
}<br />
<br />
function set.menu.item()<br />
{<br />
	retval = gbf.set.menu.item(menu.id,menu.text,keystroke,0,menu.function.id,0,GBF.ZERO.DISABLE)<br />
	LogExecError(retval, &quot;gbf.set.menu.item()&quot;)<br />
}<br />
<br />
|--- Action selected<br />
function extern long gbf.menu.selected( long obj.id, <br />
										const string object.key(), <br />
										long object.value, <br />
										long menu.option)<br />
{<br />
|--- Value of menu.option<br />
| 			41 = &quot;Maintain Item Data&quot;<br />
|			42 = &quot;Maintain BOM Data&quot;<br />
<br />
	ON CASE menu.option<br />
		CASE 41:<br />
				zoom.item = object.key(4;16)<br />
				export(&quot;zoom.item&quot;,zoom.item)<br />
				zoom.to$(&quot;tppdm0110s000&quot;,z.session,prog.name$,&quot;&quot;,0)<br />
				break<br />
		CASE 42:<br />
				zoom.item = object.key(4;16)<br />
				export(&quot;zoom.item&quot;,zoom.item)<br />
				zoom.to$(&quot;tibom1110s000&quot;,z.session,prog.name$,&quot;&quot;,0)<br />
|***Question<br />
|How to refresh data ?????	init_data_gbf()<br />
				break<br />
<br />
		DEFAULT:<br />
				message(&quot;Invalid selection&quot;)<br />
	ENDCASE<br />
	return (0)<br />
}<br />
Hello,<br />
<br />
for refresh data in the tree try to use this function:<br />
<br />
function refresh.F5()<br />
{<br />
	long	event_2(EVTMAXSIZE)<br />
	<br />
	evt.type(event_2) = EVTKEYPRESS<br />
	evt.keypress.key(event_2) = FKEY(5)<br />
	send.event(get.pgrp(PID), event_2)<br />
}</div></div><hr />



</div>
</body>
</html>