<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="Invoking Baan session from other application, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] Invoking Baan session from other application AFS/DDC/OLE: Function servers" />
	
	<title>Invoking Baan session from other application [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="index.html">Newbaanboard</a> &gt; <a href="index.html">Baan SIGs</a> &gt; <a href="index.html">AFS/DDC/OLE: Function servers</a> &gt; Invoking Baan session from other application</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">r_bharose</div><div class="date">18th February 2003, 16:39</div></div><div class="posttext">Is there a way to invoke a baan sessions from other application.<br />
Lets say, I am using MS-Outlook. In the task list I have defined &quot;maintain customers&quot; as a task. I should be able to invoke Baan session &quot;Main Customer&quot; Directly. <br />
Is it possible?. ( I have seen running bw from command line with session name as argument invokes that perticular session).<br />
I want to go one step further of invoking a session with a perticular record. eg. Maintain sales Order with Sales order numver &quot;XXXX&quot;.<br />
<br />
Has anybody explored this?<br />
<br />
Thanks in advance.<br />
<br />
Ram</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Renegade</div><div class="date">18th February 2003, 17:00</div></div><div class="posttext">I do not know abt MS OUTlook.... But if u can select the record at the side of Outlook using VB macros or something, then invoking Baan can be done using BOIs. BOI stands for Business Object Interface. <br />
<br />
Posts galore on this topic at this forum. Search for BOI, BCK or OpenWorld.<br />
<br />
Good luck</div></div><hr />


<div class="post"><div class="posttop"><div class="username">r_bharose</div><div class="date">18th February 2003, 17:29</div></div><div class="posttext">I am looking for the solution .. where I can actully invoke the baan screen.... not going through BOI's...<br />
<br />
I am actully exploring a functionality for building a small workflow..</div></div><hr />


<div class="post"><div class="posttop"><div class="username">avpatil</div><div class="date">19th February 2003, 00:24</div></div><div class="posttext">Hi,<br />
Here is one way you can do this. <br />
Write a custom DLL that will zoom to a session. From outlook if u can call a VB script then u can call this Baan DLL trhough VB (using Baan OLEautomation). This is something that can be done easily.<br />
<br />
Arvind</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Paul P</div><div class="date">19th February 2003, 03:25</div></div><div class="posttext">Dear Ram,<br />
<br />
The thread below is about starting a BaanERP session from command line. Could this be what you're looking for?<br />
Running session in background (http://www.baanboard.com/baanboard/showthread.php?s=&amp;threadid=8872)<br />
<br />
Rgds,<br />
Paul</div></div><hr />


<div class="post"><div class="posttop"><div class="username">r_bharose</div><div class="date">19th February 2003, 12:21</div></div><div class="posttext">I do not want the sessions to run in background.<br />
Instead the user should be actually presented with baan session to interact with. <br />
Basically idea is to have a task in outlook. This task will have a customised outlook form with session linked to it. Hence when a user clicks on the button on the outlook form, Baan session will start and the user will interact with session.<br />
<br />
Has anobody done similar thing?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">AndreasSchmitt</div><div class="date">11th June 2003, 11:12</div></div><div class="posttext">What you are looking for is exactly what we want to implement.<br />
If you are any further with your project, please let me know ...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jaapzwaan</div><div class="date">11th June 2003, 12:58</div></div><div class="posttext">Dear r_bharose,<br />
<br />
Please enter your Baan version and DB type in your profile. Now I don't know if this information is relevant for you:<br />
<br />
In BaanERP5.1 you can simply create a Baan Link by dragging one or more rows from the grid to your desktop.<br />
<br />
You can also select a record and select the following menu entry:<br />
File-&gt; Send To -&gt; Task List<br />
<br />
This creates .bwl files which can easily be edited.<br />
<br />
Regards,<br />
Jaap Zwaan</div></div><hr />


<div class="post"><div class="posttop"><div class="username">zardoz</div><div class="date">11th June 2003, 14:00</div></div><div class="posttext">You can use this technique:<br />
<br />
- create a baan DLL that has only one function, like<br />
<br />
function call.session(const string sessname())<br />
{<br />
zoom.to$(z.session, sessname, &quot;&quot;, &quot;&quot;, 0)<br />
}<br />
<br />
from VB, using the OLE you can call this DLL passing the function name you want to call;<br />
<br />
NB: each call consumes 1 license, so pay attention...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">AndreasSchmitt</div><div class="date">11th June 2003, 14:39</div></div><div class="posttext">If yo start ottstpoledaemon prior to your VB Call <br />
no additional licence is eaten ...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">11th June 2003, 15:07</div></div><div class="posttext">Andreas,<br />
<br />
I am not sure what you mean about starting ottstpoledaemon prior to the VB calls.  Could you give a sample of this.  I am not sure how you could do this and not eat up a license.<br />
<br />
Thanks<br />
<br />
Mark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">AndreasSchmitt</div><div class="date">11th June 2003, 15:26</div></div><div class="posttext">Hi Mark !<br />
I assume you have a BaanIV session open (regularly connected)<br />
If you start otccomdllbaan (self-made) via VB/VB-Script:<br />
<br />
example:<br />
<br />
Private Sub CommandButton1_Click()<br />
	<br />
	    Set BaanObj = CreateObject(&quot;Baan4.Application&quot;)<br />
	    BaanObj.Timeout = 10<br />
	    On Error GoTo BaanAutomationError<br />
	<br />
	    B_function = &quot;start.session(&quot; &amp; Chr(34) &amp; &quot;tiitm0101m000&quot; &amp; Chr(34) &amp; &quot;)&quot;<br />
	    BaanObj.ParseExecFunction &quot;otccomdllbaan&quot;, B_function<br />
	    Exit Sub<br />
	<br />
	' error handling<br />
	    <br />
	BaanAutomationError:<br />
	    MsgBox &quot;Baan IV automation error: &quot; &amp; BaanObj.Error<br />
	    MsgBox &quot;Return value function: &quot; &amp; B_function &amp; &quot;  &quot; &amp; BaanObj.ReturnValue<br />
	    BaanObj.Quit<br />
	    Set BaanObj = Nothing<br />
	    Exit Sub<br />
	<br />
	End Sub<br />
<br />
<br />
then normally a bw.exe LoginDialog is opened. If you have started ottstpoledaemon vi BaanMenu/Apllication/Start<br />
then no Login Dialog appears, the baan-dll is successfully called<br />
and no licence is consumed (checked it twice ... )<br />
<br />
greetings Andreas</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">11th June 2003, 15:40</div></div><div class="posttext">Now I understand. I was thinking you had a method to start a connection without having a Baan connection open.  In my case if my ole automation stuff starts in the same shell as something active it hangs.<br />
<br />
As for the original post I think what zardoz mentioned may work.  I will have to give it a try if I have time today.<br />
<br />
Mark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">11th June 2003, 16:27</div></div><div class="posttext">Here is what I did to launch a session - first the baan code:<br />
<br />
<br />
function extern call.session(const string sessname())<br />
{<br />
	zoom.to$(sessname,Z.SESSION, &quot;&quot;, &quot;&quot;, 0)<br />
}<br />
<br />
<br />
I put this into my tdapi library.  And now for the VB code:<br />
<br />
<br />
' Set-up the variables<br />
Dim BaanObj As Object<br />
Dim B_function As String<br />
Dim B_function2 As String<br />
Dim Query As String<br />
Dim temp_string As String<br />
Dim value_string As String<br />
Dim query_id As Long<br />
Dim RetVal As Long<br />
Dim dllname As String<br />
Dim dllfunction As String<br />
Dim msg As String<br />
<br />
<br />
Sub Run_function_server()<br />
'<br />
' Baseline Macro<br />
'<br />
<br />
    'dllname = &quot;otisfcdll9475&quot;<br />
    dllname = &quot;otdapidllrecpt&quot;<br />
    Sheets(&quot;Run Parameters&quot;).Activate<br />
    main_f = Sheets(&quot;Run Parameters&quot;).Cells(Row, 1)<br />
    Call open_baan<br />
    dllfunction = &quot;call.session(&quot; &amp; Chr$(34) &amp; &quot;tpppc6403m000&quot; &amp; Chr$(34) &amp; &quot;)&quot;<br />
    Call SendtoBAAN<br />
    Call close_baan<br />
End Sub<br />
<br />
<br />
'***************************************************************************************<br />
'   Name                    :   SendtoBaan<br />
'   Short Description       :   Send/Receive information to/from Baan<br />
'   Comments                :   Check if Baan is active otherwise connect to Baan<br />
'                               send information to Baan with parseexecfunction with 2 parameters<br />
'                                a) dllname<br />
'                                b) dllfunction (includes parameters)<br />
'                               return information checked for errors and messages displayed<br />
'                               Also if a record has an error the error flag switch is turned on<br />
'***************************************************************************************<br />
'Sub SendtoBAAN(ByVal dllname As String, ByVal dllfunction As String)<br />
Sub SendtoBAAN()<br />
    BaanObj.ParseExecFunction dllname, dllfunction<br />
' check result<br />
    errormsg = &quot;&quot;<br />
    If BaanObj.Error &lt;&gt; 0 Then<br />
            Select Case BaanObj.Error<br />
            Case Is = -1<br />
                    errormsg = &quot;DLL Unknown&quot;<br />
            Case Is = -2<br />
                    errormsg = &quot;Function Unknown&quot;<br />
            Case Is = -3<br />
                    errormsg = &quot;Syntax Error in Function Call&quot;<br />
            End Select<br />
            MsgBox (&quot;Call to Baan DLL failed, error = &quot; &amp; errormsg)<br />
            close_baan<br />
    End If<br />
' If return false then everything was okay. If return value true<br />
' then we had an error<br />
    returnvalue = Val(BaanObj.returnvalue)<br />
    If returnvalue Then<br />
        strlen = Len(BaanObj.functioncall)<br />
        compos = InStr(1, BaanObj.functioncall, &quot;commmsg:&quot;, 1)<br />
        msg = Mid(BaanObj.functioncall, compos + 8, strlen - 3)<br />
        msg = RTrim(Mid(msg, 1, Len(msg) - 3))<br />
        MsgBox msg<br />
    End If<br />
    Exit Sub<br />
AutomationError:<br />
    MsgBox &quot;Baan IV automation error: &quot; &amp; BaanObj.Error<br />
End Sub<br />
<br />
Sub open_baan()<br />
' The DLL &quot;ottdllsql_query&quot; contains a function to convert this string to a Baan query and<br />
' other functions to parse and execute the query. The DLL also contains functions to retrieve<br />
' the result of the query, e.g. function &quot;olesql_getstring&quot;.<br />
    On Error GoTo CannotCreateBaan<br />
        <br />
'My connection was Automatic since I changed a registry entry to<br />
'run a different .bwc file.<br />
'run Baan Application<br />
    Set BaanObj = CreateObject(&quot;Baan4.Application.ole701&quot;)<br />
    BaanObj.Timeout = 3600<br />
    On Error GoTo BaanAutomationError<br />
    Exit Sub<br />
    <br />
' error handling<br />
CannotCreateBaan:<br />
    MsgBox &quot;Unable to start Baan&quot;<br />
    Exit Sub<br />
    <br />
BaanAutomationError:<br />
    MsgBox &quot;Baan IV automation error: &quot; &amp; BaanObj.Error<br />
    MsgBox &quot;Return value function: &quot; &amp; B_function &amp; &quot;  &quot; &amp; BaanObj.returnvalue<br />
    BaanObj.Quit<br />
    Set BaanObj = Nothing<br />
    Exit Sub<br />
    <br />
End Sub<br />
Sub close_baan()<br />
' exit Baan<br />
    If Not BaanObj Is Nothing Then<br />
        BaanObj.Quit<br />
        Set BaanObj = Nothing<br />
    End If<br />
End Sub<br />
<br />
<br />
Please note that I used code I aready had and did not clean it up for this test, also I used a .bwc file that has password encoded in it.  And since this post ended up falling under OLE I am going to move it to the other forum.  <br />
<br />
Mark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">wgarcia</div><div class="date">10th February 2005, 16:29</div></div><div class="posttext">In outlook your you can create tasks or to receive tasks by mail, to these tasks one can attach a code VB through the option Macro that is in the option of tools (in new task).  The macro assigned to the task can carry out the connection to Baan, and to run a session specifies. one can also work with instructions AFS from the code VB. <br />
 <br />
The form of making it, and examples of these codes can get them in other consultations.  you can also write he/she stops this way to send you examples of these codes.  <br />
  <br />
Good Luck</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Al Smith</div><div class="date">10th February 2005, 22:52</div></div><div class="posttext">Hi,<br />
To call a Baan session from vb without a custom dll (in Baan IV at least)<br />
<br />
BaanObj.ParseExecFunction &quot;ottstpstandard&quot;, &quot;zoom.to.menu(&quot; &amp; Chr(34) &amp; &quot;tiitm0101m000&quot; &amp; Chr(34) &amp; &quot;,2,&quot; &amp; Chr(34) &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; Chr(34) &amp; &quot;,0,0)&quot;<br />
<br />
Al.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">tjbyfield</div><div class="date">10th February 2005, 23:47</div></div><div class="posttext">I am wondering why you want to invoke Baan from Outlook ?  <br />
<br />
Could &quot;Webtop&quot; address the business process ? <br />
<br />
Is there really a need for Microsoft Outlook and for that matter is Baan the best solution for the business ? If it is a small application/business perhaps one of the Microsoft ERP's would fit better.<br />
<br />
Terry</div></div><hr />


<div class="post"><div class="posttop"><div class="username">catwalk</div><div class="date">14th April 2005, 05:15</div></div><div class="posttext">Hi tjbyfield,<br />
<br />
I think the idea here is to have a capability to invoke the Baan screens from the third party tool. I think what the user is looking is to create is a workflow application. <br />
<br />
User will be presented with tasks he needs to complete in Baan. The Taks management apllication can be any groupware application such as outlook or Lotus workflow or any other application.<br />
<br />
The hyperlink in the application should be smart enough to open the precise record in Baan. eg. if The Task is  to approve a perticular purchase order. Then when user clicks on the link, baan session &quot;maintain purchase order &quot; is opened with the purchase order which needs to approved on the screen.<br />
<br />
There is a lot of good discussion on this in this tread. If anybody can come out with workign application it would be great.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">NPRao</div><div class="date">14th April 2005, 09:39</div></div><div class="posttext">I think what the user is looking is to create is a workflow application. <br />
I am not sure about other BaaN Versions, I think there is a Workflow Engine in BaaN-5+, atleast its available in 5.2 onwards. There is also DEM, which can help in the Business Process Flow and Modelling. Why re-invent the wheel ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">NvanBeest</div><div class="date">15th April 2005, 13:42</div></div><div class="posttext">Why re-invent the wheel ?Because we can? :) <br />
<br />
More seriously, that's what adaptive software is supposed to allow, isn't it?  If there is a workflow system already used for other applications and/or business processes, would you rather add Baan to it, or recreate the existing stuff in Baan?  My personal feeling would be that, if the existing system works well, why would you have to switch to something &quot;new&quot;?<br />
<br />
Anyway, that's the way I feel!  The best part of Baan was always the tools, and not the front-end.  Happy customizing!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">awever</div><div class="date">15th April 2005, 18:25</div></div><div class="posttext">There is a SSA Workflow solution for BaanIVc and BaanERP 5.0c available, which can also start other type of applications.<br />
The release for ERP LN is on its way.<br />
<br />
This solution can also send you an email, when you have new workitems to execute.<br />
<br />
The to-do list is part of the Worktop and the Webtop.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jholdrid</div><div class="date">18th July 2005, 21:37</div></div><div class="posttext">I am sorry to join this discussion so late; I have found all of the information here so worth while and it has helped us launch Baan applications from Other applications.<br />
<br />
However we are having a license problem - we have baan open but when we run, we appear to have to open another license as it never finds our default.<br />
<br />
the code above looked like:<br />
      Set BaanObj = CreateObject(&quot;Baan4.Application&quot;)<br />
 <br />
Our system hangs unless we code:<br />
      Set BaanObj = CreateObject(&quot;Baan4.Application.default&quot;)<br />
or    Set BaanObj = CreateObject(&quot;Baan4.Application.testserver&quot;) if default checked is our test server.<br />
       and this opens a second license.<br />
<br />
Any ideas as to what we could change so that we are using the already open Baan connection ?<br />
<br />
Thanks so much for your help<br />
<br />
 :confused:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">19th July 2005, 15:08</div></div><div class="posttext">I have not tested this lately, but the last time I tried using my open connection everything would hang.  When you set up your .bwc file the automation tab is what name you will use in your CreateObject.  I think if you do some searches on the board you will find other discussions about licenses and using the ole automation.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">avpatil</div><div class="date">19th July 2005, 16:21</div></div><div class="posttext">Hi,<br />
I have observed that if Baan client (the default client) is open then if Baan client is called, then I get some automation error. You can try to avoid the statement Create Object or some other. I have never tried that.<br />
<br />
Arvind</div></div><hr />


<div class="post"><div class="posttop"><div class="username">patrick</div><div class="date">29th September 2005, 14:37</div></div><div class="posttext">I am a bit late but this might still interest you,<br />
<br />
Look here http://users.i4surf.net/myplace/</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Nandan</div><div class="date">8th October 2005, 11:16</div></div><div class="posttext">I have seen bms functions used in, &quot;tgwms&quot; (The old workflow solution from Baan, which never got implemented), but never figured out how to use the bms function to invoke baan sessions and interact with them.<br />
<br />
I guess the stuff which can be used in AFS to interact with the sessions can be used to start/interact/closed session in foreground.<br />
<br />
If someone has used these functions successfully, please share your experience.</div></div><hr />



</div>
</body>
</html>