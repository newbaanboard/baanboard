<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="DispInvoke failed, error -2147352573, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] DispInvoke failed, error -2147352573 AFS/DDC/OLE: Function servers" />
	
	<title>DispInvoke failed, error -2147352573 [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="index.html">Newbaanboard</a> &gt; <a href="index.html">Baan SIGs</a> &gt; <a href="index.html">AFS/DDC/OLE: Function servers</a> &gt; DispInvoke failed, error -2147352573</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">psehouri</div><div class="date">19th March 2008, 11:40</div></div><div class="posttext">Hello,<br />
<br />
If I use this vbscript code below to print 15L units via : tcmcs0401m000 and everything works fine.<br />
<br />
Dim SessionImpression<br />
Dim RapportImpression<br />
Dim ErrMessage1<br />
Dim OfKey1 <br />
Dim OfKey2 <br />
Dim OfKeyValue1 <br />
Dim OfKeyValue2 <br />
Dim CodeImprimante<br />
<br />
SessionImpression = &quot;tcmcs0401m000&quot; <br />
RapportImpression = &quot;rtcmcs040101000&quot; <br />
ErrMessage1 = Space(30)<br />
OfKey1 = &quot;cuni.f&quot; <br />
OfKey2 = &quot;cuni.t&quot; <br />
CodeImprimante = &quot;L&quot; <br />
OfKeyValue1 = &quot;15L&quot; <br />
OfKeyValue2 = &quot;15L&quot; <br />
<br />
Set BaanObj = CreateObject(&quot;Baan4.Application.510&quot;) <br />
BaanObj.ParseExecFunction &quot;ottstpapihand&quot;, &quot;stpapi.put.field(&quot; &amp; Chr(34) &amp; SessionImpression &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; OfKey1 &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; OfKeyValue1 &amp; Chr(34) &amp; &quot;)&quot; <br />
BaanObj.ParseExecFunction &quot;ottstpapihand&quot;, &quot;stpapi.put.field(&quot; &amp; Chr(34) &amp; SessionImpression &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; OfKey2 &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; OfKeyValue2 &amp; Chr(34) &amp; &quot;)&quot; <br />
BaanObj.ParseExecFunction &quot;ottstpapihand&quot;, &quot;stpapi.set.report(&quot; &amp; Chr(34) &amp; SessionImpression &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; RapportImpression &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; CodeImprimante &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; ErrMessage1 &amp; Chr(34) &amp; &quot;)&quot; <br />
BaanObj.ParseExecFunction &quot;ottstpapihand&quot;, &quot;stpapi.continue.process(&quot; &amp; Chr(34) &amp; SessionImpression &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; ErrMessage1 &amp; Chr(34) &amp; &quot;)&quot; <br />
BaanObj.ParseExecFunction &quot;ottstpapihand&quot;, &quot;stpapi.end.session(&quot; &amp; Chr(34) &amp; SessionImpression &amp; Chr(34) &amp; &quot;)&quot; <br />
BaanObj.Quit <br />
<br />
<br />
If I want to do the same using Python using the code below, I get a BW Message saying : <br />
<br />
DispInvoke Failed, error = -2147352573<br />
<br />
So, the session works, but I can't quit the session automatically because of the BW Message...<br />
<br />
Someone already experience and solve this problem ???<br />
Than'x...<br />
<br />
<br />
import win32com.client<br />
<br />
Societe     = &quot;510&quot;<br />
LanceBaaN   = &quot;Baan4.Application.&quot; + Societe<br />
<br />
SessionImpression = &quot;tcmcs0410m000&quot; <br />
RapportImpression = &quot;rtcmcs041001000&quot; <br />
ErrMessage1 = &quot;&quot;<br />
OfKey1 = &quot;ccty.f&quot; <br />
OfKey2 = &quot;ccty.t&quot; <br />
CodeImprimante = &quot;L-PAYSAGE&quot; <br />
OfKeyValue1 = &quot;FRA&quot; <br />
OfKeyValue2 = &quot;FRA&quot; <br />
<br />
BaanObj = win32com.client.Dispatch(LanceBaaN)<br />
<br />
BaanObj.ParseExecFunction(&quot;ottstpapihand&quot;, &quot;stpapi.put.field(&quot; + chr(34) + SessionImpression + chr(34) + &quot;,&quot; + chr(34) + OfKey1 + chr(34) + &quot;,&quot; + chr(34) + OfKeyValue1 + chr(34) + &quot;)&quot;)<br />
BaanObj.ParseExecFunction(&quot;ottstpapihand&quot;, &quot;stpapi.put.field(&quot; + chr(34) + SessionImpression + chr(34) + &quot;,&quot; + chr(34) + OfKey2 + chr(34) + &quot;,&quot; + chr(34) + OfKeyValue2 + chr(34) + &quot;)&quot;)<br />
BaanObj.ParseExecFunction(&quot;ottstpapihand&quot;, &quot;stpapi.set.report(&quot; + chr(34) + SessionImpression + chr(34) + &quot;,&quot; + chr(34) + RapportImpression + chr(34) + &quot;,&quot; + chr(34) + CodeImprimante + chr(34) + &quot;,&quot; + chr(34) + ErrMessage1 + chr(34) + &quot;)&quot;)<br />
BaanObj.ParseExecFunction(&quot;ottstpapihand&quot;, &quot;stpapi.continue.process(&quot; + chr(34) + SessionImpression + chr(34) + &quot;,&quot; + chr(34) + ErrMessage1 + chr(34) + &quot;)&quot;)<br />
<br />
BaanObj.ParseExecFunction(&quot;ottstpapihand&quot;, &quot;stpapi.end.session(&quot; + chr(34) + SessionImpression + chr(34) + &quot;)&quot;)<br />
BaanObj.Quit</div></div><hr />


<div class="post"><div class="posttop"><div class="username">psehouri</div><div class="date">21st March 2008, 11:49</div></div><div class="posttext">Yep, help please !!!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">21st March 2008, 12:29</div></div><div class="posttext">Sorry, but I would say there are not many python programmers on the board.  So your best bet might be posting on a python board.  Or show patience until someone that does know Python shows up to make a suggestion.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">psehouri</div><div class="date">21st March 2008, 14:18</div></div><div class="posttext">Hello Mark, but I don't think it's a Python issue... The message is a BW Message...<br />
<br />
I saw in a precedent post that the problem already appear about PHP and BaaN on this forum...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">21st March 2008, 14:37</div></div><div class="posttext">I can't say for sure, but I see two sets of code which looks identical to me.  One works in vb and one doesn't in python.  I do not understand all the details in making the connection, but to me it looks like python is not making a connection.  Where exactly in the code does it get this error?  If it is the BaanObj = win32com.client.Dispatch(LanceBaaN) statement then to me it points to the library(or windows DLL) that contains win32com.client.dispatch.  That falls way outside my knowledge base - it could me a windows update, a baan client update or even maybe a baan patch.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">psehouri</div><div class="date">21st March 2008, 15:05</div></div><div class="posttext">I can't say for sure, but I see two sets of code which looks identical to me.  One works in vb and one doesn't in python.  I do not understand all the details in making the connection, but to me it looks like python is not making a connection.  Where exactly in the code does it get this error?  If it is the BaanObj = win32com.client.Dispatch(LanceBaaN) statement then to me it points to the library(or windows DLL) that contains win32com.client.dispatch.  That falls way outside my knowledge base - it could me a windows update, a baan client update or even maybe a baan patch.<br />
<br />
Hello Mark_u,<br />
my Python Code connects to BaaN because, the execution of the session continue and give the good result.<br />
THe code doing the connection is : BaanObj = win32com.client.Dispatch(&quot;Baan4.Application.510&quot;)<br />
<br />
If I comment the other lines, I get the error. So, I think you're right, maybe it's a Python issue, I continue to search...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">psehouri</div><div class="date">25th March 2008, 09:48</div></div><div class="posttext">Hello,<br />
<br />
The problem was due to ambiguous definition of method or property...<br />
<br />
So, flagging (what Python believes to be) a property as a method fix it...<br />
<br />
<br />
Maybe it's the first code in Python on this site, I'm happy :D<br />
<br />
The code becomes : <br />
<br />
<br />
import win32com.client<br />
<br />
Societe     = &quot;510&quot;<br />
LanceBaaN   = &quot;Baan4.Application.&quot; + Societe<br />
<br />
SessionImpression = &quot;tcmcs0410m000&quot; <br />
RapportImpression = &quot;rtcmcs041001000&quot; <br />
ErrMessage1 = &quot;&quot;<br />
OfKey1 = &quot;ccty.f&quot; <br />
OfKey2 = &quot;ccty.t&quot; <br />
CodeImprimante = &quot;L&quot; <br />
OfKeyValue1 = &quot;FRA&quot; <br />
OfKeyValue2 = &quot;FRA&quot; <br />
<br />
BaanObj = win32com.client.Dispatch(LanceBaaN)<br />
BaanObj._FlagAsMethod(&quot;ParseExecFunction&quot;)<br />
BaanObj.ParseExecFunction(&quot;ottstpapihand&quot;, &quot;stpapi.put.field(&quot; + chr(34) + SessionImpression + chr(34) + &quot;,&quot; + chr(34) + OfKey1 + chr(34) + &quot;,&quot; + chr(34) + OfKeyValue1 + chr(34) + &quot;)&quot;)<br />
BaanObj.ParseExecFunction(&quot;ottstpapihand&quot;, &quot;stpapi.put.field(&quot; + chr(34) + SessionImpression + chr(34) + &quot;,&quot; + chr(34) + OfKey2 + chr(34) + &quot;,&quot; + chr(34) + OfKeyValue2 + chr(34) + &quot;)&quot;)<br />
BaanObj.ParseExecFunction(&quot;ottstpapihand&quot;, &quot;stpapi.set.report(&quot; + chr(34) + SessionImpression + chr(34) + &quot;,&quot; + chr(34) + RapportImpression + chr(34) + &quot;,&quot; + chr(34) + CodeImprimante + chr(34) + &quot;,&quot; + chr(34) + ErrMessage1 + chr(34) + &quot;)&quot;)<br />
BaanObj.ParseExecFunction(&quot;ottstpapihand&quot;, &quot;stpapi.continue.process(&quot; + chr(34) + SessionImpression + chr(34) + &quot;,&quot; + chr(34) + ErrMessage1 + chr(34) + &quot;)&quot;)<br />
BaanObj.ParseExecFunction(&quot;ottstpapihand&quot;, &quot;stpapi.end.session(&quot; + chr(34) + SessionImpression + chr(34) + &quot;)&quot;)<br />
BaanObj._FlagAsMethod(&quot;Quit&quot;)<br />
BaanObj.Quit<br />
BaanObj = None</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">25th March 2008, 13:56</div></div><div class="posttext">Glad you got it fixed and you posted the solution.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">matigro</div><div class="date">10th July 2009, 21:54</div></div><div class="posttext">Nice script, after headbanging with the wall to understand some things about Windows(tm) and connections, I made it run! :D<br />
The only problem I found is that it needs one configuration to connect to LN for itself. i.e. I can't use same connection with my LN worktop, I use one at the time. :( And it is not a common way to do it (for the company I work).<br />
Is this problem in all other programming languages?<br />
<br />
Thanks, psehouri. &quot;Now is better than never.&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">psehouri</div><div class="date">16th July 2009, 23:53</div></div><div class="posttext">Nice script, after headbanging with the wall to understand some things about Windows(tm) and connections, I made it run! :D<br />
The only problem I found is that it needs one configuration to connect to LN for itself. i.e. I can't use same connection with my LN worktop, I use one at the time. :( And it is not a common way to do it (for the company I work).<br />
Is this problem in all other programming languages?<br />
<br />
Thanks, psehouri. &quot;Now is better than never.&quot;<br />
<br />
You're right, I need one connection for the AFS, and another to use another AFS... on the same computer of course. It's the same using VBS or Python scripts... it's a BaaN &quot;rule&quot;...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">arthur_info</div><div class="date">28th December 2009, 20:25</div></div><div class="posttext">I'm using vb.net and my Baan version is Baan40c.68. I'm facing the same problem here, but the solution BaanObj._FlagAsMethod(&quot;Quit&quot;) doesn't work... Somebody has any other suggestion?<br />
<br />
Thanks in advance.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">matigro</div><div class="date">29th December 2009, 13:42</div></div><div class="posttext">I'm using vb.net and my Baan version is Baan40c.68. I'm facing the same problem here, but the solution BaanObj._FlagAsMethod(&quot;Quit&quot;) doesn't work.<br />
<br />
Look on first post of this thread, psehouri wrote a vb script that was working.<br />
Hello,<br />
If I use this vbscript code below to print 15L units via : tcmcs0401m000 and everything works fine.<br />
<br />
Dim SessionImpression<br />
Dim RapportImpression<br />
Dim ErrMessage1<br />
(..some code....)<br />
Set BaanObj = CreateObject(&quot;Baan4.Application.510&quot;) <br />
BaanObj.ParseExecFunction &quot;ottstpapihand&quot;, &quot;stpapi.put.field(&quot; &amp; Chr(34) &amp; SessionImpression &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; OfKey1 &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; OfKeyValue1 &amp; Chr(34) &amp; &quot;)&quot; <br />
(...more code...)<br />
BaanObj.Quit <br />
<br />
<br />
<br />
The way that close connection in VB language is BaanObj.Quit<br />
<br />
Method BaanObj._FlagAsMethod(&quot;Quit&quot;) is used in Python language to close connection.<br />
<br />
The name in CreateObject method is the name that you used when you create it in BECS (Baan Environment and Configuration Selector).<br />
ie: I have one that I called BaanV_server1 so I have something like this Set BaanObj = CreateObject(&quot;Baan4.Application.BaanV_server1&quot;)<br />
You could see this name in BECS, click in the connection/configure/Automation<br />
<br />
Hope it helps you</div></div><hr />


<div class="post"><div class="posttop"><div class="username">arthur_info</div><div class="date">29th December 2009, 18:43</div></div><div class="posttext">Yes... I've tried that but the error continues... I've created another post to collect all the 3 errors that I'm trying to solve... <br />
<br />
But thanks for all...</div></div><hr />



</div>
</body>
</html>