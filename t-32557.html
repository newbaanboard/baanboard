<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="Sales order AFS in different company, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] Sales order AFS in different company AFS/DDC/OLE: Function servers" />
	
	<title>Sales order AFS in different company [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="index.html">Newbaanboard</a> &gt; <a href="index.html">Baan SIGs</a> &gt; <a href="index.html">AFS/DDC/OLE: Function servers</a> &gt; Sales order AFS in different company</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">bahwesh.bharti</div><div class="date">12th March 2007, 14:17</div></div><div class="posttext">Hi.. <br />
we are facing problem while creating sales order in another company. The actual requirement is like say we are in company A and using some session we have to create sales order in company B. I had used AFS to create the sales order and switch.to.company() to switch between companies. But it is giving error that the &quot;session is not available&quot;.<br />
The same AFS is working fine while creating sales order in the same company (A).<br />
Need input from u ppls. It's urgent.<br />
<br />
Thanx.......<br />
Bhawesh</div></div><hr />


<div class="post"><div class="posttop"><div class="username">george7a</div><div class="date">12th March 2007, 14:20</div></div><div class="posttext">Hi,<br />
<br />
What does switch.to.company() return?<br />
<br />
From the manual:<br />
 1 Success. <br />
-1 Company not available.<br />
-2 No permission to change to this company.<br />
-3 Package combination does not correspond with new company number.<br />
-4 First day of the week does not correspond to first day of the week of original company<br />
<br />
- George</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bahwesh.bharti</div><div class="date">13th March 2007, 04:33</div></div><div class="posttext">switch.to.company returns 1.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">george7a</div><div class="date">13th March 2007, 07:51</div></div><div class="posttext">Hi,<br />
<br />
In what command do yo get the error? Can you please post your code?<br />
<br />
- George</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bahwesh.bharti</div><div class="date">13th March 2007, 12:52</div></div><div class="posttext">switch.to.company() returns 1 that is it is successful but when i use stpapi.put.field(&quot;tdsls4101m000&quot;,&quot;tdsls040.orno&quot;,str$(b.orno))<br />
and see the process i see this session (tdsls4101m000) is not opened. at<br />
ret.val = stpapi.insert(&quot;tdsls4101m000&quot;,true,err.msg)<br />
the err.msg is filled with &quot;Session not available&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">thieuf</div><div class="date">14th March 2007, 08:45</div></div><div class="posttext">Hello,<br />
<br />
a possible way to handle this is starting in the company where you want to create the sales orders and getting the information from the purchasing company. It is easy to select data from another company using standard select statements on the tables in another company. <br />
Get the information you need, put them in an array or textfile and start <br />
reading the array or textfile and inserting the sales orders.<br />
<br />
Another way is using standard EDI within Baan. The default setup from baan should enable you to make a quick and dirty setup.<br />
<br />
Third way is inserting the salesorders as quotaions in baan (directly inserting them in the quotation tables) and then generating the salesorders form the quotations.<br />
<br />
Hope this helps in any way.<br />
<br />
best regards,<br />
<br />
thieuf</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bahwesh.bharti</div><div class="date">15th March 2007, 05:14</div></div><div class="posttext">Thanx alot !!! the problem was with our setup itself.. switch.to.company() is working perfectly fine with AFS.</div></div><hr />



</div>
</body>
</html>