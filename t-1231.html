<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="Printing with vb, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] Printing with vb AFS/DDC/OLE: Function servers" />
	
	<title>Printing with vb [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="index.html">Newbaanboard</a> &gt; <a href="index.html">Baan SIGs</a> &gt; <a href="index.html">AFS/DDC/OLE: Function servers</a> &gt; Printing with vb</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">tbrault</div><div class="date">5th March 2002, 10:01</div></div><div class="posttext">:confused: <br />
Hello, I want to create a program with vb (visual basic) to run session of baan.<br />
In fact, I would want to print item datas (tiitm0401m00) by sending item code with vb. But I don't know how do this?<br />
Can you send me a code example?<br />
PS  I use the library : &quot;ottstpapihand&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">5th March 2002, 15:10</div></div><div class="posttext">I can not tell you how to run a real Baan session, but I do know that you can write a Baan function server, put that in a DLL and call that from VB.<br />
See this <br />
link (http://www.baanboard.com/baanboard/showthread.php?s=&amp;threadid=1233) for the same VB code.  Then you can search on stpapi and see most of the function server questions.<br />
<br />
Good Luck!<br />
<br />
Mark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">tbrault</div><div class="date">6th March 2002, 10:30</div></div><div class="posttext">Hi<br />
I have an another pb : I would want to print with the session &quot;tisfc0408m000&quot;. I have created a program, the compilation is ok, but I have not screen that display. Can you help me please.<br />
PS : (I have create program to print Item data and this program run normally)<br />
That's my vb program : <br />
&quot;&quot;<br />
Public Function impression_of()<br />
        '--&gt; Nouveau parametre, d√©claration---------------------------------------<br />
            '----&gt; Declaration Session<br />
        Dim SessionImpression As String<br />
        Dim RapportImpression As String<br />
        Dim ErrMessage1 As String<br />
            '---&gt; Declaration Champs<br />
        Dim OfKey1 As String<br />
        Dim OfKey2 As String<br />
        Dim DuplicataKey As String<br />
        Dim ModifieKey As String<br />
        Dim CodeImprimante As String<br />
            '----&gt; Declaration variable<br />
        Dim OfKeyValue1 As String<br />
        Dim OfKeyValue2 As String<br />
        Dim DuplicataKeyValue As String<br />
        Dim ModifieKeyValue As String<br />
        '-------------------------------------------------------------------------<br />
        '--&gt; Definition parametre-------------------------------------------------<br />
            '----&gt; Definition Session<br />
        SessionImpression = &quot;tisfc0408m000&quot;<br />
        RapportImpression = &quot;rtisfc040804000&quot;<br />
        ErrMessage1 = Space(30)<br />
            '----&gt; Definition champs<br />
        OfKey1 = &quot;pdno.f&quot;<br />
        OfKey2 = &quot;pdno.t&quot;<br />
        DuplicataKey = &quot;print.dupl&quot;<br />
        ModifieKey = &quot;print.modi&quot;<br />
        CodeImprimante = &quot;D&quot;<br />
            '----&gt; Definition variable<br />
        OfKeyValue1 = &quot;140004&quot;<br />
        OfKeyValue2 = &quot;140004&quot;<br />
        DuplicataKeyValue = &quot;1&quot;<br />
        ModifieKeyValue = &quot;1&quot;<br />
        '--------------------------------------------------------------------------<br />
        <br />
'--&gt; Programme<br />
    Set BaanObj = CreateObject(&quot;Baan4.Application&quot;)<br />
    BaanObj.ParseExecFunction &quot;ottstpapihand&quot;, &quot;stpapi.put.field(&quot; &amp; Chr(34) &amp; SessionImpression &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; OfKey1 &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; OfKeyValue1 &amp; Chr(34) &amp; &quot;)&quot;<br />
    BaanObj.ParseExecFunction &quot;ottstpapihand&quot;, &quot;stpapi.put.field(&quot; &amp; Chr(34) &amp; SessionImpression &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; OfKey2 &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; OfKeyValue2 &amp; Chr(34) &amp; &quot;)&quot;<br />
    BaanObj.ParseExecFunction &quot;ottstpapihand&quot;, &quot;stpapi.put.field(&quot; &amp; Chr(34) &amp; SessionImpression &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; DuplicataKey &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; DuplicataKeyValue &amp; Chr(34) &amp; &quot;)&quot;<br />
    BaanObj.ParseExecFunction &quot;ottstpapihand&quot;, &quot;stpapi.put.field(&quot; &amp; Chr(34) &amp; SessionImpression &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; ModifieKey &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; ModifieKeyValue &amp; Chr(34) &amp; &quot;)&quot;<br />
    BaanObj.ParseExecFunction &quot;ottstpapihand&quot;, &quot;stpapi.continue.process(&quot; &amp; Chr(34) &amp; SessionImpression &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; ErrMessage1 &amp; Chr(34) &amp; &quot;)&quot;<br />
<br />
    BaanObj.ParseExecFunction &quot;ottstpapihand&quot;, &quot;stpapi.set.report(&quot; &amp; Chr(34) &amp; SessionImpression &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; RapportImpression &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; CodeImprimante &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; ErrMessage1 &amp; Chr(34) &amp; &quot;)&quot;<br />
    BaanObj.ParseExecFunction &quot;ottstpapihand&quot;, &quot;stpapi.print.report(&quot; &amp; Chr(34) &amp; SessionImpression &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; ErrMessage1 &amp; Chr(34) &amp; &quot;)&quot;<br />
<br />
BaanObj.ParseExecFunction &quot;ottstpapihand&quot;, &quot;stpapi.end.session(&quot; &amp; Chr(34) &amp; SessionImpression &amp; Chr(34) &amp; &quot;)&quot;<br />
BaanObj.Quit<br />
End Function<br />
&quot;&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">6th March 2002, 15:23</div></div><div class="posttext">Here is what I did to get it to work.<br />
SessionImpression = &quot;tisfc0408m000&quot;<br />
| Used this report instead because my prod. order<br />
| did not have a material list.<br />
RapportImpression = &quot;rtisfc040801000&quot;<br />
ErrMessage1 = Space(30)<br />
'---&gt; Definition champs<br />
OfKey1 = &quot;pdno.f&quot;<br />
OfKey2 = &quot;pdno.t&quot;<br />
DuplicataKey = &quot;print.dupl&quot;<br />
ModifieKey = &quot;print.modi&quot;<br />
'Used the printer just to make sure.<br />
CodeImprimante = &quot;LOUIR01&quot;<br />
                                  '----&gt; Definition variable<br />
OfKeyValue1 = &quot;300100&quot;<br />
OfKeyValue2 = &quot;300100&quot;<br />
DuplicataKeyValue = &quot;1&quot;<br />
ModifieKeyValue = &quot;1&quot;<br />
Set BaanObj = CreateObject(&quot;Baan4.Application&quot;)<br />
BaanObj.ParseExecFunction &quot;ottstpapihand&quot;, &quot;stpapi.put.field(&quot; &amp; Chr(34) &amp; SessionImpression &amp; Chr(34) &amp; &quot;,&quot; _<br />
&amp; Chr(34) &amp; OfKey1 &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; OfKeyValue1 &amp; Chr(34) &amp; &quot;)&quot;<br />
BaanObj.ParseExecFunction &quot;ottstpapihand&quot;, &quot;stpapi.put.field(&quot; &amp; Chr(34) &amp; SessionImpression &amp; Chr(34) &amp; &quot;,&quot; _<br />
&amp; Chr(34) &amp; OfKey2 &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; OfKeyValue2 &amp; Chr(34) &amp; &quot;)&quot;<br />
'Commented out these lines because my session<br />
' defaults are YES to orig and yes to dup.<br />
'BaanObj.ParseExecFunction &quot;ottstpapihand&quot;, &quot;stpapi.put.field(&quot; &amp; Chr(34) &amp; SessionImpression &amp; Chr(34) &amp; &quot;,&quot; _<br />
'&amp; Chr(34) &amp; DuplicataKey &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; DuplicataKeyValue &amp; Chr(34) &amp; &quot;)&quot;<br />
'BaanObj.ParseExecFunction &quot;ottstpapihand&quot;, &quot;stpapi.put.field(&quot; &amp; Chr(34) &amp; SessionImpression &amp; Chr(34) &amp; &quot;,&quot; _<br />
'&amp; Chr(34) &amp; ModifieKey &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; ModifieKeyValue &amp; Chr(34) &amp; &quot;)&quot;<br />
' Must do set report BEFORE CONTINUE<br />
BaanObj.ParseExecFunction &quot;ottstpapihand&quot;, &quot;stpapi.set.report(&quot; &amp; Chr(34) &amp; SessionImpression &amp; Chr(34) &amp; _<br />
&quot;,&quot; &amp; Chr(34) &amp; RapportImpression &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; CodeImprimante &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; _<br />
ErrMessage1 &amp; Chr(34) &amp; &quot;)&quot;<br />
BaanObj.ParseExecFunction &quot;ottstpapihand&quot;, &quot;stpapi.continue.process(&quot; &amp; Chr(34) &amp; SessionImpression &amp; _<br />
Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; ErrMessage1 &amp; Chr(34) &amp; &quot;)&quot;<br />
' Set report not needed.<br />
'BaanObj.ParseExecFunction &quot;ottstpapihand&quot;, &quot;stpapi.print.report(&quot; &amp; Chr(34) &amp; SessionImpression &amp; Chr(34) &amp; _<br />
'   &quot;,&quot; &amp; Chr(34) &amp; ErrMessage1 &amp; Chr(34) &amp; &quot;)&quot;<br />
<br />
BaanObj.ParseExecFunction &quot;ottstpapihand&quot;, &quot;stpapi.end.session(&quot; &amp; Chr(34) &amp; SessionImpression &amp; Chr(34) _<br />
&amp; &quot;)&quot;<br />
                                  <br />
BaanObj.Quit<br />
<br />
<br />
Sorry my post is not as pretty as yours, but I was in a hurry.<br />
<br />
Mark</div></div><hr />



</div>
</body>
</html>