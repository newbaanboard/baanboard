<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="afs inserting line in ticst001, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] afs inserting line in ticst001 AFS/DDC/OLE: Function servers" />
	
	<title>afs inserting line in ticst001 [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="index.html">Newbaanboard</a> &gt; <a href="index.html">Baan SIGs</a> &gt; <a href="index.html">AFS/DDC/OLE: Function servers</a> &gt; afs inserting line in ticst001</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">jojovalenton</div><div class="date">5th May 2014, 21:59</div></div><div class="posttext">hello,<br />
<br />
pls advise why this afs is inserting to the next prod. order number not to the current prod. order inside ticst001. i debug this and all variables are reading correctly from the source espc. the pdno and pono, both modify and add works the same in this script. thanks.<br />
<br />
   |* AFS Script<br />
   stpapi.put.field(&quot;ticst0101m100&quot;,&quot;ticst001.pdno&quot;,i.pdno)<br />
   stpapi.put.field(&quot;ticst0101m100&quot;,&quot;ticst001.pono&quot;,str$(i.pono))<br />
   ret = stpapi.find(&quot;ticst0101m100&quot;,error.msg)<br />
<br />
   if ret &lt;&gt; 1 then  |not found<br />
      add = stpapi.synchronize.dialog(&quot;ticst0101m100&quot;,&quot;add&quot;,error.msg)<br />
      if add = 1 then<br />
<br />
      stpapi.put.field(&quot;ticst0101m100&quot;,&quot;ticst001.pdno&quot;,i.pdno)<br />
      stpapi.put.field(&quot;ticst0101m100&quot;,&quot;ticst001.pono&quot;,str$(i.pono))<br />
      stpapi.put.field(&quot;ticst0101m100&quot;,&quot;ticst001.sitm.segment.1&quot;,&quot;&quot;)<br />
      stpapi.put.field(&quot;ticst0101m100&quot;,&quot;ticst001.sitm.segment.2&quot;,i.sitm)<br />
      stpapi.put.field(&quot;ticst0101m100&quot;,&quot;ticst001.lsel&quot;,str$(etol(tclsel.any)))<br />
      stpapi.put.field(&quot;ticst0101m100&quot;,&quot;ticst001.qune&quot;,str$(qune.qty))<br />
      stpapi.put.field(&quot;ticst0101m100&quot;,&quot;ticst001.ques&quot;,str$(ques.qty))<br />
      stpapi.put.field(&quot;ticst0101m100&quot;,&quot;ticst001.ccur&quot;,&quot;SAR&quot;)<br />
      stpapi.put.field(&quot;ticst0101m100&quot;,&quot;ticst001.cwar&quot;,&quot;PP02&quot;)<br />
      stpapi.put.field(&quot;ticst0101m100&quot;,&quot;ticst001.cpes(1)&quot;,str$(cpes.pric))<br />
      stpapi.put.field(&quot;ticst0101m100&quot;,&quot;ticst001.qucs&quot;,&quot;0&quot;)<br />
      stpapi.put.field(&quot;ticst0101m100&quot;,&quot;ticst001.cpcs(1)&quot;,&quot;0&quot;)<br />
      stpapi.put.field(&quot;ticst0101m100&quot;,&quot;ticst001.issu&quot;,str$(i.qucs))<br />
      stpapi.put.field(&quot;ticst0101m100&quot;,&quot;ticst001.iswh&quot;,&quot;0&quot;)<br />
      stpapi.put.field(&quot;ticst0101m100&quot;,&quot;ticst001.opno&quot;,&quot;10&quot;)<br />
      stpapi.put.field(&quot;ticst0101m100&quot;,&quot;ticst001.aldt&quot;,str$(utc.num()))<br />
      stpapi.put.field(&quot;ticst0101m100&quot;,&quot;ticst001.bfls&quot;,str$(o.bfcp1))<br />
      stpapi.put.field(&quot;ticst0101m100&quot;,&quot;ticst001.drin&quot;,str$(etol(tcyesno.no)))<br />
      stpapi.put.field(&quot;ticst0101m100&quot;,&quot;ticst001.dris&quot;,str$(etol(tcyesno.yes)))<br />
      stpapi.put.field(&quot;ticst0101m100&quot;,&quot;ticst001.revn&quot;,&quot;0&quot;)<br />
      stpapi.put.field(&quot;ticst0101m100&quot;,&quot;ticst001.mcmd&quot;,str$(etol(tisfc.mcmd.print.and.alloc)))<br />
      stpapi.put.field(&quot;ticst0101m100&quot;,&quot;ticst001.preq&quot;,&quot;0.00&quot;)<br />
      stpapi.put.field(&quot;ticst0101m100&quot;,&quot;ticst001.cctt&quot;,str$(etol(ticst.updm.no.action)))<br />
      stpapi.put.field(&quot;ticst0101m100&quot;,&quot;ticst001.alty&quot;,str$(etol(tialty.input)))<br />
      stpapi.put.field(&quot;ticst0101m100&quot;,&quot;ticst001.owns&quot;,str$(etol(tcowns.comp.owned)))<br />
      stpapi.put.field(&quot;ticst0101m100&quot;,&quot;ticst001.aamt(1)&quot;,&quot;0.0000&quot;)<br />
      stpapi.put.field(&quot;ticst0101m100&quot;,&quot;ticst001.bwar&quot;,&quot;PP02&quot;) <br />
<br />
      |saving<br />
      retval = stpapi.insert(&quot;ticst0101m100&quot;, true, error.msg)<br />
      if retval = 1 then<br />
         message(&quot;save&quot;)<br />
         posting.to.orders(i.inno, i.pono, i.sitm)<br />
      else<br />
         message(error.msg)<br />
      endif<br />
      endif<br />
   endif<br />
   stpapi.end.session(&quot;ticst0101m100&quot;)<br />
}<br />
<br />
regards,<br />
<br />
jojo</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">5th May 2014, 23:22</div></div><div class="posttext">Are you saying if you do stpapi.update and stpapi.insert, both work against the next production order?  If you can insert I would not expect to need a find at all.  But if something already exists then I would expect to see an stpapi.update.  I would also not expect to see the production number and position as part of the input.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jojovalenton</div><div class="date">6th May 2014, 08:24</div></div><div class="posttext">hi mark,<br />
<br />
thanks for reply. i will take note of your comments but is there any way that i can mark the line and copy or duplicate it and then put my values and save? <br />
<br />
regards,<br />
<br />
jojo</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bhushanchanda</div><div class="date">6th May 2014, 11:19</div></div><div class="posttext">Hi,<br />
<br />
When you see the session, the Production Order no is a view field. So, before inserting or modifying. You have to change the view.<br />
Try this piece of code:-<br />
<br />
stpapi.put.field( &quot;ticst0101m100&quot;, &quot;ticst001.pdno&quot;, tigil002.pdno)<br />
	ret = stpapi.change.view( &quot;ticst0101m100&quot;,  error )<br />
	stpapi.put.field( &quot;ticst0101m100&quot;, &quot;ticst001.pono&quot;, str$(tigil000.pono) )<br />
	ret =  stpapi.find( &quot;ticst0101m100&quot; , err  )<br />
	if ret = 1 then<br />
		ret =  stpapi.mark( &quot;ticst0101m100&quot; , err  )<br />
		ret = stpapi.synchronize.dialog(&quot;ticst0101m100&quot;, &quot;modify&quot;, err.msg) <br />
		stpapi.put.field( &quot;ticst0101m100&quot;, &quot;ticst001.issu&quot;, str$(tigil005.issu) )<br />
		stpapi.put.field( &quot;ticst0101m100&quot;, &quot;ticst001.dris&quot;, str$(1) )		<br />
		ret = stpapi.update( &quot;ticst0101m100&quot;, TRUE, err ) <br />
		if ret = 1 and isspace(error) then<br />
			stpapi.save( &quot;ticst0101m100&quot;, err ) <br />
		else<br />
			stpapi.recover( &quot;ticst0101m100&quot;, err ) <br />
		endif<br />
	endif<br />
	<br />
	stpapi.end.session( &quot;ticst0101m100&quot; , err  )<br />
	stpapi.end.session( &quot;ticst0101m100&quot; , errr1  )</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jojovalenton</div><div class="date">6th May 2014, 13:33</div></div><div class="posttext">thanks mark &amp; bhushan.  now it's ok and inserting in the right order.<br />
<br />
regards,<br />
<br />
jojo</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bhushanchanda</div><div class="date">6th May 2014, 13:37</div></div><div class="posttext">Hi,<br />
<br />
If possible please post your code so that it will help people facing similar issues.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jojovalenton</div><div class="date">7th May 2014, 14:31</div></div><div class="posttext">I only used the same codes i posted above, i noticed only that my i.pono is reading from the wrong source that is why its inserting to diff prod. order.<br />
<br />
thanks,<br />
<br />
jojo</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DDPatel</div><div class="date">5th June 2021, 10:21</div></div><div class="posttext">Hi,<br />
<br />
When you see the session, the Production Order no is a view field. So, before inserting or modifying. You have to change the view.<br />
Try this piece of code:-<br />
<br />
stpapi.put.field( &quot;ticst0101m100&quot;, &quot;ticst001.pdno&quot;, tigil002.pdno)<br />
	ret = stpapi.change.view( &quot;ticst0101m100&quot;,  error )<br />
	stpapi.put.field( &quot;ticst0101m100&quot;, &quot;ticst001.pono&quot;, str$(tigil000.pono) )<br />
	ret =  stpapi.find( &quot;ticst0101m100&quot; , err  )<br />
	if ret = 1 then<br />
		ret =  stpapi.mark( &quot;ticst0101m100&quot; , err  )<br />
		ret = stpapi.synchronize.dialog(&quot;ticst0101m100&quot;, &quot;modify&quot;, err.msg) <br />
		stpapi.put.field( &quot;ticst0101m100&quot;, &quot;ticst001.issu&quot;, str$(tigil005.issu) )<br />
		stpapi.put.field( &quot;ticst0101m100&quot;, &quot;ticst001.dris&quot;, str$(1) )		<br />
		ret = stpapi.update( &quot;ticst0101m100&quot;, TRUE, err ) <br />
		if ret = 1 and isspace(error) then<br />
			stpapi.save( &quot;ticst0101m100&quot;, err ) <br />
		else<br />
			stpapi.recover( &quot;ticst0101m100&quot;, err ) <br />
		endif<br />
	endif<br />
	<br />
	stpapi.end.session( &quot;ticst0101m100&quot; , err  )<br />
	stpapi.end.session( &quot;ticst0101m100&quot; , errr1  )<br />
<br />
<br />
<br />
Dear sir,<br />
<br />
I have same script for AFS to update &quot;ticst0101m100&quot;, Data is updating but i want to do 1 extra step, That is &quot;Initiate inventory issue&quot; (Form command - 'initiate.inventory').<br />
<br />
	long ret<br />
	string error(200)<br />
	<br />
	stpapi.put.field(&quot;ticst0101m100&quot;,&quot;ticst001.pdno&quot;,ticsl051.pdno)<br />
	stpapi.put.field(&quot;ticst0101m100&quot;,&quot;ticst001.opno&quot;,&quot;10&quot;)<br />
	<br />
	ret = stpapi.find(&quot;ticst0101m100&quot;,error)<br />
	if ret = 1 then<br />
		ret = stpapi.mark(&quot;ticst0101m100&quot;,error)<br />
		if ret = 1 then<br />
			ret = stpapi.synchronize.dialog(&quot;ticst0101m100&quot;, &quot;modify&quot;, error)<br />
			if ret = 1 then<br />
				stpapi.put.field(&quot;ticst0101m100&quot;,&quot;ticst001.issu&quot;,str$(ticsl051.prqt))<br />
				stpapi.put.field(&quot;ticst0101m100&quot;,&quot;ticst001.lsel&quot;,str$(3)) |tclsel.specific<br />
				stpapi.put.field(&quot;ticst0101m100&quot;,&quot;ticst001.clot&quot;,ticsl051.ilot)<br />
				ret = stpapi.update(&quot;ticst0101m100&quot;, true, error)<br />
				if ret = 1 then<br />
					stpapi.form.command(&quot;ticst0101m100&quot;, 5, &quot;initiate.inventory&quot;, error)<br />
					stpapi.set.report(&quot;ticst0101m100&quot;, &quot;tisfc020701000&quot;, &quot;D&quot;, error)<br />
						if isspace(error) then<br />
							|stpapi.print.report(&quot;ticst0101m100&quot;, error)<br />
							stpapi.continue.process(&quot;ticst0101m100&quot;, error)<br />
						endif<br />
				else<br />
					stpapi.recover(&quot;ticst0101m100&quot;,error)<br />
				endif<br />
			endif<br />
		endif<br />
	endif<br />
	stpapi.end.session(&quot;ticst0101m100&quot;)<br />
<br />
<br />
Code is working good till &quot;stpapi.update&quot; statement. But after that how can i hit &quot;Initiate inventory issue&quot; option? i tried &quot;stpapi.print.report&quot; and &quot;stpapi.continue.process&quot; statement but no luck.<br />
<br />
<br />
Regards,<br />
DDPatel</div></div><hr />



</div>
</body>
</html>