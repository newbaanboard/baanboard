<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="Check client directory, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] Check client directory Tools Development" />
	
	<title>Check client directory [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="../index.html">Newbaanboard</a> &gt; <a href="../index.html">Baan Quick Support: Functional &amp; Technical</a> &gt; <a href="../index.html">Tools Development</a> &gt; Check client directory</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">PeterH</div><div class="date">11th October 2002, 10:31</div></div><div class="posttext">BEfore using the function server2client or client2server we want to check if the directories exist on both systems. For the unix server the function stat.info is used and works correctly but for the client (windows 2000) the functions stat.info() and dir.open() doesn't give any response, only that the directory doesn't exist. <br />
Even if the windows directory exists.<br />
<br />
These function can be used within the program or report scripts. We are developing a session so a baan user can copy files between unix (server) and windows(client).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Natasha</div><div class="date">11th October 2002, 10:38</div></div><div class="posttext">When user started bw.exe,  the current directiry Windows is ..\Program Files\Baan\Bin.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">NPRao</div><div class="date">11th October 2002, 10:52</div></div><div class="posttext">You can use -<br />
<br />
http://www.baanboard.com/programmers_manual_baanerp_help_functions_client_file_access_create_local_directory <br />
<br />
More Info -<br />
<br />
<br />
FunctionUsage<br />
Expl.:	- This function creates a directory on the client <br />
Post:	- The directory &quot;client.dir&quot; is created on the client<br />
Input:	- client.dir -&gt; the name and path of the directory<br />
Return:	- 0 	| succeed<br />
	  183 	| directory already exists<br />
	  &lt;&gt; 0 	| failure<br />
	  70  Permission is denied.<br />
	  380  Invalid property value.<br />
	  382  Property is read-only at run time.<br />
	  383  Property is read-only.<br />
	  394  Property is write-only.<br />
EndFunctionUsage<br />
<br />
<br />
Remember, to put the code in your script -<br />
<br />
#pragma used dll ottdllbw</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Ilansu</div><div class="date">17th October 2002, 18:48</div></div><div class="posttext">NPRao Hi.<br />
<br />
I'm trying to use this function to check if a directory exist :<br />
<br />
<br />
function check.if.dir.exist()<br />
{<br />
long		ret<br />
ret=create.local.directory(file.name)<br />
if ret=0 then<br />
	message(&quot;INVALID DIRECTORY  NAME  !&quot;)<br />
	remove.local.directory(file.name)<br />
endif<br />
<br />
}<br />
<br />
but i get an error :Function 'create.local.directory' returns no value<br />
<br />
when i use the create.local.directory(file.name) without a return value the directory is created.<br />
<br />
any idea ?<br />
<br />
I'm using Baan 4c4 on Unix.<br />
<br />
Thanks <br />
Ilan S</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">17th October 2002, 20:15</div></div><div class="posttext">Ilan,<br />
<br />
I did a bic_info6.1 on ottdllbw and on our 4c3 system the function create.local.directory is declared as just extern.  No return code.  It may be the same on 4c4 and what NPR was talking about was Baan 5.  <br />
<br />
Here is what the bic_info returned:<br />
function extern create.local.directory(<br />
         string dirent(256) )<br />
so this may not work for you and I do not know of a way to check it.<br />
<br />
Mark</div></div><hr />



</div>
</body>
</html>