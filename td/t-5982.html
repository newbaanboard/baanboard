<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="Can not save data..., baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] Can not save data... Tools Development" />
	
	<title>Can not save data... [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="../index.html">Newbaanboard</a> &gt; <a href="../index.html">Baan Quick Support: Functional &amp; Technical</a> &gt; <a href="../index.html">Tools Development</a> &gt; Can not save data...</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">psehouri</div><div class="date">29th July 2002, 12:20</div></div><div class="posttext">Hello,<br />
I have the following problems : <br />
<br />
1°) I launch a sub session (type 3) andI do a change.view.<br />
It replies me that another view found...<br />
<br />
When I make a get fields, it gives me the good record....<br />
<br />
2°) When I put fields, and save, there is a cancel command... and data is not save.<br />
<br />
AFS.LOG : <br />
<br />
LOGGING STARTED<br />
29/07/2002<br />
3-&gt;get.fields<br />
3&lt;-get.fields...<br />
&gt;pspmg0202m000 put.field:pspmg001.orno 39752<br />
&gt;pspmg0202m000 Find<br />
3-&gt;def.find<br />
3&lt;-def.find01<br />
&lt;pspmg0202m000 record found (1)<br />
&gt;pspmg0202m000 put.field:comp.batch.frm tcyesno.yes<br />
&gt;pspmg0202m000 put.field:cmdt.frm 29072002<br />
&gt;pspmg0202m000 handle.subproc tdilc4113s000 add<br />
&gt;pspmg0202m000 continue.process<br />
3-&gt;cont.process<br />
5&lt;-api.child.startedtdilc4113s0003<br />
5-&gt;get.fields<br />
5&lt;-get.fields...<br />
&lt;pspmg0202m000 <br />
&gt;tdilc4113s000 change.view<br />
5-&gt;start.set<br />
5&lt;-start.set<br />
&lt;tdilc4113s000 2 another view found<br />
&gt;tdilc4113s000 put.field:tdilc402.qstr 100<br />
&gt;tdilc4113s000 put.field:tdilc402.orno 100<br />
&gt;tdilc4113s000 save<br />
5-&gt;update.db<br />
5&lt;-update.db<br />
&lt;tdilc4113s000 <br />
&gt;tdilc4113s000 end.session<br />
5-&gt;end.program<br />
5&lt;-end.program1Command cancelled<br />
&gt;pspmg0202m000 end.session<br />
3-&gt;end.program<br />
3&lt;-cont.process<br />
3&lt;-end.program1</div></div><hr />


<div class="post"><div class="posttop"><div class="username">klesch</div><div class="date">29th July 2002, 14:31</div></div><div class="posttext">Can you post a code wich you use to do that, too?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">psehouri</div><div class="date">29th July 2002, 14:58</div></div><div class="posttext">Yes, of course, here's the code...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">klesch</div><div class="date">29th July 2002, 15:04</div></div><div class="posttext">I did not realize that this is a VB code. I'm sorry, but I'm not able to help you, because I'm not familiar to VB.<br />
<br />
Maybe, somebody else will know what the problem is.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">29th July 2002, 22:39</div></div><div class="posttext">Since I am not and work and can not see the session I can only make a few guesses.  Is there more than one key field on the session?  By this I mean if you went to the sub-session and did a find does it require more than one field? If yes then try to put those fields also.  If not that then you may want to try setting the view first.  Can't really tell since I am not familiar with the session.  Will check when I get to work tomorrow.<br />
<br />
Good Luck!<br />
<br />
Mark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">psehouri</div><div class="date">30th July 2002, 10:41</div></div><div class="posttext">Yes, there's 5 fields for the index. Just before doing the Change.View, I make a Put... But, it is still the same...<br />
<br />
<br />
What do you mean by setting the view first ???<br />
<br />
Thank's for the time you take to make responses...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">30th July 2002, 17:00</div></div><div class="posttext">Since I am not familiar with the form, I was thinking that maybe putting the five fields then doing a stpapi.change.view on the form. And then checking the return value to see if it found a view.  This is usually done on a multi-occurance form.<br />
<br />
Also I have never called a sub-session this way. I always use the main session and let it zoom or call the sub-sessions.  I know others have used this method successfully.<br />
<br />
<br />
Mark</div></div><hr />



</div>
</body>
</html>