<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="Want to create an File which opens into Excel Perfectly, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] Want to create an File which opens into Excel Perfectly Tools Development" />
	
	<title>Want to create an File which opens into Excel Perfectly [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="../index.html">Newbaanboard</a> &gt; <a href="../index.html">Baan Quick Support: Functional &amp; Technical</a> &gt; <a href="../index.html">Tools Development</a> &gt; Want to create an File which opens into Excel Perfectly</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">Ajesh</div><div class="date">18th August 2016, 16:27</div></div><div class="posttext">Hello Baaners<br />
<br />
I have created an ASCII File with the Headings and Details and i want it to be formatted such that it opens in Excel perfectly, i.e, Each Columns comes as speperately as intended.<br />
<br />
So i created a &quot;tab&quot; in the Headers and in details and put it in an ASCII File using seq.open. Now i copied onto the Client using the command server2client and saved it as &quot;.xlsx&quot; file format. Now when the Excel opens it, i get a message <br />
&quot;File extension or the format is not valid. Verify the file is not corrupted and so on&quot;<br />
<br />
But when i save the file as &quot;.xls&quot;, the Excel opens it more or less perfectly. I need to save it in &quot;.xlsx&quot; format as it is the latest one.<br />
<br />
Also, i need to make the Header Bold..<br />
<br />
PS: If you have used Mingle, there is an option which says, export to excel and it exports very beautifully. Was thinking if this could be replicated or if it is already there.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bhushanchanda</div><div class="date">18th August 2016, 17:14</div></div><div class="posttext">Hi,<br />
<br />
There are many ways to achieve that but with a bit coding and customizations- &gt;<br />
<br />
This shows a way to do it with creating an XML file with Excel supporting tags (http://www.baanboard.com/baanboard/showthread.php?t=42287)<br />
<br />
This shows a way to do it with Open XML  (http://www.baanboard.com/node/3819)<br />
<br />
Other ways are -&gt;<br />
<br />
1. Create a script in any programming you want to convert CSV to Excel.<br />
2. Use external reporting tool<br />
3. Create HTML file with &lt;td&gt; and &lt;tr&gt; tags and rename it as .xls (Again, it will show a pop up warning but it will eventually open up with the formatting and styling you need)<br />
<br />
Output to Excel utility uses a Java Program to perform the export using dll ttstpdllssi. Not sure if you can use it but if you can hack out its usage using ttstpbaandoc, you might be able to reuse it in your program.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Ajesh</div><div class="date">22nd August 2016, 09:27</div></div><div class="posttext">Any links for learning about Open XML standards?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bhushanchanda</div><div class="date">22nd August 2016, 09:51</div></div><div class="posttext">You can start here (http://openxmldeveloper.org/)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Ajesh</div><div class="date">22nd August 2016, 10:08</div></div><div class="posttext">So how it works exactly? If i code it in Open XML, Excel reads it as xlsx file? and converts all the formatting like the Colour,Bold etc perfectly?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Ajesh</div><div class="date">24th August 2016, 14:49</div></div><div class="posttext">Okay Then..<br />
<br />
I have converted it to xml file and then opening into Excel. Have one last hurdle. While opening the xls file, the Excel says &quot;The Data may be corrupt&quot;.Are you sure you want to open the file?&quot;<br />
<br />
I think to skip this one thing and i will accomplish this Topic. What can i add into the &quot;xml&quot; file so that i dont get to see this warning?<br />
<br />
PS: Apart from the Reg Edit Solution. Thats not practical,i.e,going to Client side and doing reg Edit in Mass.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bhushanchanda</div><div class="date">24th August 2016, 17:10</div></div><div class="posttext">Hi,<br />
<br />
Check if this workbook opens up without any issues. If yes, build one with this standard.<br />
<br />
&lt;?xml version=&quot;1.0&quot;?&gt;<br />
&lt;?mso-application progid=&quot;Excel.Sheet&quot;?&gt; <br />
&lt;Workbook xmlns=&quot;urn:schemas-microsoft-com:office:spreadsheet&quot;<br />
        xmlns:o=&quot;urn:schemas-microsoft-com:office:office&quot;<br />
        xmlns:x=&quot;urn:schemas-microsoft-com:office:excel&quot;<br />
        xmlns:ss=&quot;urn:schemas-microsoft-com:office:spreadsheet&quot;<br />
        xmlns:html=&quot;http://www.w3.org/TR/REC-html40&quot;&gt;<br />
&lt;DocumentProperties xmlns=&quot;urn:schemas-microsoft-com:office:office&quot;&gt;<br />
      &lt;Author&gt;Your_name_here&lt;/Author&gt;<br />
      &lt;LastAuthor&gt;Your_name_here&lt;/LastAuthor&gt;<br />
      &lt;Created&gt;20080625&lt;/Created&gt;<br />
      &lt;Company&gt;ABC Inc&lt;/Company&gt;<br />
      &lt;Version&gt;10.2625&lt;/Version&gt;<br />
&lt;/DocumentProperties&gt;<br />
&lt;ExcelWorkbook xmlns=&quot;urn:schemas-microsoft-com:office:excel&quot;&gt;<br />
        &lt;WindowHeight&gt;6135&lt;/WindowHeight&gt;<br />
        &lt;WindowWidth&gt;8445&lt;/WindowWidth&gt;<br />
        &lt;WindowTopX&gt;240&lt;/WindowTopX&gt;<br />
        &lt;WindowTopY&gt;120&lt;/WindowTopY&gt;<br />
        &lt;ProtectStructure&gt;False&lt;/ProtectStructure&gt;<br />
        &lt;ProtectWindows&gt;False&lt;/ProtectWindows&gt;<br />
&lt;/ExcelWorkbook&gt;<br />
<br />
&lt;Styles&gt;<br />
      &lt;Style ss:ID=&quot;Default&quot; ss:Name=&quot;Normal&quot;&gt;<br />
            &lt;Alignment ss:Vertical=&quot;Bottom&quot; /&gt;<br />
            &lt;Borders /&gt;<br />
            &lt;Font /&gt;<br />
            &lt;Interior /&gt;<br />
            &lt;NumberFormat /&gt;<br />
            &lt;Protection /&gt;<br />
      &lt;/Style&gt;<br />
&lt;/Styles&gt;<br />
<br />
&lt;Worksheet ss:Name=&quot;Sample Sheet 1&quot;&gt;<br />
&lt;Table ss:ExpandedColumnCount=&quot;2&quot; x:FullColumns=&quot;1&quot; x:FullRows=&quot;1&quot; ID=&quot;Table1&quot;&gt;<br />
&lt;Column ss:Width=&quot;150&quot; /&gt;<br />
&lt;Column ss:Width=&quot;200&quot; /&gt;<br />
&lt;Row&gt;<br />
      &lt;Cell&gt;&lt;Data ss:Type=&quot;Number&quot;&gt;1&lt;/Data&gt;&lt;/Cell&gt;<br />
      &lt;Cell&gt;&lt;Data ss:Type=&quot;Number&quot;&gt;2&lt;/Data&gt;&lt;/Cell&gt;<br />
&lt;/Row&gt;<br />
&lt;Row&gt;<br />
      &lt;Cell&gt;&lt;Data ss:Type=&quot;Number&quot;&gt;3&lt;/Data&gt;&lt;/Cell&gt;<br />
      &lt;Cell&gt;&lt;Data ss:Type=&quot;Number&quot;&gt;4&lt;/Data&gt;&lt;/Cell&gt;<br />
&lt;/Row&gt;<br />
&lt;Row&gt;<br />
      &lt;Cell&gt;&lt;Data ss:Type=&quot;Number&quot;&gt;5&lt;/Data&gt;&lt;/Cell&gt;<br />
      &lt;Cell&gt;&lt;Data ss:Type=&quot;Number&quot;&gt;6&lt;/Data&gt;&lt;/Cell&gt;<br />
&lt;/Row&gt;<br />
&lt;Row&gt;<br />
      &lt;Cell&gt;&lt;Data ss:Type=&quot;Number&quot;&gt;7&lt;/Data&gt;&lt;/Cell&gt;<br />
      &lt;Cell&gt;&lt;Data ss:Type=&quot;Number&quot;&gt;8&lt;/Data&gt;&lt;/Cell&gt;<br />
&lt;/Row&gt;<br />
&lt;/Table&gt;<br />
&lt;/Worksheet&gt;<br />
<br />
&lt;Worksheet ss:Name=&quot;Sample Sheet 2&quot;&gt;<br />
&lt;Table ss:ExpandedColumnCount=&quot;2&quot; x:FullColumns=&quot;1&quot; x:FullRows=&quot;1&quot; ID=&quot;Table2&quot;&gt;<br />
&lt;Column ss:Width=&quot;150&quot; /&gt;<br />
&lt;Column ss:Width=&quot;200&quot; /&gt;<br />
&lt;Row&gt;<br />
      &lt;Cell&gt;&lt;Data ss:Type=&quot;String&quot;&gt;A&lt;/Data&gt;&lt;/Cell&gt;<br />
      &lt;Cell&gt;&lt;Data ss:Type=&quot;String&quot;&gt;B&lt;/Data&gt;&lt;/Cell&gt;<br />
&lt;/Row&gt;<br />
&lt;Row&gt;<br />
      &lt;Cell&gt;&lt;Data ss:Type=&quot;String&quot;&gt;C&lt;/Data&gt;&lt;/Cell&gt;<br />
      &lt;Cell&gt;&lt;Data ss:Type=&quot;String&quot;&gt;D&lt;/Data&gt;&lt;/Cell&gt;<br />
&lt;/Row&gt;<br />
&lt;Row&gt;<br />
      &lt;Cell&gt;&lt;Data ss:Type=&quot;String&quot;&gt;E&lt;/Data&gt;&lt;/Cell&gt;<br />
      &lt;Cell&gt;&lt;Data ss:Type=&quot;String&quot;&gt;F&lt;/Data&gt;&lt;/Cell&gt;<br />
&lt;/Row&gt;<br />
&lt;Row&gt;<br />
      &lt;Cell&gt;&lt;Data ss:Type=&quot;String&quot;&gt;G&lt;/Data&gt;&lt;/Cell&gt;<br />
      &lt;Cell&gt;&lt;Data ss:Type=&quot;String&quot;&gt;H&lt;/Data&gt;&lt;/Cell&gt;<br />
&lt;/Row&gt;<br />
&lt;/Table&gt;<br />
&lt;/Worksheet&gt;<br />
&lt;/Workbook&gt;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Ajesh</div><div class="date">25th August 2016, 08:01</div></div><div class="posttext">No it does not. Same Issue. If i name it as xml file it opens perfectly but if i name it as xls or xlsx, i get the warning message...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bhushanchanda</div><div class="date">25th August 2016, 08:40</div></div><div class="posttext">Hi,<br />
<br />
Its a result of feature called Extension Hardening which was introduced in Office 2007 onwards. You might try it on Office 14 where it will work just fine or an older version of Office 2003. I don't see a problem if you just use .xml extension either as its an XML based worksheet. It will save you from handling delimiter issues while working on global reports. <br />
<br />
Other solutions are -&gt;<br />
<br />
1. Modifying the registries on each client machine<br />
2. Creating your own utility in any other programming which does the excel writing for you<br />
3. Using alternatives like OpenOffice where the problem doesn't exists<br />
4. Upgrade to some later version or downgrade to office 2003</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Ajesh</div><div class="date">25th August 2016, 10:27</div></div><div class="posttext">Creating the utility seems the best option. Calling it from script and converting into xlsx..<br />
Now how do i create it?:)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bhushanchanda</div><div class="date">25th August 2016, 11:53</div></div><div class="posttext">If you know Java, do what Infor does. Use Apache POI (https://poi.apache.org/)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Ajesh</div><div class="date">25th August 2016, 16:01</div></div><div class="posttext">What about transforming using XSLT? fr</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bhushanchanda</div><div class="date">25th August 2016, 19:47</div></div><div class="posttext">Its one way, but will take a lot of coding and brainstorming. I would prefer java/python over it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Ajesh</div><div class="date">29th August 2016, 09:55</div></div><div class="posttext">An xlsx file is usually a bunch of around 10 files zipped... What you do in Java exactly? You make all the files?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bhushanchanda</div><div class="date">29th August 2016, 10:22</div></div><div class="posttext">Hi,<br />
<br />
You wont need to do that. The language you use will do it for you. For example, you can use Xslx Writer library in Python to do it. Here is the link with all sorts of examples -&gt; http://xlsxwriter.readthedocs.io/examples.html<br />
<br />
Or you can use Java based apache poi XSSF library. Google it and you will get tons of ways to do it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Ajesh</div><div class="date">29th August 2016, 13:40</div></div><div class="posttext">So in your first post in this thread, you gave the link to Open XML format, So does that piece of program directly write the file in xlsx format??</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bhushanchanda</div><div class="date">29th August 2016, 14:36</div></div><div class="posttext">Hi,<br />
<br />
No, I don't think so. It was an example for writing an excel file(.xls) with the styling if required(in your case I guess you wanted to make the fonts Bold). XSLX is not possible without any utility as you can't build it from scratch unless you go with writing a code to create the supporting files and zip them which is too tedious of a task.<br />
<br />
But again, why don't you just go with .xls if its giving you the required styling and formatting? I guess users should be okay with that. And if they aren't you would need to build the utility of your own as I pointed out earlier.</div></div><hr />



</div>
</body>
</html>