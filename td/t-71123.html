<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="select last records, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] select last records Tools Development" />
	
	<title>select last records [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="../index.html">Newbaanboard</a> &gt; <a href="../index.html">Baan Quick Support: Functional &amp; Technical</a> &gt; <a href="../index.html">Tools Development</a> &gt; select last records</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">Svidos29</div><div class="date">2nd June 2018, 11:43</div></div><div class="posttext">Hello,<br />
<br />
i've a little problem that i don't know how to manage. <br />
<br />
The problem is: I'm selecting a table in order DESC, with some conditions, i've to check if the record that i have selected has 0 sum (of a field in another table that i'm selecting in the selectdo). Here, there are some possibilities: <br />
1) if there is another record after this, it means that it can take the values of this (previous) record; <br />
2) if there are no previous records, it has to take the values for the unique current record that is selected;<br />
3) if the sum is not 0, it has to take the values of the current record;<br />
<br />
I hope i explained myself<br />
<br />
If i can help i would attach the current code that i built, that doesn't work for the condition number 2.<br />
<br />
Thanks, in advance</div></div><hr />


<div class="post"><div class="posttop"><div class="username">giggty</div><div class="date">4th June 2018, 14:27</div></div><div class="posttext">Please post your code to make your problem (hopefully) less vague :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Svidos29</div><div class="date">4th June 2018, 19:17</div></div><div class="posttext">hi,<br />
<br />
here the code:<br />
<br />
                select	tctax100.*<br />
		from	tctax100					<br />
		where	tctax100.otof = :cisli220.pfbp<br />
		order by tctax100._index4 desc							<br />
		selectdo<br />
			select 	tctax910.nreg, tctax910.bpid<br />
			from	tctax910<br />
			selectdo<br />
				select	sum(tctax910.amnt):tmp.amnt<br />
				from	tctax910<br />
				where	tctax910.nreg = :tctax100.nreg.c   <br />
				and 	tctax910.bpid = :tctax100.otof<br />
				selectdo<br />
                                         return<br />
                                selectempty<br />
                                          break<br />
                                endselect</div></div><hr />


<div class="post"><div class="posttop"><div class="username">giggty</div><div class="date">6th June 2018, 11:03</div></div><div class="posttext">Sorry, but It is still not clear to me :)<br />
Let me recap:<br />
1. You want to get a rowset of tctax100. (What for? Are you building a report?)<br />
2. For the first row you want to get this first row.<br />
3. For rows from number 2 to the last one you want the previous one instead (i. e. instead of 2nd you want 1st and for the last one you want the penultimate - so you have 2 identical first rows?)<br />
4. 3 stays valid unless select sum(tctax910.amnt) for the current row is not 0 - then you want the current row.<br />
Is that 100% correct?</div></div><hr />



</div>
</body>
</html>