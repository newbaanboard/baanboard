<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="Call DLL fucntion in Program Script, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] Call DLL fucntion in Program Script Tools Development" />
	
	<title>Call DLL fucntion in Program Script [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="../index.html">Newbaanboard</a> &gt; <a href="../index.html">Baan Quick Support: Functional &amp; Technical</a> &gt; <a href="../index.html">Tools Development</a> &gt; Call DLL fucntion in Program Script</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">layswan</div><div class="date">8th October 2012, 04:51</div></div><div class="posttext">Hi,<br />
<br />
Anyone know how to call a DLL function in normal program script?<br />
<br />
Below was the code that I used to call the DLL but i m getting value of 0 for func_id which mean function not found.<br />
<br />
dll_id = load_dll(&quot;ocxswn1100&quot;)<br />
<br />
	message(&quot;%s&quot;, dll_id)<br />
<br />
	if dll_id then<br />
		<br />
		func_id = get_function(dll_id, &quot;cxwsn1100.whint.dlltdpur.get.buy.from.and.invoice.from.bp&quot;)<br />
<br />
		message(&quot;%s&quot;, func_id)<br />
<br />
		if func_id then<br />
<br />
			message(&quot;A&quot;)<br />
		endif<br />
	endif<br />
<br />
<br />
Thanks!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">vahdani</div><div class="date">8th October 2012, 11:49</div></div><div class="posttext">Hi,<br />
<br />
two questions:<br />
<br />
<br />
 Is cxswn1100 really a DLL? By convention DLLs are named like cxswndll1100.<br />
 Is &quot;cxwsn1100.whint.dlltdpur.get.buy.from.and.invoice.from.bp&quot; an external  function in cxswn1100 DLL?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bdittmar</div><div class="date">8th October 2012, 11:54</div></div><div class="posttext">Hi,<br />
<br />
Anyone know how to call a DLL function in normal program script?<br />
<br />
Below was the code that I used to call the DLL but i m getting value of 0 for func_id which mean function not found.<br />
<br />
dll_id = load_dll(&quot;ocxswn1100&quot;)<br />
<br />
	message(&quot;%s&quot;, dll_id)<br />
<br />
	if dll_id then<br />
		<br />
		func_id = get_function(dll_id, &quot;cxwsn1100.whint.dlltdpur.get.buy.from.and.invoice.from.bp&quot;)<br />
<br />
		message(&quot;%s&quot;, func_id)<br />
<br />
		if func_id then<br />
<br />
			message(&quot;A&quot;)<br />
		endif<br />
	endif<br />
<br />
<br />
Thanks!<br />
<br />
Hello,<br />
<br />
is #pragma .... used in declariation ?<br />
<br />
#pragma used dll ocxwsn1100<br />
<br />
and as vahdani suggest, is it realy a dll ?<br />
<br />
Regards</div></div><hr />


<div class="post"><div class="posttop"><div class="username">vahdani</div><div class="date">8th October 2012, 12:18</div></div><div class="posttext">An After thought:<br />
<br />
The functions load_dll(), get_function() and exec_function() are used when the DLL is not fixed or known at compile time. This is called Dynamic DLL loading. This technic is used for example in EDI where each EDI message type has its own processing DLL. Each DLL has then the same external function names with different function bodies/implementations.<br />
<br />
If the DLL is known at compile time (as in 99% of programming cases) then you should do the following:<br />
<br />
First make the DLL known to the compiler either by entering the DLL code in &quot;libraries&quot; in &quot;Maintain scripts&quot;-program or use pragma used dll in script like:<br />
<br />
#pragma used dll otdslsdll1234<br />
<br />
... and then in your script simply call an external function in the DLL such as:<br />
<br />
    ret.val = otdslsdll1234.some.function(param1, param2,..)</div></div><hr />



</div>
</body>
</html>