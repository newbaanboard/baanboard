<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="Advanced programming., baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] Advanced programming. Tools Development" />
	
	<title>Advanced programming. [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="../index.html">Newbaanboard</a> &gt; <a href="../index.html">Baan Quick Support: Functional &amp; Technical</a> &gt; <a href="../index.html">Tools Development</a> &gt; Advanced programming.</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">dbinderbr</div><div class="date">16th September 2002, 18:08</div></div><div class="posttext">Hello there,<br />
<br />
I am trying to do some unusual programming, but I believe it's possible to do it in tools like I did in another languages.<br />
<br />
I intend to take some actions at run-time according to some information and parameters passed by the user.<br />
<br />
I'd like to know, for example, if it's possible to declare a variable at run-time or to attribute a value to a table field.<br />
<br />
I will try to explain better bellow.<br />
<br />
Suppose I can choose any table in the form and write some data to it. For example, I chose the tiitm001 and would like to insert the item &quot;000009&quot;.<br />
<br />
Using dynamic SQL I could check if the record already exist and do other operations, but, how could I attribute a value to the table field tiitm001.item? Note, until run-time I didnt know which table or field I would treat, so I have to write the instruction table.field = some.value at run-time using the data entered in the form.<br />
<br />
Using the variable with the name of the table entered in the form by the user I would be able to take the field names in the ttadv422, but how could I represent this kind of things in the script,<br />
<br />
any.table.field.from.ttadv422 = any.data<br />
<br />
Is it possible to do it in Baan Tools?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Guillaume.G</div><div class="date">16th September 2002, 18:44</div></div><div class="posttext">It's possible With the AFS Technologie. I make the same developpement what you want.<br />
<br />
But with AFS, it's not possible to use the table name but the session which maintain the table (for example tiitm0101m000 for tiitm001)<br />
And it's only possible to update the input field which in the form of the session<br />
<br />
And the AFS ''simulate&quot; the standard session.<br />
<br />
You can see a copy of form in attach file.<br />
<br />
I think it's very good, because the fonctionnal intigrity of the data is ok because the program of the session is executed.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dbinderbr</div><div class="date">16th September 2002, 19:45</div></div><div class="posttext">Thanks Guillaume !!<br />
<br />
Can you tell me where I can find documents about AFS technology or just a simple example?<br />
<br />
Thanks a lot.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">NPRao</div><div class="date">16th September 2002, 20:24</div></div><div class="posttext">Daniel,<br />
<br />
You have 2 options -<br />
<br />
1. Use AFS as Guillaume suggested. There is a separate section with examples and documents in the forum. Please refer and search at -<br />
<br />
AFS/DDC/OLE: Function servers (http://www.baanboard.com/baanboard/forumdisplay.php?s=&amp;forumid=59) <br />
<br />
2. Use expression compilers - l.expr(), d.expr(), or s.expr$(). <br />
<br />
http://www.baanboard.com/programmers_manual_baanerp_help_functions_expressions_runtime_expr_compile</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Guillaume.G</div><div class="date">17th September 2002, 10:42</div></div><div class="posttext">Hi Daniel<br />
<br />
In the zip file, you find :<br />
- the AFS documentation<br />
- the Script of my session<br />
- the copy of the forms<br />
<br />
My session simulate the session for updating data of all tables.<br />
<br />
Limitations : it's only for update the data. The insert is impossible at the moment.<br />
<br />
An other version of this session reading a xml file which containt the definition of data (session name, index field, field updating and data)<br />
<br />
For the AFS you can find lot of information in the thread DDC/AFS/... see the reply of Nprao<br />
<br />
Guillaume <br />
<br />
Best Regard</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dbinderbr</div><div class="date">17th September 2002, 15:42</div></div><div class="posttext">Thanks Guillaume and  NPRao !!<br />
<br />
I will be evaluating both options to see which one best fits in my case, but, both of them are very useful in many situations !<br />
<br />
After trying to use these solutions I will post the results ok.<br />
<br />
Thanks a lot.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dbinderbr</div><div class="date">18th September 2002, 22:14</div></div><div class="posttext">Hello there,<br />
<br />
I designed two simple sessions and a table to test the ASF functions.<br />
<br />
But, I had some problems. It always inserts a blank record !! <br />
<br />
I have created a table with the fields listed bellow:<br />
- table: tudcb900<br />
-&gt; Code: tudcb900.codi.o - tcmcs.long<br />
-&gt; Name: tudcb900.nome.o - tcmcs.str50<br />
-&gt; Phone: tudcb900.fone - tcmcs.str15<br />
<br />
There are only these fields, no relations, no conditions, no mandatory fields, nothing special at all.<br />
<br />
The sessions: one that calls the maintain session of the table mentioned above containing the AFS functions. There are nothing special used in these sessions, the maintain session of the table tudcb900 has a script only with the table declaration, nothing else.<br />
<br />
The script that has the AFS functions I have posted as an attachment with the log file generated by the execution.<br />
<br />
I dont know what to do... I've tried everything, apparently I wrote the script following percfectly the AFS manual.<br />
<br />
Thanks in advance.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Guillaume.G</div><div class="date">25th September 2002, 10:20</div></div><div class="posttext">Hi Daniel<br />
<br />
I try your script (with the same table and same script) and the result is good. The AFS insert the record ans in the second pass the message is &quot;the record already exist&quot;<br />
<br />
I think that you have not the last version of ttstpapihand.<br />
<br />
The minimum solution for use the AFS without bugg is : 126067 and the last solution is 127443.<br />
<br />
I have the solution 126067 in my system and is very good.<br />
<br />
For know your version of ttstpapihand, you can use the bic_info utility.<br />
<br />
Best regard<br />
<br />
Guillaume.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dbinderbr</div><div class="date">25th September 2002, 22:54</div></div><div class="posttext">This problem was solved by installing the solution 115279. It has some dependencies, so, probably you'll have to previously install some other solutions.<br />
<br />
More details about the journey I had to solve this problem is available in the thread:<br />
<br />
6771 (http://www.baanboard.com/baanboard/showthread.php?s=&amp;threadid=6771)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">JaapJD</div><div class="date">1st October 2002, 14:19</div></div><div class="posttext">The original question was how to point to fields dynamically at runtime and give them a value. <br />
<br />
The first thing you have to know which table fields belong to a table. You can use the rdi.table(.column) functions. Once you know the fieldnames, you can give them a value using the function put.var.<br />
<br />
Example:<br />
<br />
<br />
      field.name = &quot;tiitm001.item&quot;<br />
      put.var(pid, field.name, &quot;MYVALUE&quot;)<br />
<br />
<br />
Regards,<br />
<br />
Jaap</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dbinderbr</div><div class="date">1st October 2002, 19:56</div></div><div class="posttext">Hi Jaap !!<br />
<br />
Yes, my original question didnt have any relation with AFS but as AFS was also interesting to me, the subject changed completely.<br />
<br />
I was still needing the information you have posted !!!<br />
<br />
Probably put.var will solve my problem.<br />
<br />
Thank you very much.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">lsatenstein</div><div class="date">3rd October 2002, 22:34</div></div><div class="posttext">I had the task of having a variable number of items in arrays of data and also of dynamically deciding on a table and doing an insert at run time.<br />
<br />
The easy solution....  dynamic sql.  <br />
<br />
I determined my requirements, allocated memory for the strings that were the sql statements and then did the sql.parse() etc.<br />
<br />
Worked out well, and very effective/efficient.<br />
<br />
Support for enhancements and changes are easy too.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dbinderbr</div><div class="date">4th October 2002, 16:24</div></div><div class="posttext">Hello Leslie,<br />
<br />
I was already using dynamic sql to read the table the user had chosen, it's really the easiest way. But, besides reading the information I also had to write it dynamically to certain fields. In this case, the use of put.var, get.var, etc. together with the dynamic SQL was very useful and pratical.<br />
<br />
Have a nice weekend.</div></div><hr />



</div>
</body>
</html>