<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="need(no. of lines to be printed), baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] need(no. of lines to be printed) Tools Development" />
	
	<title>need(no. of lines to be printed) [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="../index.html">Newbaanboard</a> &gt; <a href="../index.html">Baan Quick Support: Functional &amp; Technical</a> &gt; <a href="../index.html">Tools Development</a> &gt; need(no. of lines to be printed)</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">Rita Kotecha</div><div class="date">11th July 2005, 15:33</div></div><div class="posttext">Hi,<br />
<br />
I have a report where I have No. of lines printed from the service order. I have a layout after.orno where the total is printed and another after.fieldname where the authorised signatory is printed.<br />
<br />
In the report script I have written in the before.layout of the after.orno <br />
         need(23)<br />
<br />
as I want the total and the signature on the same page and the layouts after.orno and after.fieldname have 23 lines in all.<br />
<br />
With this it works fine.<br />
<br />
Can any one tell me If I can dynamically calcuate the no. of lines to be printed in and below the field.orno layout (instead of hardcoding 23)?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">evesely</div><div class="date">11th July 2005, 20:57</div></div><div class="posttext">You could look up the number of rows for the layouts in the ttadv331 table (ttadv331.rows, company 0) using the various index fields (i.e., language, PVRC, report, layout), sum them together, and use the need() function with this total as the argument in the before.layout of the first layout.  I haven't ever tried it, but it should be possible.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Rita Kotecha</div><div class="date">12th July 2005, 15:44</div></div><div class="posttext">Are there any standard functions from which  I can get the current report and layout in the report script.<br />
<br />
Then only I can search in ttadv331 for the layouts following it and the no of lines for the same.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">evesely</div><div class="date">13th July 2005, 15:57</div></div><div class="posttext">Try spool.report and lattr.layout.id$.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Rita Kotecha</div><div class="date">14th July 2005, 13:53</div></div><div class="posttext">Hi Mr Evesely,<br />
<br />
Can you please explain me more about lattr.layout.$id</div></div><hr />


<div class="post"><div class="posttop"><div class="username">evesely</div><div class="date">14th July 2005, 15:49</div></div><div class="posttext">If you step through a report in debug mode, there are a ton of variables that have values.  When you get to the section of code pertaining to the layout where you want to use need(), look at the value of the lattr.layout.id$ variable.  It contains the name of the current layout (e.g., &quot;detail.1&quot;, &quot;before.ticst001.pono.1&quot;).  I'm not sure why you need this; unless you are making a generic function, you already know the layout for which you are writing code.<br />
<br />
Once you know the layout, it's just a matter of mapping it to the fields in ttadv331.  The layout type field is enumerated (after field layouts are ttadv.layt.after.field = 5).<br />
<br />
I hope that helps.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Rita Kotecha</div><div class="date">18th July 2005, 16:54</div></div><div class="posttext">Thanks Mr evesly,<br />
<br />
Shall try it in my code and post the report scipt once I am through. Yes the purpose is to write a general dll.</div></div><hr />



</div>
</body>
</html>