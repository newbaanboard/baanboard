<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="select query using a substring as filter, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] select query using a substring as filter Tools Development" />
	
	<title>select query using a substring as filter [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="../index.html">Newbaanboard</a> &gt; <a href="../index.html">Baan Quick Support: Functional &amp; Technical</a> &gt; <a href="../index.html">Tools Development</a> &gt; select query using a substring as filter</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">mnmhema</div><div class="date">7th December 2012, 11:08</div></div><div class="posttext">I need to do a query as follows:<br />
<br />
select  tcibd001.ccde <br />
from tcibd001 <br />
where tcibd001.item(10;10)  =   :order <br />
group by  tcibd001.ccde <br />
as set with 1 rows <br />
<br />
<br />
There is something wrong in the phrase   tcibd001.item(10;10). This should be similar to the substring function in SQL server.<br />
Please advise.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pcolombo</div><div class="date">7th December 2012, 11:47</div></div><div class="posttext">You can use a substring (as you wrote in your post) in a program script , but i think you can't in a query. The SQL sintax for querys  is more restrictive than  a program script (i.e, you can't use {field1,field2...} refers to.. in query sintax but in script).<br />
<br />
I guess you can use, something like this in report generated by query <br />
<br />
detail.1:<br />
before.layout:<br />
lattr.print = (tcibd001.item(10;10)  = order) ? true : false<br />
<br />
where both tcibd001.item and order must be defined as report input fields.<br />
But i don't really think this could be very &quot;performant&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mnmhema</div><div class="date">7th December 2012, 12:15</div></div><div class="posttext">Hi pcolombo<br />
Thanks for your reply.<br />
Let me explain with an example.<br />
<br />
The order number (2912010020) . <br />
<br />
The tcibd001.item number is 10000000002912010020.<br />
<br />
If the item number contains the order number, the query must return  the country code (ccde) from the table tcibd001<br />
<br />
I concatenate this ccde to a  string variable and print that in my report.<br />
<br />
line = strip$(itemdsca &amp; &quot;  Sold on: &quot; &amp; soldon &amp; &quot;/&quot; &amp; str$(pono) &amp; cr$() &amp; lf$() &amp; &quot;Country Code &quot; &amp;  ccde  )<br />
<br />
Can you please tell me, how can I add the expression lattr.print = (tcibd001.item(10;10) = order) ? true : false in the variable “line”?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bdittmar</div><div class="date">7th December 2012, 12:17</div></div><div class="posttext">I need to do a query as follows:<br />
<br />
select  tcibd001.ccde <br />
from tcibd001 <br />
where tcibd001.item(10;10)  =   :order <br />
group by  tcibd001.ccde <br />
as set with 1 rows <br />
<br />
<br />
There is something wrong in the phrase   tcibd001.item(10;10). This should be similar to the substring function in SQL server.<br />
Please advise.<br />
<br />
Hello,<br />
<br />
<br />
select ..........<br />
from ............<br />
where tcibd001._index1 = {:1 &amp; :2}<br />
wherebind (1, &quot;         &quot;)<br />
wherebind (2, ?????????)<br />
.........<br />
<br />
Regards</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mnmhema</div><div class="date">7th December 2012, 12:35</div></div><div class="posttext">Hi bdittmar<br />
I changed my query as per your suggestion.<br />
<br />
order =&quot;2912890220&quot;<br />
select  tcibd001.ccde <br />
from tcibd001<br />
where tcibd001.item  = :1 <br />
as set with 1 rows <br />
selectbind (1, ????????? &amp; order &amp; ????????????????????????????)<br />
Now I am getting errors like <br />
? not expected<br />
 Select do , endselect not expected.<br />
what is wrong in my query?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bdittmar</div><div class="date">7th December 2012, 13:09</div></div><div class="posttext">Hi bdittmar<br />
I changed my query as per your suggestion.<br />
<br />
order =&quot;2912890220&quot;<br />
select  tcibd001.ccde <br />
from tcibd001<br />
where tcibd001.item  = :1 <br />
as set with 1 rows <br />
selectbind (1, ????????? &amp; order &amp; ????????????????????????????)<br />
Now I am getting errors like <br />
? not expected<br />
 Select do , endselect not expected.<br />
what is wrong in my query?<br />
<br />
Hello,<br />
<br />
Read wherebind in DEV-Guide, please !<br />
<br />
Something like:<br />
<br />
<br />
order =&quot;2912890220&quot;<br />
select  tcibd001.ccde <br />
from tcibd001<br />
|where tcibd001.item  = :1 <br />
where tcibd001._index1 inrange {:1 &amp; :2}<br />
and {:3 &amp; :4}<br />
selectbind (1, &quot;         &quot;)<br />
selectbind (2, :order)<br />
selectbind (3, &quot;ZZZZZZZZZ&quot;)<br />
selectbind (4, (:order&amp;&quot;ZZZZZZZZZZZZZZ&quot;))<br />
as set with 1 rows <br />
|selectbind (1, ????????? &amp; order &amp; ????????????????????????????)<br />
<br />
<br />
Regards</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pcolombo</div><div class="date">7th December 2012, 13:29</div></div><div class="posttext">As you posted previosuly you are in a query!. As far i know u cannot use wherebind or selectbind in querys but in program scripts</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pcolombo</div><div class="date">7th December 2012, 13:44</div></div><div class="posttext">Are you want to filter by order? If it , why just dont simply join tdsls401, to tcibd001 and then put a filter in query for tdsls401.orno?. In another way you can't put a field in screen to filter.</div></div><hr />



</div>
</body>
</html>