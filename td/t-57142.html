<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="Application exporting data from BaaN Automatically, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] Application exporting data from BaaN Automatically Tools Development" />
	
	<title>Application exporting data from BaaN Automatically [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="../index.html">Newbaanboard</a> &gt; <a href="../index.html">Baan Quick Support: Functional &amp; Technical</a> &gt; <a href="../index.html">Tools Development</a> &gt; Application exporting data from BaaN Automatically</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">alopezsantam</div><div class="date">2nd November 2009, 12:57</div></div><div class="posttext">Hi,<br />
<br />
Every day I have to perfrom many automatic tasks, some of them involve downloading tables in excel and notepad format from BaaN, to monitor sales, orders etc... I am developing an Application that manage to perform most of those automatic tasks, however, when it comes to program the tasks that involve BaaN I am extremelly lost.<br />
<br />
I was thinking on using some kind of macro in VB, like the ones I have found in the BaaN Client's folder called Samples. However I haven't been able to make the sample macros work (they get stack in the initial senstece Set Baan4Obj = CreateObject(&quot;Baan4.Application&quot;) reporting that ther program is unable to create a BaaN object.<br />
<br />
I was looking for a simple tutorial to tell BaaN to download certain information in a Notepad or excel format without using the GUI. <br />
<br />
Thank you in advance.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Hitesh Shah</div><div class="date">2nd November 2009, 13:49</div></div><div class="posttext">If u do not want to try 3rd party solutions , u can use baan exchange / easy sqls  and report conversion to ascii files for getting files in xl / notepad . If u can code in baan writing wrappers  around this functionalities , the soluton could be very much useful.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">2nd November 2009, 16:04</div></div><div class="posttext">Hi,<br />
<br />
Every day I have to perfrom many automatic tasks, some of them involve downloading tables in excel and notepad format from BaaN, to monitor sales, orders etc... I am developing an Application that manage to perform most of those automatic tasks, however, when it comes to program the tasks that involve BaaN I am extremelly lost.<br />
<br />
I was thinking on using some kind of macro in VB, like the ones I have found in the BaaN Client's folder called Samples. However I haven't been able to make the sample macros work (they get stack in the initial senstece Set Baan4Obj = CreateObject(&quot;Baan4.Application&quot;) reporting that ther program is unable to create a BaaN object.<br />
<br />
I was looking for a simple tutorial to tell BaaN to download certain information in a Notepad or excel format without using the GUI. <br />
<br />
Thank you in advance.<br />
<br />
This works but it is slow - or at least it is for me. On previous versions of the baan client that was the default.  On the current version of the baan  client there is a tab called automation.  So for you default .bwc file check out what is in that tab - that is what you should put in createobject.  Each .bwc can have a different automation connection so that you can call the one you want.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">alopezsantam</div><div class="date">2nd November 2009, 17:12</div></div><div class="posttext">Ok, I have looked for the .bwc file (since that may solve the problem with the excel macro, which would let me use the sample macro to learn how baan VB work). I found the file but inside there were many fields but none of them was automation. Here is what it said:<br />
<br />
[ApplicationServer]<br />
bse=/baan/bse<br />
bshell=bshell<br />
command=<br />
location=<br />
connection=<br />
[Remote]<br />
hostname=somedomain<br />
username=s444444<br />
password=<br />
logindialog=NO<br />
serveros=<br />
protocol=EXEC<br />
portnumber=512<br />
domain=<br />
password64=<br />
[NLS]<br />
locale=ISO<br />
RightToLeft=False<br />
[Font]<br />
fontName80=Fixedsys<br />
fontWidth80=0<br />
fontHeight80=-12<br />
fontWeight80=normal<br />
fontPitch80=fixed<br />
fontItalic80=NO<br />
fontName132=Fixedsys<br />
fontWidth132=0<br />
fontHeight132=-12<br />
fontWeight132=normal<br />
fontPitch132=fixed<br />
fontItalic132=NO<br />
<br />
Did I miss anything?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">alopezsantam</div><div class="date">2nd November 2009, 17:17</div></div><div class="posttext">Maybe if I can fix what ever errors the sample macro gives me (since the macro is supposed to be 100% correct, that shouldn't take long) you can also address me to a tutorial/manual where I can learn how to refer to the data (Using VB) I would like to download. (I basically want to program what I can do manually with the GUI displaying thing in NOTEPAD).<br />
<br />
By the way thank you for the rapid response.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">3rd November 2009, 00:30</div></div><div class="posttext">There is not a tutorial that I am aware of.  I learned most of this just playing with it.  You can also search the AFS/DDC/OLE forum for additional hints - where this thread probably belongs.  Let me edit your post first.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">3rd November 2009, 00:32</div></div><div class="posttext">What client on you using?  Mine includes this:  <br />
<br />
[Automation]<br />
className=Baan4.Application.101<br />
classId={41C2BC02-0991-431E-8053-CB0F46EFE0E3}<br />
multiInstance=NO<br />
<br />
You can see this in the bw configuration tab.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">alopezsantam</div><div class="date">3rd November 2009, 11:37</div></div><div class="posttext">Sorry if this is a stupid question but I can't find the config tab. Where is it?<br />
<br />
Is there any other way to find out how to call a BaaN object. Attach is all the screens  I see when I execute the bw.exe in case it helps.<br />
<br />
Thanks,</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bdittmar</div><div class="date">3rd November 2009, 12:47</div></div><div class="posttext">Sorry if this is a stupid question but I can't find the config tab. Where is it?<br />
<br />
Is there any other way to find out how to call a BaaN object. Attach is all the screens  I see when I execute the bw.exe in case it helps.<br />
<br />
Thanks,<br />
<br />
Hello,<br />
<br />
see attachment !<br />
<br />
Regards</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">3rd November 2009, 15:25</div></div><div class="posttext">The client automation tab is in the .bwc configuration.  So when logging into baan before typing in password, hit the configure button on the bwclient.  That will bring up the screen bdittmar has posted.  Of course that assumes you are running a current client, some of the older clients did not have this option. You should also have this automation entry somewhere in the registry.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">3rd November 2009, 15:30</div></div><div class="posttext">Also to get the entry into the registry just re-save the .bwc file.  Also I noticed that the default configuration we use has Baan4.Automation.Default.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">alopezsantam</div><div class="date">4th November 2009, 10:56</div></div><div class="posttext">Then the problem is simple, My client does not have this capability since that tab does not exist, I got to that wind and everything looked ok except for the fact that the Automation tab was missing. <br />
<br />
The solution I guess is probably to look for another client and install it my self. <br />
<br />
You guys know any that for sure has that capability?<br />
<br />
I haven't said it lately but thanks a lot for your help.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">4th November 2009, 14:58</div></div><div class="posttext">The version we are using is B40c.87.  Something else to look for is called bw.reg(or maybe bwreg.bat something like that) it used to create the registry entries.  Also use regedit and look for Baan4.application that needs to exist.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">zardoz</div><div class="date">4th November 2009, 16:06</div></div><div class="posttext">I post this little piece of code in VB .NET:<br />
<br />
<br />
Imports System<br />
Imports System.IO<br />
Imports System.Text<br />
<br />
Public Class Form1<br />
<br />
    Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click<br />
        startproc()<br />
    End Sub<br />
<br />
    Private Function Button2_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button2.Click<br />
        Dim openFileDialog1 As New OpenFileDialog()<br />
        ' ------ Put the right directory here:<br />
        openFileDialog1.InitialDirectory = &quot;C:\Programmi\Baan\Baan IV\lib\user&quot;<br />
        openFileDialog1.Filter = &quot;BW Configuration File (*.bwc)|*.bwc&quot;<br />
        openFileDialog1.FilterIndex = 2<br />
        openFileDialog1.RestoreDirectory = True<br />
        If openFileDialog1.ShowDialog() = System.Windows.Forms.DialogResult.OK Then<br />
            BAANFile.Text = openFileDialog1.FileName<br />
            Return openFileDialog1.FileName<br />
        Else<br />
            Return &quot;&quot;<br />
        End If<br />
<br />
    End Function<br />
<br />
    Private Sub searchtxt(ByRef obj As System.Windows.Forms.TextBox, ByVal strs As String, ByVal otxt As String)<br />
        Dim j<br />
        j = otxt.Contains(strs)<br />
        If j Then<br />
            obj.Text = otxt.Substring(Len(strs) + 1)<br />
        End If<br />
    End Sub<br />
<br />
<br />
    Private Sub getOLEname(ByVal filename As String)<br />
        Dim myStream As System.IO.Stream = Nothing<br />
        Dim text As String()<br />
        Dim i, j As Integer<br />
<br />
        Try<br />
            myStream = File.OpenRead(filename)<br />
            If (myStream IsNot Nothing) Then<br />
                text = File.ReadAllLines(filename)<br />
                For i = 0 To text.Length - 1<br />
                    searchtxt(BAANBSE, &quot;bse&quot;, CStr(text(i)))<br />
                    searchtxt(BAANCls, &quot;className&quot;, CStr(text(i)))<br />
                    searchtxt(BAANHst, &quot;hostname&quot;, CStr(text(i)))<br />
                Next<br />
                BAANTmp.Text = BAANBSE.Text &amp; &quot;\tmp&quot;<br />
            End If<br />
        Catch Ex As Exception<br />
            MessageBox.Show(&quot;Cannot read file from disk. Original error: &quot; &amp; Ex.Message)<br />
        Finally<br />
            If (myStream IsNot Nothing) Then<br />
                myStream.Close()<br />
            End If<br />
        End Try<br />
    End Sub<br />
<br />
    Private Sub BaanConfig_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles BAANFile.TextChanged<br />
        getOLEname(BAANFile.Text)<br />
    End Sub<br />
End Class<br />
<br />
Module main<br />
    Dim BAANObj As Object<br />
    Dim BAANFun As String<br />
<br />
<br />
    Sub startproc()<br />
       <br />
        On Error GoTo BaanCannotCreate<br />
        BAANObj = CreateObject(Form1.BAANCls.Text)<br />
        BAANObj.Timeout = 10<br />
        On Error GoTo BaanAutomationError<br />
        ' ----- Your code here<br />
        GoTo BaanEnd<br />
BaanCannotCreate:<br />
        MsgBox(&quot;Unable to create baan object&quot;)<br />
        Exit Sub<br />
BaanAutomationError:<br />
        MsgBox(&quot;Baan IV automation error: &quot; &amp; BAANObj.Error)<br />
        MsgBox(&quot;Return value function: &quot; &amp; BAANFun &amp; &quot;  &quot; &amp; BAANObj.returnvalue)<br />
BaanEnd:<br />
        BAANObj.Quit()<br />
        BAANObj = Nothing<br />
        Exit Sub<br />
    End Sub<br />
<br />
<br />
In this way you can choose between all your BW configuration files interactively, the software uses the BAANCls.text variable it founds on the config file.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">alopezsantam</div><div class="date">4th November 2009, 16:19</div></div><div class="posttext">I had already double-clicked the bw.reg (and that was suppose to create what ever register I needed).<br />
<br />
I searched with regedit and found BaaN4.Application (As you can see in the attachement). I don't know what to do now.<br />
<br />
I have tried to execute one of the sample macros again in case something that I've changed had solved the problem, but instead I have gotten the exact same result (&quot;Unable to start BaaN&quot; giving the error when calling the constructor to create the Baan object).<br />
<br />
I have attached the snapshot of the regedit result and below I've pasted the code of one of the sample macros I'am trying to run. Again just in case it can help.<br />
<br />
/////////////////CODE///////////////////////////<br />
<br />
Dim BaanObj As Object<br />
Dim B_function As String<br />
Dim B_function2 As String<br />
Dim Query As String<br />
Dim user As String<br />
Dim temp_string As String<br />
Dim query_id As Long<br />
Dim RetVal As Long<br />
<br />
Sub GetBaanUsers()<br />
    ' This example will fill the spreadsheet with the names of BAAN IV users,<br />
    ' with the criterium: user name &gt; &quot;tools&quot;<br />
    ' This macro parses the following string:<br />
    ' &quot;select ttaad200.user from ttaad200 where ttaad200.user &gt; &quot;tools&quot;&quot;<br />
    ' The DLL &quot;ottdllsql_query&quot; contains a function to convert this string to a Baan query and<br />
    ' other functions to parse and execute the query. The DLL also contains functions to retrieve<br />
    ' the result of the query, e.g. function &quot;olesql_getstring&quot;.<br />
    On Error GoTo CannotCreateBaan<br />
    <br />
    'run Baan Application<br />
    Set BaanObj = CreateObject(&quot;Baan4.Application&quot;)<br />
    ThisWorkbook.Sheets(&quot;Users&quot;).Activate<br />
    BaanObj.Timeout = 10<br />
    On Error GoTo BaanAutomationError<br />
    <br />
    ' form the string to Visual Basic format. Mind how quotes (Chr(34)) are put in the string<br />
    Query = &quot;select ttaad200.user from ttaad200 where ttaad200._compnr=000 and ttaad200.user &gt; &quot; &amp; Chr(34) &amp; Chr(34) &amp; &quot;tools&quot; &amp; Chr(34) &amp; Chr(34)<br />
    <br />
    B_function = &quot;olesql_parse(&quot; &amp; Chr(34) &amp; Query &amp; Chr(34) &amp; &quot;)&quot;<br />
    ' execute the function olesql_parse(&quot;select ttaad200.user from ttaad200 where ttaad200.user &gt; &quot;tools&quot;&quot;)<br />
    ' from DLL ottdllsql_query<br />
    BaanObj.ParseExecFunction &quot;ottdllsql_query&quot;, B_function<br />
    ' If this function fails the ReturnValue is equal to zero, otherwise<br />
    ' the function olesql_parse returns a identification number of the query<br />
    ' Convert the (string) ReturnValue to a long variable using the function Val<br />
    query_id = Val(BaanObj.ReturnValue)<br />
    If query_id = 0 Then<br />
        MsgBox &quot;function olesql_parse fails&quot;<br />
        GoTo BaanAutomationError<br />
    End If<br />
    ' The function olesql_fetch reads one query result, in this example the (string) value of ttaad200.user<br />
    ' The identification number of the query must be passed as argument to this function<br />
    B_function = &quot;olesql_fetch(&quot; &amp; query_id &amp; &quot;)&quot;<br />
    BaanObj.ParseExecFunction &quot;ottdllsql_query&quot;, B_function<br />
    temp_string = &quot;ttaad200.user&quot;<br />
    user = String(10, &quot; &quot;)<br />
    ' The function olesql_getstring retrieves the query result and stores it in the second argument,<br />
    ' a 'call by reference' argument. Note that the second argument must be large enough to fill in the result<br />
    B_function2 = &quot;olesql_getstring(&quot; &amp; Chr(34) &amp; temp_string &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; user &amp; Chr(34) &amp; &quot;)&quot;<br />
    BaanObj.ParseExecFunction &quot;ottdllsql_query&quot;, B_function2<br />
    <br />
    ' search returned string in the function call (call by reference argument)<br />
    temp_string = BaanObj.FunctionCall<br />
    user = Mid(temp_string, 35, 10)<br />
    user = Trim(user)<br />
    <br />
    Row = 1<br />
    Column = 6<br />
    If user = &quot;&quot; Then MsgBox (&quot;No users found&quot;)<br />
    While (user &lt;&gt; &quot;&quot;)<br />
        ' fill spreadsheet<br />
        Worksheets(&quot;Users&quot;).Cells(Row, Column) = user<br />
        Row = Row + 1<br />
        If Row &gt; 10 Then<br />
            Row = 1<br />
            Column = Column + 1<br />
        End If<br />
        <br />
        ' Read next query result. If this function fails, the ReturnValue is not equal to zero<br />
        BaanObj.ParseExecFunction &quot;ottdllsql_query&quot;, B_function<br />
        If BaanObj.ReturnValue = 0 Then<br />
            ' retrieve query result and store it in the second argument of the function olesql_getstring<br />
            BaanObj.ParseExecFunction &quot;ottdllsql_query&quot;, B_function2<br />
            temp_string = BaanObj.FunctionCall<br />
            ' the second argument (user name) can be retrieved from position 35 of the FunctionCall<br />
            user = Mid(temp_string, 35, 10)<br />
            user = Trim(user)    ' removes spaces from text string<br />
        ElseIf BaanObj.ReturnValue = 110 Then       ' end of set<br />
            user = &quot;&quot;<br />
        Else<br />
            GoTo BaanAutomationError<br />
        End If<br />
    Wend<br />
    <br />
    ' stop and remove query<br />
    B_function = &quot;olesql_break(&quot; &amp; query_id &amp; &quot;)&quot;<br />
    BaanObj.ParseExecFunction &quot;ottdllsql_query&quot;, B_function<br />
    If BaanObj.ReturnValue &lt;&gt; 0 Then GoTo BaanAutomationError<br />
    B_function = &quot;olesql_close(&quot; &amp; query_id &amp; &quot;)&quot;<br />
    BaanObj.ParseExecFunction &quot;ottdllsql_query&quot;, B_function<br />
    <br />
    ' exit Baan<br />
    BaanObj.Quit<br />
    Set BaanObj = Nothing<br />
    Exit Sub<br />
    <br />
' error handling<br />
CannotCreateBaan:<br />
    MsgBox &quot;Unable to start Baan&quot;<br />
    Exit Sub<br />
    <br />
BaanAutomationError:<br />
    MsgBox &quot;Baan IV automation error: &quot; &amp; BaanObj.Error<br />
    MsgBox &quot;Return value function: &quot; &amp; B_function &amp; &quot;  &quot; &amp; BaanObj.ReturnValue<br />
    BaanObj.Quit<br />
    Set BaanObj = Nothing<br />
    Exit Sub<br />
    <br />
End Sub</div></div><hr />


<div class="post"><div class="posttop"><div class="username">zardoz</div><div class="date">4th November 2009, 18:08</div></div><div class="posttext">It seems that the ClassID is &quot;Baan4 Application&quot; instead of &quot;Baan4.Application&quot;.<br />
Try substitute the string in the VB program in CreateObject.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">alopezsantam</div><div class="date">4th November 2009, 18:33</div></div><div class="posttext">Yeah, I tried that as soon as I saw it, but still the same result. Is it possible that I don't have the dll needed or any other stuff needed. What files/resources would I need in order for the macro to be able to create the BaaNobj?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">zardoz</div><div class="date">5th November 2009, 09:45</div></div><div class="posttext">Why don't you reinstall a recent version of BW?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">alopezsantam</div><div class="date">5th November 2009, 12:06</div></div><div class="posttext">Yeah, I'll do that, that's a great idea. <br />
<br />
Where and which I can find one that will 100% have the Automation capabilities. I am going to search baanboard and as my colleages.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">alopezsantam</div><div class="date">5th November 2009, 12:08</div></div><div class="posttext">Ok I found one that will have the automation.</div></div><hr />



</div>
</body>
</html>