<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="Function to detect for special character, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] Function to detect for special character Tools Development" />
	
	<title>Function to detect for special character [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="../index.html">Newbaanboard</a> &gt; <a href="../index.html">Baan Quick Support: Functional &amp; Technical</a> &gt; <a href="../index.html">Tools Development</a> &gt; Function to detect for special character</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">teddybear</div><div class="date">28th July 2009, 06:19</div></div><div class="posttext">Hi there,<br />
<br />
I am trying to write a function that scan a string for certain characters that are not allowed.<br />
<br />
For example, the allowed character are A-Z, 1-9, comma, full stop, (, ), / and hyphen.<br />
<br />
How can I write a fucntion that tell if characters not listed above is present.<br />
<br />
Many thankssssss.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">saumya</div><div class="date">28th July 2009, 08:01</div></div><div class="posttext">extern domain tcdsca cust<br />
long i,j,length,<br />
domain tcbool illegal<br />
field.cust:<br />
check.input:<br />
	check.char(cust)<br />
<br />
	   if 	illegal = true then<br />
	        message(&quot;illegal character not allowed.&quot;)<br />
	        set.input.error(&quot;&quot;,e)<br />
              endif<br />
<br />
functions:<br />
function check.char(tcdsca cust)<br />
{<br />
     length = len(cust)<br />
     illegal = false<br />
    for i = 1 to length<br />
           	j = asc(cust(i;1))<br />
 	if (j &gt;=asc(&quot;A&quot;) and j &lt;= asc(&quot;Z&quot;)) or <br />
 	   (j &gt;=asc(&quot;a&quot;) and j &lt;= asc(&quot;z&quot;)) or<br />
 	   (j &gt;= asc(&quot;1&quot;) and j &lt;= asc(&quot;9&quot;)) or<br />
	   (asc(&quot;,&quot;) = j ) or <br />
	   (asc(&quot;.&quot;) = j ) or<br />
	   (asc(&quot;(&quot;) = j ) or<br />
	   (asc(&quot;)&quot;) = j ) or<br />
	   (asc(&quot;/&quot;) = j ) or<br />
	   (asc(&quot;-&quot;) = j ) then<br />
	else<br />
	   illegal = true<br />
		<br />
	endif<br />
    endfor<br />
}</div></div><hr />


<div class="post"><div class="posttop"><div class="username">teddybear</div><div class="date">28th July 2009, 10:49</div></div><div class="posttext">Thanks saumya</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rameshchinnap</div><div class="date">10th August 2009, 12:47</div></div><div class="posttext">hi, use<br />
   string.scan()<br />
<br />
examples:<br />
double D<br />
<br />
long L<br />
<br />
string S(80)<br />
<br />
long ret<br />
<br />
ret = string.scan(&quot;string 123 456.78&quot;,&quot;%s %d %f&quot;,S,L,D)<br />
<br />
    | S contains &quot;string&quot;, L contains 123, D contains 456.78<br />
<br />
ret = string.scan(&quot;string|123|456.78&quot;,&quot;%s|%d|%f&quot;,S,L,D)<br />
<br />
    | S contains &quot;string&quot;, L contains 123, D contains 456.78</div></div><hr />


<div class="post"><div class="posttop"><div class="username">BaanInOhio</div><div class="date">10th August 2009, 18:05</div></div><div class="posttext">in 'before.program' section, build a string with the good characters:<br />
<br />
good.str = &quot;ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890,/()&quot;<br />
<br />
<br />
... can add &quot;&amp; str$(nn)&quot; for special characters (where 'nn' is the numeric representation of the character).<br />
<br />
<br />
check each character by:<br />
<br />
good = (pos(good.str, each.char) &gt; 0) ? true : false<br />
<br />
in a string parse or loop.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">~Vamsi</div><div class="date">24th August 2009, 20:08</div></div><div class="posttext">Another alternative is to use regular expressions. See http://www.baanboard.com/programmers_manual_baanerp_help_functions_expressions_runtime_expr_compile for details.</div></div><hr />



</div>
</body>
</html>