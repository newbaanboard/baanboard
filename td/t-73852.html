<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="last record of invoice, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] last record of invoice Tools Development" />
	
	<title>last record of invoice [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="../index.html">Newbaanboard</a> &gt; <a href="../index.html">Baan Quick Support: Functional &amp; Technical</a> &gt; <a href="../index.html">Tools Development</a> &gt; last record of invoice</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">smusba</div><div class="date">20th May 2021, 13:32</div></div><div class="posttext">I am stuck in one report logic. I had created a report but in this logic it should pick only the last record of any invoice and match with the status. If the last record status is not matching with the form parameter it should skip that record.<br />
Below is the logic  I used but its not working.<br />
function read.main.table.1()<br />
{                                              <br />
 select    cisli902.*<br />
 from      cisli902<br />
 where   cisli902._index1 inrange {:ityp.f, :idoc.f,:tdat.f}<br />
 and        {:ityp.t, :idoc.t,:tdat.t}<br />
 and        cisli902.scod = :scod.f<br />
 order by cisli902.ityp asc,cisli902.idoc asc,cisli902.tdat asc<br />
 selectdo<br />
      rprt_Send()<br />
 endselect<br />
}</div></div><hr />


<div class="post"><div class="posttop"><div class="username">GeekGirlAkshara</div><div class="date">20th May 2021, 14:22</div></div><div class="posttext">Hi,<br />
I assume, you want last invoice line of an invoice(The table you have used looks like a header table.(I might be wrong) ). <br />
In any case, you will have to order by it by descending order.<br />
<br />
if u want the data of invoice line you simply can order it by invoice line no desc.<br />
<br />
ex:<br />
<br />
 select    cisli310.*<br />
 from      cisli310<br />
 where   cisli310._index1 inrange {:ityp.f, :idoc.f,:tdat.f}<br />
 and        {:ityp.t, :idoc.t,:tdat.t}<br />
 and        Your_condition<br />
 order by cisli310.pono desc<br />
as set with 1 rows<br />
 selectdo<br />
      rprt_Send()<br />
 endselect<br />
<br />
<br />
Hope This Helps! :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">smusba</div><div class="date">20th May 2021, 14:40</div></div><div class="posttext">This query only gives one record what I need is every invioice is repeated multiple times I want to fetch last record of all the invoices.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">24th May 2021, 16:10</div></div><div class="posttext">Use multiple queries versus trying to do it all in one query.  Maybe the first query could use an alias and get just the invoice number.  Thencheck the appropriate status.  If it is the right status then do another query to get just the last record like GeekGirlAkshara proposed using a given invoice number.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">smusba</div><div class="date">27th May 2021, 14:40</div></div><div class="posttext">Yes I did the same thing thanks</div></div><hr />



</div>
</body>
</html>