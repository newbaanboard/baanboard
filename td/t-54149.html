<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="How to use two DLL with identical global variables?, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] How to use two DLL with identical global variables? Tools Development" />
	
	<title>How to use two DLL with identical global variables? [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="../index.html">Newbaanboard</a> &gt; <a href="../index.html">Baan Quick Support: Functional &amp; Technical</a> &gt; <a href="../index.html">Tools Development</a> &gt; How to use two DLL with identical global variables?</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">Angelika_N</div><div class="date">30th October 2008, 10:41</div></div><div class="posttext">I want to use two DLL in one script. In both DLL there are variables with identical names (extern), for example 'r.mess'.<br />
I receive a mistake at loading of the second DLL:<br />
Error: Load DLL: Incompatible array subscripts in link external 'r.mess'<br />
Error: Load DLL: Subscripts 1, source 150, external 100<br />
Fatal error: Dynamic Link failure external symbol 'r.mess' in DLL object 'odll_1'<br />
Fatal error: Can not continue in script_1 (function_1)<br />
<br />
Is it possible to use these DLL together?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">george7a</div><div class="date">30th October 2008, 10:43</div></div><div class="posttext">Hi,<br />
<br />
You might want to check the Function overloading (http://www.baanboard.com/programmers_manual_baanerp_help_dynamic_link_libraries_function_overloading). Here are the available functions:<br />
http://www.baanboard.com/programmers_manual_baanerp_help_functions_dll_overview_and_synopsis<br />
<br />
- George</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Angelika_N</div><div class="date">30th October 2008, 12:49</div></div><div class="posttext">I already use these functions for dynamic loading DLL (load_dll, get_function, exec_function). <br />
I load the first DLL and I start its function.<br />
Then I load the second library and I receive a error (global variables have identical names in different DLL)<br />
It is possible to unload the first library?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">george7a</div><div class="date">30th October 2008, 13:50</div></div><div class="posttext">I am not sure! I will check it...<br />
<br />
try this workaround create a script, that uses the other DLL and call the function, then exports the wanted value. In your original script, import it.<br />
<br />
- George</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Angelika_N</div><div class="date">30th October 2008, 14:45</div></div><div class="posttext">I tried to create intermediate script and DLL.<br />
It is impossible.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">george7a</div><div class="date">30th October 2008, 14:59</div></div><div class="posttext">What are the DLLs that you are using? I would like to test it here.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Angelika_N</div><div class="date">30th October 2008, 15:46</div></div><div class="posttext">It not standard libraries.<br />
In the first DLL there is a variable r.mess (it is declared as global, extern)<br />
In the second DLL there is a same variable.<br />
<br />
I run function get.item () the first DLL.<br />
Then I run function get.clot () the second DLL.<br />
The variable r.mess is not used anywhere</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ARijke</div><div class="date">31st October 2008, 10:03</div></div><div class="posttext">The external variables should be unique. So one of those has to be renamed.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">günther</div><div class="date">5th November 2008, 11:58</div></div><div class="posttext">Normally, the best coding style is to use unique names for external variables and functions (simply by using the dll name as prefix). This could also be done by using the preprocessor if you had to replace the entire dll code just because of renaming a variable.<br />
And folks: Don't change anything of the interface of a dll; add new features - otherwise you will get errors on your live system! So, If you have to change too much, copy the dll and use the new one until you are sure that no other session depends on the old variables / functions!<br />
 <br />
In your case, I would suggest to check which dll has r.mess with 100 chars, and then to extend it to 150 chars. Then the problem should be solved (for the moment).<br />
 <br />
Günther</div></div><hr />



</div>
</body>
</html>