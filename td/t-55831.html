<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="How can I know the report's language?, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] How can I know the report's language? Tools Development" />
	
	<title>How can I know the report's language? [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="../index.html">Newbaanboard</a> &gt; <a href="../index.html">Baan Quick Support: Functional &amp; Technical</a> &gt; <a href="../index.html">Tools Development</a> &gt; How can I know the report's language?</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">david7</div><div class="date">12th May 2009, 09:40</div></div><div class="posttext">Hi,<br />
<br />
I have been reading some threads that is related to the report's language. I think I have a different problem:<br />
<br />
I am trying to print a PO to a device I created. How can my script know the language of the printed report? <br />
<br />
I have noticed that PO reports can be printed in different languages depending on the PO itself or maybe the BP.<br />
<br />
I have checked the language$ variable and it is always &quot;2&quot; even if the report langauge is 3.<br />
<br />
Any ideas?<br />
<br />
- D7</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bdittmar</div><div class="date">12th May 2009, 10:21</div></div><div class="posttext">Hi,<br />
<br />
I have been reading some threads that is related to the report's language. I think I have a different problem:<br />
<br />
I am trying to print a PO to a device I created. How can my script know the language of the printed report? <br />
<br />
I have noticed that PO reports can be printed in different languages depending on the PO itself or maybe the BP.<br />
<br />
I have checked the language$ variable and it is always &quot;2&quot; even if the report langauge is 3.<br />
<br />
Any ideas?<br />
<br />
- D7<br />
<br />
Hello,<br />
<br />
Use:<br />
<br />
brp.open.language()<br />
<br />
--------------------------------------------------------------------------------<br />
<br />
Syntax<br />
long brp.open.language( string rep_name(16), string lang, string device(14), long mode )<br />
<br />
Description<br />
This is the same as brp.open() in most respects, except that it includes a language argument. This enables you to specify a language for the report other than the default user language. <br />
<br />
Return values<br />
&gt;0        an ID for the activated report<br />
  0        report could not be activated<br />
 -1        spooler could not be opened<br />
<br />
Context<br />
Bshell function.<br />
<br />
Regards</div></div><hr />


<div class="post"><div class="posttop"><div class="username">david7</div><div class="date">12th May 2009, 10:30</div></div><div class="posttext">Bernd,<br />
<br />
brp.open.language prints a report. The report is already printed. my code works as a device and from there, after the report has been printed, I need to get the language of that report.<br />
<br />
- D7</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MilindV</div><div class="date">12th May 2009, 11:07</div></div><div class="posttext">Hi<br />
<br />
May be, this will solve your problem.<br />
<br />
Predefined variables (Report)<br />
lattr.language$  R  The language code of the report.<br />
 <br />
<br />
<br />
Thanks &amp; Regards<br />
MilindV</div></div><hr />


<div class="post"><div class="posttop"><div class="username">david7</div><div class="date">12th May 2009, 11:13</div></div><div class="posttext">Sorry,<br />
<br />
I forgot to mention that I have tried that too and it is not declared in the script! I get a compilation error.<br />
<br />
- D7</div></div><hr />


<div class="post"><div class="posttop"><div class="username">wiggum</div><div class="date">12th May 2009, 12:27</div></div><div class="posttext">I think the only way to get the language which was used for the report is to insert lattr.language$ into a layout of the report (before.report) so that you can read this in your script.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">david7</div><div class="date">12th May 2009, 12:44</div></div><div class="posttext">Thanks for the reply but, there are many reports in our system. I do not want to customize them all.<br />
<br />
Is there a way to know the report's language from the device script without editing the report?<br />
<br />
- D7</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bdittmar</div><div class="date">12th May 2009, 14:02</div></div><div class="posttext">Thanks for the reply but, there are many reports in our system. I do not want to customize them all.<br />
<br />
Is there a way to know the report's language from the device script without editing the report?<br />
<br />
- D7<br />
<br />
Hello,<br />
<br />
maybe this will help,<br />
<br />
reportname with language is stored in prog.name$<br />
<br />
e.g. tisfc0408012003 for language = 3<br />
<br />
Regards</div></div><hr />


<div class="post"><div class="posttop"><div class="username">david7</div><div class="date">12th May 2009, 15:30</div></div><div class="posttext">Thanks but, the predefined varibale &quot;prog.name$&quot; shows the name of the device script that I am writing and no the report that was printed to the device.<br />
<br />
- D7</div></div><hr />


<div class="post"><div class="posttop"><div class="username">george7a</div><div class="date">14th May 2009, 09:48</div></div><div class="posttext">If we are talking about a standard session (not customized) then there should be a logic behind choosing the language. If you can dig up the logic, you will have the language. For example, If you are printing a Purchase order, there is a field there that specifies the Language. In other cases it might pick up the BP Language...<br />
<br />
- George</div></div><hr />


<div class="post"><div class="posttop"><div class="username">günther</div><div class="date">14th May 2009, 16:47</div></div><div class="posttext">Thanks but, the predefined varibale &quot;prog.name$&quot; shows the name of the device script that I am writing and no the report that was printed to the device.<br />
 <br />
- D7<br />
In that case, you could try get.var(parent, &quot;language$&quot;, my.lang) to retrieve language of the parent into your local variable my.lang. (You could even climb up the ladder with get.var(parent, &quot;parent&quot;, parent.parent) and so on.) <br />
 <br />
Hope you don't get confused!<br />
Günther</div></div><hr />


<div class="post"><div class="posttop"><div class="username">david7</div><div class="date">18th May 2009, 08:19</div></div><div class="posttext">In that case, you could try get.var(parent, &quot;language$&quot;, my.lang) to retrieve language of the parent into your local variable my.lang. (You could even climb up the ladder with get.var(parent, &quot;parent&quot;, parent.parent) and so on.) <br />
 <br />
Hope you don't get confused!<br />
Günther<br />
<br />
Thanks Gunther, but that did not work. Since the session I am printing from is in English and the select device (the parent &amp; the grand parent). So &quot;language$&quot; has always returns the same result which is the language of the current user and not the language of the report.<br />
<br />
As a workaround, I have edited some reports and put in them &quot;lattr.language$&quot;.<br />
<br />
- D7</div></div><hr />


<div class="post"><div class="posttop"><div class="username">günther</div><div class="date">18th May 2009, 09:41</div></div><div class="posttext">Oops, sorry. But I think there is still a chance:<br />
1. In reports, the predefined variable prog.name$ contains the full name of the report starting with &quot;r&quot; and ending with the reports language, e.g.  &quot;2&quot; (=english).<br />
2. So If we are able to retrieve that prog.name$ the rest would be easy, right? <br />
 <br />
=&gt; Could you try get.var(parent, &quot;prog.name$&quot;, full.report.name) to retrieve it?<br />
 <br />
Günther</div></div><hr />


<div class="post"><div class="posttop"><div class="username">david7</div><div class="date">18th May 2009, 09:48</div></div><div class="posttext">The parent of my script is &quot;ttstpsplclose&quot;, so, this is what will be in prog.name$.<br />
<br />
When my process starts, the report process (r...) will be finished already. So I can not get anything from it. Every get.var will direct me to the &quot;ttstpsplclose&quot; and I am not sure that that process does know the language of the report.<br />
<br />
The parent of &quot;ttstpsplclose&quot; (my script's grand parent) will be finished (dead) by the time my script starts.<br />
<br />
Any other ideas?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">günther</div><div class="date">18th May 2009, 10:04</div></div><div class="posttext">You're absolutely right; the printer driver gets started during/after ttstpclose.<br />
 <br />
Maybe a &quot;heuristical&quot; approach could help: The first argument of the printer driver (argv$(1)) contains the name of the spool file. So at least you could open it, read the first lines (eg. 10) and check if you find &quot;Page:&quot; (then it seems to be English), &quot;Seite:&quot; (then it seem to be German). Not perfect, but who cares?<br />
 <br />
Günther</div></div><hr />


<div class="post"><div class="posttop"><div class="username">david7</div><div class="date">18th May 2009, 10:32</div></div><div class="posttext">I am doning something similar right now. since not all reports have the same layouts, I am editing them first as I wrote before.<br />
<br />
If there is a generic way to get the report language it will be much easier.<br />
<br />
- D7</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Hitesh Shah</div><div class="date">19th May 2009, 08:24</div></div><div class="posttext">If u set the report language in the resport script either through free$  or procesinfo$ , u can access the same in device script . free$ is bshell instance variable and unique and no need to import / export .</div></div><hr />


<div class="post"><div class="posttop"><div class="username">david7</div><div class="date">19th May 2009, 09:13</div></div><div class="posttext">Thanks for the reply,<br />
<br />
As I said earlier I am looking for a solution that won't customize all the reports.<br />
<br />
Also as I mentioned the report process will end before my script starts.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Han Brinkman</div><div class="date">19th May 2009, 09:30</div></div><div class="posttext">Am I correct if I assume that you would like to know in your PROGRAM script what the report language will be?<br />
Perhaps you can explain us why you need it, what are you trying to solve?<br />
<br />
Regards,<br />
Han</div></div><hr />


<div class="post"><div class="posttop"><div class="username">david7</div><div class="date">19th May 2009, 09:35</div></div><div class="posttext">I will try to make it easy and give you a simple example.<br />
<br />
I am archiving the report via this script that I wrote as a device. I want to have a directory for every language. For example the german reports should be in &quot;Z:\GER&quot; and the english ones should be in &quot;Z:\ENG&quot;.<br />
<br />
As I said this is only part of the script. It does other things (that also depends on the language) to the report before archiving.<br />
<br />
I hope this explains it better.<br />
<br />
- D7</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Hitesh Shah</div><div class="date">19th May 2009, 10:21</div></div><div class="posttext">U may check last printed report for the user in ttaad320 (or maybe with spool.id variable if accessible) . The language in ttaad320 probably is the report language . I could not test due to lack of other language reports .</div></div><hr />


<div class="post"><div class="posttop"><div class="username">david7</div><div class="date">19th May 2009, 10:30</div></div><div class="posttext">I have checked that already, and the language field is always empty! other fields are good.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">david7</div><div class="date">5th August 2009, 17:27</div></div><div class="posttext">Does anyone know why is the language field in the device queue table (ttaad320.clan) is always empty?<br />
<br />
Is there a switch somewhere that will log this variable too?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Marioth</div><div class="date">5th August 2009, 18:13</div></div><div class="posttext">I looked in our system and it is always filled, so I think it has to do with the set up, but at the moment I don't know yet where to set it, but I will search for it or maybe somebody else has a clue.<br />
<br />
Regards,<br />
<br />
Mario</div></div><hr />


<div class="post"><div class="posttop"><div class="username">david7</div><div class="date">5th August 2009, 18:24</div></div><div class="posttext">Thanks for your reply,<br />
<br />
Is it the language of the user who printed? or the language of the printed report?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Marioth</div><div class="date">5th August 2009, 19:00</div></div><div class="posttext">If I am correct it is the language of the report and not the user. <br />
<br />
Cheers,<br />
<br />
Mario</div></div><hr />



</div>
</body>
</html>