<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="inputstr.to.date function not working, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] inputstr.to.date function not working Tools Development" />
	
	<title>inputstr.to.date function not working [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="../index.html">Newbaanboard</a> &gt; <a href="../index.html">Baan Quick Support: Functional &amp; Technical</a> &gt; <a href="../index.html">Tools Development</a> &gt; inputstr.to.date function not working</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">ciavaglia</div><div class="date">10th July 2014, 21:32</div></div><div class="posttext">I'm getting no where with Baan support so I'm asking if anyone has had this issue.  My experience leads my to believe it's an issue in Baan's Porting Set.<br />
<br />
I need to convert strings into dates.  I understand that there is many ways to do this.  I'm not looking for other solutions.  I'm looking to use the standard inputstr.to.date() function as described in the Baan Programming Manual.<br />
<br />
My strings can come in 3 formats(mmddyy, m-d-yy, m-d-yyyy).<br />
Below is my program and parts of the datecurr file.<br />
<br />
4GL script:<br />
declaration:<br />
  long date.val<br />
<br />
choice.cont.process:<br />
on.choice:<br />
  date.val = inputstr.to.date(&quot;010114&quot;, &quot;%D015,2&quot;)  |This returns 735234<br />
  date.val = inputstr.to.date(&quot;1-1-14&quot;, &quot;%D045,2&quot;)   |This returns -1<br />
  date.val = inputstr.to.date(&quot;1-1-2014&quot;, &quot;%D099,2&quot;)  |This returns -1<br />
  choice.again()<br />
<br />
datecurr:<br />
D|0151|MDY|%02m%02d%02y|<br />
D|0152|MDY|%02m%02d%02y|<br />
D|0153|MDY|%02m%02d%02y|<br />
D|0154|MDY|%02m%02d%02y|<br />
D|0451|MDY|%m-%d-%02y|<br />
D|0452|MDY|%m-%d-%02y|<br />
D|0453|MDY|%m.%d.%02y|<br />
D|0454|MDY|%m/%d/%02y|<br />
D|0991|MDY|%m-%d-%04Y|<br />
D|0992|MDY|%m-%d-%04Y|<br />
D|0993|MDY|%m.%d.%04Y|<br />
D|0994|MDY|%m/%d/%04Y|</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">10th July 2014, 23:57</div></div><div class="posttext">I get same results on my system.  I even tried the %D() format and a couple of others.  Some return 0 most -1.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">günther</div><div class="date">11th July 2014, 12:00</div></div><div class="posttext">Hi.<br />
 <br />
First of all, have a look at your file $BSE/lib/datecurr, which should contain an entry &quot;D|0452|...&quot; with the expected format.<br />
 <br />
If not: <br />
1. Make a copy of that file(!)<br />
2. Use the Option &quot;Convert to Runtime&quot; (and re-login) in ttadv4180m000 to create the file.<br />
3. log off and on again. <br />
 <br />
Regards <br />
Günther</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ciavaglia</div><div class="date">11th July 2014, 14:41</div></div><div class="posttext">Gunther<br />
<br />
Please note a included a copy of the entries from my datacurr file in the original post.</div></div><hr />



</div>
</body>
</html>