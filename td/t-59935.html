<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="print report in windows printer, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] print report in windows printer Tools Development" />
	
	<title>print report in windows printer [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="../index.html">Newbaanboard</a> &gt; <a href="../index.html">Baan Quick Support: Functional &amp; Technical</a> &gt; <a href="../index.html">Tools Development</a> &gt; print report in windows printer</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">maheswar</div><div class="date">27th January 2011, 15:10</div></div><div class="posttext">Hi All,<br />
<br />
This in an different post about afs only.<br />
<br />
stpapi.put.field(&quot;tdakp9492m000&quot;,&quot;pono.f&quot;,str$(10))<br />
stpapi.put.field(&quot;tdakp9492m000&quot;,&quot;pono.t&quot;,str$(16))<br />
	<br />
stpapi.set.report(&quot;tdakp9492m000&quot;,&quot;rtdakp949211000&quot;,&quot;W&quot;,err.msg)<br />
       	if isspace(err.msg) then<br />
         	stpapi.continue.process(&quot;tdakp9492m000&quot;,err.msg)<br />
        endif<br />
<br />
hint:Here &quot;W&quot; (in stpapi.set.report function)is the device name of windows printer.<br />
<br />
I am using this above code to print a report in windows printer.<br />
but when i am executing my code this report is getting printed in windows printer directly and i am not able to see the preview.<br />
<br />
But according to my requirement i must able to see the preview.<br />
Please give me some solution.<br />
<br />
Thanks &amp; REgards,<br />
Maheswar</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">27th January 2011, 16:35</div></div><div class="posttext">Use Spool.preview (http://www.baanboard.com/baanboard/showthread.php?t=30614&amp;highlight=spool.preview).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">maheswar</div><div class="date">28th January 2011, 05:59</div></div><div class="posttext">Hi Sir,<br />
<br />
Thank you for suggestion.<br />
<br />
I have used this variable in my script.<br />
but  it is not giving any preview.<br />
<br />
<br />
Regards,<br />
Mahes</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">28th January 2011, 15:50</div></div><div class="posttext">Can you post the code and a screen shot of the device you are using?  Do you own the source code for that session(tdakp9492m000)?  Can you put it in debug mode and see what spool.preview is equal too when the report gets launched?  At one point in time (and I think I still do this) I had to export spool.copies and import it into a session to change the number of copies.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">maheswar</div><div class="date">28th January 2011, 16:17</div></div><div class="posttext">Hello Sir,<br />
<br />
<br />
I have tested in debug mode. this spool.preview is getting assigned , but no change in output.<br />
<br />
I am posting screen shot of device  and script also.<br />
Please check it.<br />
<br />
with <br />
Thanks &amp; Regards,<br />
Mahes</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">28th January 2011, 18:17</div></div><div class="posttext">Did you see that last post by jmartin? Move where spool.preview is set.<br />
<br />
<br />
function print.standard.report()<br />
{<br />
	string err.msg(80)<br />
	message(&quot;hello&quot;)<br />
	spool.preview= true    <br />
	stpapi.put.field(&quot;tdakp9492m000&quot;,&quot;orno.f&quot;,str$(10))<br />
	stpapi.put.field(&quot;tdakp9492m000&quot;,&quot;orno.t&quot;,str$(16))<br />
	<br />
	stpapi.put.field(&quot;tdakp9492m000&quot;,&quot;pono.f&quot;,str$(10))<br />
	stpapi.put.field(&quot;tdakp9492m000&quot;,&quot;pono.t&quot;,str$(16))<br />
	stpapi.set.report(&quot;tdakp9492m000&quot;,&quot;rtdakp949211000&quot;,&quot;W&quot;,err.msg)<br />
	  |spool.preview= 1    <br />
<br />
	if isspace(err.msg) then<br />
		stpapi.continue.process(&quot;tdakp9492m000&quot;,err.msg)<br />
	endif<br />
<br />
<br />
}<br />
<br />
<br />
I tested my code in that other thread and it no longer worked.  I had to move the spool.preview to before I called any stpapi code.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">maheswar</div><div class="date">29th January 2011, 05:46</div></div><div class="posttext">Hello Sir,<br />
<br />
<br />
Thank you for your valuable suggestions.<br />
<br />
I placed &quot;spool.preview=1 &quot; before any afs is called.<br />
<br />
so it is working fine.<br />
<br />
With <br />
Thanks &amp; Regards,<br />
Mahes</div></div><hr />



</div>
</body>
</html>