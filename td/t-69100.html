<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="unable to add code through QKey, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] unable to add code through QKey Tools Development" />
	
	<title>unable to add code through QKey [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="../index.html">Newbaanboard</a> &gt; <a href="../index.html">Baan Quick Support: Functional &amp; Technical</a> &gt; <a href="../index.html">Tools Development</a> &gt; unable to add code through QKey</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">VishalMistry</div><div class="date">18th July 2016, 16:45</div></div><div class="posttext">Hi all,<br />
<br />
I have to copy a tfgld1510s000 (sub-session) and make it main session. I also need to remove the filter criteria for this session.<br />
<br />
as this is a standard session, no source code is available. to make changes, i added a script in my vrc (tfgld1510) and also added |#parent under declaration section. <br />
<br />
anybody can guide me how and where i can add my own code under before.program section ? <br />
below is a code snippet of before.program section:<br />
<br />
before.program:<br />
	| This must be executed first; it loads the parent object<br />
	| dll so it's routines can be called.<br />
	| &quot;find_parent_obj&quot; is an exported function that is in<br />
	| the tccomqcidll1 library.<br />
	if (find_parent_obj(&quot;otfgld1510&quot;, &quot;otfgld1510&quot;, _pobj_path) &lt; 0) then<br />
	  message(&quot;Unable to find parent object dll!&quot;)<br />
	  end()<br />
	endif<br />
<br />
	_pobj_dll_id = load_dll(_pobj_path,0)<br />
	if (_pobj_dll_id &lt;= 0) then<br />
	  message(&quot;Unable to load parent object dll!&quot;)<br />
	  end()<br />
	endif<br />
	_pobj_exe1(&quot;before.program&quot;)<br />
<br />
what i need to do is remove the filter applied in standard script.<br />
<br />
Request to guide me in this regard.<br />
<br />
Vishal</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joy Conner</div><div class="date">18th July 2016, 20:08</div></div><div class="posttext">did you add qkey library to session?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">18th July 2016, 20:12</div></div><div class="posttext">Actually you wanted to you could strip the code back down to nothing but a |#parent. Then just add the before.program and the code you want.  Then compile it and see what happens. Or this is a sample from one of mine. You could add more code below in 2 spots before or after the original call to before program.  If you want to suppress the call to the original codes before.program then try the |#inhibit command. Never tried that with before.program, but it works on form field events.<br />
<br />
before.program:<br />
| You could put code here.<br />
	|#pobj added by QKEY 3.70<br />
	| This must be executed first; it loads the parent object<br />
	| dll so it's routines can be called.<br />
	| &quot;find_parent_obj&quot; is an exported function that is in<br />
	| the tccomqcidll1 library.<br />
	if (find_parent_obj(&quot;otisfc0101&quot;, &quot;otisfc0101&quot;, _pobj_path) &lt; 0) then<br />
	  message(&quot;Unable to find parent object dll!&quot;)<br />
	  end()<br />
	endif<br />
<br />
	_pobj_dll_id = load_dll(_pobj_path,0)<br />
	if (_pobj_dll_id &lt;= 0) then<br />
	  message(&quot;Unable to load parent object dll!&quot;)<br />
	  end()<br />
	endif<br />
	|#end add by QKEY<br />
	|#call<br />
	|#pobj added by QKEY 3.70<br />
	_pobj_exe1(&quot;before.program&quot;)<br />
	|#end add by QKEY<br />
	doing.update = false<br />
| You could put other code here.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">VishalMistry</div><div class="date">19th July 2016, 10:47</div></div><div class="posttext">Hi,<br />
<br />
I think we don't need to as the library is added by QKey itself as we are using version 3.72.<br />
<br />
Vishal</div></div><hr />


<div class="post"><div class="posttop"><div class="username">VishalMistry</div><div class="date">19th July 2016, 13:44</div></div><div class="posttext">Hello Mark,<br />
<br />
It's been almost 6 months I touched QKey. After following your advice, my issue is resolved now.<br />
<br />
Many thanks.<br />
<br />
Vishal</div></div><hr />



</div>
</body>
</html>