<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="Calculation Sum for variable, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] Calculation Sum for variable Tools Development" />
	
	<title>Calculation Sum for variable [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="../index.html">Newbaanboard</a> &gt; <a href="../index.html">Baan Quick Support: Functional &amp; Technical</a> &gt; <a href="../index.html">Tools Development</a> &gt; Calculation Sum for variable</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">ainulm</div><div class="date">9th August 2014, 03:26</div></div><div class="posttext">Hi All,<br />
<br />
I would like to ask. How should i calculate sum for a &quot;variable A&quot; that has been declared in program script.<br />
Eg.<br />
<br />
Variable A: rep.acp.amount.<br />
<br />
Since i cannot access to program script. may I know how to handle this problem? (fyi:I have tried using function total in Aggregate Function, but the value is not right)<br />
Thanks for those who help.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bdittmar</div><div class="date">9th August 2014, 13:21</div></div><div class="posttext">Hi All,<br />
<br />
I would like to ask. How should i calculate sum for a &quot;variable A&quot; that has been declared in program script.<br />
Eg.<br />
<br />
Variable A: rep.acp.amount.<br />
<br />
Since i cannot access to program script. may I know how to handle this problem? (fyi:I have tried using function total in Aggregate Function, but the value is not right)<br />
Thanks for those who help.<br />
<br />
Hello,<br />
you say A is declared in program script, so you have access to program script.<br />
Therefor calculation can be done in selectdo with A = A + amount<br />
<br />
If i'm not right, give more details for your requirement, please<br />
<br />
Regards</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ainulm</div><div class="date">11th August 2014, 02:32</div></div><div class="posttext">Hi Bernd,<br />
Thank you for your reply,<br />
My system does not have developer license. So i dont have access to Program Script.<br />
<br />
I want to calculate total in report &quot;Print Related Sales Invoices and Purchase Invoices&quot;.<br />
User required to have total in Sales Invoices and Purchase Invoices. <br />
<br />
Eg:In After.field report, I have select total in 'Aggregate Function' for Sales Invoices. But the problem arise when it sum for both Sales Invoices and Purchase Invoices amount. How should i make a total for only Sales Invoices? Please help. You may refer to attachment for more details. <br />
Thank you in advance</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bdittmar</div><div class="date">11th August 2014, 08:19</div></div><div class="posttext">Hi Bernd,<br />
Thank you for your reply,<br />
My system does not have developer license. So i dont have access to Program Script.<br />
<br />
I want to calculate total in report &quot;Print Related Sales Invoices and Purchase Invoices&quot;.<br />
User required to have total in Sales Invoices and Purchase Invoices. <br />
<br />
Eg:In After.field report, I have select total in 'Aggregate Function' for Sales Invoices. But the problem arise when it sum for both Sales Invoices and Purchase Invoices amount. How should i make a total for only Sales Invoices? Please help. You may refer to attachment for more details. <br />
Thank you in advance<br />
<br />
Hello,<br />
<br />
try to use the TOTALs with print condition (SALES , PURCHASE)<br />
<br />
Regards</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ainulm</div><div class="date">11th August 2014, 09:08</div></div><div class="posttext">Hi Bernd,<br />
Ive tried to put the field &quot;rep.sli.amount&quot; which represent as &quot;Sales Invoice&quot; amount in the print condition. but it doesnt change anything. please help. :(</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bhushanchanda</div><div class="date">11th August 2014, 10:04</div></div><div class="posttext">Hi,<br />
<br />
One more thing you can try is, I guess you might be having access to Report Script. If yes, then you can declare one more variable. In the layout section of the Sales Invoices, in before.layout subsection, keep adding the amounts and add this on the report layout.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ainulm</div><div class="date">11th August 2014, 10:15</div></div><div class="posttext">Hi bhushanchanda,<br />
thank you for your reply.<br />
<br />
Yes, i do have access to Report Script. I dont understand what you mean for 'keep adding the amounts',<br />
can you please guide me in details? im still new in creating script in report. :(</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bhushanchanda</div><div class="date">11th August 2014, 10:22</div></div><div class="posttext">Hi,<br />
<br />
Declare a variable in report script say, si.tot<br />
<br />
Now, check the layout which is printing the Sales Invoice lines. <br />
<br />
e.g if the layout is detail.1 and the amount printed is temp.amnt then, you can write this:-<br />
<br />
detail.1:<br />
before.layout:<br />
si.tot = si.tot + temp.amnt<br />
<br />
Hence, after all the lines are printed, you will have si.tot which is storing the total.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ainulm</div><div class="date">11th August 2014, 10:40</div></div><div class="posttext">Hi Bhushan,<br />
<br />
I tried using your method. but it display as '0.00'. I set as 'amount' in the layout field. <br />
Below is my script, please let me know if i did anything wrong. thank you.<br />
<br />
<br />
declaration:<br />
<br />
	extern 	domain 	tcamnt	amount<br />
<br />
after.field.1:<br />
before.layout:<br />
	amount = amount + rep.acp.amount</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bhushanchanda</div><div class="date">11th August 2014, 10:43</div></div><div class="posttext">Hi,<br />
<br />
Yes, you are adding the total amounts. Please use the layout section which is printing the detail lines.<br />
<br />
If possible post a snapshot of your layouts.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ainulm</div><div class="date">11th August 2014, 11:19</div></div><div class="posttext">Hi Bhushan, <br />
<br />
User request not to print details. They just want to print the total amount of Purchase Invoice and Sales Invoice separately. <br />
<br />
Please refer the attachment for my layout.<br />
<br />
So the value for each Total Sales Invoice and Total Purchase Invoice should be print accordingly. <br />
Problem happen when both Total Sales Invoice and Total Purchase Invoice sum up the whole amount. Please help. :(</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bhushanchanda</div><div class="date">11th August 2014, 11:47</div></div><div class="posttext">Hi,<br />
<br />
Make 1 as output expression in detail 1 and 2.<br />
<br />
In report script write:-<br />
<br />
detail.1:<br />
before.layout:<br />
sal.tot = sal.tot + variable_used_in_detail_as_sales_invoice_amount<br />
lattr.print = false<br />
<br />
detail.2:<br />
before.layout:<br />
put.tot = put.tot + variable_used_in_detail_as_purchase_invoice_amount<br />
lattr.print = false<br />
<br />
Now,<br />
<br />
These two variables will have the total amounts of purchase and sales.<br />
<br />
Try debugging the report if the variables are getting the values or not.<br />
<br />
Also make sure, if you are declaring the two variables in report script, do not add them as Report Input fields else they will always be printed as 0.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bdittmar</div><div class="date">11th August 2014, 13:04</div></div><div class="posttext">Hi Bernd,<br />
Ive tried to put the field &quot;rep.sli.amount&quot; which represent as &quot;Sales Invoice&quot; amount in the print condition. but it doesnt change anything. please help. :(<br />
<br />
Hello,<br />
<br />
is it a customized Report or a standard Report ?<br />
<br />
What is the session and reportcode?<br />
<br />
Regards</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ainulm</div><div class="date">14th August 2014, 04:01</div></div><div class="posttext">Hai Bhushan,<br />
<br />
Sorry for late reply.<br />
I keep trying your propose code,<br />
but why the value display ad hashtag. may refer to the attachment for details.<br />
Please help. :confused::confused:<br />
Thank you in advance.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bdittmar</div><div class="date">14th August 2014, 08:20</div></div><div class="posttext">Hai Bhushan,<br />
<br />
Sorry for late reply.<br />
I keep trying your propose code,<br />
but why the value display ad hashtag. may refer to the attachment for details.<br />
Please help. :confused::confused:<br />
Thank you in advance.<br />
<br />
Hello,<br />
<br />
use another Format for field.<br />
###### means, cannot Display because value is to big.<br />
<br />
Regards</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bhushanchanda</div><div class="date">14th August 2014, 08:29</div></div><div class="posttext">Hi, <br />
<br />
Also in report script initialize the two variables-<br />
<br />
before.program:<br />
sal.tot=0<br />
pur.tot=0</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ainulm</div><div class="date">14th August 2014, 08:51</div></div><div class="posttext">Hai Bernd,<br />
<br />
Thank you for your reply.<br />
I have tried used other format. the value is display.<br />
But when i calculate manually the value is different. is it the code correct?<br />
<br />
Bhushan,<br />
<br />
1. I have verified that im adding the amount at the both detail layout.<br />
2. I did not set 'TOTAL' in the after.field layout. <br />
<br />
Is there anything wrong with my code? please help :(<br />
Thank you in advance</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bhushanchanda</div><div class="date">14th August 2014, 09:38</div></div><div class="posttext">Hi,<br />
<br />
Check 2 things:-<br />
<br />
1. Verify that you are not adding the total fields but the amounts in detail layout.<br />
<br />
2. Check if you are not selecting the &quot;TOTAL&quot; for both the fields in the layout.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Aryaraj</div><div class="date">19th September 2015, 12:21</div></div><div class="posttext">Dear Sir,<br />
 <br />
When we go to report layout that time after inserting a field we can use aggregate function total but I want to use it in program script.How can we use it? or after printing the report whatever is printed with aggregate function can we store it in variable  for further processing? <br />
<br />
 Regards<br />
Aarya</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bhushanchanda</div><div class="date">19th September 2015, 13:03</div></div><div class="posttext">Yes, you can. Though its not advisable as any changes to layout i.e. adding or removing any total field will need a script retrofit as well. You can use following in your report script.<br />
<br />
total..0 (first total of layout)<br />
total..1 (second total of layout)<br />
...<br />
<br />
And so on.<br />
<br />
Note that, the order of total..x will change if there is any layout changes.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Aryaraj</div><div class="date">24th September 2015, 11:51</div></div><div class="posttext">Dear Bhushan Sir,<br />
<br />
I tried total(variable name) at report script but while compiling the report system gives error message as  Error: Unresolved reference to function 'total'.<br />
<br />
What else can we try?<br />
<br />
Regards<br />
Aarya</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bhushanchanda</div><div class="date">24th September 2015, 12:30</div></div><div class="posttext">Hi,<br />
<br />
You don't need any variable names. If you have 3 total fields in your report layout, you can access them using-<br />
<br />
total..0<br />
total..1<br />
total..2</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Aryaraj</div><div class="date">25th September 2015, 11:43</div></div><div class="posttext">Dear Bhushan sir,<br />
<br />
Its working.<br />
<br />
Thaaaxxxxx alots.<br />
<br />
Regards<br />
Aarya</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">25th September 2015, 17:31</div></div><div class="posttext">Keep in mind if you modify the report, and or subtract other total fields then the total.. variables might change which field they represent.  Just something you need to be aware of when using total.. variables.</div></div><hr />



</div>
</body>
</html>