<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="How to Use Db.Insert function to Insert multibyte strings, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] How to Use Db.Insert function to Insert multibyte strings Tools Development" />
	
	<title>How to Use Db.Insert function to Insert multibyte strings [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="../index.html">Newbaanboard</a> &gt; <a href="../index.html">Baan Quick Support: Functional &amp; Technical</a> &gt; <a href="../index.html">Tools Development</a> &gt; How to Use Db.Insert function to Insert multibyte strings</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">andrewzeng</div><div class="date">16th November 2005, 03:17</div></div><div class="posttext">When I Use this Funcnction <br />
<br />
then Record is Created ,But Whwmd957.Comm Is nothing<br />
<br />
<br />
function InsertData(domain whwmd.nodrno odno,domain whwmd.nodlno odln,string mtno,domain whwmd.nodtp odtp,domain whwmd.nstr100 odnm,domain whwmd.npkunt pkut,domain whwmd.nqty pknm,domain whwmd.nstr100 comm)<br />
{<br />
<br />
	long tableid <br />
	db.retry.point()<br />
	tableid = db.bind(&quot;twhwmd957&quot;)<br />
	<br />
	if tableid&gt;0 then	<br />
		<br />
		string pkid(20)<br />
		domain whwmd.nboid pkid<br />
		pkid = getnewid()<br />
		<br />
		db.insert(tableid,DB.RETRY)	<br />
		<br />
		whwmd957.pfid = pkid		<br />
		whwmd957.odno = odno		<br />
		whwmd957.odln = odln		<br />
		whwmd957.mtno = mtno<br />
		whwmd957.odtp = odtp<br />
		whwmd957.odnm = odnm<br />
		whwmd957.pkut = pkut<br />
		whwmd957.pknm	= pknm<br />
		whwmd957.comm = comm |this is multibyte strings<br />
			<br />
		commit.transaction()<br />
	else<br />
		message(&quot;Binding Error&quot;)<br />
	endif<br />
}</div></div><hr />


<div class="post"><div class="posttop"><div class="username">beginer</div><div class="date">16th November 2005, 08:30</div></div><div class="posttext">Hi,<br />
<br />
How is it that db.insert() is written before assigning the fields ????<br />
<br />
I suppose the record should not be created at all.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">en@frrom</div><div class="date">16th November 2005, 10:07</div></div><div class="posttext">You should first assign the correct field values, and only after that you should use db.insert().</div></div><hr />


<div class="post"><div class="posttop"><div class="username">andrewzeng</div><div class="date">21st November 2005, 02:41</div></div><div class="posttext">Record Is really created</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Youp2001</div><div class="date">21st November 2005, 11:41</div></div><div class="posttext">Ok, it can be that the record is created, but in order to create it with the correct values you should first assign all fields the correct value before doing an insert. <br />
<br />
If this is not possible for some reason you could first insert the record, add the field values and do an update of the record (make sure you have read the correct record for updating first with locking). <br />
<br />
Youp</div></div><hr />


<div class="post"><div class="posttop"><div class="username">baanbomb</div><div class="date">25th November 2005, 09:49</div></div><div class="posttext">may be you should use mb.import$() or mb.export$() or mb.cast.to.str$( string_expr )<br />
to convert your Comm string first.<br />
FYI:mb.import$(Comm,Comm) <br />
      Whwmd957.Comm = comm<br />
      db.insert(tableid,DB.RETRY)</div></div><hr />



</div>
</body>
</html>