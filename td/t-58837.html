<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="Output from Report to Excel is not in proper format, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] Output from Report to Excel is not in proper format Tools Development" />
	
	<title>Output from Report to Excel is not in proper format [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="../index.html">Newbaanboard</a> &gt; <a href="../index.html">Baan Quick Support: Functional &amp; Technical</a> &gt; <a href="../index.html">Tools Development</a> &gt; Output from Report to Excel is not in proper format</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">vaishali_sftdev</div><div class="date">14th July 2010, 10:10</div></div><div class="posttext">I am using this code:<br />
spool.fileout=(&quot;/home/129/mig.xls&quot;)<br />
brp_id1 = brp.open( &quot;rlpbpm040110000&quot;, &quot;F&quot;, 0 )<br />
<br />
Data output in the excel file:<br />
<br />
!&amp;220013!-416450!4   10!:      0.0028!K        14.000!Z      0.0028&quot;+22-01-2010&quot;6        14.000<br />
!&amp;220015!-416450!4   10!:      0.0046!K        23.000!Z      0.0046&quot;+19-01-2010&quot;6        23.000<br />
!&amp;220017!-416451!4   30!:      0.2000!K        10.000!Z      0.2000&quot;+27-01-2010&quot;6        10.000<br />
!&amp;220109!-416507!4   10!:      0.0200!K         4.000!Z      0.0200&quot;+25-06-2010&quot;6         0.000<br />
!&amp;220119!-416451!4   30!:     10.0000!K       500.000!Z     10.0000&quot;+08-07-2010&quot;6       500.000<br />
!&amp;220120!-416541!4   10!:      0.5000!K      5000.000!Z      0.5000&quot;+08-07-2010&quot;6     10000.000<br />
!&amp;220121!-416545!4   10!:      2.0000!K     10000.000!Z      2.0000&quot;+08-07-2010&quot;6     10000.000<br />
!&amp;220123!-416552!4   10!:      0.0100!K       100.000!Z      0.0100&quot;+07-07-2010&quot;6       600.000<br />
!&amp;220123!-416552!4   20!:      1.2500!K       500.000!Z      1.2500&quot;+07-07-2010&quot;6       600.000<br />
!&amp;220125!-416552!4   10!:      0.0200!K       200.000!Z      0.0200&quot;+14-07-2010&quot;6         0.000<br />
!&amp;220125!-416552!4   20!:      0.2500!K       100.000!Z      0.2500&quot;+14-07-2010&quot;6         0.000<br />
<br />
<br />
Please reply as soon as possible.. I am not getting what change I have to make in the code... Thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">14th July 2010, 15:33</div></div><div class="posttext">You are using a baan report to write an excel file.  That will not work.  You will have to write your own excel driver to get the file in an excel format.  There is some code in the Code and Utlities forum that might help you. Below is a little snippet of code where I create a csv file that (on our systems) launches excel.<br />
<br />
<br />
			temp.file = creat.tmp.file$(bse.tmp.dir$())<br />
			temp.file = strip$(temp.file)<br />
			newfile = seq.open(temp.file,&quot;w&quot;)<br />
			buff = &quot; RFQ Sequence,Item,Descriptopn,Buyer,Ord. Qty, Last Supplier, CDRS&quot;<br />
			rc = seq.puts(buff,newfile)<br />
		endif<br />
		old.buyr = tipgc001.buyr<br />
		buff = &quot;,=&quot; &amp; chr$(34) &amp; strip$(tdexi110.item) &amp; chr$(34) &amp; sprintf$(&quot; ,%s,%s,%d,=&quot;,tiitm001.dsca, tipgc001.buyr, tdexi110.oqty)<br />
			&amp; chr$(34) &amp; tdpur040.suno &amp; chr$(34) &amp; &quot;,&quot; &amp; newbuf &amp; &quot;,&quot; &amp; rfqbuf<br />
		rc = seq.puts(buff,newfile)<br />
		rc = seq.puts(buff,totfile)</div></div><hr />



</div>
</body>
</html>