<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="SQL query problem, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] SQL query problem Tools Development" />
	
	<title>SQL query problem [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="../index.html">Newbaanboard</a> &gt; <a href="../index.html">Baan Quick Support: Functional &amp; Technical</a> &gt; <a href="../index.html">Tools Development</a> &gt; SQL query problem</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">FrenoLeRoi</div><div class="date">23rd March 2007, 17:56</div></div><div class="posttext">I have a field in a table, which is a string field. This field can have also space/empty values<br />
<br />
In many cases this field is filled with an integer (converted to a string). I need to find the max integer value in the table for this field<br />
<br />
This is a wrong solution...<br />
-----------------------------------------------<br />
long temp<br />
<br />
select        &lt;field&gt;<br />
from          &lt;table&gt;<br />
where        &lt;field&gt; &lt;&gt; &quot;&quot;<br />
order by &lt;field&gt; desc<br />
selectdo<br />
    temp = lval(strip$ยง(&lt;field&gt;))<br />
    if temp then<br />
         break<br />
    endif<br />
endselect<br />
-----------------------------------------------<br />
...because, for example string &quot;100&quot; is less than string &quot;99&quot;.<br />
<br />
How can i do this?<br />
<br />
I use baanIV.<br />
<br />
Thanks a lot.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">23rd March 2007, 19:21</div></div><div class="posttext">Is this for a report?  More details are needed.  One way (http://www.baanboard.com/baanboard/showthread.php?t=7171&amp;highlight=string+sort) is to use qss.sort - do some searching on &quot;sorting&quot; and strings.  You should find plenty of solutions.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">srikarthy</div><div class="date">24th March 2007, 02:59</div></div><div class="posttext">Hi,<br />
<br />
If getting the maximum number is the only requirement you can write something like this since lval converts the string into an integer. <br />
<br />
long temp<br />
temp = 0<br />
<br />
select &lt;field&gt;<br />
from &lt;table&gt;<br />
where &lt;field&gt; &lt;&gt; &quot;&quot;<br />
selectdo<br />
if temp &lt; lval(strip$ยง(&lt;field&gt;)) then<br />
temp = lval(strip$ยง(&lt;field&gt;)) <br />
endif<br />
endselect</div></div><hr />


<div class="post"><div class="posttop"><div class="username">FrenoLeRoi</div><div class="date">25th March 2007, 15:31</div></div><div class="posttext">Thanks srikarthy, this can be a solution.<br />
<br />
I was wondering if there was a way to get this value just with the sql statement, something like &quot;order by lval(&lt;field&gt;) desc&quot;.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">en@frrom</div><div class="date">26th March 2007, 09:49</div></div><div class="posttext">Mark, I think the qss.sort is totally not necessary in this case, and therefor a serious waste of response time... (the sorting process is not very healthy for performance..)<br />
<br />
Srikarthy's suggestion works fine, and is the best option towards performance. <br />
<br />
I was wondering if there was a way to get this value just with the sql statement, something like &quot;order by lval(&lt;field&gt;) desc&quot;. In a normal query this is not possible<br />
<br />
Regards,<br />
Eli Nager</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">26th March 2007, 17:12</div></div><div class="posttext">Mark, I think the qss.sort is totally not necessary in this case, and therefor a serious waste of response time... (the sorting process is not very healthy for performance..)<br />
<br />
Srikarthy's suggestion works fine, and is the best option towards performance. <br />
<br />
 In a normal query this is not possible<br />
<br />
Regards,<br />
Eli Nager<br />
At this point I agree - but at the time I posted there really was enough information to determine what was really required.  I mean no tables were mention, etc. - so sometimes it is just a shot in the dark with responses. :)</div></div><hr />



</div>
</body>
</html>