<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="File Browser, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] File Browser Tools Development" />
	
	<title>File Browser [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="../index.html">Newbaanboard</a> &gt; <a href="../index.html">Baan Quick Support: Functional &amp; Technical</a> &gt; <a href="../index.html">Tools Development</a> &gt; File Browser</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">Bogdan</div><div class="date">26th April 2002, 14:47</div></div><div class="posttext">Hi,<br />
<br />
I want to browse files in a folder (local-WIN and server-AIX) and maybe to select them. Is it possible in BaaN IVc3?<br />
<br />
Thank you.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">NPRao</div><div class="date">26th April 2002, 20:33</div></div><div class="posttext">I guess I see 2 possible solutions -<br />
<br />
1. Use app_start to call the windows explorer.<br />
<br />
2. use the baan file/directory functions and maybe put the info on the gbf browser</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">26th April 2002, 23:10</div></div><div class="posttext">On the server side you can use the dir commands like dir.open, dir.entry, etc.  These commands would allow you to do what you are talking about on the server side.  Never could figure a way to do this on the client.<br />
<br />
Good Luck!<br />
<br />
Mark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Bogdan</div><div class="date">26th April 2002, 23:30</div></div><div class="posttext">Hi,<br />
<br />
Well, my basic ideea was to make a small session that simulate a ftp client (some of our users are using files as printer output and because they do not have access to ftp ...).<br />
Then I found that extraordinary code for importing into word, excel, pdf, etc., but I still want to do that; just for fun.<br />
<br />
Thanks a lot for yours help. I'll try yours sugestions.<br />
By the way where, I can find some help regarding BaaN OS integration (I mean functions, etc. for interacting with OS-es).My help seems to be incomplete. I know about seq.xxx but never heard about dir.xxx :confused: !<br />
Regarding app_start, I tried some time ago to use it, but with no result; I'll work harder on this side :o .<br />
<br />
Thank you</div></div><hr />


<div class="post"><div class="posttop"><div class="username">NPRao</div><div class="date">26th April 2002, 23:38</div></div><div class="posttext">You can refer to the tools dll - ttdllfilehand<br />
<br />
Library ttdllfilehand<br />
File Handling, also working for remote<br />
(38 Functions available)<br />
<br />
void  app.file( const string source(), const string target(), ref long ret )<br />
 <br />
long  cmp.files( const string source(), const string target() )<br />
 <br />
void  convert.filename.for.remote( const string source(), ref string target() )<br />
 <br />
void  copy.file( const string source(), const string target(), ref long ret )<br />
 <br />
long  copy.move.file( long copy, const string fpath(), const string tpath() )<br />
 <br />
long  cp.dir.and.subdirs( const string src(), const string trg() )<br />
 <br />
long  create.directory( const string directory() )<br />
 <br />
long  create.local.temp.file( const string path(), ref string local.path() )<br />
 <br />
long  dir.present( const string directory() )<br />
 <br />
long  edit.file( const string programm(), const string fname(), long read.only, [ string extension(50) ], [ long text.mode ], [ long jump.to.line ] )<br />
 <br />
long  file.cmp( const string file1(), const string file2() )<br />
 <br />
long  file.copy.or.move( const string source(), const string target(), [ long mode ] )<br />
 <br />
long  file.present( const string path() )<br />
 <br />
long  is_dir( const string dirname() )<br />
 <br />
long  is_file( const string path() )<br />
 <br />
long  local.to.remote( const string source(), const string target() )<br />
 <br />
long  mkdir.rem( const string directory() )<br />
 <br />
void  move.file( const string source(), const string target(), ref long ret )<br />
 <br />
long  mv.dir.and.subdirs( const string src(), const string trg() )<br />
 <br />
long  pack.patch( const domain ttadv.path path.dumps, const domain ttadv.path path.patch, const string patch.code() )<br />
 <br />
long  pattern.in.file( const string file(), const string pattern() )<br />
 <br />
long  read.vrc.from.patch( const string path.patch(), ref string target.vers(), ref string target.rele(), ref string target.cust() )<br />
 <br />
long  remote.to.local( const string source(), const string target() )<br />
 <br />
long  remove.local.temp.file( const string path(), ref string local.path() )<br />
 <br />
long  rm.dir.and.subdirs( const string src() )<br />
 <br />
void  ttadv0010.convert.filename( const string source(), ref string target() )<br />
 <br />
long  ttadv0010.file_copy( const string source(), const string target() )<br />
 <br />
long  ttadv0010.file_move( const string source(), const string target() )<br />
 <br />
void  ttdllfilehand.abort.wrb( )<br />
 <br />
void  ttdllfilehand.app.file.wrb( const string source(), const string target(), ref long ret )<br />
 <br />
void  ttdllfilehand.change.file.wrb( const string source(), ref long ret )<br />
 <br />
void  ttdllfilehand.commit.wrb( )<br />
 <br />
void  ttdllfilehand.copy.file.wrb( const string source(), const string target(), ref long ret )<br />
 <br />
domain ttadv.path  ttdllfilehand.creat.tmp.file.wrb( const string source() )<br />
 <br />
void  ttdllfilehand.db.retry.point.wrb( )<br />
 <br />
void  ttdllfilehand.move.file.wrb( const string source(), const string target(), ref long ret )<br />
 <br />
void  ttdllfilehand.rm.file.wrb( const string source(), ref long ret )<br />
 <br />
long  unpack.patch( const domain ttadv.path path.src, const domain ttadv.path path.dest )<br />
 <br />
more functions in the help file -<br />
<br />
Syntax<br />
<br />
long seq.open.local( string filename, string mode(2), [long remove.after.use] )<br />
<br />
Description<br />
<br />
This opens a specified file on the client system. It returns a file pointer, which you can use to identify the file in subsequent operations. The function supports long file names.<br />
<br />
Arguments<br />
<br />
filename	The name of the file that must be opened. If you do not specify a path name, the file is searched for in the directory where BW is loaded.<br />
mode	The mode in which the file must be opened. This can be one of the following options:r	Open for reading.w	Create for writing.a	Open for writing at end of file, or create for writing.In addition, you can add &quot;t&quot; to any of the above options if you want the file to be opened in text mode.<br />
remove.after.use	Use this optional argument to specify whether or not the file must be removed after it has been closed by seq.close.local():&lt;&gt;0 	file is removed<br />
    0	file is not removed<br />
Note<br />
<br />
You cannot use seq.*() functions in combination with the seq.*.local() functions. So, you cannot use seq.seek() or seq.rewind(), for example, on a file that was opened with seq.open.local(). <br />
<br />
Return values<br />
<br />
  &gt;0	success; file pointer is returned<br />
&lt;=0	error; file could not be opened<br />
<br />
Context<br />
<br />
ttdllbw library function.<br />
<br />
Let us know if you are looking for more info and your findings.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">alejandro</div><div class="date">27th April 2002, 01:26</div></div><div class="posttext">If in your system you have this dll tgbrg0019 &quot;File Selection&quot; you can call this function<br />
<br />
function extern long select.file(<br />
	domain	tgfile	path, <br />
		long	multi.select.allowed,<br />
	ref	string	selected(,),<br />
	ref	long	no.of.selected,<br />
		long	max.selected)<br />
<br />
It is very  powerfull and it will display the browser you are looking for, in server side.<br />
<br />
Little explanation:<br />
<br />
 path: You will see folders and files from this path<br />
multi.select.allowed: well as it sounds.<br />
selected: In  this variable will be put file you select<br />
the rest sounds simple, I think.<br />
<br />
If you need further details, let me know.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">~Vamsi</div><div class="date">27th April 2002, 02:25</div></div><div class="posttext">Alejandro,<br />
<br />
Very Cool. :cool:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Bogdan</div><div class="date">27th April 2002, 21:35</div></div><div class="posttext">Thank a lot guys <br />
<br />
Right now I can't test and use all the information you provided to me, but I'll do it next week and I'll let you know.<br />
<br />
Thank you again.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MrMarco</div><div class="date">29th April 2002, 20:06</div></div><div class="posttext">Guys!<br />
<br />
Can I say I have tried out the browser function call and it is SO cool! Is there a function that allows the contents of the selected file to be viewed in read-only mode? This would be the icing on the cake!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">alejandro</div><div class="date">29th April 2002, 20:22</div></div><div class="posttext">What do you mean?<br />
<br />
With the Browser you cannot create or insert files.<br />
<br />
Also a NOTE:<br />
<br />
To call this function you have to create a session or a dll<br />
<br />
Look at your log files (ttstperrlog) to see a new file named as log.ppmmm where you can see erros within the use of this functon.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">~Vamsi</div><div class="date">29th April 2002, 20:25</div></div><div class="posttext">Marco,<br />
<br />
If that functionality does not exist, it should be possible to extend the existing function. Let us know if you did it and if so how :).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Bogdan</div><div class="date">30th April 2002, 12:06</div></div><div class="posttext">Hi,<br />
<br />
I'm on a dead line. I made a session in witch I call select.file. First there were some missing gif-s and I got some errors but I put them in the right place and now in BSE/log is no error log file.<br />
<br />
When I'm launching the session there is a very short window &quot;flash&quot; and that's it. . I think something is missing.<br />
<br />
Are there some special var's initializations?<br />
<br />
The script is type 4 and the form is also 4.<br />
I'll try with a 3GL script, but until then maybe you can give me clue.<br />
<br />
Thanks a lot</div></div><hr />


<div class="post"><div class="posttop"><div class="username">alejandro</div><div class="date">30th April 2002, 12:37</div></div><div class="posttext">I think you have to call this function with zoom from the field you want to return files selected.<br />
<br />
That is how i use it, and it works.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Bogdan</div><div class="date">30th April 2002, 13:56</div></div><div class="posttext">Alejandro,<br />
<br />
Thanks for your great help, but still not working; anyway I think it should work in a regular session also, not only in a zoomed one.<br />
<br />
Can you provide me a small piece of script with the function call?<br />
<br />
This is mines(3GL):<br />
<br />
extern string    fisier.sursa.work(32,1)<br />
extern long      nrfis,naspa<br />
function main()<br />
{<br />
naspa=select.file(&quot;/work/Bob&quot;,1,fisier.sursa.work,nrfis,1)<br />
}<br />
<br />
I assumed that multi.select.allowed=1 means &quot;yes&quot; and max.selected=1 means only one file alloewd for selection.<br />
no.of.selected is the number of files selected?<br />
By the way, the function returns 0 (is it success?)<br />
<br />
;)  Is there a way for me to find out the exact sintax/usage for such kind of functions or the repository dll/scripts (e.g. tgbrg0019, ttdllbw, etc.) ;) <br />
<br />
Thank you again</div></div><hr />


<div class="post"><div class="posttop"><div class="username">alejandro</div><div class="date">30th April 2002, 15:34</div></div><div class="posttext">Here is the small piece of code you asked for, using your same way of working.<br />
<br />
I have tested it and worked fine.<br />
<br />
|************************************************<br />
|* tccomtestborra  0  VRC B40O c4 expl<br />
|* Test<br />
|* alejandro<br />
|* 30/04/02 [14:13]<br />
|************************************************<br />
|* Script Type: 0<br />
|************************************************<br />
	extern	string	fisier.sursa.work(256,2) <br />
	extern	long	nrfis,naspa <br />
function main() <br />
{ <br />
	naspa = select.file(&quot;&quot;,1,fisier.sursa.work,nrfis,2) <br />
	message(fisier.sursa.work(1,1))<br />
	message(fisier.sursa.work(1,2))<br />
} <br />
<br />
Little explanation:<br />
<br />
- I guess this function always returns 0<br />
- I gave more room to string contaning files<br />
- Number of files selected has to have the same value as the    second fisier.sursa.work dimension. 2 in my example<br />
- If you put &quot;&quot; as the init path, or a wrong path, the browser will begin in ${HOME} user's folder.<br />
- multi.select.allowed=1 means true  -  multi.select.allowed=0 means false <br />
<br />
In my system this works. If not in yours cannot understand why<br />
<br />
<br />
If you want to know object information use  <br />
 ttadv2439m000, but if the programmer did not write function's use in script, you only will see function definitions, but not use. This is the case for tgbrg0019.<br />
<br />
Hope this will help you,<br />
<br />
Alejandro</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MrMarco</div><div class="date">30th April 2002, 17:13</div></div><div class="posttext">Hi Bogdan,<br />
<br />
I used this peice of code and it works on our B40C c4 system:<br />
<br />
domain	tgfile		path<br />
domain	tcmcs.long	result,<br />
			no.of.selected,<br />
			max.selected<br />
<br />
domain	tcmcs.str80	z.selected(100)<br />
<br />
<br />
<br />
path = &quot;/baan/multisite/&quot;<br />
no.of.selected = 0<br />
max.selected   = 10<br />
<br />
result = select.file(path, 1, z.selected, no.of.selected, max.selected)<br />
<br />
Don't forget to include the DLL in the list of libraries on the session.<br />
<br />
Have fun!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">30th April 2002, 17:25</div></div><div class="posttext">I found a sample of where this is used - in the script tgbrg1245.  The second parameter is a true/false field.  <br />
<br />
It looks like the gif's on our system are in a different directory, not sure what I am going to do about that. I keep getting a permission error.<br />
<br />
<br />
Mark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">evesely</div><div class="date">30th April 2002, 18:42</div></div><div class="posttext">Here is some more info<br />
<br />
<br />
 The function does always return zero, but the 4th argument is set to the number of items selected (hence, it will be zero if nothing is picked)<br />
 In 4c4 (and perhaps elsewhere), there is an optional 6th parameter that, if non-zero, only shows and allows selection of directories</div></div><hr />


<div class="post"><div class="posttop"><div class="username">NPRao</div><div class="date">30th April 2002, 18:47</div></div><div class="posttext">Hi Ed,<br />
<br />
we are on the Beta-BaaN-5.2  and here is the function prototype-<br />
<br />
long	default.func.id	  | Default function id for enter/double click on leaf<br />
<br />
function extern select.file(domain tgfile path, <br />
			    long multi.select.allowed,<br />
			    ref string selected(,),<br />
			    ref long no.of.selected,<br />
			    long max.selected)<br />
{<br />
DLLUSAGE<br />
	Expl.:	- select file<br />
ENDDLLUSAGE<br />
<br />
	long	ignore, def.options<br />
	long	exit.value<br />
	long    i, ret<br />
	string	session.desc(60)<br />
<br />
I think there are only 5 parameters to this function, I will have to check the BaaN-5.2-GA code if there are any changes to this function.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">evesely</div><div class="date">30th April 2002, 19:19</div></div><div class="posttext">I looked on one of our ERP systems here, and it only has the five arguments.  That's interesting since the 4c4 change was made back in 1998 as part of solution 15855.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Bogdan</div><div class="date">30th April 2002, 21:39</div></div><div class="posttext">Hi,<br />
<br />
Well, about those gif's, I just copied them to GBF.gif folder; until now nothing seems to be wrong.<br />
<br />
But I still think something else is also missing or is in the wrong place. My sys is BaaN IVc3; maybe something is different from IVc4, but this function is used in IVc3 also (e.g. audit sequence).<br />
<br />
I tried also the code provided by alejandro and mrmarco, but no result.<br />
I'll keep digging.<br />
<br />
Thank you all</div></div><hr />


<div class="post"><div class="posttop"><div class="username">evesely</div><div class="date">30th April 2002, 22:14</div></div><div class="posttext">I think there is a problem with this functionality in IVc3.  I have tried the session Mark alluded to (tgbrg1245m000) on four different systems: IVc3 unix, IVc3 NT, IVc4 unix, and IVc4 NT.  The IVc4 versions worked, and the IVc3 versions gave the brief &quot;flash&quot; effect that others have noted.  I don't get any BW errors and can't see any log activity.<br />
<br />
BTW, it seems to work fine on V, too.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">30th April 2002, 22:35</div></div><div class="posttext">Evesely said:<br />
I think there is a problem with this functionality in IVc3. I have tried the session Mark alluded to (tgbrg1245m000) on four different systems: IVc3 unix, IVc3 NT, IVc4 unix, and IVc4 NT. The IVc4 versions worked, and the IVc3 versions gave the brief &quot;flash&quot; effect that others have noted. I don't get any BW errors and can't see any log activity. <br />
<br />
After the brief flash I did get some errors.  For the session I mentioned a log.tgbrg was created.  The errors in it pointed to the fact that the gif files that it used were not under ${BSE}/gif/GBF.gif directory.  So I have a request in with our admin to move the gif files or call Baan. I am not sure what he is going to try, but will get back to the group when I know something.<br />
<br />
I forgot - yes we are on 4c3.<br />
<br />
Mark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">alejandro</div><div class="date">1st May 2002, 00:44</div></div><div class="posttext">Mark, <br />
If you develop a session in tccom package-module, for example, that call this function, logs will be created in log.tccom file.<br />
<br />
So sure that you called the function from tgbrg, so your log is log.tgbrg.<br />
<br />
We saw the same errors with files. These files are used to put the graphics on the screen's icons. These icons are for going to the next file or the first, etc... similar than every standard BaaN form.<br />
<br />
What we did with these graphics files was to put them in a especific folder, in order to know which were copied, and put them (copying) in the right folder.<br />
<br />
Also in log.ppmmm file , you will see:<br />
- Session that called this function dll<br />
- User, time, etc...<br />
-Unix error if aplicable, no permissioin, etc...<br />
<br />
Alejandro</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">1st May 2002, 21:34</div></div><div class="posttext">Our application admin has placed a call with Baan. The solution he was given did not work.  Hopefully they will find a solution for us 4c3 users and I will post it when I have it.<br />
<br />
Mark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Bogdan</div><div class="date">2nd May 2002, 00:56</div></div><div class="posttext">Hi,<br />
<br />
Yes, the session I made and where is used select.file did not make any error log after I copied the missing gif's. But if I try to use the session tgbrg1245m000 I got an error log witch looks like that:<br />
02-03-06[00:38:09]baan: ******* S T A R T of Log message ******<br />
02-03-06[00:38:09]baan: Session: tgbrg1245m000 (foreground), process = 5<br />
02-03-06[00:38:09]baan: File   : ptggbfsrvlib0, line: 4093<br />
02-03-06[00:38:09]baan: Errors : e = 0, db.error = 0, lang: 2, comp: 0<br />
02-03-06[00:38:09]baan: init.text.gc(TEXT_GC)<br />
02-03-06[00:38:09]baan: failed, return value = UNIX ERROR 77 (-77), return<br />
02-03-06[00:38:09]baan: *********** E N D of Log message ******<br />
<br />
02-03-06[00:38:09]baan: ******* S T A R T of Log message ******<br />
02-03-06[00:38:09]baan: Session: tgbrg1245m000 (foreground), process = 5<br />
02-03-06[00:38:09]baan: File   : ptggbfsrvlib0, line: 1074<br />
02-03-06[00:38:09]baan: Errors : e = 0, db.error = 0, lang: 2, comp: 0<br />
02-03-06[00:38:09]baan: init.gc()<br />
02-03-06[00:38:09]baan: failed, return value = UNIX ERROR 77 (-77), return<br />
02-03-06[00:38:09]baan: *********** E N D of Log message ******<br />
<br />
02-03-06[00:38:09]baan: ******* S T A R T of Log message ******<br />
02-03-06[00:38:09]baan: Session: tgbrg1245m000 (foreground), process = 5<br />
02-03-06[00:38:09]baan: File   : ptgbrg00190, line: 58<br />
02-03-06[00:38:09]baan: Errors : e = 0, db.error = 0, lang: 2, comp: 0<br />
02-03-06[00:38:09]baan: gbf.init()<br />
02-03-06[00:38:09]baan: failed, return value = UNIX ERROR 77 (-77), return<br />
02-03-06[00:38:09]baan: *********** E N D of Log message ******<br />
It seems that some functions are missing or not working in tgbrgsrvlib and tgbrg0019; tgbrgsrvlib is used by tgbrg0019.<br />
<br />
Maybe somebody who has the sources for tgbrg0019 and tgbrgsrvlib can take a look to see what's the point with these functions ;)  ?<br />
<br />
See you soon</div></div><hr />


<div class="post"><div class="posttop"><div class="username">alejandro</div><div class="date">2nd May 2002, 01:14</div></div><div class="posttext">Bogdan,<br />
<br />
In your log appear this:<br />
02-03-06[00:38:09]baan: Errors : e = 0, db.error = 0, lang: 2, comp: 0  <br />
<br />
Are you executing tgbrg1245m000 from company 0?<br />
<br />
If so I think that in company 0 there are not any tgbrg tables defined.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Bogdan</div><div class="date">2nd May 2002, 01:41</div></div><div class="posttext">Hi Alejandro,<br />
<br />
yes in my example the company was 000, but i tried with other companies too and is not working (there are the same errors). It could be a configuration error? On the sistems I've been tested the enterprise modeler is installed but not configured. After all the dll is tgBRG0019. Do you use E.M. ?<br />
<br />
See you soon</div></div><hr />


<div class="post"><div class="posttop"><div class="username">alejandro</div><div class="date">2nd May 2002, 14:21</div></div><div class="posttext">Yes, we use DEM in our company. With dynamic nenu browser. When exporting and then importing models to other companies, i saw that zoom in tgbrg1245m000. When the menu browser appeared I began to investigate and...<br />
<br />
I think all your problems come from your BaaN version. You are in c3. Let us wait Mark Holland's report to support or better, I suggest you to open a case in Support. Sometimes solutions are different in different installations.<br />
<br />
I have heared that DEM c4 can be installed in c3. Do not know it comes with a patch or with a set of them. Support will tell you.<br />
<br />
I have not access to c3, so i  cannot help you very much, but am going see if in c4 those log messages can appear and when.<br />
<br />
But you started this thread asking for a bidirectional browser?<br />
<br />
If so, here is the other browser direction, local to server: Code (http://www.baanboard.com/baanboard/showthread.php?threadid=1910)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Bogdan</div><div class="date">4th May 2002, 17:20</div></div><div class="posttext">Alejandro,<br />
<br />
Yes indeed, I started this thread for both directions local and server (or even local and other ftp host, why not?); I saw the other thread you post for local side; I'll count on it, but what I'm bothering now is why this function is not working; I don't think it's a version bug; after all there is a genuine BaaN session calling this function; it must be a setting problem; I zoomed the tgbrg0019 dll and I found it's using 3 tables (ttdsk900, ttdsk903 and ttgfd400); the last one is not filled in my system, it' empty; also there are 2 refered tables (ttgfd100 and ttgfd101); both are empty.<br />
Can you check your system to see if these tables are filled? It's no hurry, I just want to reduce the unknown aspects.<br />
<br />
Thanks a lot for your support.<br />
<br />
P.S. maybe it's better to programm &quot;from the begining&quot; all this stuff?<br />
I don't know how to integrate both pieces of &quot;browsers&quot; into one form even if the tgbrg0019 will work.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">alejandro</div><div class="date">4th May 2002, 18:17</div></div><div class="posttext">In my system those tables you mentioned are empty too.<br />
<br />
In table ttdsk900 there first two rows read:<br />
<br />
Icons Group:GBF<br />
Description  :Generic Browser Framework<br />
Files:            : ${BSE}/gif/GBF.gif<br />
<br />
And the second only change Icons Group named GBF.gif<br />
<br />
We have not maken modifications in these tables.<br />
I still think your problem comes froom your BaaN software, you are in c3, I am in c4.<br />
<br />
On the other side of your question, I think it is not very difficult to put both browsers in the same session. You can create a new session. Two fields, one for server folders / files and one second for local folders / files. Put zoom on those fields to tgbrg0019 for the first field and a second zoom to the local PC dialog code posted on the second field.<br />
<br />
A buttom to execute ftp with functions client2server or server2client, and maybe a checkbox to select the direction of ftp you want.<br />
<br />
I think it can be a good project to share in the forum. Le us wait Vamsi, for example as moderator, what says and maybe he can lead this. I'm not an expert, but can collaborate. I think all pieces of the puzzle are in the board, only rest some &quot;joiners&quot; of these  pieces.<br />
<br />
Let us wait.<br />
<br />
I suggest you again to contact support in order to solve those problems you have with tgbrg0019.<br />
<br />
Alejandro</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">8th May 2002, 15:59</div></div><div class="posttext">I just thought I would let everyone know that this works on 4c3. <br />
We received this from baan:<br />
<br />
<br />
I see what you're saying. I checked it on my system and the zoom seems to work fine. Maybe you're having an older version of tgbrg1245m000. If you would take a look at solution 109412, you will find the latest version of this session.<br />
<br />
In addition, solution 15855 provides the latest version of the tgbrg0019. <br />
 <br />
<br />
With these two solution the tgbrg1245m000 session works fine.  My zoom also works - but I do get an error.  I am out of town and will not get a chance to work on my code until tomorrow.  I will post another update as soon as possible.<br />
<br />
Mark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">evesely</div><div class="date">8th May 2002, 21:00</div></div><div class="posttext">After installing 15855 (preceded by 15113, 15459, 15467, 15487, 15504, and 15681 if they are not already installed), the browser seems to work for me on 4c3.  The function in the library now also includes the only.directories argument I mentioned earlier in this thread.<br />
<br />
Thanks, Mark.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">vishbaan</div><div class="date">9th May 2002, 10:27</div></div><div class="posttext">Hi Marco/Alejandro<br />
<br />
This thread is interesting.<br />
<br />
I think we are looking for something similar to the result of running the session &quot;ttstperrlog&quot;.<br />
<br />
If you run this,<br />
  - it browses all the error log files<br />
  - allows you to select the log file<br />
  - and selected log file is sent to output device meaning we are <br />
    able to open the file, read and print.<br />
<br />
How to acheive the same as above using the select.file(...) function of tgbrg0019 dll.<br />
<br />
I tried thru a 4GL session type 4; I get a flash(?!); the functions returns 0; But I dont get any browser showing files from the path specified.<br />
<br />
<br />
	extern	domain	tgfile		fv.path<br />
		domain	tcmcs.str30	var.file(10)<br />
		domain	tcmcs.long	var.filenos<br />
		domain	tcmcs.long	var.ret<br />
<br />
choice.cont.process:<br />
on.choice:<br />
<br />
	var.ret = select.file(fv.path, 0, var.file, var.filenos, 2)<br />
<br />
<br />
thanks to help me working on it.<br />
<br />
VISH</div></div><hr />


<div class="post"><div class="posttop"><div class="username">alejandro</div><div class="date">9th May 2002, 15:10</div></div><div class="posttext">I think you have to make this changes:<br />
<br />
extern domain tgfile fv.path <br />
STRING var.file(255,2) <br />
domain tcmcs.long var.filenos <br />
domain tcmcs.long var.ret <br />
<br />
choice.cont.process: <br />
on.choice: <br />
<br />
var.ret = select.file(fv.path, 0, var.file, var.filenos, 2) <br />
<br />
Take a try and tell us.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">vishbaan</div><div class="date">12th May 2002, 09:49</div></div><div class="posttext">hi a'Jandero,<br />
<br />
I tried by declaring the file variable as STRING  var.file(255,2).<br />
<br />
But still the same problem. I dont get the file browser; It does not list the files...<br />
<br />
tks for ur further help. Should I hv to load any patches...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">evesely</div><div class="date">13th May 2002, 16:24</div></div><div class="posttext">Vishbaan,<br />
<br />
What version of Baan are you running?  If it is IVc3, see my post (up 4 from here).  There are several solutions.  My IVc4 systems are at SP8 and SP9, and they have no problems.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mbowen</div><div class="date">13th May 2002, 19:30</div></div><div class="posttext">Bogdan,<br />
I just used this function.  It is very handy.<br />
However, it did work for me at first either.<br />
I had to load a patch for the DLL and then it worked fine.<br />
Check if the object you are using in in your base VRC, if it is, then try loading the patch.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">manusatsangi</div><div class="date">29th May 2002, 15:11</div></div><div class="posttext">Hi,<br />
This select.file is useful if one wants an interactive browser.<br />
But, my requierment was to just get the list of files in a directory, something like 'ls' or 'dir'.<br />
I tried <br />
<br />
ret = app_start(&quot;dir&quot;, ...)<br />
<br />
but the stdout file gets no data populated even though value of ret = 0 (success). Maybe, because 'dir' is not an exe but an internal windows command.<br />
Could not run shell() or run.prog() command for this.<br />
Nearest to this what I get guess was dll function<br />
<br />
tgbrg0019.gbf.get.children()<br />
<br />
but no help on this available, and not desired results produced.<br />
In short, pls suggest some function which I can use in BaaN scripts which produces same result as <br />
<br />
dir c:\foo\bar &gt; c:\foobaroutput<br />
<br />
Warm Regards<br />
Manu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">29th May 2002, 16:18</div></div><div class="posttext">Are you looking for a list of files in a directory on the client or the server?  What type of OS are on your clients? If on the server what type of system is it(Unix or NT)?<br />
<br />
Sorry about all the questions but I hope they help others answer you questions. I do know on a unix server these commands work:<br />
<br />
      dir.open          |Open directory for reading<br />
      dir.open.tree     |Opens directory tree for reading<br />
      dir.entry         |Get one directory entry<br />
      dir.rewind        |Reset read pointer<br />
      dir.close         |Closes opened directory<br />
<br />
<br />
These commands allow you to read through a directory. <br />
<br />
Mark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">manusatsangi</div><div class="date">31st May 2002, 11:45</div></div><div class="posttext">Hi,<br />
Our server is Win 2000 Server, BaaN IV c4. Clients OS is Windows ME.<br />
I could look for list of files on server as well as client.<br />
I could not get help on dir.* commands.<br />
<br />
Warm Regards<br />
Manu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">manusatsangi</div><div class="date">6th June 2002, 13:45</div></div><div class="posttext">Hi,<br />
Just in case if my post missed attention of all, please send me the detail syntax of dir.* and file.* functions.<br />
I did not find these functions in man pages or any of the dlls.<br />
<br />
Warm Regards<br />
Manu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">6th June 2002, 15:24</div></div><div class="posttext">I am attaching a word document which contains some help on the commands.  The dir.* commands work on the server.  If you want something that works on the client your program could create and execute a simple bat.  Then read the file it created.<br />
<br />
Good Luck!<br />
<br />
Mark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">r_nagu</div><div class="date">17th June 2002, 22:53</div></div><div class="posttext">Hi,<br />
     I am trying to use the tgbrg0019 [File selection] dll to make a file browser. Fortunately we have the source code for this dll and while going though the select.file function with in this dll I came across this statement. <br />
	<br />
retval = gbf.init(gbf.current.library(), &quot;&quot;,<br />
	bit.or(GBF.MENU.ALL  ,  GBF.MENU.FILE.OPEN),<br />
	bit.or(GBF.BUTTON.ALL, GBF.BUTTON.FILE.QUIT),<br />
		def.options)<br />
<br />
I am trying to find out what gbf.current.library() statement does and which function or dll holds this function. I checked tggbfsrvlib but could not find gbf.current.library(). I am not sure where else it is stored. There are two includes which are specified in dll tfbrg0019, itggbfdefs&quot; &quot;itgcomlogging&quot; but I can not look at them since we dont have source for these includes.<br />
<br />
Does anybody know what gbf.current.library() is does?<br />
<br />
Appreciate your help.<br />
<br />
Thanks,<br />
NS</div></div><hr />


<div class="post"><div class="posttop"><div class="username">NPRao</div><div class="date">18th June 2002, 02:57</div></div><div class="posttext">Hi NS,<br />
<br />
the only info I found from the help manual is -<br />
<br />
<br />
Syntax<br />
string gbf.current.library()<br />
<br />
Description<br />
The gbf.current.library() is a macro, which is defined as: gbf.file.to.library(__FILE__). It makes an educated guess based on the current filename what the object name is.<br />
<br />
Arguments<br />
None<br />
<br />
Return values<br />
The run time object name of the object file.<br />
<br />
<br />
I think this function is present in the $BSE/include[baan-version]/bic_gbf file, which is a binary, so we cannot view it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">r_nagu</div><div class="date">18th June 2002, 17:16</div></div><div class="posttext">Hi Rao,<br />
	Thanks for the info. If gbf.current.library() is a macro, than I would imagine that I should be able to use this in a program script but, when I compile this following code:<br />
		<br />
	gbf.init(gbf.current.library(), test, 1,1,1)<br />
<br />
I get compilation error saying Unresolved reference to function gbf.current.library. I had dll tggbfsrvlib attached to the script. <br />
<br />
I also checked for file bic_gbf under $BSE/include6.1 but unable to find it.<br />
<br />
Any idea what might be causing this?<br />
<br />
Thanks,<br />
NS</div></div><hr />


<div class="post"><div class="posttop"><div class="username">NPRao</div><div class="date">18th June 2002, 21:50</div></div><div class="posttext">I checked a script which was using the gbf libraries,  I found these statements in the declaration section -<br />
<br />
<br />
|----------------------------------------------------------------------<br />
|Includes for the Graphical Browser Framework Functionality<br />
|----------------------------------------------------------------------<br />
	#include &lt;bic_menu&gt;<br />
	#include &lt;bic_pulldown&gt;<br />
	#include &lt;bic_bsf&gt;<br />
	#include &lt;bic_tt&gt;<br />
	#include &lt;bic_shell&gt;<br />
	#include &lt;bic_gbf&gt;	|* GBF defines<br />
<br />
<br />
	#pragma	used dll ottgbfprintasc<br />
	#pragma	used dll ottgbfsrvlib</div></div><hr />


<div class="post"><div class="posttop"><div class="username">frigyesg</div><div class="date">9th September 2002, 13:32</div></div><div class="posttext">Originally posted by lbencic <br />
...<br />
You can also issue regular unix commands, and I think local.  Such as &quot;ls&quot;.  So, what I have done it the past is send a directory listing to a temp file, then open the temp file up and parse through it to get the file names in the directory.  You can do what you want with it at that point. <br />
<br />
Is there a way to use the &quot;ls&quot; command for local directorys? I know about the seq...local commands, but i didn´t find a way to list a local directory to a temp file. But this is exact what i need, to find specific files without any user interaction. I can do this with &quot;appl_start&quot; and a dos &quot;batch&quot; file, but I´m not very happy with this solution.<br />
<br />
Best Regards<br />
Frigyes:confused:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">9th September 2002, 14:42</div></div><div class="posttext">Not sure if you are aware of this post (http://www.baanboard.com/baanboard/showthread.php?s=&amp;threadid=1910), but it uses VB for the local file browser.  This is the only other solution I have seen for the client side.<br />
<br />
Good Luck!<br />
<br />
Mark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Badre Alam</div><div class="date">18th September 2002, 07:47</div></div><div class="posttext">Hi, Bogdan<br />
<br />
I tried up your code with bit modification and it is working fine.<br />
<br />
here is the actual code :<br />
<br />
function Explorer.BaaN()<br />
{<br />
extern string work(32,1)<br />
extern long nr<br />
ret = EXEC_DLL_FUNCTION (&quot;otgbrg0019&quot;, &quot;select.file&quot;, ret1, <br />
		&quot;/usr/users/badre/&quot;, 0, work, nr, 0)<br />
}<br />
<br />
this will open the BaaN explorer with listing of all the dir. and files.<br />
<br />
<br />
Rgds<br />
<br />
Alam Badre<br />
<br />
BaaN/Unix/Informix (Admn.)<br />
Informix Certified Professional</div></div><hr />


<div class="post"><div class="posttop"><div class="username">gentercz</div><div class="date">18th February 2003, 16:25</div></div><div class="posttext">hi all,<br />
<br />
i tried to round up the previous posts to a small &quot;click and view&quot; logic.<br />
<br />
The function lists the content of the folder and lets you select ONE file (last argument of dll).<br />
Then this file will be displayed ... ( of course only ascii files make sense) ...<br />
<br />
<br />
	#pragma used dll ottdllbw<br />
	#pragma used dll ottdlldisplay<br />
	<br />
	<br />
	ret = EXEC_DLL_FUNCTION (&quot;otgbrg0019&quot;, &quot;select.file&quot;, ret1,<br />
		&quot;/baan4c4/&quot;, 0, work, nr, 1)<br />
	tmp.file = strip$(work(1,1) )<br />
	display.file( tmp.file, &quot;File: &quot; &amp; tmp.file, 80, 25, &quot;&quot;, &quot;&quot;, FALSE)<br />
<br />
Cheers,<br />
Jochen</div></div><hr />


<div class="post"><div class="posttop"><div class="username">günther</div><div class="date">22nd December 2003, 11:17</div></div><div class="posttext">Now this thread is quit complicated. <br />
<br />
@r_ragnu:<br />
I've been successful in getting an erp gbf example (check twiki) on ivc4. You should use:<br />
#include &quot;itggbfdefs&quot; instead of #include &lt;bic_gbf&gt;. Maybe some #defines are missing such as #define GBF.LEAF 3.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Badre Alam</div><div class="date">7th January 2004, 09:17</div></div><div class="posttext">yes, you can use the bic_info6.1 &lt;dllobject&gt;, this will list you all the functions available within the given dll, with proper syntax etc...<br />
<br />
<br />
Thanks<br />
<br />
Alam Badre</div></div><hr />



</div>
</body>
</html>