<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="BaanObj.ParseExecFunction question, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] BaanObj.ParseExecFunction question Tools Development" />
	
	<title>BaanObj.ParseExecFunction question [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="../index.html">Newbaanboard</a> &gt; <a href="../index.html">Baan Quick Support: Functional &amp; Technical</a> &gt; <a href="../index.html">Tools Development</a> &gt; BaanObj.ParseExecFunction question</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">2nd October 2001, 01:31</div></div><div class="posttext">What I would like to do is process a series of files through a function server from excel.  I have made a dll (it works) and borrowed some of the code from the Baan ole examples.  The problem is that when excel runs the macro it starts the dll running and then the macro just continues, I get a baanobj.error before the dll has finished processing the file. The dll currently does not return anything to the macro - basically I read a file and create another file with the data. I need to control the parse so it waits until the first file is processed and then runs the next file. Can someone help on this?? I get a -10 error everytime - it works for the first file and then stops.  Maybe if I new how to return a &quot;all done&quot; message it would wait before going to the next macro statement.  That is problem number 2.  Also I tried coding around the -10 error but it still only processed one file.<br />
<br />
Also I do not have the source to the tuoledll examples so I am not sure how to pass data back to excel.  This would be helpful when running into errors in the function server code.  I could also use some help with this.<br />
<br />
Thanks for any help or suggestions!<br />
<br />
Mark<br />
<br />
Here is the Excel Macro code:<br />
<br />
BaanObj.ParseExecFunction dllname, dllfunction<br />
' check result<br />
errormsg = &quot;&quot;<br />
if BaanObj.Error &lt;&gt; 0 Then<br />
    Select Case BaanObj.Error<br />
    Case Is = -1<br />
        errormsg = &quot;DLL Unknown&quot;<br />
    Case Is = -2<br />
        errormsg = &quot;Function Unknown&quot;<br />
    Case Is = -3<br />
        errormsg = &quot;Syntax Error in Function Call&quot;<br />
    End Select<br />
    MsgBox (&quot;Call to Baan DLL failed, error = &quot; &amp; errormsg)<br />
     close_baan<br />
End If</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">2nd October 2001, 23:21</div></div><div class="posttext">-10 error solved by increasing timeout.  The rest of my problems were solved by OLE expert Gordon. He sent me a sample DLL and excel code.</div></div><hr />



</div>
</body>
</html>