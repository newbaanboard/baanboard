<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="VB calls to BaanIVc, Customer table, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] VB calls to BaanIVc, Customer table Tools Development" />
	
	<title>VB calls to BaanIVc, Customer table [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="../index.html">Newbaanboard</a> &gt; <a href="../index.html">Baan Quick Support: Functional &amp; Technical</a> &gt; <a href="../index.html">Tools Development</a> &gt; VB calls to BaanIVc, Customer table</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">gous99</div><div class="date">17th June 2002, 23:57</div></div><div class="posttext">Hi, here is my VB code, I'm just trying to find a record in the customer table, and update a field.<br />
<br />
The problem is that the return value of the stpapi.find() call is always 0, as if it doesn't find the record. The record exists in Baan, maybe I'm not doing something, or I forgot something in my calls, but if someone sees something wrong, it would be greatly appreciated.<br />
<br />
Private Sub Command1_Click()<br />
Dim objBaan As New Baan4.Baan4<br />
<br />
Dim BaanSession, ErrStr As String<br />
Dim FindRet As Long<br />
<br />
Dim BaanKeyField, BaanUpdateField, BaanKeyValue As String<br />
<br />
BaanSession = &quot;tccom1101m000&quot;<br />
BaanKeyField = &quot;tccom010.cuno&quot;<br />
BaanKeyValue = &quot;RR&quot;<br />
BaanUpdateField = &quot;tccom010.namb&quot;<br />
BaanUpdateValue = &quot;This is a test&quot;<br />
<br />
objBaan.ParseExecFunction &quot;ottstpapihand&quot;, &quot;stpapi.put.fields(&quot; &amp; Chr(34) &amp; BaanSession &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; BaanKeyField &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; BaanKeyValue &amp; Chr(34) &amp; &quot;)&quot;<br />
<br />
FindRet = objBaan.ParseExecFunction(&quot;ottstpapihand&quot;, &quot;stpapi.find(&quot; &amp; Chr(34) &amp; BaanSession &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; ErrStr &amp; Chr(34) &amp; &quot;)&quot;)<br />
<br />
<br />
objBaan.ParseExecFunction &quot;ottstpapihand&quot;, &quot;stpapi.put.fields(&quot; &amp; Chr(34) &amp; BaanSession &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; BaanUpdateField &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; BaanUpdateValue &amp; Chr(34) &amp; &quot;)&quot;<br />
objBaan.ParseExecFunction &quot;ottstpapihand&quot;, &quot;stpapi.update(&quot; &amp; Chr(34) &amp; BaanSession &amp; Chr(34) &amp; &quot;,1,&quot; &amp; Chr(34) &amp; ErrStr &amp; Chr(34) &amp; &quot;)&quot;<br />
objBaan.ParseExecFunction &quot;ottstpapihand&quot;, &quot;stpapi.save(&quot; &amp; Chr(34) &amp; BaanSession &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; ErrStr &amp; Chr(34) &amp; &quot;)&quot;<br />
<br />
objBaan.ParseExecFunction &quot;ottstpapihand&quot;, &quot;stpapi.end.session(&quot; &amp; Chr(34) &amp; BaanSession &amp; Chr(34) &amp; &quot;)&quot;<br />
<br />
objBaan.Quit<br />
Set objBaan = Nothing<br />
<br />
End Sub</div></div><hr />


<div class="post"><div class="posttop"><div class="username">alejandro</div><div class="date">18th June 2002, 00:29</div></div><div class="posttext">You use stpapi.put.fields, is a mistake in your post or you are using it in your script?<br />
<br />
If I remember well, the right function is stpapi.put.field, without 's'</div></div><hr />



</div>
</body>
</html>