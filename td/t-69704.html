<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="How to use text.write() function, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] How to use text.write() function Tools Development" />
	
	<title>How to use text.write() function [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="../index.html">Newbaanboard</a> &gt; <a href="../index.html">Baan Quick Support: Functional &amp; Technical</a> &gt; <a href="../index.html">Tools Development</a> &gt; How to use text.write() function</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">showstuff11</div><div class="date">27th January 2017, 05:01</div></div><div class="posttext">Good morning,<br />
<br />
can i call for a help on how to use this text.write function,<br />
i cannot really understand on how to use this code..<br />
ths is from another post here in baanboard <br />
http://www.baanboard.com/baanboard/showthread.php?t=9968<br />
<br />
 t.no =  text.write( &quot;tdsls040.txtb&quot;, &quot;2&quot;, kw1,kw2, kw3, kw4, &quot;text&quot;, &quot;text&quot;, tmp.file )<br />
<br />
this is the condition im facing... a header remarks with 2 to more line of text<br />
<br />
please help me understand this function..</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bdittmar</div><div class="date">27th January 2017, 08:58</div></div><div class="posttext">Hello,<br />
<br />
text.write()<br />
Syntax:<br />
<br />
function long  text.write  (string text_field, string lang, string kw1, string kw2, string kw3, string kw4, string tgroup, string edit_opt, string tmp_file [, long bidi] [, string rtf_file])<br />
<br />
Description<br />
<br />
<br />
This adds a new text to the text manager and assigns a new text number to the text.<br />
<br />
<br />
Arguments<br />
<br />
string text_field The name of the new text field. See Text fields overview. This returns the text number for the new field.<br />
 <br />
string lang This specifies the language for the new text.<br />
 <br />
string kw1 Use these arguments to specify key words for the text.<br />
 <br />
string kw2  <br />
string kw3  <br />
string kw4  <br />
string tgroup This specifies the name of the text group to which the text must be assigned. If you specify an empty string here, the text is assigned to the user's default group.<br />
 <br />
string edit_opt This specifies the type of window in which the text must be displayed.<br />
 <br />
string tmp_file The name of the file where the text for the new field is stored. The contents of this file is changed before the text is stored, Long lines are wrapped to meet the line width of the text group to which the text is assigned.<br />
 <br />
[long bidi ] Use this optional argument to indicate the text alignment. Possible values are:<br />
<br />
true      text is right justified<br />
<br />
false    text is left justified; this is the default option<br />
 <br />
[string rtf_file ] The name of the file in which the RTF version of the text must be stored. This is an optional argument. The usage of this argument depends on the settings of the text group as defined in the tgroup argument. If this is an empty string, no text is retrieved and the function returns 0.<br />
 <br />
 <br />
Return values<br />
<br />
&gt;0        success; returns the number of lines written<br />
<br />
 &lt;0        error<br />
<br />
<br />
Include bic_text :<br />
<br />
#include &lt;bic_text&gt;<br />
             <br />
<br />
void<br />
             remove.textfields() ( const string field.name.string, ... ) <br />
<br />
void<br />
             set.file.for.textfield() ( const string field.name.string, const string filename ) <br />
<br />
long<br />
             text.copy() ( string text_field_to(17),   string text_field_from(17),   string kw1(17) mb, string kw2(17) mb,  string kw3(17) mb, string kw4(17) mb,  string tgroup(8), string edit_opt(15) ) <br />
<br />
long<br />
             text.copy.between.companies() ( string text_field_to(17),   string text_field_from(17),   long source_company,   long target_company, string kw1(17) mb,  string kw2(17) mb, string kw3(17) mb,   string kw4(17) mb, string tgroup(8),  string edit_opt(15) ) <br />
<br />
long<br />
             text.copy.language() ( long textnr, string lang_from,   string lang_to ) <br />
<br />
long<br />
             text.defaults() ( string text_field(17),   ref string tgroup(8),   ref string edit_opt(15),  [long comp_number] ) <br />
<br />
long<br />
             text.delete() ( string text_field(17), string lang ) <br />
<br />
long<br />
             text.edit() ( string text_field(17), string lang, string kw1(17) mb, string kw2(17) mb, string kw3(17) mb, string kw4(17) mb, string tgroup(8), string edit_opt(15),   long mode ) <br />
<br />
long<br />
             text.present.in.language() ( long textnr, string lang   [, ref long nr_lines ] ) <br />
<br />
long<br />
             text.read() ( string text_field(17), string lang,   ref string kw1(17) mb,   ref string kw2(17) mb,   ref string kw3(17) mb,   ref string kw4(17) mb,   ref string tgroup(8),   ref string edit_opt(15),   string tmp_file(256), long lock [,string rtf_file(256)] ) <br />
<br />
long<br />
             text.rewrite() ( string text_field(17), string lang,   string kw1(17) mb, string kw2(17) mb, string kw3(17) mb, string kw4(17) mb, string tgroup(8), string edit_opt(15),   string tmp_file(256) [, long bidi, string rtf_file(256)] ) <br />
<br />
long<br />
             text.to.buf() ( string text_field(17), string lang,   long nr_lines,  ref string buf(,)   [, long rtf.text] ) <br />
<br />
boolean<br />
             text.buf.to.field() ( string text_field(17), string buf ) <br />
<br />
boolean<br />
             text.set.keywords() ( string text_field(17), string kw1(17),   [, string kw2(17),  string kw3(17),   , long kw4(17)] ) <br />
<br />
boolean<br />
             text.set.language() ( string text_field(17), string language(1)) <br />
<br />
long<br />
             textfield.to.database() ( string text_field(17) ) <br />
<br />
long<br />
             textfield.to.buf() ( string text_field(17), ref string buffer ) <br />
<br />
long<br />
             text.window() ( string edit_opt(15),   ref long start_column,   ref long start_row,   ref long number_columns,   ref long number_rows ) <br />
<br />
long<br />
             text.write() ( string text_field(17), string lang, string kw1(17) mb, string kw2(17) mb, string kw3(17) mb, string kw4(17) mb,  string tgroup(8), string edit_opt(15),  string tmp_file(256) [, long bidi, string rtf_file(256)] ) <br />
<br />
<br />
Regards</div></div><hr />


<div class="post"><div class="posttop"><div class="username">alex.bonutti</div><div class="date">4th September 2017, 12:12</div></div><div class="posttext">Hi all,<br />
I'm developing a session extension with Tools 10.5 which should create and save a predefined text in purchase order footer. I've tried both via external variable or via database text field, text is created but I'm not able to commit the transaction and save it. This is a sample of my 4GL code:<br />
<br />
...<br />
file.tmp = creat.tmp.file$()<br />
ft = seq.open(file.tmp,&quot;w&quot;)<br />
<br />
text_body = &quot;Sample text&quot;<br />
ret = seq.puts(text_body, ft)<br />
seq.close(ft)<br />
<br />
ret = text.write(&quot;tdpur400.txtb&quot;, &quot;6&quot;, &quot;Purchase.&quot;, &quot;Order footer.&quot;, tdpur400.orno, &quot;&quot;, &quot;text&quot;, &quot;text&quot;, file.tmp)<br />
<br />
ret = dal.change.object(&quot;tdpur400&quot;)<br />
ret = dal.save.object(&quot;tdpur400&quot;)<br />
if ret &lt;&gt; 0 then<br />
    abort.transaction()<br />
	ret = dal.get.error.message(error.mess)<br />
	message(str$(ret) &amp; &quot; - &quot; &amp; error.mess)<br />
else<br />
	commit.transaction()<br />
	message(&quot;Footer text created for purchase order &quot; &amp; tdpur400.orno)<br />
endif<br />
...<br />
<br />
dal.get.error.message return value is 1.<br />
I made a few tries with DAL scripts<br />
<br />
ret = dal.change.object(&quot;tdpur400&quot;)<br />
dal.set.field(&quot;tdpur400.txtb&quot;, text_nr)<br />
ret = dal.save.object(&quot;tdpur400&quot;)<br />
<br />
<br />
or even db update funtions<br />
<br />
db.update(ttdpur400, db.retry)<br />
<br />
but transaction cannot be completed with DAL error<br />
<br />
Record ... cannot be saved in table Purchase Orders in company ...<br />
<br />
If I commit just the text.write function, a text is correctly saved in the database, but it can't be linked in my entity (which is a purchase order). Can someone help me?<br />
<br />
Thanks,<br />
Alex</div></div><hr />



</div>
</body>
</html>