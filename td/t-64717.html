<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="Report, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] Report Tools Development" />
	
	<title>Report [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="../index.html">Newbaanboard</a> &gt; <a href="../index.html">Baan Quick Support: Functional &amp; Technical</a> &gt; <a href="../index.html">Tools Development</a> &gt; Report</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">Aryaraj</div><div class="date">11th October 2013, 09:49</div></div><div class="posttext">Dear Concern,<br />
<br />
We want report in vertical format. Herewith attaching the document for your reference.<br />
<br />
<br />
Regards,<br />
Arya</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bhushanchanda</div><div class="date">11th October 2013, 10:33</div></div><div class="posttext">Hi,<br />
<br />
Haven't you got training to create reports?<br />
<br />
There are two ways in which you can create this report. 1st way is to use Classic Baan Report's which I think will not work in your case as it has a limit of 255 Characters only. The second way is to use seq.* functions to put your data in a file either excel or csv.<br />
<br />
There's one more way to do it i.e. SSRS.<br />
<br />
Now, going back to the logic, you can get all this data in table cisli245.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">11th October 2013, 18:20</div></div><div class="posttext">I have done this both ways that Bhushan has mentioned.  My report was based off work center information.<br />
<br />
The easiest way was to use variables for the headers and arrays for the details records.  So basically my program determined something like 8 month-year ranges.  So I had something like mon.year(8) for the headers - the header layout had mon.year(1) thru (8) in it.  <br />
<br />
Then I took my details layouts and had arrays for it also.  I would take each work center get standards actuals for the month in question.  So I had an array like act(8) - where (1) thru (8) corresponded to the header records for month and year.  So the flow of the program at a high level:<br />
(1) Get the months in question<br />
(2) For each work center:<br />
(3)    for each of the 8 months requested <br />
(4)          determine the month start and end from calendar<br />
(5)          get actuals each month<br />
(6)          get standard each month<br />
(7)    get next month<br />
(8)    send to report<br />
(9) get next work center requested<br />
<br />
Now the program was a lot more complicated than that - since it actually let them pick the reporting type (weeks or months) and how many (weeks or months) to generate for the report.  I think the max was 10 - but can't remember.<br />
<br />
So the best way to approach this from your side is to generate a report that first works for just one month using arrays. Then add on however many months you need or fit on the report.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bhushanchanda</div><div class="date">11th October 2013, 18:32</div></div><div class="posttext">Yes,<br />
<br />
As Mark said, the program can get a lot more complicated.<br />
But, if you know the use of seq.* functions, you can do it in a simpler way as well. Just create a header with the 4 quarter's i.e 12 months which will be hardcoded with 1 column as Item code. <br />
<br />
Take 12 variables for 12 months (in your case 12*4 = 48 :D). Now, based on the users input of date range, for every item, calculate the values for the variables. If the date range is for a few months out of 12, just keep the other variables as 0. When you collect the values for a single item, put it into the details lines. In this way build your report.<br />
<br />
One more way is to take the input as year and quarter. So, you will need to have lesser variables &amp; columns. Now, design the header with 3 months (in your case 3*4 = 12 variables). Now, add the months name in the header based on the users input.<br />
This can be a stable way of doing it. <br />
<br />
The only thing you will need to worry is how you can convince your users for the stable header.;) Later when you start going into advance programming, start developing the one as Mark mentioned, using arrays.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Aryaraj</div><div class="date">15th October 2013, 13:57</div></div><div class="posttext">Dear Sir,<br />
<br />
I know that we've limited space in report layout i.e 255. I've used tmp.date variable in report. <br />
And in Script i'm using this query <br />
tmp.date = str$(monthno)&amp;&quot;-&quot;&amp;str$(yearno)<br />
<br />
<br />
Regards,<br />
Arya</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Aryaraj</div><div class="date">21st October 2013, 12:50</div></div><div class="posttext">Dear Concern,<br />
<br />
Waiting for your reply<br />
<br />
Regards,<br />
Arya</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">21st October 2013, 16:03</div></div><div class="posttext">I am not sure who or what the question is?  Yes - you are limited to the number of input fields and number of characters per report line.  So you just figure out how many months you can report.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Aryaraj</div><div class="date">22nd October 2013, 14:33</div></div><div class="posttext">Dear Sir,<br />
<br />
My problem is that I want report (month Sale report)in vertical format. I'm attached document for your reference and also I want this report for 12 month basis. For eg.if I gave range from June to October it should print vertically. Herewith I attached existing report which is coming in horizontal format.Both Report I'll sent the existing one and the required report format.<br />
<br />
<br />
Regards,<br />
Arya</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">22nd October 2013, 17:11</div></div><div class="posttext">As Bhusan and I have pointed out - you have 2 options.  I would first limit the options to 3 or 4 months then you can determine how many months your report can support.<br />
<br />
Option 1 is to redesign the initial program to use arrays.  You could have 4 arrays by bp code - invoice qty, weight, assess value, and gross amount.  Write one or multiple subroutines to update the data for the BP code.  Send one record to the report.  The layout would have all 4 arrays(assuming enough space on the report).  I don't know you data, field limits, etc.  So I do not know if there is enough space.  On my reports I usually had less than a year - maybe 6 to 10 months.<br />
<br />
Option 2 is to take the original report and write it to disk.  Then ready it back in printing each month across the sheet.  Again it may not have enough space.  But you can read the data back into a record buffer.  <br />
<br />
Good Luck!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bhushanchanda</div><div class="date">22nd October 2013, 17:40</div></div><div class="posttext">Hi,<br />
<br />
tmp.date = str$(monthno)&amp;&quot;-&quot;&amp;str$(yearno)<br />
<br />
This piece of code will do no change to your report. This is just concatinating two variables which is of no use for your requirement. We have no idea what you are trying to do with this line. Anyway, you can't expect people to prepare reports for you, rather you can start working on what you want first and later when you face any problems you can come back and post your queries.<br />
<br />
Also, make sure you are well prepared with Baan Reporting &amp; Programming. If you are, you should first create sample reports using a single table, then go for joins etc. For your requirement, you will need a basic understanding of how to use select loops, how to print records, how to convert dates.<br />
<br />
As, you want month wise report, you will need to use special functions to convert your dates and much more. So, start with your self study. You can get Prog. Guide from Xtreme and study it. Also, there are many threads which will give you basic understanding of report printing. Also, when you are prepared, you can refer this thread too, Mark and I have already proposed few solutions for you.<br />
<br />
I am sure you will be get this report done soon. All the best :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">vamsi_gujjula</div><div class="date">22nd October 2013, 18:27</div></div><div class="posttext">Hi Aryaraj<br />
<br />
As everyone is saying there are two way <br />
<br />
1) where you create baan report ( this is generally for printing on paper, so  there is a limitation on paper width , similarly you have limitation on baan report i.e 255 chars)<br />
<br />
2)  you can create a file at server ( just like notepad file, and you can write as much data as you want with out limitation)  and transfer it local machine and open it as csv file<br />
<br />
<br />
i have used spool functions which is similar to creation of file , please go through the script and try to get the flow. ( check this function write.data(long rpt.no) )<br />
<br />
code not compiled ( as i simplified it)<br />
                                                                               <br />
|****************************** declaration section ***************************<br />
declaration:<br />
<br />
  table   twhinh501 | Cycle Counting Order Lines<br />
  table   twhinh500<br />
  table   twhinh521<br />
  table   twhinh520<br />
  table   ttcibd001<br />
  table   ttcmcs023<br />
  <br />
<br />
<br />
   extern  domain  tcorno           orno.f    fixed<br />
   extern  domain  tcorno           orno.t    fixed<br />
   extern  domain  tcpono           pono.f, pono.t<br />
   extern  domain  tccwar           cwar.f, cwar.t<br />
   extern  domain  whloca           loca.f, loca.t<br />
   extern  domain  tcmcs.str40       rpts      fixed<br />
   extern  domain  tcmcs.str30      type      fixed<br />
   extern  domain  tcmcs.str30      dtsl      fixed<br />
   extern  domain  tcitem           item.f,item.t<br />
   extern  domain  tccitg           citg.f,citg.t<br />
   extern  domain  whinh.vara       appr.f,appr.t<br />
   extern  domain  whinh.csst       ccst.f,ccst.t<br />
   extern  domain  tcncmp           comp.f,comp.t<br />
   extern  domain  tfgld.prod       prno<br />
   extern  domain  tfgld.year       year<br />
   extern  domain  tcdate           date.f,date.t<br />
   extern  domain  tcmcs.str40      list(3)        | report selection<br />
   extern  domain  tcmcs.str30     list1(3)        | for type of report <br />
   extern  domain  tcmcs.str30     list2(3)        | for date selection<br />
   extern  domain  tcdsca  cdis.dsca<br />
<br />
           domain  tccopr          ecpr<br />
           string  bucket(700),mon_year(10)<br />
	   long    rpts.option , dummy ,comp , type.option ,s.spool.id , dtsl.option,yy,mm<br />
	   boolean  rpt1.header,rpt2.header,split.year<br />
	   double  qvrc , amnt<br />
	domain tcsern cntn.f , cntn.t<br />
<br />
#define  delimiter &quot;|&quot;<br />
|chr$(9)<br />
<br />
|****************************** program section ********************************<br />
<br />
<br />
|****************************** group section **********************************<br />
<br />
group.1:<br />
init.group:<br />
   get.screen.defaults()<br />
	disable.group(3)<br />
	disable.fields(&quot;date.f&quot;,&quot;date.t&quot;,&quot;prno&quot;)<br />
<br />
<br />
|****************************** choice section ********************************<br />
<br />
choice.cont.process:<br />
before.choice:<br />
	check.all.input()<br />
on.choice:<br />
   execute(print.data)<br />
<br />
choice.print.data:<br />
before.choice:<br />
<br />
	<br />
after.choice:<br />
	read.main.table()<br />
   	if s.spool.id &gt; 0 then<br />
		spool.close()<br />
	else<br />
		Message(&quot;No data with in selection&quot;)<br />
	endif<br />
<br />
<br />
<br />
|****************************** field section **********************************<br />
<br />
<br />
field.comp.f:<br />
init.field: <br />
	comp.f = get.compnr()<br />
	comp.t = comp.f<br />
	<br />
when.field.changes:<br />
	comp.t = comp.f<br />
	<br />
field.orno.f:<br />
when.field.changes:<br />
	orno.t = orno.f<br />
	<br />
field.item.f:<br />
when.field.changes:<br />
	item.t = item.f<br />
	<br />
field.citg.f:<br />
when.field.changes:<br />
	citg.t = citg.f<br />
	<br />
field.pono.f:<br />
when.field.changes:<br />
	pono.t = pono.f<br />
	<br />
field.cwar.f:<br />
when.field.changes:<br />
	cwar.t = cwar.f<br />
	<br />
field.loca.f:<br />
when.field.changes:<br />
	loca.t = loca.f<br />
	<br />
field.date.f:<br />
when.field.changes:<br />
	date.t = date.f<br />
field.ccst.f:<br />
when.field.changes:<br />
	ccst.t = ccst.f<br />
	<br />
field.appr.f:<br />
when.field.changes:<br />
	appr.t = appr.f<br />
	<br />
field.rpts:<br />
init.field:<br />
	<br />
check.input:<br />
	<br />
when.field.changes:<br />
<br />
	<br />
	<br />
<br />
<br />
field.dtsl:<br />
init.field:<br />
	<br />
check.input:<br />
	<br />
	if isspace(dtsl) then<br />
		set.input.error(&quot;tcgenstring&quot;,&quot;Please fill the Date Selection&quot;)<br />
	endif	<br />
when.field.changes:<br />
      <br />
field.type:<br />
init.field:<br />
	list1(1,1) = &quot;Detail Report&quot; <br />
	list1(1,2) = &quot;Report By Item / Month&quot;	<br />
	list1(1,3) = &quot;Report By Item Group / Month&quot;<br />
	set.list.values.for.field (&quot;type&quot;,3,list1)<br />
	type = &quot;Detail Report&quot;<br />
	type.option = 1<br />
check.input:<br />
	<br />
	if isspace(type) then<br />
		set.input.error(&quot;tcgenstring&quot;,&quot;Please fill the Report Type Selection&quot;)<br />
	endif	<br />
<br />
field.year:<br />
init.field:<br />
        num.to.date(date.num(),year,dummy,dummy)<br />
	date.f = date.to.utc (year,1,1,0,0,0)<br />
		if utc.add( date.f, 1,0 , 0, 0, 0, -1, date.t ) &lt;&gt; 0 then<br />
			message(&quot;Error While Calculating date&quot;)<br />
		endif<br />
<br />
check.input:<br />
	if dtsl.option &lt;&gt; 3 and year = 0 then<br />
		set.input.error(&quot;tcgenstring&quot;,&quot;Invalid Year&quot;)<br />
	endif<br />
when.field.changes:<br />
	<br />
<br />
<br />
field.prno:<br />
check.input:<br />
	if dtsl.option = 2 and prno = 0 then<br />
		set.input.error(&quot;tcgenstring&quot;,&quot;Invalid Year&quot;)<br />
	endif<br />
when.field.changes:<br />
<br />
<br />
<br />
|****************************** function section ******************************<br />
<br />
functions:<br />
<br />
function read.main.table()<br />
{<br />
	long curr.comp<br />
	curr.comp = get.compnr()<br />
<br />
	select tcemm170.comp:comp<br />
	from tcemm170<br />
	where tcemm170._index1 inrange {:comp.f} and {:comp.t}<br />
	and tcemm170.ctyp &lt;&gt; tcemm.ctyp.financial<br />
	selectdo<br />
			rpts.option = 1<br />
			type.option = 3<br />
		if switch.to.company(comp) = 1 then<br />
			on case type.option <br />
<br />
			case 3:<br />
				on case rpts.option<br />
				case 1:<br />
					get.cycle.counting.by.itemgroup()<br />
					break<br />
				break<br />
			default:<br />
				break<br />
			endcase<br />
		endif<br />
	selecteos<br />
		switch.to.company(curr.comp)	<br />
	endselect<br />
}<br />
<br />
<br />
<br />
|********* Functions related to report by item group<br />
<br />
<br />
function get.cycle.counting.by.itemgroup()<br />
{<br />
long i<br />
domain  tcdate month.first.day , month.last.day<br />
select<br />
       tcmcs023.citg,         | item group <br />
       tcmcs023.dsca,         | Description<br />
       sum(whinh501.qvrc):qvrc,         | Variance Qty  <br />
       sum(whinh501.amnt):amnt         | Valuation Amount<br />
       <br />
from<br />
       whinh500,              | Cycle Counting Orders<br />
       whinh501,              | Cycle Counting Order Lines<br />
       tcibd001,              | Items - General<br />
       tcmcs023<br />
where   whinh501._index1 inrange {:orno.f, :cntn.f, :pono.f}<br />
                            and  {:orno.t, :cntn.t, :pono.t} and<br />
       whinh500._index1 refers to whinh501 and<br />
       whinh501.item refers to tcibd001 and<br />
       tcibd001.citg refers to tcmcs023 and<br />
       whinh501.item inrange :item.f and :item.t and<br />
       whinh501.cdat inrange :date.f and :date.t and<br />
       whinh501.cwar inrange :cwar.f and :cwar.t and<br />
       whinh501.loca inrange :loca.f and :loca.t and<br />
       tcibd001.citg inrange :citg.f and :citg.t and<br />
       whinh500.ccst inrange :ccst.f and :ccst.t and<br />
       ((:rpts.option &lt;&gt; 2 and whinh501.appr inrange :appr.f and :appr.t )<br />
          or  (:rpts.option  =  2))<br />
	group by tcmcs023.citg,tcmcs023.dsca<br />
        selectdo<br />
		bucket = &quot;&quot;<br />
		if not split.year then<br />
		bucket = str$(qvrc)&amp; delimiter &amp; str$(amnt)&amp; delimiter<br />
		else <br />
		<br />
			for  i = 1 to 12 step 1<br />
				month.first.day = date.to.utc (year,i,1,0,0,0)<br />
				if utc.add( month.first.day, 0, 1, 0, 0, 0, -1, month.last.day ) &lt;&gt; 0 then<br />
					message(&quot;Error While Calculating date&quot;)<br />
				endif<br />
	<br />
				get.cycle.counting.by.itemgroup.and.month(   month.first.day,<br />
									     month.last.day,<br />
									     tcmcs023.citg )<br />
				<br />
			<br />
			endfor<br />
		endif<br />
		write.data(1)<br />
	endselect<br />
<br />
}<br />
<br />
<br />
function get.cycle.counting.by.itemgroup.and.month(domain tcdate i.date.f , <br />
						      domain tcdate i.date.t , <br />
					              domain tccitg i.citg)<br />
{<br />
<br />
| 	double qvrc , amnt<br />
	select tcibd001_1.citg,sum(whinh501_1.qvrc):qvrc,sum(whinh501_1.amnt):amnt         | Valuation Amount<br />
       <br />
	from whinh500 whinh500_1,whinh501 whinh501_1,tcibd001 tcibd001_1<br />
	where   whinh501_1._index1 inrange {:orno.f, :cntn.f, :pono.f}<br />
                            and  {:orno.t, :cntn.t, :pono.t} and<br />
        whinh500_1._index1 refers to whinh501_1 and<br />
        whinh501_1.item refers to tcibd001_1 and<br />
        whinh501_1.item inrange :item.f and :item.t and<br />
        whinh501_1.cdat inrange :i.date.f and :i.date.t and<br />
        whinh501_1.cwar inrange :cwar.f and :cwar.t and<br />
        whinh501_1.loca inrange :loca.f and :loca.t and<br />
        tcibd001_1.citg = :i.citg and<br />
        whinh500_1.ccst inrange :ccst.f and :ccst.t and<br />
        ((:rpts.option &lt;&gt; 2 and whinh501_1.appr inrange :appr.f and :appr.t )<br />
          or  (:rpts.option  =  2))<br />
	group by tcibd001_1.citg<br />
        selectdo<br />
		bucket = bucket &amp; str$(qvrc)&amp; delimiter &amp; str$(amnt)&amp; delimiter<br />
        selectempty<br />
		bucket = bucket &amp; &quot; &quot; &amp; delimiter &amp; &quot; &quot; &amp; delimiter<br />
<br />
	endselect<br />
<br />
<br />
}<br />
<br />
<br />
<br />
<br />
|************* Common Functions<br />
<br />
function write.data(long rpt.no)<br />
{<br />
|  Has 6 cases depending on type.option and rpt.no<br />
<br />
string bucket.header(600)<br />
if s.spool.id = 0 then<br />
	s.spool.id = spool.open(&quot;&quot;,&quot;EA&quot;,0)<br />
	if s.spool.id &gt; 0 then<br />
		if split.year then  | dtsl.option = 1  and group by reports<br />
			bucket.header = concat$(delimiter, &quot;Jan-&quot;&amp;str$(year)&amp;&quot; Var. Qty&quot;, &quot;Jan-&quot;&amp;str$(year)&amp;&quot; Var. Amt&quot;,<br />
					   &quot;Feb-&quot;&amp;str$(year)&amp;&quot; Var. Qty&quot;, &quot;Feb-&quot;&amp;str$(year)&amp;&quot; Var. Amt&quot;,<br />
					   &quot;Mar-&quot;&amp;str$(year)&amp;&quot; Var. Qty&quot;, &quot;Mar-&quot;&amp;str$(year)&amp;&quot; Var. Amt&quot;,<br />
					   &quot;Apr-&quot;&amp;str$(year)&amp;&quot; Var. Qty&quot;, &quot;Apr-&quot;&amp;str$(year)&amp;&quot; Var. Amt&quot;,<br />
					   &quot;May-&quot;&amp;str$(year)&amp;&quot; Var. Qty&quot;, &quot;May-&quot;&amp;str$(year)&amp;&quot; Var. Amt&quot;,<br />
					   &quot;Jun-&quot;&amp;str$(year)&amp;&quot; Var. Qty&quot;, &quot;Jun-&quot;&amp;str$(year)&amp;&quot; Var. Amt&quot;,<br />
					   &quot;Jul-&quot;&amp;str$(year)&amp;&quot; Var. Qty&quot;, &quot;Jul-&quot;&amp;str$(year)&amp;&quot; Var. Amt&quot;,<br />
					   &quot;Aug-&quot;&amp;str$(year)&amp;&quot; Var. Qty&quot;, &quot;Aug-&quot;&amp;str$(year)&amp;&quot; Var. Amt&quot;,<br />
					   &quot;Sep-&quot;&amp;str$(year)&amp;&quot; Var. Qty&quot;, &quot;Sep-&quot;&amp;str$(year)&amp;&quot; Var. Amt&quot;,<br />
					   &quot;Oct-&quot;&amp;str$(year)&amp;&quot; Var. Qty&quot;, &quot;Oct-&quot;&amp;str$(year)&amp;&quot; Var. Amt&quot;,<br />
					   &quot;Nov-&quot;&amp;str$(year)&amp;&quot; Var. Qty&quot;, &quot;Nov-&quot;&amp;str$(year)&amp;&quot; Var. Amt&quot;,<br />
					   &quot;Dec-&quot;&amp;str$(year)&amp;&quot; Var. Qty&quot;, &quot;Dec-&quot;&amp;str$(year)&amp;&quot; Var. Amt&quot; )						   <br />
		endif<br />
<br />
	else<br />
		Mess(&quot;gbinh5401.1&quot;,1)<br />
		|Error while opening the Spool<br />
		end()<br />
	endif<br />
endif<br />
	<br />
		if not rpt2.header and not rpt1.header  then					|#627478-002.sn<br />
				<br />
			spool.pr.line = concat$( delimiter ,   &quot;Company&quot;,<br />
							       &quot;Order Type&quot;,<br />
							       &quot;Item Group&quot;, <br />
							       &quot;Description&quot;,<br />
							       trim$(bucket.header)	<br />
						)<br />
			spool.line()<br />
<br />
			rpt2.header = true<br />
		endif										|#627478-002.en<br />
<br />
<br />
<br />
		|cycle counting by item group<br />
								|#627478-002.eo<br />
			<br />
			spool.pr.line = concat$( delimiter ,   comp,<br />
							       &quot;Cycle Counting Order&quot;,<br />
							       tcmcs023.citg,         | item group <br />
							       trim$(tcmcs023.dsca),         | Description<br />
							       trim$(bucket)	<br />
						)<br />
			spool.line()<br />
<br />
			<br />
		endif<br />
		break<br />
<br />
	endcase<br />
<br />
     <br />
<br />
}<br />
<br />
<br />
<br />
<br />
<br />
function get.standard.cost.price( domain tcitem i.item)<br />
{<br />
	select ticpr007.ecpr:ecpr<br />
	from ticpr007<br />
	where ticpr007._index1 = {:i.item}<br />
	as set with 1 rows<br />
	selectdo<br />
	selectempty<br />
		ecpr = 0<br />
	endselect<br />
}<br />
<br />
<br />
function get.reason.code.desc(domain tccdis i.cdis)<br />
{<br />
	select tcmcs005.dsca:cdis.dsca<br />
	from  tcmcs005<br />
	where tcmcs005._index1 = {:i.cdis}<br />
	as set with 1 rows<br />
	selectdo<br />
	selectempty<br />
		cdis.dsca = &quot;&quot;<br />
	endselect<br />
}</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Aryaraj</div><div class="date">24th October 2013, 12:13</div></div><div class="posttext">Dear Sir,<br />
<br />
Waiting for your reply.<br />
<br />
Regards,<br />
Arya</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Aryaraj</div><div class="date">8th July 2014, 10:48</div></div><div class="posttext">Dear Sir,<br />
<br />
For month in horizontal format we have tried the below coding, and used totals(1),totals(2),.........,totals(12) this field in report layout. But still not getting. Please help us in this matter.<br />
<br />
		reset.vars()<br />
		utc.to.date(r.ddat,yearno,monthno,month_dayno,hours,minutes,seconds) <br />
		tmp.date = str$(monthno) &amp; &quot;-&quot; &amp; str$(yearno)			<br />
		<br />
		ret = utc.to.date(r.ddat, dummy, month, dummy, dummy, dummy, dummy)<br />
			totals(month) = totals(month) + cisli245.amth(1)<br />
			tot.amnt = tot.amnt + cisli245.amth(1)<br />
<br />
function reset.vars()<br />
{<br />
	tot.amnt = 0<br />
<br />
	for i = 1 to 12<br />
		totals(i) = 0<br />
	endfor	<br />
}</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">8th July 2014, 16:16</div></div><div class="posttext">What exactly is the problem? This code looks fine.  It will reset the total amount to 0 then add 1 amount to 1 month.  Now I would expect something like where you reset totals to 0 then do a select for maybe those cisli records and add each one to the appropriate month.  Then after all that totaling you do a report send for the record.  Then on the report you add 12 fields in the detail layout - totals(1) thru totals(12).  That would work.</div></div><hr />



</div>
</body>
</html>