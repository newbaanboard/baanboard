<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="Unknown Message????, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] Unknown Message???? Tools Development" />
	
	<title>Unknown Message???? [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="../index.html">Newbaanboard</a> &gt; <a href="../index.html">Baan Quick Support: Functional &amp; Technical</a> &gt; <a href="../index.html">Tools Development</a> &gt; Unknown Message????</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">Joy Conner</div><div class="date">14th November 2002, 17:19</div></div><div class="posttext">Has anyone received a message stating &quot;Unknown Message&quot;?<br />
<br />
<br />
Joy</div></div><hr />


<div class="post"><div class="posttop"><div class="username">baanprog</div><div class="date">14th November 2002, 19:41</div></div><div class="posttext">Do u mean a message() or a fatal error or a message when running a session and doing some operations or while programming?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joy Conner</div><div class="date">14th November 2002, 19:47</div></div><div class="posttext">This not a fatal error.  This is a message box that states &quot;Unknown Message&quot;.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">baanprog</div><div class="date">14th November 2002, 20:00</div></div><div class="posttext">When does this message come?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">14th November 2002, 20:15</div></div><div class="posttext">Could it be that one of the messages in whichever session has been deleted?  Do you see a message number in the message box?<br />
<br />
Mark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joy Conner</div><div class="date">14th November 2002, 20:25</div></div><div class="posttext">I use Qkey for customizations and have some customizations attached to tdinv1101m000.<br />
<br />
I have a library of custom functions.  One of the functions executes a VB script that reads serial port to retrieve data.  The function returns a value stored in variable named order.weight.<br />
<br />
In the session tdinv1101m000 I call the function as follows:<br />
<br />
order.weight = read.serial.port() and I get this message.  I step through the code and see that the call to read.serial.port is executing and returning the correct value.  I have been trying to isolate the problem, so I comment out the above line and replace it with order.weight = 9.62 and I do NOT get the message.<br />
<br />
I think my problem is structural so I generate a custom session with same variable placed on the form. Each time I press the continue key, it executes the same function displays the value on the form.  It works in custom session without message box stating &quot;Unknown Message&quot;.<br />
<br />
Joy</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joy Conner</div><div class="date">14th November 2002, 20:55</div></div><div class="posttext">The message is attached.<br />
<br />
Joy</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joy Conner</div><div class="date">15th November 2002, 21:15</div></div><div class="posttext">I have generated a report session.<br />
<br />
Now there are not Qkey customizations.  Just a BaaN script.  Three fields on the form.  The code reads as follows:<br />
<br />
field.quantity:<br />
when.field.changes:<br />
    weight = read.serial.port()<br />
    display(&quot;weight&quot;)<br />
<br />
When I put a value into the quantity field on the form, this produces error in attached message.<br />
<br />
Also, on the form is the continue button.  In the code, same program, the program reads <br />
Choice.cont.process:<br />
on.choice:<br />
     weight = read.serial.port()<br />
     display(&quot;weight&quot;)<br />
<br />
When I press the continue button on the form, the weight is displayed and no message is display.  The program behaves as I had intended.<br />
<br />
I'm still stumped.<br />
<br />
Joy Conner</div></div><hr />


<div class="post"><div class="posttop"><div class="username">baanprog</div><div class="date">15th November 2002, 21:43</div></div><div class="posttext">I think the problem lies in read.serial.port() function, it is stepping on the standard program flow and causing this problem, most probably.<br />
<br />
I have come across an instance where the message will not be displayed when it is in choice.cont.process, but I dont remember how and when.<br />
<br />
what is the code inside the read.serial.port() function, can u please post it also.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joy Conner</div><div class="date">15th November 2002, 22:01</div></div><div class="posttext">I thought so too.  But that does not explain why it works when it is executed via the continue button.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">16th November 2002, 00:14</div></div><div class="posttext">Glad to see someone besides me using Q-key.  Does this happen the minute you get to the When.field.changes section or the minute you step into the weight = read.serial.port() statement?<br />
Are you calling a DLL?  I was just wondering what that function main() was for - I have never put that in my DLL's.<br />
<br />
Mark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joy Conner</div><div class="date">16th November 2002, 00:23</div></div><div class="posttext">Hi Mark.  <br />
<br />
Thanks for your attention.  The function is buried in a dll and the dll is identified in the list of attached libraries.<br />
<br />
Joy</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">16th November 2002, 00:32</div></div><div class="posttext">Hi Joy!<br />
<br />
(1)Does it unknow message happen the minute you get into the when.field.changes section?<br />
<br />
(2) Or does it happen the minute you execute the weight = read.serial.port() DLL Function?<br />
<br />
And 3 was a curiosity question-<br />
<br />
(3) What purpose does the function main() server?<br />
I have never used it?<br />
<br />
Mark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joy Conner</div><div class="date">16th November 2002, 00:36</div></div><div class="posttext">I forgot to answer your other question....<br />
<br />
field.weight:<br />
when.field.changes:<br />
     weight = read.serial.port()<br />
     display.all()   &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;  this line produces the message.<br />
<br />
I thought &quot;function main()&quot; was required in dll's.  My consultants did that and I followed their practice, never questioning it.<br />
<br />
Joy</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">16th November 2002, 00:47</div></div><div class="posttext">I think what is happening is that it is looping. Try putting the display(&quot;weight&quot;) in another place. Maybe in the next fields before.input section.<br />
<br />
Mark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">16th November 2002, 00:51</div></div><div class="posttext">I just read my reply - not sure if that fixes the looping.  It looks like what would happen is that you change the weight and this activates the when field changes section.  Then you change the weight again and this I think would re-activate the when field changes section when you do the display.  So I think it needs to move, but I am not sure where.<br />
<br />
Mark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">shah_bs</div><div class="date">16th November 2002, 03:57</div></div><div class="posttext">Using when.field.changes would imply a keyboard or scanner input, and since the function read.serail.port() is not a form of keyboard input, I would suggest placing the weight=read.serial.port() in the before.field: sub-section. There would then (most probably) be no need to use the display.all() function.<br />
<br />
Although, the primary question about the unknown message remains unanswered ...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">baanprog</div><div class="date">16th November 2002, 13:00</div></div><div class="posttext">Remove the function main() it is not necessary in dll's.<br />
<br />
function main() is used in 3GL scripts and all the code is written in it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">baanprog</div><div class="date">18th November 2002, 22:03</div></div><div class="posttext">Joy,<br />
<br />
Did it get resolved?<br />
<br />
Regards</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joy Conner</div><div class="date">18th November 2002, 22:18</div></div><div class="posttext">After much pain on this one, I discovered that the following structure works....<br />
<br />
dll Library (as posted last week with no changes)<br />
<br />
function domain tcwght read.serial.port()<br />
{<br />
      code<br />
        &quot;<br />
        &quot;<br />
      return(weight)<br />
}<br />
<br />
Subsession as follows............<br />
declaration:<br />
       extern  domain tcwght order.weight<br />
before.program:<br />
        order.weight = read.serial.port()<br />
        put.var(parent, &quot;order.weight&quot;, order.weight&quot;)<br />
        end()<br />
<br />
Mainsession as follows..............<br />
declaration:<br />
      extern  domain  tcwght order.weight<br />
<br />
field.tdinv100.dqan:<br />
after.input:<br />
      zoom.to$(&quot;subsession&quot;, z.session, &quot;&quot;,&quot;&quot;,0)<br />
      display(&quot;order.weight&quot;)<br />
<br />
Perhaps someone can explain why this structure is necessary or why my old structure did not work.  The function in the library is executing a program on client.  This is the first time I have attempted to implemented this type of logic.<br />
<br />
Also want to thank those who gave attention to this.<br />
<br />
Joy Conner</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sant123</div><div class="date">17th March 2003, 18:37</div></div><div class="posttext">Joy,<br />
<br />
have an update session to modify certain fields in Item Master, validation of an Item is done with the Item data from another system I am using app_start to invoke the other system and check if the Item is valid for update, and I get the Unknown Message error. If I comment validation of an Item everything works just fine. There are lots of display and display.all functions, and it works fine if I donot invoke the validation process using app_start.<br />
<br />
My doubt is does the standard process gets inturupted if you call the app_start in check.input or after.input section.<br />
<br />
Thanks for any help.<br />
<br />
San.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Iao_Scaglia</div><div class="date">7th March 2017, 16:55</div></div><div class="posttext">hello to all,<br />
I reply to this post because I have the same problem of Joy Conner.<br />
I create a VB script which calls a DLL with OLE to make same action like open sales quotation, open customer, insert a new sales order etc ect.<br />
Every works fine if I have to open a session but if I want to open the sales order and execute the event of inser new rk, execute(add.set), the system returns &quot;Unknown message&quot;.<br />
Please help me.<br />
<br />
regards<br />
Sergio</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Joy Conner</div><div class="date">8th March 2017, 00:19</div></div><div class="posttext">Have you tried this thread (http://www.baanboard.com/baanboard/showthread.php?t=13194&amp;highlight=unknownhttp://)?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Iao_Scaglia</div><div class="date">8th March 2017, 09:21</div></div><div class="posttext">I don't use app_start().<br />
below my script:<br />
DLL:<br />
...<br />
	zoom.cuno = cuno<br />
	export(&quot;zoom.cuno&quot;, zoom.cuno)<br />
	zoom.to$(&quot;tdsls1101m000&quot;,z.session,&quot;tuscadllauto&quot;,&quot;&quot;, 0)<br />
<br />
In sales quotation:<br />
before program:<br />
...<br />
	if zoomfield$ = &quot;tuscadllauto&quot; then<br />
		import(&quot;zoom.cuno&quot;, smi.cuno)<br />
	endif<br />
<br />
form.1:<br />
init.form:<br />
...<br />
	if zoomfield$ = &quot;tuscadllauto&quot; then<br />
		if lval(smi.cuno) &lt;&gt; 0 and background then<br />
			ignore.first.event = true<br />
			get.screen.defaults()<br />
			tdsls001.cuno = smi.cuno<br />
			execute(add.set)<br />
		endif<br />
	endif<br />
<br />
when the program execute the before.input of tdsls001.qono the &quot;Unknow message&quot; is shown.<br />
If I delete the before.input of tdsls001.qono the message is shown after the choice add.set.<br />
:(</div></div><hr />



</div>
</body>
</html>