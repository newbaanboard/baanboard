<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="Use count on string field, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] Use count on string field Tools Development" />
	
	<title>Use count on string field [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="../index.html">Newbaanboard</a> &gt; <a href="../index.html">Baan Quick Support: Functional &amp; Technical</a> &gt; <a href="../index.html">Tools Development</a> &gt; Use count on string field</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">Han Brinkman</div><div class="date">13th August 2003, 22:48</div></div><div class="posttext">We try to print the number op po's on a report with help of the aggregation function. However this brings up a error, it reports that the strip$ function is not allowed on a numeric field.<br />
<br />
Am I doing something wrong?<br />
<br />
Anyone having a clue about what I am doing wrong?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">NPRao</div><div class="date">13th August 2003, 22:55</div></div><div class="posttext">Hans,<br />
<br />
Refer to - strip$() (http://www.baanboard.com/programmers_manual_baanerp_help_functions_string_operations_strip)<br />
<br />
The strip$() function takes string as input file and you were passing long to it, hence the error.<br />
<br />
you can change it to - strip$(str$(xxx)) to get away with that compilation error.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mgakhar</div><div class="date">13th August 2003, 22:58</div></div><div class="posttext">The Strip$() function is only used for String variables in order to strip off the trailing spaces. For eg. if a string var var1 is 36 chars long has a value &quot;BAAN                               &quot;, when u use strip$(var1) it outputs &quot;BAAN&quot;, it strips off the trailing spaces.<br />
<br />
Hope this helps.<br />
<br />
Manish.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Han Brinkman</div><div class="date">13th August 2003, 23:05</div></div><div class="posttext">This is not what I meant, we added a field in the report, changed on the third tab the aggregate function. Compile, then the error is reported. So I didn't add the strip function myself, it's put in the script by the compiler.<br />
<br />
I understand that you can't use a e.g. average function on a string field but a count should work.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">13th August 2003, 23:36</div></div><div class="posttext">Hello Han!<br />
<br />
One question - Did you change anything other than to select the aggregate function count?  If that is all you did then I think you will need a new version of the report generator or maybe a new include file.  It may even be the compiler, but I suspect something in the repgen program may be including the strip$ and the compiler does not like it.  It maybe best to contact Baan, I am not really sure which piece may need to be updated.<br />
<br />
Mark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">tools123</div><div class="date">14th August 2003, 03:00</div></div><div class="posttext">Mark is right.undo the aggregate field and see if error goes away.<br />
if it does not there is something else in the report.<br />
<br />
Have you thought about a variable after each detail / after.po layout? I would assume your way of aggregating would count the<br />
same PO many times if there are multiple positions on the detail.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rupertb</div><div class="date">14th August 2003, 11:53</div></div><div class="posttext">Han,<br />
You've probably figured this out - anyway, the aggregate function count can only be used with fields of domain type 'numeric'.<br />
Use another field in the report layout to count on.<br />
<br />
Regards,<br />
Rupert</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">14th August 2003, 17:09</div></div><div class="posttext">Yes - Rupert is correct and I did not think about that.  When I read count of PO's I just assumed something line tdpur041.orno, which is long.  I did a test of a count on a text string just to make sure I got the same error as Han - I did.  So Rupert I believe has the correct solution.<br />
<br />
Mark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Han Brinkman</div><div class="date">14th August 2003, 19:56</div></div><div class="posttext">To give you more background information: I am currently training some collegue's. They have basic SQL knowledge and it's hard to explain something that completly logic in 'normal' sql which doesn't work in Baan.<br />
<br />
Of course we have solved it by using variables in the script.<br />
<br />
Thanks a lot for your help, glad to hear that you guy's have the same problem. I thought I was going crazy after seeing the error.<br />
<br />
Thanks again,<br />
Han</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Amit_Jain</div><div class="date">14th May 2007, 10:41</div></div><div class="posttext">Hi HAN / ALL<br />
<br />
Actually this count function returns value in the variable that you select that is where the problem is?<br />
<br />
You do one thing, you must have defined this field as sorting field now define a report input varible of type long namely count use this variable as 'form field'<br />
in the 'After.field' layout which is defined for that particular field and see the difference<br />
<br />
Do let me know if that solves your problem :) <br />
<br />
Regards<br />
Amit Jain</div></div><hr />



</div>
</body>
</html>