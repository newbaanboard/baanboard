<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="Hyperlink behind picture object on Baan forms..???, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] Hyperlink behind picture object on Baan forms..??? Tools Development" />
	
	<title>Hyperlink behind picture object on Baan forms..??? [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="../index.html">Newbaanboard</a> &gt; <a href="../index.html">Baan Quick Support: Functional &amp; Technical</a> &gt; <a href="../index.html">Tools Development</a> &gt; Hyperlink behind picture object on Baan forms..???</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">en@frrom</div><div class="date">9th January 2007, 16:17</div></div><div class="posttext">Hey all,<br />
<br />
See this link (http://www.baanboard.com/baanboard/showthread.php?t=12892) as a reference...<br />
<br />
I am displaying images on my Baan forms using the method described in the aforementioned thread. When moving the cursor over such an image (object) the cusor changes from the 'arrow' sign to a 'hand', i.e. giving the impression you could click on it to activate some control/link which is behind the object. <br />
<br />
My requirement is exactly that: I want to be able to click on an image and activate a url-path containing to a large picture stored on the server (opened let's say in the default picture browser, in IE, etc). <br />
<br />
Does anyone know of a way to add functionality behind those images/objects?<br />
<br />
<br />
Kind regards,<br />
Eli Nager</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mr_suleyman</div><div class="date">11th January 2007, 13:11</div></div><div class="posttext">I don't think that there is way to solve it on Baan. May be you can  use HTML to handle it ?<br />
<br />
Good Luck!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">en@frrom</div><div class="date">11th January 2007, 13:27</div></div><div class="posttext">How would I be able to handle it by using HTML? I don't mind the HTML, the whole issue is capturing the click-event on the item displayed on form...<br />
<br />
Actually I do have the feeling that it mus be possible, from looking at all the functions and events in the Baan-help -&gt; objects-functions and the long line of DsC/DsN events etc<br />
<br />
I do not know those functions/events well enough, and therefor thought maybe someobody around here knows more...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mr_suleyman</div><div class="date">11th January 2007, 13:43</div></div><div class="posttext">I don't know your structure but you can cunstruct your html file and easily open from baan. Almost everything is possible on html. I hope there is a way on baan.<br />
<br />
Good LUck !</div></div><hr />


<div class="post"><div class="posttop"><div class="username">norwim</div><div class="date">11th January 2007, 17:52</div></div><div class="posttext">&lt;Quote&gt;..... you can cunstruct your html file and easily open from baan.&lt;/Quote&gt;<br />
Could you please explain what you meant here? Open a html file from Baan ....<br />
with seq.open? <br />
<br />
thx in advance<br />
<br />
Norbert</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mr_suleyman</div><div class="date">12th January 2007, 08:25</div></div><div class="posttext">I don't implement it. But Why not possibble? I think that it  can be done  template html structure. Only u should send  picture place and link information parameter to this template file. It can be run from baan By using app_start command .<br />
That' all norwim</div></div><hr />


<div class="post"><div class="posttop"><div class="username">en@frrom</div><div class="date">12th January 2007, 09:49</div></div><div class="posttext">In the motto of &quot;Everything is possible&quot;, impossible is a non-existing word in my dictionary, and the famous (Dutch?) saying: &quot;Where there is a will, there is a way, and where there is no way there is detour...&quot;, I decided that I will let this work anyway the way I want it, namely that upon clicking on an image on my form, I will display that image in big. Of course the only difficulty is capturing/identifying that click on the image. The actions performed upon clicking don't really matter, everything is possible (displaying picture, some report, different session, spreadsheets, graphs, anything)...<br />
<br />
I thought of the concept and just have to find the correct way to apply it in code... Will post it here for people once I have a stable code.<br />
<br />
<br />
Regards,<br />
Eli Nager</div></div><hr />


<div class="post"><div class="posttop"><div class="username">csecgn</div><div class="date">12th January 2007, 12:57</div></div><div class="posttext">I've done some (not successfull) experiments with your question, the eventhandler, timers, ... . <br />
I've seen a NOVENTS during creating the object in the include(last line if remember correctly). Maybe it would an idea to send  EVTBUTTONPRESS or EVTBUTTONDPRESS instead of. If it works, the &quot;only&quot; remainig problem is to find a place where you can create your eventhandler function and how to call it... . Timer? (works, but has not been &quot;fast/precise&quot; enough during my experiments)<br />
<br />
Just an idea<br />
<br />
Regards<br />
csecgn</div></div><hr />


<div class="post"><div class="posttop"><div class="username">george7a</div><div class="date">12th January 2007, 13:01</div></div><div class="posttext">Hi,<br />
<br />
I don't think that the timer will work. I have tried something simpler and the timer didn't work:<br />
http://www.baanboard.com/baanboard/showpost.php?p=104488&amp;postcount=9<br />
<br />
- George</div></div><hr />


<div class="post"><div class="posttop"><div class="username">csecgn</div><div class="date">12th January 2007, 13:09</div></div><div class="posttext">I've used the timer only for calling my eventhandler-function.. But it has been to slow (or to fast sometimes). It has been the easiest way to call choice.interrupt: where the function has been placed.<br />
If I find time, I try at monday again (or another way).<br />
<br />
Regards<br />
csecgn</div></div><hr />


<div class="post"><div class="posttop"><div class="username">en@frrom</div><div class="date">12th January 2007, 13:53</div></div><div class="posttext">Hey guys, <br />
<br />
As promised I have played around with this, and achieved a nice solution... Will try to explain clearly...<br />
<br />
My requirements: <br />
<br />
In my session I display per item all kinds of relevant data, and display up to 4 gif-files (depends how many available per item) with images of the item on the screen. The images are placed as objects using the Baan object-handling functions. <br />
<br />
What I wanted to achieve was to double-click an image and display an enlarged JPG-version of the photo clicked. Because I display up to 4 images per screen, I need to know also which of the pictures I clicked.<br />
<br />
<br />
Solution:<br />
<br />
I created a new 3GL program which activates a timer, and then every 0.5 seconds checks for a left mouse click on an object. If an object is clicked, it checks whether this is an image object, and opens Internet Explorer with the corresponding picture.<br />
<br />
In the display session, while displaying the pictures, I count how many pictures I display for this item, and keep the object id -&gt;  =return value of funtion create.object() of each image in an array. <br />
<br />
Then after displaying the images on screen I start my 3GL program, export/import the item number (picture file names are based on item number), number of pictures displayed for this item, and the object id numbers for each displayed picture.<br />
<br />
When a left mouse event is captured, it checks whether this was on one of the pictures on the form, and if yes displays the enlarged jpg-version of the picture in Internet Explorer.<br />
<br />
This works fine. The only thing that bothers me now, is that it takes 4-5 seconds until the Internet Explorer is opened with the picture. I don't know yet why this is, it is for sure not due to the file size of the picture, because I tested it also with small files of &lt;10kb, and it took as long. Maybe the function app_start() is very slow...? Dunn, will still have to play around with that... <br />
<br />
Piece of code in the main session:<br />
<br />
		for j = 1 to 4<br />
			file.name = &quot;e:\baan\gif\artikels\&quot; &amp; strip$(shiftl$(tcibd001.item)) &amp; &quot;_&quot; &amp; str$(j) &amp; &quot;.gif&quot;<br />
			fid = seq.open(file.name, &quot;r&quot;)<br />
<br />
			if fid &gt; 0 then<br />
				if pics = 1 then<br />
					igen0100.display.photo.in.location(-10, 450, 191, 344, &quot;e:\baan\gif\artikels\blanc.gif&quot;, pics)<br />
				endif<br />
				pics = pics + 1<br />
				igen0100.display.photo.in.location(x.pos, 470, 160, 120, file.name, pics)<br />
				x.pos = x.pos + 160<br />
<br />
				pic.id(pics - 1) = igen0100.object.mpix(pics)<br />
			endif<br />
		endfor<br />
<br />
		if pics &gt; 1 then<br />
			timer = activate(&quot;otcromtimer&quot;, tcibd001.item, pics - 1, pic.id(1), pic.id(2), pic.id(3), pic.id(4))<br />
		endif<br />
<br />
Make sure to kill the 3GL session at the right places, like in choice.abort.program, choice.end.program, and form.x, after.form. Just code: <br />
<br />
	if timer then<br />
		kill(timer)<br />
		timer = 0<br />
	endif<br />
<br />
Note: I initialize 'timer' because I am checking on timer &gt; 0 on several places, so this is important...<br />
<br />
<br />
the 3GL code:<br />
<br />
|******************************************************************************<br />
|* Title	: tcromtimer - Timer handling and event capturing (for tcrom0101me00)<br />
|* Author	: Eli Nager<br />
|* Date		: 12/01/2007<br />
|******************************************************************************<br />
|* Script Type	: 3GL<br />
|* Copyright 2007 by Eli Nager<br />
|* <br />
|* All Rights Reserved <br />
|* <br />
|* Permission to use, copy, modify, and distribute this software and its<br />
|* documentation for any purpose and without fee is hereby granted,<br />
|* provided that the above copyright notice appear in all copies and that<br />
|* both that copyright notice and this permission notice appear in<br />
|* supporting documentation. <br />
|* <br />
|* ELI NAGER AND BAANBOARD.COM DISCLAIM ALL WARRANTIES WITH REGARD TO <br />
|* THIS SOFTWARE, INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY<br />
|* AND FITNESS, IN NO EVENT SHALL ELI NAGER NOR BAANBOARD.COM BE LIABLE <br />
|* FOR ANY SPECIAL, INDIRECT OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES <br />
|* WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, <br />
|* WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER <br />
|* TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE<br />
|* OR PERFORMANCE OF THIS SOFTWARE.<br />
|*                                                                                <br />
|****************************************************************************<br />
                                                                                <br />
|****************************** DECLARATION SECTION ***************************<br />
<br />
	table	ttcibd001<br />
<br />
<br />
		domain	tcmcs.long	i, j<br />
<br />
	extern	domain	tcmcs.long	tim.id, obj.id, i.pic.id(4), i.pics<br />
	extern	domain	tcitem		i.item<br />
<br />
	#pragma used dll ottdllbw<br />
<br />
<br />
|*****************************************************************************<br />
<br />
function main()<br />
<br />
{<br />
	i.item = argv$(1)<br />
	i.pics = lval(argv$(2))<br />
	<br />
	j = 1<br />
	for i = 3 to (i.pics + 2)<br />
		i.pic.id(j) = lval(argv$(i))<br />
		j = j + 1<br />
	endfor<br />
<br />
	tim.id = set.timer(500)<br />
<br />
	handle.events()<br />
}<br />
<br />
<br />
<br />
function handle.events()<br />
{<br />
	long event(EVTMAXSIZE)<br />
	string	start(1024)			| Start command<br />
	long	rc				| Return code.<br />
	string	appl(132)			| Application to start.<br />
	long	app_id				| Application id.<br />
<br />
<br />
            while next.event(event)<br />
            	ON CASE evt.type(event)<br />
		            case EVTBUTTONDPRESS:<br />
			case EVTBUTTONRELEASE:<br />
				if evt.button.button(event) = EVTBUTTON1 then<br />
					obj.id = evt.window(event)<br />
<br />
					for i = 1 to i.pics<br />
					      if obj.id = i.pic.id(i) then<br />
						appl = &quot;iexplore.exe&quot;<br />
						start =  appl &amp; &quot; &quot; &amp; &quot;\\es7000F\baangif\artikels\&quot; &amp; i.item(10;6) &amp; &quot;g_&quot; &amp; str$(i) &amp; &quot;.jpg&quot;<br />
	<br />
						app_id = app_start(start,&quot;&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;)<br />
	<br />
						rc = app_status(app_id)<br />
						if(rc = 0) then<br />
							message(&quot;Could not start application&quot;)<br />
						endif<br />
					     endif<br />
					endfor<br />
				endif	<br />
				break<br />
<br />
		            default:<br />
		           	break<br />
		ENDCASE<br />
	endwhile<br />
}<br />
<br />
(I decided to be brave and add the whole copyright/disclaimer blabla... :rolleyes: )<br />
<br />
<br />
The reason I handle the event capturing/checks in a seperate 3GL program, is because the standard program is full of events, and when manipulating the way I do (every next.event() basically ignores the current event... etc), I would corrupt my standard (main) program every second or third time I would click on something... The advantage of doing this in a seperate 3GL, is that all this program does is timing and checking events, and does not have a form the user could click on, so no risk of interrupting/corrupting the standard flow of the program. <br />
<br />
<br />
Hope this is clear and moreover usefull for others.<br />
<br />
Any input/feedback/comment etc is very welcome.<br />
<br />
<br />
Regards,<br />
Eli Nager</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">12th January 2007, 16:36</div></div><div class="posttext">YEAH - my comment is &quot;Great solution&quot;.  I wish I had the opportunity to apply this somewhere.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mr_suleyman</div><div class="date">12th January 2007, 16:39</div></div><div class="posttext">Congratulations !<br />
I think this thread should be add on Code &amp; Utilities Part</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">12th January 2007, 16:52</div></div><div class="posttext">I think it is okay where it is since it is already linked into the other thread.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">en@frrom</div><div class="date">15th January 2007, 09:47</div></div><div class="posttext">Mark, I am surprised you do not have where/how to apply it. If you happen to apply it at some point anyway, please give me feedback and/or further comments/suggestions. I didn't put so much time in this, there surely must be ways to enhance it...<br />
<br />
As for adding this code to the codes &amp; utilities forum: there is already a thread there which gives the general solution for displaying images on Baan Forms, so I will add my code as a comment in that existing thread; like this people will find a complete solution in one thread...<br />
<br />
<br />
Regards,<br />
Eli Nager</div></div><hr />



</div>
</body>
</html>