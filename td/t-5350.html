<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="Question on integrating Excel with BaaN., baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] Question on integrating Excel with BaaN. Tools Development" />
	
	<title>Question on integrating Excel with BaaN. [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="../index.html">Newbaanboard</a> &gt; <a href="../index.html">Baan Quick Support: Functional &amp; Technical</a> &gt; <a href="../index.html">Tools Development</a> &gt; Question on integrating Excel with BaaN.</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">r_nagu</div><div class="date">29th May 2002, 19:22</div></div><div class="posttext">Hi,<br />
	I am trying to connect to baan from Excel and extract some data back to Excel. There is lot of information already on this forum regarding this and it is very useful. Based on the information I read, I wrote this piece of code in excel (VB) and when I executed it, for some reason it is not able to create the object Baan4.Application. The program keeps going to CannotCreateBaan: routine and give me the error message Unable to start BaaN.<br />
<br />
Here is the script:<br />
<br />
Dim BaanObj As Object<br />
<br />
Private Sub CommandButton1_Click()<br />
Call open_baan<br />
End Sub<br />
<br />
Sub open_baan()<br />
    On Error GoTo CannotCreateBaan<br />
        <br />
    Set BaanObj = CreateObject(&quot;Baan4.Application&quot;)<br />
    BaanObj.Timeout = 3600<br />
    On Error GoTo BaanAutomationError<br />
    Exit Sub<br />
    <br />
CannotCreateBaan:<br />
    Cells(2, 3) = &quot;Unable to start BaaN&quot;<br />
    Exit Sub<br />
       <br />
BaanAutomationError:<br />
    MsgBox &quot;Baan IV automation error: &quot; &amp; BaanObj.Error<br />
    MsgBox &quot;Return value function: &quot; &amp; B_function &amp; &quot;  &quot; &amp; BaanObj.returnvalue<br />
    BaanObj.Quit<br />
    Set BaanObj = Nothing<br />
    Exit Sub<br />
    <br />
End Sub<br />
<br />
<br />
We are using BaaN IV on Unix with BW client. Does the above mentioned script only works if you are running baan on windows? <br />
<br />
Any feedback is greatly appreciated.<br />
<br />
Thanks,<br />
NS</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">29th May 2002, 19:37</div></div><div class="posttext">Are you trying this on a Windows Client?  It sounds like it, but I am not sure.  Run regedit and look for HKEY_CLASSES_ROOT\CLSID\{00000000-4000-11ce-AAA8-00608C50C597}\LocalServer32 = C:\BAAN\bin\bw.exe /Automation.  This is a copy from a line of the bw.reg file on my PC, your client should have a copy of it in the baan directory. If the entry is not found then you will need to run the bw.reg file on your PC to create the entries.  I had the same problem when I first tried using OLE.<br />
<br />
Mark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">r_nagu</div><div class="date">29th May 2002, 19:49</div></div><div class="posttext">Mark,<br />
       I checked the registry and there was no entry as you have mentioned. So, I ran the bw.reg file on my PC and it made an entry in the registry. When I re-ran my code after this, I got the same error message (Unable to start Baan) along with a BW error message.<br />
<br />
Here is the BW error message:<br />
&quot;1: Error in CreateInstance(IUnkown*, REFID, LPVOID*). SendOleEvent timed out.&quot;<br />
<br />
Any ideas.<br />
<br />
Thanks for your help.<br />
NS</div></div><hr />


<div class="post"><div class="posttop"><div class="username">gfasbender</div><div class="date">29th May 2002, 20:33</div></div><div class="posttext">NS, you're running Baan IV not Baan 5 correct? Baan 5 uses object &quot;Baan.Application&quot; not &quot;Baan4.Application&quot;.<br />
<br />
You might want to also insure that you have the most current objects in Baan solution 13742.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">r_nagu</div><div class="date">29th May 2002, 21:43</div></div><div class="posttext">Hi,<br />
     I was able to connect to Baan throug Excel but as soon as the program executes this &quot;BaanObj.ParseExecFunction&quot;, I get an error message saying &quot;Connection with server lost&quot; and the application locks up.<br />
<br />
Any suggestions?<br />
<br />
Thanks,<br />
NS</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">29th May 2002, 22:27</div></div><div class="posttext">Did you download the Baan solution Gordon mentioned?  It seems to me this fixed this problem before for another user on the board. You might also want to post the code that will help us see if everything looks okay.<br />
<br />
Good Luck!<br />
<br />
Mark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">r_nagu</div><div class="date">29th May 2002, 22:49</div></div><div class="posttext">Mark/Gordon,<br />
        I am trying to download the patch rightnow but I am not sure how far I get with this since we don't have the BaaN support.<br />
<br />
Here is the complete scirpt.<br />
<br />
Dim BaanObj As Object<br />
Dim B_function As String<br />
Dim Query As String<br />
<br />
Sub GetBaanUsers()<br />
    If BaanObj Is Nothing Then<br />
            ConnectBaan<br />
        If BaanObj Is Nothing Then<br />
            End<br />
        End If<br />
        End If<br />
    ThisWorkbook.Sheets(&quot;Sheet1&quot;).Activate<br />
    Query = &quot;select ttaad200.user from ttaad200 where  ttaad200._compnr = 000&quot;<br />
    B_function = &quot;olesql_parse(&quot; &amp; Query &amp; &quot;)&quot;<br />
    BaanObj.ParseExecFunction &quot;ottdllsql_query&quot;, B_function<br />
    query_id = Val(BaanObj.returnvalue)<br />
End Sub<br />
<br />
Sub ConnectBaan()<br />
    Set BaanObj = CreateObject(&quot;Baan4.Application&quot;)<br />
    BaanObj.Timeout = 2000000<br />
    On Error GoTo CannotCreateBaan<br />
    Exit Sub<br />
    <br />
CannotCreateBaan:<br />
    Cells(2, 3) = &quot;Can not connect to Baan&quot;<br />
    End<br />
End Sub<br />
<br />
Sub DisconnectBaan()<br />
    If Not BaanObj Is Nothing Then<br />
        BaanObj.Quit<br />
        Set BaanObj = Nothing<br />
    End If<br />
End Sub<br />
<br />
I also checked the log messages in baan (log.bshell) and it reports &quot;Attribute of unkown type 355&quot;<br />
<br />
Appreciate all your help.<br />
<br />
Thanks,<br />
NS</div></div><hr />


<div class="post"><div class="posttop"><div class="username">alejandro</div><div class="date">30th May 2002, 00:30</div></div><div class="posttext">When you run Excel have you a connection yet to BaaN?<br />
<br />
If so, try to execute in BaaN this Object ottstpoledaemon. Then run your Excel code. To run it simply type ottstpoledaemon from menu option run program.<br />
<br />
Also, which BW version are you using?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Al Smith</div><div class="date">30th May 2002, 17:31</div></div><div class="posttext">Hi,<br />
You do have an error in your B_function string. The olesql_parse  needs quotes ,chr(34), around the Query variable.<br />
<br />
B_function = &quot;olesql_parse(&quot; &amp; Chr(34) &amp; Query &amp; Chr(34) &amp; &quot;)&quot;<br />
<br />
Al.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">r_nagu</div><div class="date">31st May 2002, 15:56</div></div><div class="posttext">Alejandro,<br />
          I tried your suggestion to run ottstpoledaemon and then try to run my code but, it would not work. We are using BW version B40c.61.<br />
<br />
Al,<br />
          I did try your suggestion but got the same error message (&quot;Connection with server lost&quot;).<br />
<br />
<br />
         What else could go wrong?<br />
<br />
Thanks,<br />
NS</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Al Smith</div><div class="date">31st May 2002, 16:36</div></div><div class="posttext">Hi,<br />
Do you know at what step the server connection is lost?<br />
<br />
If not, try stepping through the code using F8.<br />
After the Set BaanObj = CreateObject(&quot;Baan4.Application&quot;) is executed you should see the Option Dialog box at the bottom of your screen. Go into the shell and do a &quot;PS&quot;. you should see the ttstpoledaem. Doing an &quot;oic&quot; should show the ottstpoledaemon object as loaded.<br />
Continue to step through the code. After BaanObj.ParseExecFunction &quot;ottdllsql_query&quot;, B_function is executed, again go into the Option Dialog shell and do a &quot;oic&quot;. Now the ottdllsql_query object should be loaded.<br />
<br />
Al.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">r_nagu</div><div class="date">31st May 2002, 20:15</div></div><div class="posttext">Al,<br />
       The connection with server is lost the movment it executes BaanObj.ParseExecFunction &quot;ottdllsql_query&quot;, B_function <br />
<br />
       After connecting to baan i ran the &quot;oic&quot; commnad and it does shows ottstpoledaemon object as loaded.<br />
<br />
       I could not check for ottdllsql_query object  since it breks out just after BaanObj.ParseExecFunction &quot;ottdllsql_query&quot;, B_function.<br />
<br />
       You think I might have the old BaanObj objects? where are located?<br />
<br />
Thanks for your help.<br />
NS</div></div><hr />


<div class="post"><div class="posttop"><div class="username">r_nagu</div><div class="date">31st May 2002, 20:57</div></div><div class="posttext">Well, this time it did not disconnect from baan but gave me this error message in log.bshell.<br />
<br />
2002-05-31[13:21:30]:E:bsp: ******* S T A R T of Error message *******<br />
2002-05-31[13:21:30]:E:bsp: Log message called from /port.6.1c.05.01/vobs/tt/mir/mir/main.c: #879 keyword: stop<br />
2002-05-31[13:21:30]:E:bsp: Pid 1576 Uid 125 Euid 125 Gid 125 Egid 125<br />
2002-05-31[13:21:30]:E:bsp: user_type S language 2 user_name bsp tty ote locale ISO88591/NULL<br />
2002-05-31[13:21:30]:E:bsp: Errno 0 bdb_errno 213 (Transaction is started but not updated)<br />
2002-05-31[13:21:30]:E:bsp: Log_mesg: bshell received SIGTERM <br />
2002-05-31[13:21:30]:E:bsp: ******* E N D of Error message ******<br />
<br />
Hope I am getting closer.<br />
<br />
Thanks,<br />
NS</div></div><hr />


<div class="post"><div class="posttop"><div class="username">alejandro</div><div class="date">31st May 2002, 22:40</div></div><div class="posttext">Looking your previous post, and this last with log.bshell it seems that you are not completing your query. You have created a query_id, but you do not do anything later. This is true only if you posted complete code.<br />
<br />
What I think you have to put before EndSub line in Sub GetBaanUsers is:<br />
<br />
<br />
    query_id = Val(BaanObj.ReturnValue)<br />
    B_function = &quot;olesql_fetch(&quot; &amp; query_id &amp; &quot;)&quot;<br />
    BaanObj.ParseExecFunction &quot;ottdllsql_query&quot;, B_function<br />
    temp_string = &quot;ttaad200.user&quot;<br />
    user = String(10, &quot; &quot;)<br />
    B_function2 = &quot;olesql_getstring(&quot; &amp; Chr(34) &amp; temp_string &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; user &amp; Chr(34) &amp; &quot;)&quot;<br />
    BaanObj.ParseExecFunction &quot;ottdllsql_query&quot;, B_function2<br />
    temp_string = BaanObj.FunctionCall<br />
    user = Mid(temp_string, 35, 10)<br />
    user = Trim(user)<br />
    'Then here you have the first user. I finish here, test it please, later we will comment<br />
    B_function = &quot;olesql_break(&quot; &amp; query_id &amp; &quot;)&quot;<br />
    BaanObj.ParseExecFunction &quot;ottdllsql_query&quot;, B_function<br />
    B_function = &quot;olesql_close(&quot; &amp; query_id &amp; &quot;)&quot;<br />
    BaanObj.ParseExecFunction &quot;ottdllsql_query&quot;, B_function<br />
    BaanObj.Quit<br />
    Set BaanObj = Nothing<br />
<br />
<br />
<br />
Also when querying tables try to use index. In this case ttaad200.user is the key field, but I have used this query object with complex select statements and is mandatory to write them well. So the string query should be changed to:<br />
<br />
Query = &quot;select ttaad200.user from ttaad200 where ttaad200._compnr = 000 order by ttaad200._index1&quot; <br />
<br />
Hope this helps.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">r_nagu</div><div class="date">31st May 2002, 22:54</div></div><div class="posttext">Alejandro,<br />
          The reason I did not complete the code is beacuse I was getting disconnected from baan with error message &quot;(&quot;Connection with server lost&quot;)&quot; as soon as the step &quot;BaanObj.ParseExecFunction &quot;ottdllsql_query&quot;, B_function &quot; is executed.<br />
         I did copied your code and added to my privouslly posted code but, i still get the same error message i.e., &quot;(&quot;Connection with server lost&quot;)&quot; .<br />
<br />
Here is the complete code:<br />
<br />
Dim BaanObj As Object<br />
Dim B_function As String<br />
Dim Query As String<br />
<br />
Sub GetBaanUsers()<br />
    If BaanObj Is Nothing Then<br />
            ConnectBaan<br />
            MsgBox (&quot;Connected..&quot;)<br />
    Else<br />
        MsgBox (&quot;Already connected&quot;)<br />
    End If<br />
    <br />
    If BaanObj Is Nothing Then<br />
            End<br />
    End If<br />
<br />
    ThisWorkbook.Sheets(&quot;Sheet1&quot;).Activate<br />
    Query = &quot;select ttaad200.user from ttaad200 where ttaad200._compnr = 000 order by ttaad200._index1&quot;<br />
    B_function = &quot;olesql_parse(&quot; &amp; Query &amp; &quot;)&quot;<br />
    B_function = &quot;olesql_parse(&quot; &amp; Chr(34) &amp; Query &amp; Chr(34) &amp; &quot;)&quot;<br />
    BaanObj.ParseExecFunction &quot;ottdllsql_query&quot;, B_function<br />
    query_id = Val(BaanObj.returnvalue)<br />
    BaanObj.ParseExecFunction &quot;ottdllsql_query&quot;, B_function<br />
    temp_string = &quot;ttaad200.user&quot;<br />
    user = String(10, &quot; &quot;)<br />
    B_function2 = &quot;olesql_getstring(&quot; &amp; Chr(34) &amp; temp_string &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; user &amp; Chr(34) &amp; &quot;)&quot;<br />
    BaanObj.ParseExecFunction &quot;ottdllsql_query&quot;, B_function2<br />
    temp_string = BaanObj.FunctionCall<br />
    user = Mid(temp_string, 35, 10)<br />
    user = Trim(user)<br />
    'Then here you have the first user. I finish here, test it please, later we will comment<br />
    B_function = &quot;olesql_break(&quot; &amp; query_id &amp; &quot;)&quot;<br />
    BaanObj.ParseExecFunction &quot;ottdllsql_query&quot;, B_function<br />
    B_function = &quot;olesql_close(&quot; &amp; query_id &amp; &quot;)&quot;<br />
    BaanObj.ParseExecFunction &quot;ottdllsql_query&quot;, B_function<br />
    Call DisconnectBaan<br />
End Sub<br />
<br />
Sub ConnectBaan()<br />
    Set BaanObj = CreateObject(&quot;Baan4.Application&quot;)<br />
    BaanObj.Timeout = 2000000<br />
    On Error GoTo CannotCreateBaan<br />
    Exit Sub<br />
    <br />
CannotCreateBaan:<br />
    Cells(2, 3) = &quot;Can not connect to Baan&quot;<br />
    End<br />
End Sub<br />
<br />
Sub DisconnectBaan()<br />
    If Not BaanObj Is Nothing Then<br />
        BaanObj.Quit<br />
        Set BaanObj = Nothing<br />
    End If<br />
End Sub<br />
<br />
<br />
Thanks,<br />
Nagesh</div></div><hr />


<div class="post"><div class="posttop"><div class="username">r_nagu</div><div class="date">31st May 2002, 23:20</div></div><div class="posttext">I ran bic_info6.1 -a ottdllsql_query and after displaying all the information at the end it show the following.<br />
<br />
---------------------------OBJECT IDENTS--------------------------------<br />
@(#)/f3/BaanIVc/bse/tools/ttB40_b/pttdll/pdllsql_query0, 97/08/26 [07:12], From bsp<br />
@(#)-DREL6_1<br />
@(#)bic_global	7.16:7/17/97 Copyright (c) Baan International b.v.<br />
@(#)bic_object	7.7.1.1:11/21/96 Copyright (c) Baan International b.v.<br />
@(#)bic_event	6.1.1.2:6/13/96 Copyright (c) Baan International b.v.<br />
@(#)bic_shell, 08-1994/R1, Copyright (c) Baan International b.v.<br />
@(#)bic_fork	1.1:3/1/95 Copyright (c) Baan International b.v.<br />
@(#) Call 10018477, 96/01/29: Error ; not expected, using date.to.num()<br />
@(#) Call 10020566, 96/04/26: Error if using parenthesis on from/to fld<br />
@(#) Call 10228702, 97/03/10: Error if parenthesis on date fields<br />
@(#) Call 10241698, 97/05/01: Error when using exists<br />
@(#) Call 10242579, 97/05/01: Error when using exists<br />
@(#) Call 11609, 97/07/16: Error when using between<br />
@(#)bic_process, 05-1992/R1, Copyright (c) Baan International b.v.<br />
@(#)Call 441214, 1995/06/28<br />
<br />
Its interesting because, when VB executes BaanObj.ParseExecFunction &quot;ottdllsql_query&quot;, B_function I get disconnected from Baan with an error message &quot;Connection lost with server&quot; and it creates core file on Unix. When tried to read that core file, it had the same error message as given by the bic_info command i.e., . Error when using between, Error when using exists etc.,<br />
<br />
I am thinking maybe my ottdllsql_query object is gone bad. Then again I am not 100% sure on this.<br />
<br />
Just wanted to see what you guys think.<br />
<br />
Thanks again,<br />
<br />
NS</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Al Smith</div><div class="date">1st June 2002, 00:03</div></div><div class="posttext">Hi,<br />
I ran bic_info6.1 against mine and got similar results. But the function works.<br />
<br />
As you might know, the ParseExecFunction can be run against almost any Baan object. <br />
Try adding this in place of your ottdllsql_query and step through the code again using F8.<br />
<br />
BaanObj.ParseExecFunction &quot;ottstpcalc&quot;, &quot;&lt;4&gt;&quot;<br />
<br />
After this line is executed, doing a &quot;oic&quot; in the shell should show the calculator object (ottstpcalc) as being loaded. You wont see the calculator itself.<br />
<br />
If this works, at least we know that your ParseExecFunction will work and you might have a corrupted ottdllsql_query object.<br />
<br />
Al.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">r_nagu</div><div class="date">1st June 2002, 00:17</div></div><div class="posttext">Al,<br />
       I just ran the code you mentioned but, it gave me the same error message. So, I guess there is something wrong with ParseExecFunction itself. Where are these functions located?<br />
<br />
        Does BW version matters? we are using BW version B40c.61 and the baan server is a Unix machine. Baan version is B40c0.<br />
<br />
Thanks,<br />
NS</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Al Smith</div><div class="date">1st June 2002, 02:05</div></div><div class="posttext">Hi,<br />
We're using BW B40c.050 but I don't think it makes a difference.<br />
<br />
The ParseExecFunction is referenced in the bw.tlb (Type Library) under the Baan/Lib directory. It has to be in the path that's shown in the bw.reg file.<br />
If you right-click the bw.reg you should be able to select Edit and pull it up in Notepad. Below is the bw.reg from this computer.<br />
<br />
Note the path to bw.tlb under the heading ; The Baan4 Automation Information below.<br />
<br />
Another thing you might try is to set a reference in your VB program to point to this. Select &quot;Project&quot; on the VB menu then references. You should see Baan4 Type Library as one of the selections. (Note: If you're using Excel's VBA the reference is under tools.)<br />
<br />
Good luck,<br />
Al<br />
<br />
 NREGEDIT<br />
<br />
;ident: $RCSfile: bw.reg $ $Revision: /main/1 $<br />
<br />
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;<br />
; The BW configuration file association<br />
;<br />
HKEY_CLASSES_ROOT\.bwc = BW_Configuration<br />
HKEY_CLASSES_ROOT\BW_Configuration = BW configuration file<br />
HKEY_CLASSES_ROOT\BW_Configuration\shell\open\command = &quot;C:\BAAN\bin\bw.exe&quot; &quot;%1&quot;<br />
<br />
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;<br />
; The Baan4 Application Class for Automation<br />
;<br />
HKEY_CLASSES_ROOT\Baan4.Application = Baan4 Application<br />
HKEY_CLASSES_ROOT\Baan4.Application\CLSID = {00000000-4000-11ce-AAA8-00608C50C597}<br />
<br />
HKEY_CLASSES_ROOT\CLSID\{00000000-4000-11ce-AAA8-00608C50C597} = Baan4 Application<br />
HKEY_CLASSES_ROOT\CLSID\{00000000-4000-11ce-AAA8-00608C50C597}\InprocHandler32 = ole32.dll<br />
HKEY_CLASSES_ROOT\CLSID\{00000000-4000-11ce-AAA8-00608C50C597}\LocalServer32 = C:\BAAN\bin\bw.exe /Automation<br />
HKEY_CLASSES_ROOT\CLSID\{00000000-4000-11ce-AAA8-00608C50C597}\ProgID = Baan4.Application<br />
HKEY_CLASSES_ROOT\CLSID\{00000000-4000-11ce-AAA8-00608C50C597}\VersionIndependentProgID = Baan4.Application<br />
<br />
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;<br />
; The Baan4 Automation Information<br />
;<br />
HKEY_CLASSES_ROOT\TypeLib\{00000001-4000-11ce-AAA8-00608C50C597}<br />
HKEY_CLASSES_ROOT\TypeLib\{00000001-4000-11ce-AAA8-00608C50C597}\1.1 = Baan4 Type Library<br />
HKEY_CLASSES_ROOT\TypeLib\{00000001-4000-11ce-AAA8-00608C50C597}\1.1\0\win32 = C:\BAAN\lib\bw.tlb<br />
HKEY_CLASSES_ROOT\TypeLib\{00000001-4000-11ce-AAA8-00608C50C597}\1.1\9\win32 = C:\BAAN\lib\bw.tlb<br />
<br />
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;<br />
; The Baan4 DispInterface<br />
;<br />
HKEY_CLASSES_ROOT\Interface\{00000002-4000-11ce-AAA8-00608C50C597} = IDispatchBaan4<br />
HKEY_CLASSES_ROOT\Interface\{00000002-4000-11ce-AAA8-00608C50C597}\ProxyStubClsid = {00020420-0000-0000-C000-000000000046}<br />
HKEY_CLASSES_ROOT\Interface\{00000002-4000-11ce-AAA8-00608C50C597}\NumMethods = 7<br />
HKEY_CLASSES_ROOT\Interface\{00000002-4000-11ce-AAA8-00608C50C597}\BaseInterface = {00020400-0000-0000-C000-000000000046}<br />
<br />
otepad.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">r_nagu</div><div class="date">3rd June 2002, 16:40</div></div><div class="posttext">Al,<br />
I checked the path for bw.tlb and it looks like it is in the right place both in bw.reg and regedit. <br />
<br />
I also checked the reference to bw.tlb in the Excel VBA and it was not selected. I selected it, compiled the VB script and ran the program again but, unfortunately i am still getting the same error message. <br />
<br />
I am not sure what else could go wrong. <br />
<br />
Thanks for all your help.<br />
<br />
NS</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">3rd June 2002, 20:54</div></div><div class="posttext">Were you able to download the new objects that Gordon mentioned?  It may not be the client side, but the server tools objects. I copied your code to a test macro and it worked just fine, so I figure it is the tools objects on the server(just a guess).<br />
<br />
Mark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">r_nagu</div><div class="date">3rd June 2002, 22:12</div></div><div class="posttext">Mark,<br />
         Yes, I was able to download and patch object ottdllsql_query but, even after this I am still facing the same problem. Everything goes ok till the command BaanObj.ParseExecFunction &quot;ottdllsql_query&quot;, B_function and as soon as it executes this, the connection with server is lost and a core is dumped in my home directory. When I look at the log message under $BSE/log/log.bshell this is what i see.<br />
<br />
2002-06-03[15:00:36]:E:bsp: ******* S T A R T of Error message *******<br />
2002-06-03[15:00:36]:E:bsp: Log message called from /port.6.1c.05.01/vobs/tt/lib/ds_1/ds_mess.c: #672 keyword: DS_NOKEYWORD<br />
2002-06-03[15:00:36]:E:bsp: Pid 4649 Uid 125 Euid 125 Gid 125 Egid 125<br />
2002-06-03[15:00:36]:E:bsp: user_type S language 2 user_name bsp tty ote locale ISO88591/NULL<br />
2002-06-03[15:00:36]:E:bsp: Errno 0 bdb_errno 0<br />
2002-06-03[15:00:36]:E:bsp: Log_mesg: Attribute of unknown type 355<br />
2002-06-03[15:00:36]:E:bsp: ******* E N D of Error message *******<br />
2002-06-03[15:00:36]:E:bsp: <br />
2002-06-03[15:00:36]:E:bsp: ******* S T A R T of Error message *******<br />
2002-06-03[15:00:36]:E:bsp: Log message called from /port.6.1c.05.01/vobs/tt/lib/ds_1/ds_mess.c: #672 keyword: DS_NOKEYWORD<br />
2002-06-03[15:00:36]:E:bsp: Pid 4649 Uid 125 Euid 125 Gid 125 Egid 125<br />
2002-06-03[15:00:36]:E:bsp: user_type S language 2 user_name bsp tty ote locale ISO88591/NULL<br />
2002-06-03[15:00:36]:E:bsp: Errno 0 bdb_errno 0<br />
2002-06-03[15:00:36]:E:bsp: Log_mesg: Attribute of unknown type 355<br />
2002-06-03[15:00:36]:E:bsp: ******* E N D of Error message *******<br />
2002-06-03[15:00:36]:E:bsp: <br />
2002-06-03[15:00:36]:E:bsp: ******* S T A R T of Error message *******<br />
2002-06-03[15:00:36]:E:bsp: Log message called from /port.6.1c.05.01/vobs/tt/mir/mir/gfx_obj.c: #1463 keyword: DS_INTERR<br />
2002-06-03[15:00:36]:E:bsp: Pid 4649 Uid 125 Euid 125 Gid 125 Egid 125<br />
2002-06-03[15:00:36]:E:bsp: user_type S language 2 user_name bsp tty ote locale ISO88591/NULL<br />
2002-06-03[15:00:36]:E:bsp: Errno 0 bdb_errno 0<br />
2002-06-03[15:00:36]:E:bsp: Log_mesg: Internal error<br />
2002-06-03[15:00:36]:E:bsp: ******* E N D of Error message *******<br />
2002-06-03[15:00:36]:E:bsp: <br />
2002-06-03[15:00:36]:E:bsp: ******* S T A R T of Error message *******<br />
2002-06-03[15:00:36]:E:bsp: Log message called from /port.6.1c.05.01/vobs/tt/lib/ds_1/ds_mess.c: #672 keyword: DS_NOKEYWORD<br />
2002-06-03[15:00:36]:E:bsp: Pid 4649 Uid 125 Euid 125 Gid 125 Egid 125<br />
2002-06-03[15:00:36]:E:bsp: user_type S language 2 user_name bsp tty ote locale ISO88591/NULL<br />
2002-06-03[15:00:36]:E:bsp: Errno 0 bdb_errno 0<br />
2002-06-03[15:00:36]:E:bsp: Log_mesg: Attribute of unknown type 355<br />
2002-06-03[15:00:36]:E:bsp: ******* E N D of Error message *******<br />
2002-06-03[15:00:36]:E:bsp: <br />
2002-06-03[15:00:36]:E:bsp: ******* S T A R T of Error message *******<br />
2002-06-03[15:00:36]:E:bsp: Log message called from /port.6.1c.05.01/vobs/tt/lib/ds_1/ds_mess.c: #672 keyword: DS_NOKEYWORD<br />
2002-06-03[15:00:36]:E:bsp: Pid 4649 Uid 125 Euid 125 Gid 125 Egid 125<br />
2002-06-03[15:00:36]:E:bsp: user_type S language 2 user_name bsp tty ote locale ISO88591/NULL<br />
2002-06-03[15:00:36]:E:bsp: Errno 0 bdb_errno 0<br />
2002-06-03[15:00:36]:E:bsp: Log_mesg: Attribute of unknown type 355<br />
2002-06-03[15:00:36]:E:bsp: ******* E N D of Error message *******<br />
2002-06-03[15:00:36]:E:bsp: <br />
2002-06-03[15:00:36]:E:bsp: ******* S T A R T of Error message *******<br />
2002-06-03[15:00:36]:E:bsp: Log message called from /port.6.1c.05.01/vobs/tt/mir/mir/gfx_obj.c: #1747 keyword: DS_INTERR<br />
2002-06-03[15:00:36]:E:bsp: Pid 4649 Uid 125 Euid 125 Gid 125 Egid 125<br />
2002-06-03[15:00:36]:E:bsp: user_type S language 2 user_name bsp tty ote locale ISO88591/NULL<br />
2002-06-03[15:00:36]:E:bsp: Errno 0 bdb_errno 0<br />
2002-06-03[15:00:36]:E:bsp: Log_mesg: Internal error<br />
2002-06-03[15:00:36]:E:bsp: ******* E N D of Error message *******<br />
<br />
Does the Baan version matters? We are using B40c0.<br />
<br />
Thanks again,<br />
NS</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">3rd June 2002, 23:03</div></div><div class="posttext">I think this should work for all versions of Baan 4.  We are on 4c3 and our client version is B40c.044. I do know that with our latest tools patch somethings are not working - like ttstpcreatdll, but the OLE piece does still seem to function.<br />
<br />
I am attaching the readme.txt file from the C:\baan\samples directory.  Do you have the samples directory?  The readme.txt file says it will not work in the BX and BA environments. I believe our BSP user is setup only for the BA environment, not sure - but I do know it is different than one of our &quot;normal&quot; users.  Just a thought - maybe try it using one of Baans samples, using a normal user logon.  <br />
<br />
Other than that, I guess I would recommend calling Baan support at this point, but you mentioned you all are not carrying support. I am not sure what else to try.<br />
<br />
Mark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Al Smith</div><div class="date">4th June 2002, 00:22</div></div><div class="posttext">Hi,<br />
This is a shot-in-the-dark but:<br />
I wonder if the type library is registered correctly.<br />
<br />
Check your registry (regedit) under HKEY_CLASSES_ROOT. Scroll down to TypeLib. There should be a class ID 00000001-4000-11ce-AAA8-00608C50C597.<br />
Expand the folders 0 and 9 then open win32. These should be set to c:\BAAN\lib\bw.tlb.<br />
<br />
Al.<br />
<br />
By the way, what os are you using on the PC? win95/98, 2K, etc.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">r_nagu</div><div class="date">4th June 2002, 00:41</div></div><div class="posttext">Al,<br />
       I checked the regedit and the path looks to be fine. <br />
<br />
Mark,<br />
       Our baan is running on Unix but, we use BW client for endures. So, i think we are using bw environments not bx or ba. When I do the licmon6.1 -w it shows bx/bw under TYPE column.<br />
<br />
I checked couple more things. I looked at the windows event viewer after the error message and this is what it shows<br />
<br />
===============<br />
The description for Event ID ( 1000 ) in Source ( Baan ) cannot be found. The local computer may not have the necessary registry information or message DLL files to display messages from a remote computer. The following information is part of the event: Env	 bw068 (c:\program files\baan 061)<br />
Prog	 BW file p_oleaut.cpp # 519<br />
Keyword	 TsMSOleAutomationRec::Invoke(DISPID, REFIID,	LCID, WORD, DISPPARAMS far*, VARIANT far*, EXCEPINFO far*, UINT far*)<br />
Username	 bsp	type S	language 2<br />
Process	 0x2a4<br />
Lasterror	 6 (The handle is invalid.)<br />
Errno	 0<br />
bdberrno	 0<br />
Message	   1 : DispInvoke failed, error = -2147352562<br />
==============<br />
<br />
Also, I am getting this VBA error message [Please see the attached]<br />
<br />
Looks like this is becoming a real pain. I really appreciate all your help. <br />
<br />
Thanks,<br />
NS</div></div><hr />


<div class="post"><div class="posttop"><div class="username">günther</div><div class="date">11th June 2002, 16:54</div></div><div class="posttext">I've been looking for some of the posts in this tread. Then I checked the e.g. C:\baan\samples\baan.xls file, and started to wonder why they didn't run any more. I remember to have at least checked them to work.<br />
<br />
The problem was CreateObject(&quot;Baan4.Application&quot;), which was no longer correct for *my* configuration. I had to change that line into CreateObject(&quot;Baan4.Application.hera&quot;) -- hera is our test machine; I found that setting after pressing the [Configure] button on the bw client and switching to Tab 3 &quot;Automation&quot;. My Client is B40c.63.<br />
<br />
Maybe you should also have a look at your configuration.<br />
<br />
Günther;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">12th June 2002, 18:06</div></div><div class="posttext">Just thought I would let everyone know that I have just installed a new BW client.  My OLE macro that worked on the old client no longer works with the new client.  I get the same error as r_nagu.  The minute I hit the BaanObj.ParseExecFunction. I am going to have our admin place a call with Baan.<br />
<br />
I can fix it by running regedit and changing Baan4.application to point to the old bw.exe client file. In other words I change the registry entry from LocalServer32 = C:\Program Files\Baan\bin\bw.exe /Automation to LocalServer32 = C:\Baan\bin\bw.exe c:\baan\lib\user\b4a.bwc /Automation.  The first is the location of the new client and the second is the old client.<br />
<br />
Mark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">r_nagu</div><div class="date">12th June 2002, 18:10</div></div><div class="posttext">Mark,<br />
        Would you please let me know what Baan support says?<br />
<br />
Thanks,<br />
NS</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">12th June 2002, 22:34</div></div><div class="posttext">I will let you know what we find out.  I have sent a document to our app admin to log a case.  While waiting I am trying other things to see if I can get it to work, but so far no luck.<br />
<br />
Mark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Al Smith</div><div class="date">12th June 2002, 23:03</div></div><div class="posttext">Hi,<br />
I don't know if this will help but:<br />
<br />
I needed a baan login and bwc file that was used only for automation functions (ottstpapihand) with no login dialog.<br />
What I did was to place the /Automation command in the command section of the bwc file.<br />
e.g.<br />
<br />
[ApplicationServer]<br />
bse=/baan2/baanivc/bse<br />
bshell=bshellx<br />
command=/Automation<br />
location=<br />
connection=<br />
<br />
[Remote]<br />
hostname=ssprd<br />
username=web2baan<br />
password64=removed by ~Vamsi<br />
protocol=EXEC<br />
portnumber=512<br />
domain=<br />
password=<br />
logindialog=NO<br />
serveros=<br />
<br />
[NLS]<br />
locale=ISO<br />
RightToLeft=False<br />
<br />
[Font]<br />
fontName80=Fixedsys<br />
fontWidth80=0<br />
fontHeight80=-12<br />
fontWeight80=normal<br />
fontItalic80=NO<br />
fontName132=Fixedsys<br />
fontWidth132=0<br />
fontHeight132=-12<br />
fontWeight132=normal<br />
fontItalic132=NO<br />
<br />
I then changed the LocalServer32 registry entry to c:\baan\bin\bw.exe /Web2Baan.bwc<br />
Al.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Al Smith</div><div class="date">13th June 2002, 00:11</div></div><div class="posttext">~Vamsi,<br />
Thanks for removing the password.<br />
I had corrupted it however.<br />
Al.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">13th June 2002, 00:43</div></div><div class="posttext">Hi Al!<br />
<br />
I tried the setup you suggested but that did not work either. The only thing that works in the LocalServer32 is the old bw.exe file.  For the new clients it looks like it creates another registry entry where LocalServer32=C:\Baan\BIN\BW.EXE /Automation &quot;c:\Baan\LIB\USER\ole.bwc&quot;. It does this for each of your .bwc files.  I am hoping to get a quick response back from Baan.  <br />
<br />
I did not mention this but the client I installed earlier was B40c.065.<br />
<br />
Mark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">r_nagu</div><div class="date">13th June 2002, 03:20</div></div><div class="posttext">Hi,<br />
     I tried Als suggestion too but it did not work. Hope BaaN support got some kinda answer for this. By the way the BW version I am using is B40c.61.<br />
<br />
Thanks,<br />
NS</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Al Smith</div><div class="date">13th June 2002, 16:04</div></div><div class="posttext">Hi,<br />
I'm using B40c.050.<br />
I wonder if this situation with the newer clients is in Baan's automation object or perhaps an incompatibility with microsoft's ole32.dll which is the OLE InProcess handler.<br />
If your up to trying more things, you should be able to run Baan from the &quot;Run&quot; command in your start menu. This bypasses the ole32.dll.<br />
If you enter, for example:<br />
<br />
c:\baan\bin\bw.exe &quot;c:\baan\lib\user\Test.bwc&quot;<br />
<br />
You should get the full Baan menu browser.<br />
If you change it to:<br />
<br />
c:\baan\bin\bw.exe /Automation &quot;c:\baan\lib\user\Test.bwc&quot;<br />
<br />
You should only see the option dialog. You'll have to kill the ttstpoledeam process to quit.<br />
<br />
Al.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">13th June 2002, 16:42</div></div><div class="posttext">Hi Al,<br />
<br />
This thread (http://www.baanboard.com/baanboard/showthread.php?s=&amp;threadid=5476) dicusses some of the client changes. I think it mentions the new client config started in 61 or 62. It looks like you get new registry entries for each bwc configuration. Below is a snapshot of the configuration format - I kind of like it.<br />
<br />
The new client also works as you suggest. If I run c:\baan\bin\bw.exe /Automation &quot;c:\baan\lib\user\any.bwc&quot;, I get only the option dialog box.  <br />
<br />
Mark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Al Smith</div><div class="date">14th June 2002, 18:15</div></div><div class="posttext">Hi,<br />
I just loaded B40c.62 Baan client and everything still works. (Wow, the bw.exe went from 1 meg to 6 meg.)<br />
For what it's worth, below is the Object Idents from our system for ottstpoledaem, ottdllsql_query, and ottstpapihand.<br />
<br />
Al.<br />
<br />
---------------------------OBJECT IDENTS--------------------------------<br />
@(#)/n1/BaanIVc4/bse/tools/ttB40_c4/pttstp/pstpoledaemon0, 98/10/02 [06:18], From bsp<br />
@(#)-DREL6_1<br />
@(#)bic_global	8.2:4/20/98 Copyright (c) Baan International b.v.<br />
@(#)bic_object	7.7.1.2:1/26/98 Copyright (c) Baan International b.v.<br />
@(#)bic_event	8.1:4/20/98 Copyright (c) Baan International b.v.<br />
@(#)bic_shell, 08-1994/R1, Copyright (c) Baan International b.v.<br />
@(#)bic_fork	1.1:3/1/95 Copyright (c) Baan International b.v.<br />
<br />
<br />
---------------------------OBJECT IDENTS--------------------------------<br />
@(#)/usr4/triton6/bse/tools/ttB40_c5/pttdll/pdllsql_query0, 98/11/13 [10:07], From gvdwal<br />
@(#)-DREL6_1<br />
@(#)bic_global	7.18.1.1:8/31/98 Copyright (c) Baan International b.v.<br />
@(#)bic_object	7.7.1.2:1/26/98 Copyright (c) Baan International b.v.<br />
@(#)bic_event	8.1:4/20/98 Copyright (c) Baan International b.v.<br />
@(#)bic_shell, 08-1994/R1, Copyright (c) Baan International b.v.<br />
@(#)bic_fork	1.1:3/1/95 Copyright (c) Baan International b.v.<br />
@(#)DF 70437 01/09/1998 mb.export removed<br />
@(#) Call 10018477, 96/01/29: Error ; not expected, using date.to.num()<br />
@(#) Call 10020566, 96/04/26: Error if using parenthesis on from/to fld<br />
@(#) Call 10228702, 97/03/10: Error if parenthesis on date fields<br />
@(#) Call 10241698, 97/05/01: Error when using exists<br />
@(#) Call 10242579, 97/05/01: Error when using exists<br />
@(#) Call 11609, 97/07/16: Error when using between<br />
@(#) Call 12796, 97/09/22: Error when using arithmetic on date<br />
@(#) Call 16265, 98/03/24: .date fields disappear from query<br />
@(#) Call 17250, 98/04/08: single quoted strings disappear from query<br />
@(#) Call 17988, 98/05/13: set specification cannot be used<br />
@(#)Call 441214, 1995/06/28<br />
<br />
<br />
---------------------------OBJECT IDENTS--------------------------------<br />
@(#)/usr4/triton6/bse/tools/ttB40_c5/pttstp/pstpapihand0, 99/02/02 [13:20], From gvdwal<br />
@(#)-DREL6_1<br />
@(#)bic_global	7.18.1.1:8/31/98 Copyright (c) Baan International b.v.<br />
@(#)bic_object	7.7.1.2:1/26/98 Copyright (c) Baan International b.v.<br />
@(#)bic_event	8.1:4/20/98 Copyright (c) Baan International b.v.<br />
@(#)bic_shell, 08-1994/R1, Copyright (c) Baan International b.v.<br />
@(#)bic_fork	1.1:3/1/95 Copyright (c) Baan International b.v.<br />
@(#)	October 1997: Added argmuments (do.update) in functions insert/update/delete<br />
@(#)	October 1997: Added function get.mess.code<br />
@(#)	December 1997: After update/insert new values are taken back<br />
@(#)	December 1997: Solved problem with multiple forms<br />
@(#)	December 1997: Solved problem with more than 1 session<br />
@(#)	April    1998: Session created in separate process group<br />
@(#) DF19590,98/10/05: Baan is not responding after delete action<br />
@(#) 	December 1998: Update and save action combined in 1 call<br />
@(#) 	December 1998: Performance improvements<br />
@(#)   Februari 1999: Only fields filled with put are read by stp</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">19th June 2002, 13:57</div></div><div class="posttext">Hi Al!!<br />
<br />
Just caught this today when I was going to give an update on the case.  Here is the idents from ttstpoledaemon:<br />
<br />
---------------------------OBJECT IDENTS--------------------------------<br />
@(#)/usr4/triton6/bse/tools/ttB40_c5/pttstp/pstpoledaemon0, 00/06/19 [15:39], Fn<br />
@(#)-DREL6_1<br />
@(#)bic_global  8.13:6/15/00 Copyright (c) Baan International b.v.<br />
@(#)bic_object  7.7.1.3:2/19/99 Copyright (c) Baan International b.v.<br />
@(#)bic_event   8.2:1/13/00 Copyright (c) Baan International b.v.<br />
@(#)bic_shell, 08-1994/R1, Copyright (c) Baan International b.v.<br />
@(#)bic_fork    1.1:3/1/95 Copyright (c) Baan International b.v.<br />
<br />
<br />
From ours you can see the differences and that could be the problem.<br />
<br />
Anyway this specific case is still in the &quot;waiting&quot; state.  What worries me is that I will get the same answer to this case that I got on another.  The other case our admin logged had to do with ttstpcreatdll - it no longer works.  The response from the support center was to update our porting set, but we can not do this because we are in the middle of working with Baan on data correction.  Here is the reponse back from our admin:<br />
BaaN told us that one of the things we needed to do to resolve this case is to install the porting set at level 6.1c.06.xx.  The latest level is now at 6.1c.06.04.  However, Erica Smit's A&amp;D Newsletter dated May 10 advised us not to upgrade the porting to 6.1c.06.03 or higher since it affects the data clean-up effort.<br />
<br />
We have several cases on hold where we can not install patches because of this cleanup effort. It is so frustrating to have the Baan response center give us a solution and then the Baan correction team tell us we can not install it. Sigh. If I ever get a solution I will post it.<br />
<br />
Mark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">r_nagu</div><div class="date">19th June 2002, 16:03</div></div><div class="posttext">Hi All,<br />
	My bic_info6.1 on ottstpoledaemon looks exactly like Marks. I hope upgrading the porting set is not the only solution. <br />
<br />
Mark,<br />
	You said it used to work on your old BW version. What version was that?<br />
<br />
Thanks,<br />
NS</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">19th June 2002, 16:25</div></div><div class="posttext">Hello NS!<br />
<br />
My old bw client was B40c.044.  This bw.exe file works with the porting set and tools release we are on.  I am keeping this client in another directory so the stuff I need continues to work. <br />
<br />
Mark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">r_nagu</div><div class="date">28th June 2002, 21:00</div></div><div class="posttext">Hi Mark,<br />
       I was just wondering whether you had any luck with this?<br />
<br />
Thanks,<br />
NS</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">28th June 2002, 21:33</div></div><div class="posttext">Hello NS!<br />
<br />
Sorry no luck yet.  The support sight had us install a solution which had a newer ottdllsql_query.  That did not work - same error.  Then they emailed me another version of ottdllsql_query. That did not work also, I have not heard back from them since yesterday morning.<br />
<br />
<br />
Mark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MatthewJames</div><div class="date">1st July 2002, 17:48</div></div><div class="posttext">Have you tried running this code on multiple machines?<br />
to find out if it is machine specific or a genuine bug?<br />
<br />
Other wise try fully removing you client installation and re-installing it as this will probably solve the problem if it registry based which it sounds like it is.<br />
<br />
What version of excel are you using? have you got the latest service pack?<br />
<br />
The code it's self is sound!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">1st July 2002, 18:07</div></div><div class="posttext">We just installed W2K and office XP.  This works with the old client, but not the new client. I did originally uninstall all clients.  I am not sure if that cleaned up the registry.  I might give that a try tomorrow.<br />
<br />
The same error appears on other machines with the .65 client.<br />
<br />
Mark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">12th July 2002, 22:04</div></div><div class="posttext">Here is what I was informed of today:<br />
<br />
OLE is no longer supported in the B40c.065 client. I was told to keep my .044 client until we upgrade to 5c.  In 5c I was told we will use openworld.  We are planning to upgrade to 4c4 and what I was provided was a copy of the quick guide(AG1002) for a work around. Not even close to OLE, but I can keep the old client. If you are not familiar with this quick guide it is how to use ttstpconv. Not the same as OLE.  So I will hold onto the old client until it no longer works or we go to 5c.  Which will not happen until Baan has a 5c A&amp;D version.<br />
<br />
Somewhere along the way NS asked &quot;Does BW version matter?&quot; - The answer is YES.  Maybe if you had one of the older clients it would work with 4c4 (I think that was the version you all were using).  Since I am the only one using OLE at our site I can use the old client work around - not sure if that is feasible for you NS. I had planned on rolling out a function server to a user , but will skip that.<br />
<br />
<br />
That's the update according to Baan.<br />
<br />
Mark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">r_nagu</div><div class="date">14th July 2002, 16:53</div></div><div class="posttext">Mark,<br />
    Thanks for the update. I guess I will have to dig out one of the old versions of BW and try this OLE.<br />
<br />
Thanks,<br />
NS</div></div><hr />


<div class="post"><div class="posttop"><div class="username">r_nagu</div><div class="date">14th July 2002, 16:54</div></div><div class="posttext">Mark,<br />
    Thanks for the update. I guess I will have to dig out one of the old versions of BW and try this OLE.<br />
<br />
Thanks,<br />
NS</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Darren Phillips</div><div class="date">17th July 2002, 15:15</div></div><div class="posttext">Mark<br />
<br />
When I saw that BAAN support said OLE is no longer supported in the B40c.065 client I was not happy as I have some users making use of this. So I tested the B40c.065 client and on our system it still works BaanIV4 SCH1 SP9. sounds like support cannot find the problem your having so easier to say that it is no longer supported.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">17th July 2002, 15:38</div></div><div class="posttext">Darren,<br />
<br />
When I think about it I also wonder why they included the &quot;automation&quot; tab on the configurator if the no longer support OLE. Anyway I plan on testing it when we go to 4c4 sometime in the next year.  Currently we are on 4c3 A&amp;D SP12. I really thing the problem has something to do with our porting set - but that is a guess.  Currently ttstpcreatdll does not work and baan support said we need the new porting set. We need to finish the Data recovery process Baan has us going through right now and can not install patches or a new porting set. I was hoping for a different answer, but will live with the answer they gave me.<br />
<br />
Thanks again for the update. I will keep an eye on things to see if it does start working with the new client.<br />
<br />
Mark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">15th August 2002, 16:06</div></div><div class="posttext">On Monday we updated the porting set on our test box.  We installed this to fix a problem I had with the ttstpcreatdll session.  Anyway I did think about testing this until this morning. We went from 6.1c.04.01 to 6.1c.06.04 and the OLE automation works.  So NS it looks like the client and the porting set could be causing your problem.<br />
<br />
Mark</div></div><hr />



</div>
</body>
</html>