<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="how to insert record in baan table, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] how to insert record in baan table Tools Development" />
	
	<title>how to insert record in baan table [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="../index.html">Newbaanboard</a> &gt; <a href="../index.html">Baan Quick Support: Functional &amp; Technical</a> &gt; <a href="../index.html">Tools Development</a> &gt; how to insert record in baan table</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">ncgjiju</div><div class="date">9th March 2005, 02:36</div></div><div class="posttext">Hi,<br />
<br />
      I am trying to insert record into customised baan tables using the microsoft excel sheet. There is no development license so I can't create library code that can attach the code. They do not have baan AFS (Automatic File Server) application availbale.The backend is SQL server. When I try to insert a record uisng the database method in vbscript , I unable as the hash key has to be filled in. The source code of hashkey in db.insert() is not available in the system as it is standard code. How to  get around the problem and to insert the record in baan table. What is the standard library that contains the  db.insert() function. What are the options available to slove this problem.<br />
<br />
Thanks for help.<br />
regards,<br />
<br />
George</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MariaC</div><div class="date">9th March 2005, 07:22</div></div><div class="posttext">Try using the Exchange Module.  This has the facility to import data into baan tables from ascii files.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ncgjiju</div><div class="date">10th March 2005, 02:12</div></div><div class="posttext">Hi Marai,<br />
<br />
         Thanks for your advice , but I need excel to import the data into baan tables. Since there is no development license, I am unable to make a library and create function that will create the same. Is it possible to get the name of standard library that contains the  function db.insert(). Please advise.<br />
<br />
regards,<br />
<br />
George</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Debdas Banerjee</div><div class="date">10th March 2005, 05:05</div></div><div class="posttext">Hi<br />
<br />
there is tow way to insert data in to BaaN table <br />
<br />
1: db.insert()<br />
2. Exchange Scheme<br />
<br />
1. <br />
	select tdclc955.*<br />
	from   tdclc955<br />
	where  tdclc955._index1 = {:slno.f}<br />
	selectdo<br />
		select	tdclc956.*<br />
		from	tdclc956 for update<br />
		where   tdclc956._index1 =  {:slno.f }<br />
		selectdo<br />
		selectempty<br />
		     tdclc956.slno=tdclc955.slno<br />
		     tdclc956.flag = tcyesno.No<br />
		     db.insert(ttdclc956,db.retry)<br />
		endselect		<br />
		commit.transaction()<br />
2. Exchange Scheme<br />
<br />
    BaaN Utility<br />
        Master data<br />
            Maintain exchange scheme and then go to special and maintain <br />
            AscII file and Maintain Batch<br />
<br />
    Import module<br />
         Creat Import Script<br />
               First creat then go to special and run Import data for non regular <br />
<br />
<br />
Regards</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MariaC</div><div class="date">10th March 2005, 11:12</div></div><div class="posttext">As Deb menitoned the exchange module is a standard uitility in baan which will read data from and ascii file (convert excel spreadsheet to CSV format) and then populate the corresponding tables in baan.  It works well as does reference checking.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Francesco</div><div class="date">10th March 2005, 17:06</div></div><div class="posttext">They do not have baan AFS (Automatic File Server) application availbale.<br />
<br />
Without a development license you are up a creek with no canoo. But why would AFS (Application Function Server) not be available? Anyway, you are only interested in API, and why would they turn that off? <br />
<br />
The beauty of that is that you can do all your coding in Excel's VBA and subsequently don't need developer's access to Baan. If this is not an option, then exchange is your _only_ alternative.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ncgjiju</div><div class="date">11th March 2005, 02:21</div></div><div class="posttext">Hi Franseco,<br />
<br />
                I have already done the coding in vb script, I am able to update , but unable insert a record as the probelm is of hashkeys. Can u please guide on this  issue or show any sample code.<br />
<br />
<br />
regards,<br />
<br />
George</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Francesco</div><div class="date">11th March 2005, 02:26</div></div><div class="posttext">The beauty of using the API is that you don't have to worry about hash codes. You still use Baan's session functionality and all the engines behind it.<br />
<br />
If you are updating through excel and experience problems with the hash field, I am guessing that you go directly to the database with ODBC rather than using Baan's API.<br />
<br />
There is a forum here dedicated to AFS/API/OLE. You can find tons of sample code there plus the Baan documentation on the subject (remarkably complete for Baan standards).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ncgjiju</div><div class="date">11th March 2005, 03:30</div></div><div class="posttext">Hi Franseco,<br />
<br />
         do you know the name form  or what is web site name<br />
<br />
regards.<br />
<br />
George</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Debdas Banerjee</div><div class="date">11th March 2005, 06:25</div></div><div class="posttext">I want to share my experience on inserting data into BaaN Database.<br />
1.You can insert data through Exchange Scheme<br />
2.You can insert data through AFS<br />
3.You can Insert data through any other utili using BaaN DB <br />
<br />
I am giving my code below . This is visual basic code . First we developed barcode system through Visual Basic and update the data through Visual basic. But problem is this it will not generate the hash column. You have to reorganise the data then only data will be visible through GTM or use will able to use that data . If you open that data through SQL - query analyzer , you will the data before Reorganise the data .<br />
<br />
I don't know the logic of Hash column . I tried lot for has column even I ask Baan Global they also failed to give. <br />
<br />
    Do Until rs.EOF<br />
        stmt1 = &quot;insert into tticus930&quot; &amp; gCompany &amp; _<br />
                &quot; values (&quot; &amp; rs(&quot;t_pdno&quot;) &amp; &quot;, &quot; &amp; rs(&quot;t_ldno&quot;) &amp; &quot;, &quot; &amp; _<br />
                &quot;cast('&quot; &amp; strdate &amp; &quot;' as smalldatetime), &quot; &amp; seqn &amp; &quot;, &quot; &amp; _<br />
                rs(&quot;qty&quot;) &amp; &quot;, 0, 4, '0',&quot; &amp; _<br />
                &quot; 0, 0)&quot;<br />
        dbconn.Execute stmt1<br />
        rs.MoveNext<br />
    Loop<br />
    rs.Close<br />
<br />
For Hash I did this but now working<br />
<br />
    stmt = &quot;select (max(cast(hash1 as integer)) + 1) nexthash from tticus930&quot; &amp; gCompany<br />
<br />
Regards</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">11th March 2005, 14:33</div></div><div class="posttext">Hi Franseco,<br />
<br />
         do you know the name form  or what is web site name<br />
<br />
regards.<br />
<br />
George<br />
<br />
<br />
The forum is on baanboard.  Here is a link to the AFS/DDC/OLE Forum (http://www.baanboard.com/baanboard/forumdisplay.php?f=59).  You might also want to search this complete board for &quot;hash&quot;.  Seems to me there were previous posts that discuss this topic.<br />
<br />
Mark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ncgjiju</div><div class="date">21st March 2005, 05:37</div></div><div class="posttext">I have tried the sql to get the  hash key , but I get a empty value <br />
<br />
   stmt = &quot;select (max(cast(hash1 as integer)) + 1) nexthash from tticus930&quot; &amp; gCompany<br />
<br />
mysql = &quot;select (max(cast(hash1 as integer)) + 1) next hash from tdupk070300&quot;<br />
<br />
I am getting the next hash as empty value. please help<br />
<br />
<br />
regards<br />
<br />
George</div></div><hr />


<div class="post"><div class="posttop"><div class="username">RobertB</div><div class="date">21st March 2005, 09:32</div></div><div class="posttext">Hi,<br />
<br />
It is certainly possible to fill the hash fields using SQL statements, and it's quite easy to do so. But, it's not to be recommended!.<br />
<br />
Here's how it's done: take the (Baan V) table tcibd001 (General Item Data) as an example. The first two indices are:<br />
<br />
(1) Item ; field item;<br />
(2) Search Key 1, Item; fields seak, item<br />
<br />
Each index corresponds to a hash field in the table (duh).<br />
<br />
You need to check the lengths of the individual fields in each index: for the first index, the field-length is 47 characters (domain tcitem), and for the second, it's 16 + 47 = 63 characters (domains tcseak and tcitem).<br />
<br />
Then the code for generating the first hash field for Item No. 12345678-9 is:<br />
select convert(varbinary(47), '         12345678-9                            ') as hash1, where the first nine spaces stand for a (in this case empty) Project Number, and the rest of the field is padded with spaces (important).<br />
<br />
For the second hash-field, we might have the following:select convert(varbinary(63), 'POWER DRIVE UNIT         12345678-9                            ') as hash2You already know how to do your other fields.<br />
<br />
To read a hash field, do this:<br />
select convert(varchar(47), hash1), convert(varchar(63), hash2)<br />
from baandbc..ttcibd001100<br />
where t_item = space(9) + '12345678-9'HTH,<br />
Rob</div></div><hr />


<div class="post"><div class="posttop"><div class="username">NaaBbaaN</div><div class="date">13th August 2005, 00:15</div></div><div class="posttext">How Could we read and write number, date hash fields</div></div><hr />


<div class="post"><div class="posttop"><div class="username">lsatenstein</div><div class="date">13th August 2005, 05:51</div></div><div class="posttext">There are several ways to do it, and it depends on whether you need to do it for a single record, or for multiple records. Second, if it can be done in batch or live.<br />
<br />
When it is only one record is to be added, one could dilliently use ttaad4100 GTM)<br />
<br />
When there are several, you could use the excel macro to write out a delimited file and use bdbpre/bdbpost (one of the two) to read the ascii file and to merge in the records.<br />
<br />
If you do not have developper, then I presume you do not have easy sql.<br />
With easy sql, you have a third way, and that is to write a report script (the regular script does not allow insert or delete, but you can have a report with an edit script attached. Use the sql from within the edit script to insert the records, again from a flat file as input.<br />
<br />
Use your dabase system to do an sql and completely circumvent baan. <br />
<br />
If Baan does not make a single developer licence available for free, you should switch to a better product. (Oracle, informix, and a few other sql's would offer what Baan offers)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">NaaBbaaN</div><div class="date">13th August 2005, 09:22</div></div><div class="posttext">Sorry you misunderstood me, how do I convert a numeric or date field into a hash key adding/updating a record for level 1 driver in baan. Robert has shown an example of string fields. So that then I can externally add/update a record into sql,oracle or informix and not through the expensive Baan license.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">lsatenstein</div><div class="date">13th August 2005, 15:45</div></div><div class="posttext">The date that I believe you describe is the gregorian date, with year, month and day numbers<br />
<br />
Well the julian date is the equivalent and it is the number of days since 1 january 1<br />
<br />
It is the first birthday of Jesus,  <br />
<br />
There are many functions available for that purpose.  But one of the easier ways is to derive the number corresponding to  1950/01/01 as a number, and do the calculation to arrive at the day number you want.<br />
<br />
On the internet there are published c-sources for doing the conversions both ways. Send me an email and I will send you the copies, or search with google for date conversion routines.<br />
<br />
or ask a friend to write a small session (Baan has one) that accepts a julian date and gives a gregorian date or vice-versa</div></div><hr />


<div class="post"><div class="posttop"><div class="username">RobertB</div><div class="date">15th August 2005, 14:15</div></div><div class="posttext">Hi NaabBaan,<br />
<br />
As I mentioned earlier, each index in a Baan table corresponds to a hash field in the table. So you have just as many hash fields in the table as you have indexes.<br />
<br />
Each hash field has a definite length, which is (most often!) the combined sum of the domain-lengths for each separate table-field in the the index, all converted to binary form. It's up to you to discover which Baan domains are being used in each of the indexes of interest to you.<br />
<br />
Once you know exactly which domains are being used in any particular index - and hence in the associated hash-field - you can begin to write a SQL statement to perform the conversion from index-field-values to hash-field-values. Here are some more examples (for MS-SQL 7):<br />
<br />
table xyz999, company 100, database baandb<br />
<br />
index 1:  field numa, domain abcd.int   (integer, length 16)<br />
<br />
To write this hash-field you need code similar to the following:update baandb.dbo.txyz999100 set hash1= convert(varbinary(16), numa)<br />
<br />
or <br />
<br />
insert into baandb.dbo.txyz999100 values(..., ..., ..., convert(varbinary(16), numa), ...)<br />
To write date-fields into a hash-field you need to know that Baan stores dates internally as integers. From the Baan ERP Programmers Help: <br />
Internally, BaanERP stores dates and times in Universal Coordinated Time (UTC). It stores both date and time in a single long integer referred to as the UTC long format. This integer represents the number of seconds since 0:00 hour, January 1, 1970 (in UTC).  OK, that's the UTC datetime data-type; here's an example:<br />
<br />
index 2:  field odat, domain tcdate   (UTC Date/Time, length 22)<br />
 <br />
To write to the odat field itself, you would need code similar to the following:update baandb.dbo.txyz999100 set t_odat = convert(int, datediff(ss, convert(datetime, '1970-01-01 00:00:00', 120), convert(datetime, '2005-08-14 15:31:14.000', 120))) To write to the hash-field, however, is rather more difficult. This is because, notwithstanding the fact that UTC date-fields hold an integer value, the hash contains a &quot;mixed&quot; hexadecimal version of the date. Example:<br />
<br />
UTC date is:          &quot;2002-10-23 08:31:14&quot;  <br />
Integer value is  :   136252928<br />
Hash value is:        0x14020A17081F0E<br />
<br />
To understand the hash value, you have to split the hash value into groups of two characters thus:<br />
14, 02, 0A, 17, 08, 1F, 0E.<br />
<br />
These values translate to the following ASCII characters:<br />
20, 02, 10, 23, 08, 31, 14<br />
<br />
which, if you string them together, evaluate to &quot;20021023083114&quot;, and which is the date &quot;2002-10-23 08:31:14&quot; formatted without the &quot;-&quot;, &quot; &quot; and &quot;:&quot; characters; hence we can forget the integer value 136252928 for the hash field. So, to write to the hash-field, we need code similar to the following (do not forget to convert your local time to UTC/GMT first):declare @mydate char(19)<br />
declare @myhash varbinary(16)<br />
set @mydate = '2002-10-23 08:31:14'  -- ODBC Canonical 24-hr format...<br />
set @mydate = replace(@mydate, '-', '')  -- Remove &quot;-&quot;'s...<br />
set @mydate = replace(@mydate, ' ', '')  -- Remove &quot; &quot;'s...<br />
set @mydate = replace(@mydate, ':', '')  -- Remove &quot;:&quot;'s...<br />
set @myhash = convert(varbinary, (char(substring(@mydate, 1, 2)))) + <br />
	convert(varbinary, (char(substring(@mydate, 3, 2)))) +<br />
	convert(varbinary, (char(substring(@mydate, 5, 2)))) +<br />
	convert(varbinary, (char(substring(@mydate, 7, 2)))) +<br />
	convert(varbinary, (char(substring(@mydate, 9, 2)))) +<br />
	convert(varbinary, (char(substring(@mydate, 11, 2)))) +<br />
	convert(varbinary, (char(substring(@mydate, 13, 2))))<br />
--select @myhash<br />
<br />
update baandb.dbo.txyz999100 set hash1= @myhash<br />
<br />
or <br />
<br />
insert into baandb.dbo.txyz999100 values(..., ..., ..., @myhash, ...) As far as the &quot;older&quot; date format fields are concerned, Leslie is correct in saying that you need to calculate the number of days since 0001-01-01 (the birthdate of JC) to the date in question. This means you need to calculate a &quot;Julianized&quot; date, which is made a lot easier by assigning the constant number 693595 (the number of days between &quot;0001-01-01&quot; and &quot;1900-01-01&quot;) to the date &quot;1900-01-01&quot;. Then simply add the number of days since &quot;1900-01-01&quot; to this constant to arrive at the correct number. So, to calculate the number of days between &quot;0001-01-01&quot; and the date &quot;2005-08-14&quot;, use code similar to the following:select 693595 +  datediff(dd, convert(datetime, '1900-01-01', 120), convert(datetime, '2005-08-14', 120)) Since I haven't access to Baan at the moment, I don't know how this number is stored in a hash-field; but I leave this for you as an exercise!<br />
<br />
Finally, although I give methods by which Baan hash-fields may be updated, I would personally never attempt to do this, and would never suggest that such a thing be done.   <br />
If you do go down this road, you are on your own!!!  <br />
<br />
HTH,<br />
Robert</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ashu2814</div><div class="date">29th May 2009, 11:52</div></div><div class="posttext">you can use sequential dump</div></div><hr />



</div>
</body>
</html>