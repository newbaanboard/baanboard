<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="Delete a file from Win NT server, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] Delete a file from Win NT server Tools Development" />
	
	<title>Delete a file from Win NT server [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="../index.html">Newbaanboard</a> &gt; <a href="../index.html">Baan Quick Support: Functional &amp; Technical</a> &gt; <a href="../index.html">Tools Development</a> &gt; Delete a file from Win NT server</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">learner</div><div class="date">11th March 2004, 20:23</div></div><div class="posttext">Hi,<br />
<br />
We r  running BaaN IV c4 on Win NT 4.0.<br />
<br />
I have created a session, where by as soon as the user clicks on the button , a file specified on the form gets trasnfered to the server using function clienttoserver().<br />
<br />
As soon as file gets transfered my temp. table also gets 1 record filling the details such a sr. no., , file name etc etc.<br />
<br />
Now if my user deletes this records from the session, i want that the file should also be deleted physically from the server , how to do it ???<br />
<br />
<br />
We r on win NT, and not on UNIX, i tried the below mentioned code<br />
<br />
string comm(60)<br />
<br />
comm = &quot;DEL C:\serverfolder\test.txt&quot;<br />
<br />
and execued it using shell function, but after a minute or so it said &quot;no more PTY's avalable&quot;<br />
<br />
how do i do it in Win NT ?<br />
<br />
<br />
Regards<br />
<br />
Learner</div></div><hr />


<div class="post"><div class="posttop"><div class="username">en@frrom</div><div class="date">11th March 2004, 20:56</div></div><div class="posttext">Hmmm.. I have never tried this, but from the Baan manual on Baan 5.0b (our version), it seems like this is not possible with the standard functions. To remove a file from the local client you can use remove.local.file(), and when copying from client to server using client2server() you can specify a parameter so that the file will be removed from local client after copied to server, but the other way around by server2client() that argument is not available...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">NPRao</div><div class="date">11th March 2004, 21:11</div></div><div class="posttext">Learner,<br />
and execued it using shell function, but after a minute or so it said &quot;no more PTY's avalable&quot; <br />
You cannot use shell() on Windows OS.<br />
This starts the vt200 compatible terminal emulator to execute the command specified in the command argument. The shell (for example, UNIX, VMS, or MPE) process is connected with the bshell by means of a pseudo tty. Running a shell does not block the bshell. You can switch to another window and perform other tasks.  <br />
Since you know the server file path, you can use the commands - file.rm() or seq.unlink() to remove the files.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dorleta</div><div class="date">12th March 2004, 11:01</div></div><div class="posttext">long file.rm(cons string path)<br />
<br />
returns 1 when success a negative value when fail</div></div><hr />


<div class="post"><div class="posttop"><div class="username">learner</div><div class="date">12th March 2004, 19:58</div></div><div class="posttext">Hi,<br />
<br />
yaah seq.unlink() worked for me, I executed this from server only, which means i used seq.unlink() to delete a file from a pc on LAN, <br />
<br />
i will try from pc to pc, since i suppose from server i was able to do it because i was logged in as Adminsitrator....just a guess.<br />
<br />
anyway, one more issue is that once the user clicks DELETE option standard baan throws a message &quot;Do you want to Delete Yes/No&quot; , now how do i capture yes/no options in this case, because if i use function ask.enum and relevant question code , then i asks 2 times , first time because of standard functionality and second time because i inserted ask.enum in after.choice of delete.<br />
<br />
how to handle this situation ? how to cpature the yes/no situation thrown by standard baan ???<br />
<br />
<br />
Regards<br />
<br />
Learner</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Hitesh Shah</div><div class="date">13th March 2004, 07:47</div></div><div class="posttext">Standard baan question 'Delete yes/no' can not be avoided . It's generated by standard program whenever delete button is triggerred .<br />
<br />
U may try a custom  delete button which deletes the record from main table without asking question. In that case , refreshing multi-occ records correctly without changing the respective position could be a problem.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">learner</div><div class="date">13th March 2004, 09:15</div></div><div class="posttext">Hello,<br />
<br />
Ok, agreed that we cannot stop that message, but can we some how detect whether user selected Yes or No from that message box, after the message box came due to standard functionality.<br />
<br />
Regards<br />
<br />
Learner</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Hitesh Shah</div><div class="date">13th March 2004, 10:08</div></div><div class="posttext">Only if the user selects yes , it proceeds to the choice.mark.delete sections code (all subsections) . If user chooses 'no' , these choice.mark.delete sections are not at all executed.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">learner</div><div class="date">13th March 2004, 12:51</div></div><div class="posttext">Hi,<br />
<br />
Well i checked it as u said but it's not behaving like that.<br />
<br />
<br />
choice.mark.delete:<br />
before.choice:<br />
                       message(&quot;Before.choice&quot;)<br />
<br />
after.choice:<br />
                       message(&quot;After.choice&quot;)<br />
<br />
<br />
<br />
so once i click on the DELETE choice, it gives me :<br />
<br />
First message comes as &quot;Before.choice&quot;<br />
Second message comes as &quot;after.choice&quot;<br />
<br />
and Third standard message comes as &quot;Delete Record Yes/No &quot;<br />
<br />
which means these sub-sections executes without getting the Third message box i.e. standard message box<br />
<br />
any comments .... ???<br />
<br />
see basic requirement is when the executes the DELETE choice, he is presented with a yes/no message box, if he selects Yes , then only i want that the file should be deleted from the server.<br />
<br />
<br />
Regards<br />
<br />
Learner</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Hitesh Shah</div><div class="date">13th March 2004, 14:03</div></div><div class="posttext">In nutshell, standard delete message can not be stopped  or tracked . Now I recollect my earlier tests in this regard. Ur latest tests are right in this respect.</div></div><hr />



</div>
</body>
</html>