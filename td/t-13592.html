<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="Striping blank spaces in print expressions, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] Striping blank spaces in print expressions Tools Development" />
	
	<title>Striping blank spaces in print expressions [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="../index.html">Newbaanboard</a> &gt; <a href="../index.html">Baan Quick Support: Functional &amp; Technical</a> &gt; <a href="../index.html">Tools Development</a> &gt; Striping blank spaces in print expressions</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">pjohns</div><div class="date">12th November 2003, 14:38</div></div><div class="posttext">Hello,<br />
<br />
What is the correct syntax to use in print expressions when I want to strip white space (blanks).<br />
<br />
I've tried strip[report field] and strip$[report field] but these don't appear to work.<br />
<br />
Many thanks<br />
<br />
PJ</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Ilansu</div><div class="date">12th November 2003, 14:47</div></div><div class="posttext">Try strip$(shiftl$(field.name))<br />
<br />
Ilan</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pjohns</div><div class="date">12th November 2003, 15:03</div></div><div class="posttext">Hello again Ilan,<br />
<br />
Whenever I try to enter a strip$ etc I get the error box that says &quot;Field not defined as report input&quot;<br />
<br />
The field is defined in maintain report input fields. It's only when you try to add extra syntax into the print expression box you get this error.<br />
<br />
Rgds<br />
<br />
PJ</div></div><hr />


<div class="post"><div class="posttop"><div class="username">BaanForever</div><div class="date">12th November 2003, 15:18</div></div><div class="posttext">It's not error - it's warning.<br />
It work correct with this message.<br />
Example: double: amount = 10, gross.amount = 12.<br />
You can print gross.amount - amount.  ==&gt; 2 <br />
Message will appears, but it will work.<br />
As for string - you sould use aligments box to shift it left or right. Lenth is allways set up in lenth box. It will helps only when you want in 1 field print value of several strings. for exmpl.<br />
string a.str= &quot;   asd &quot;, b.str = &quot;  fre &quot;<br />
strip$(shiftl$(a.str)) &amp; &quot;/&quot; &amp; strip$(shiftl$(b.str))<br />
==&gt;  &quot;asd/fre&quot; in aligment and lenth as set up on form</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Ilansu</div><div class="date">12th November 2003, 15:27</div></div><div class="posttext">As BaanForever mentioned it's a warning<br />
<br />
if u want to avoide the warning then u should edit the report script.<br />
<br />
field.1:<br />
before.layout:<br />
      field=strip$(shiftl$(field))<br />
<br />
Ilan</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pjohns</div><div class="date">12th November 2003, 16:12</div></div><div class="posttext">Hello,<br />
<br />
Thanks for your input.<br />
<br />
I have made the changes to my print expression and have acknowledged the warning message. But when I print my layout I still get white space printed. Please see the attached detailing my report field set-up. I have tried with the 'Link with Domain' option on and off.<br />
<br />
I have no report script for this layout. Do I need one at this point? What I'm trying to do is generate a simple one line report that I can create a csv file from.<br />
<br />
Regards<br />
<br />
PJ</div></div><hr />


<div class="post"><div class="posttop"><div class="username">patvdv</div><div class="date">12th November 2003, 16:39</div></div><div class="posttext">GRRRR. 2 offenders in one day! One more time today and I will ban MS Word document formats from this forum :mad:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">BaanForever</div><div class="date">12th November 2003, 16:43</div></div><div class="posttext">Do U read what i write for U?<br />
Set aligment to &quot;Left&quot;. And there will be happyness.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">12th November 2003, 16:51</div></div><div class="posttext">PJ,<br />
<br />
I was just reading this post and I think I just realized what you were asking.  If you have a report field that takes 25 characters, then when you print that field there will be blanks at the front or the back of the field. That is all the shifts do when running to a CSV. I do not think there is a way to shrink the total line width - is that what you are trying to do?<br />
<br />
<br />
Mark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pjohns</div><div class="date">12th November 2003, 16:52</div></div><div class="posttext">Pat: - Sorry! :rolleyes: <br />
<br />
BaanForever: - I did read your suggestion and did set the alignment to Left but I found no happiness. (Sorry I forgot to attach the correct screen shot)<br />
<br />
What else can you suggest I try?<br />
<br />
Regards<br />
<br />
PJ</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pjohns</div><div class="date">12th November 2003, 16:58</div></div><div class="posttext">Mark,<br />
<br />
That is exactly what I am trying to achieve!<br />
<br />
If my report field is 25 characters long and the printed data is only 10 characters then I don't want to see 15 blank spaces. <br />
<br />
e.g. ,12345678910     (15 blank spaces)                    , should have an output of 12345678910,<br />
<br />
<br />
PJ</div></div><hr />


<div class="post"><div class="posttop"><div class="username">BaanForever</div><div class="date">12th November 2003, 17:10</div></div><div class="posttext">strangely. <br />
Set domain not tcbano, but some domain tcmcs.str15m(with left alig), set left aligment, and use strip$(shiftl$()). may be this will work.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">12th November 2003, 17:46</div></div><div class="posttext">Are you going to be using this CSV file with Excel? Or with another app.  You may want to run the report to disk first and then strip out spaces.<br />
<br />
Mark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pjohns</div><div class="date">12th November 2003, 17:51</div></div><div class="posttext">Mark,<br />
<br />
I'm trying to create a layout that will generate a payment file out of the cash management module of Baan Finance.<br />
<br />
The idea being that once the user has run through the process of maintaining a supplier payment the csv file will be created on the server somewhere which will then be swept up by a job which will transfer the file to the bank. I suppose I could write a unix script that will strip these spaces out but I would prefer to resolve this issue at time of file generation. Are you saying that I have no other option but to manipulate the file once it has been created?<br />
<br />
Regards<br />
<br />
PJ</div></div><hr />


<div class="post"><div class="posttop"><div class="username">BaanForever</div><div class="date">12th November 2003, 18:04</div></div><div class="posttext">In script(session or report by your preference) use another variable reoprt.tfcmg001.bano with domain of same lenth, but left aligment. in script use reoprt.tfcmg001.bano = strip$(shiftl$(tfcmg001.bano))<br />
and use in layout variable report.tfcmg001.bano<br />
<br />
This will work 100%.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pjohns</div><div class="date">12th November 2003, 18:33</div></div><div class="posttext">BaanForever,<br />
<br />
This did not work: -<br />
<br />
Extracts from the report script -<br />
<br />
declaration:<br />
		<br />
	domain tcmcs.str25	report.bano<br />
<br />
detail.1:<br />
before.layout:<br />
<br />
	report.bano = strip$(shiftl$(tfcmg001.bano))<br />
<br />
<br />
<br />
I changed my layout report field to use the report.bano variable, using domain tc.mcs.str25 and set it to Left allignment. The report compiled without error.<br />
<br />
This is proving to be a nightmare for such a small thing, I will have no hair left by the end of this! <br />
<br />
Any other ideas?<br />
<br />
Thanks<br />
<br />
PJ</div></div><hr />


<div class="post"><div class="posttop"><div class="username">BaanForever</div><div class="date">12th November 2003, 19:11</div></div><div class="posttext">You are trying to escape those spaces, wich follow after 10 digits. yes? I've just test this.<br />
Made report with only one field(Domain 30 simbols. Both aligment Left and Right). and print record where this field = &quot;     abcd      &quot; to the ASCII file. And there after the letter &quot;d&quot; is linebreak.<br />
If I set in report Left Alig, then i see only &quot;abcd&quot;,linebreak.<br />
Do you want this result or may be i missunderstood you?<br />
<br />
What Service Pack Tools do you have? If i right this may be matter.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">12th November 2003, 20:17</div></div><div class="posttext">PJ,<br />
<br />
Just had this thought.  Here is what I was thinking.  Lets say you had a report with 2 input fields - Work Center and project.  You passed both of these fields to the report.  Now when you did the detail layout you had XXX,XXXXXX and you data contained &quot;W&quot; for workcenter and &quot;BBBB&quot; for project and both are left justified.  When the report runs the detail would look like this &quot;W  ,BBBB  &quot;.  So to fix this you put a new field in the detail called some.layout and string of length 10.  Notice I include a spot for the comma.  Then in your report script in the detail section, before.layout you could do this:<br />
<br />
some.layout = strip$(workcenter) &amp; &quot;,&quot; &amp; strip$(project)<br />
<br />
Then when your report ran the detail would look like &quot;W,BBBB    &quot;.  This would put all spaces at the end of the line.  And if you wanted you could put a comma after the second field.  We actually do something like this in one report.  We check the device and then set the layout based on the device.  If the device is interface then we do not print headings and build the detail based on the filled fields - example 1 line could be X,,1 and the next could be X,Y,1. We could not have X, ,1 because the receiving program would try to process the space. <br />
<br />
Just a thought I had between all of my mind numbing meetings.<br />
<br />
Mark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">lbencic</div><div class="date">12th November 2003, 23:30</div></div><div class="posttext">You guys are in deep, and Mark may be on the right track with the csv's.  <br />
I just would add that don't try to shrink a table field.  Table fields are always declared as FIXED, so strip does not work the same, the length is fixed.  <br />
Not sure how that all translates to the report expression and then out to csv, but worth mentioning.  That may be why BaanForever is seeing some different results - maybe using variables that are not fixed.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ahulikavi</div><div class="date">13th November 2003, 05:22</div></div><div class="posttext">Hi PJ,<br />
try something like in report script<br />
<br />
declaration:<br />
long i<br />
<br />
detail.1:<br />
before.layout:<br />
<br />
i = len(shiftl$(strip$(field.name)))<br />
<br />
then in the layout say<br />
field.name(1;i)<br />
<br />
Also, for payments file we use session to generate ascii file directly using seq.open / close functions, you could also explore that option.<br />
<br />
regards,</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pjohns</div><div class="date">13th November 2003, 16:21</div></div><div class="posttext">Thanks for all your replies.<br />
<br />
As Lisa says we have gone deep. A bit deeper than I expected, it's starting to go beyond my humble knowledge!<br />
<br />
BaanForever: - Yes I am trying to 'escape' the spaces. We are on service pack 5 + lots of solutions.<br />
<br />
Mark: - I see where you are going with your solution but I have to create a file that has 70 or so fields. Which I think may start to get messy using your way, I could be wrong?<br />
<br />
Lisa: - I tried setting a variable and using this instead of a fixed table field but this too failed.<br />
<br />
Akshay: - I also tried your solution but again this did not work. But I am interested to hear about the session you use to make payment files. As you may have worked out I'm a novice when it comes to Baan development, any development really. Could you give me an example of your script? What tables do I need to consider for creating such a file? I imagine tfcmg101 - 103 and some tccom tables relative to supplier.<br />
<br />
I really appreciate all your help, if you were local I would buy you all a beer! It's certainly very frustrating for me not to get this working I'll just have to plod on.<br />
<br />
Just another question with regards to the same report layout. Should I need anymore than one detail layout for this to work. The reason I'm asking is when I run the CMG sessions to output a payment file the one line of detail gets duplicated.<br />
<br />
Kind regards<br />
<br />
PJ</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ahulikavi</div><div class="date">14th November 2003, 05:40</div></div><div class="posttext">Hi PJ,<br />
<br />
See below part of the code that generates payment file. Session asks for dates from user for which to generate the file.<br />
<br />
We use normal cheque payment method for this. After cheque is generated in baan, instead of printing it, a file is generated using this session. <br />
<br />
We have also modified cheque printing session so that same cheques is not sent to bank and printed too !!!. Two custom tables are added, <br />
one for keeping  a log of docs sent and one for storing valid instrument type by bank and payment method.<br />
<br />
<br />
|****************************** declaration section ***************************<br />
<br />
declaration:<br />
       <br />
	#pragma used dll ottdllbw<br />
<br />
	table	ttfcmg100	| Check Master<br />
	table	ttccom020	| Suppliers<br />
	table	ttfcmg103	| composed payments<br />
	table	ttfcmg101	| payment advise<br />
	table	ttfacp202	| one time suppliers addresses<br />
	table	ttdtcd760	| Sent Status<br />
	table	ttdtcd761	| Bank Trf Parameters<br />
<br />
	extern 	string  				figs(15)		<br />
	long							fp, ret, errorcd		<br />
	extern 	domain	tcmcs.str35 	name1, name2 <br />
	extern  	domain  	tcorno      		det  <br />
        extern  	domain	tcmcs.st65m     	error.msg<br />
	extern 	domain	tcmcs.str30 	add1, add2, add3, add4<br />
	extern 	domain	tcdate		date.f, date.t<br />
	extern	domain 	tcmcs.str3 		payment.type<br />
	extern	domain 	tcmcs.str10 	account.number<br />
	extern	domain 	tcmcs.str1 		delivery.method, print.chk<br />
	extern	domain 	tcmcs.str20 	pay.location<br />
<br />
	#define	WRITELN(...)	ret = seq.puts(..., fp)<br />
<br />
|****************************** form section **********************************<br />
<br />
form.1:<br />
init.form:<br />
	get.screen.defaults()<br />
|****************************** choice section ********************************<br />
<br />
choice.cont.process:<br />
on.choice:<br />
execute(print.data)<br />
<br />
choice.print.data:<br />
on.choice:<br />
	if rprt_open() then<br />
		create.cheque.ascii.file()<br />
		close.files()<br />
		rprt_close()<br />
	else<br />
		choice.again()<br />
	endif<br />
	<br />
|****************************** field section *********************************<br />
field.date.f:<br />
when.field.changes:<br />
	date.t = date.f<br />
|****************************** function section ******************************<br />
<br />
functions:<br />
<br />
function create.cheque.ascii.file()<br />
{<br />
	fp= SEQ.OPEN( &quot;citidirect.dat&quot;, &quot;wt&quot;)<br />
	if fp &lt; 1 then<br />
		message(&quot;ERROR OPENING FILE %s  %d&quot;,&quot;citidirect&quot;,fp)<br />
	endif<br />
<br />
	select	tfcmg103.*, tccom020.*<br />
	from	tfcmg103, tccom020<br />
	where	tfcmg103.plan inrange :date.f and :date.t	<br />
	and	tfcmg103.suno refers to tccom020<br />
	selectdo	<br />
		mess(&quot;Processing Document &quot;&amp;tfcmg103.ttyp&amp;&quot;-&quot;&amp;str$(tfcmg103.docn)&amp;&quot; ...&quot;,0)<br />
		if ok.to.process() then<br />
			if payment.type = &quot;CHK&quot; then<br />
				select	tfcmg100.*<br />
				from	tfcmg100<br />
				where   tfcmg100.typo = :tfcmg103.ttyp <br />
				and	tfcmg100.doco = :tfcmg103.docn<br />
				selectdo<br />
					get.supplier.details()		<br />
					print.cheque()<br />
					update.sent.status()	<br />
				endselect<br />
			else	<br />
				get.supplier.details()		<br />
				print.cheque()<br />
				update.sent.status()	<br />
			endif	<br />
		endif				<br />
	endselect<br />
}<br />
<br />
<br />
|****************************************************************************<br />
<br />
function print.cheque()<br />
{<br />
account.number = &quot;11234234&quot;<br />
figs = strip$(shiftl$(edit$(tfcmg100.amnt , &quot;ZZZZZZZZZZVD99&quot;)))|** tfcmg100.amnt without commas<br />
delivery.method = &quot;1&quot; |Delivery Method  - SEND TO CUSTOMER-3, SEND TO BENEFICIARY-1, HOLD FOR CUSTOMER-4, HOLD FOR BENEFICIARY -2,<br />
pay.location = &quot;CITIBA&quot;<br />
<br />
payment.type   = strip$(shiftl$(payment.type))<br />
account.number = strip$(shiftl$(account.number))<br />
pay.location   = strip$(shiftl$(pay.location))<br />
<br />
<br />
<br />
WRITELN(&quot;#IN#&quot;&amp;payment.type&amp;&quot;#&quot;&amp;strip$(shiftl$(tfcmg100.typo))&amp;&quot;/&quot;&amp;str$(tfcmg100.doco)&amp;&quot;#&quot;&amp;account.number&amp;&quot;#INR#&quot;&amp;sprintf$(&quot;%D(%02d%02m%04Y)&quot;, tfcmg103.plan)&amp;&quot;#&quot;&amp;figs&amp;&quot;#&quot;&amp;name1&amp;name2&amp;&quot;##&quot;&amp;delivery.method&amp;&quot;#&quot;&amp;pay.location&amp;&quot;#&quot;&amp;add1&amp;&quot;#&quot;&amp;add2&amp;&quot;#&quot;&amp;add3&amp;&quot;#&quot;&amp;add4&amp;&quot;#####CITI14#&quot;&amp;sprintf$(&quot;%D(%02d%02m%04Y)&quot;, date.num())&amp;&quot;#P###&quot;&amp;print.chk&amp;&quot;#&quot;&amp;strip$(shiftl$(str$(tfcmg100.cheq)))&amp;&quot;########&quot;)<br />
WRITELN(&quot;@&quot;)<br />
}<br />
|************************************************************************* <br />
<br />
<br />
function close.files()<br />
{<br />
	seq.close(fp)	<br />
	errorcd =  server2client(&quot;citidirect.dat&quot;, &quot;c:\citidirect.dat&quot;, false, false )<br />
}<br />
<br />
<br />
<br />
function get.supplier.details()<br />
{<br />
	if tccom020.sndr = tcyesno.yes then			|One time supplier<br />
		select tfacp202.* from tfacp202<br />
		where  tfacp202.ttyp = :tfcmg100.typo<br />
		and	tfacp202.ninv = :tfcmg100.doco<br />
		selectdo<br />
			name1 =  strip$(shiftl$(tfacp202.nama))<br />
			name2 =  strip$(shiftl$(tfacp202.namb))	<br />
			add1  =  strip$(shiftl$(tfacp202.namc))	<br />
			add2 =   strip$(shiftl$(tfacp202.namd))	<br />
			add3 =  strip$(shiftl$(tfacp202.name))	<br />
			add4 =  strip$(shiftl$(tfacp202.namf))	<br />
		endselect<br />
	else<br />
		name1 =  strip$(shiftl$(tccom020.nama))<br />
		name2 =  strip$(shiftl$(tccom020.namb))	<br />
		add1 =  strip$(shiftl$(tccom020.namc))	<br />
		add2 =  strip$(shiftl$(tccom020.namd))	<br />
		add3 =  strip$(shiftl$(tccom020.name))	<br />
		add4 =  strip$(shiftl$(tccom020.namf))			<br />
	endif<br />
}<br />
<br />
function long ok.to.process()<br />
{<br />
| OK to process if <br />
|	1. document from bank/payment method valid for citidirect<br />
|	2. Document Value less than Rs. 10,00,000<br />
|	3. Document Finalised<br />
|	4. Document Not sent previously<br />
|This Function will generate error report based on above conditions<br />
|<br />
<br />
det=0		|variable for printing detail layout in error report<br />
	select tdtcd761.*<br />
	from tdtcd761<br />
	where	tdtcd761._index1 = {:tfcmg103.bank, :tfcmg103.paym}<br />
	selectdo<br />
		payment.type = tdtcd761.inst		| tdtcd761.inst stores intrument type eg: CHK for cheque, DD for demand draft<br />
		if payment.type = &quot;CHK&quot; then<br />
			print.chk = &quot;Y&quot;<br />
		else<br />
			print.chk = &quot;&quot;<br />
		endif	<br />
	selectempty<br />
		mess(&quot;Document &quot;&amp;tfcmg103.ttyp&amp;&quot;-&quot;&amp;str$(tfcmg103.docn)&amp;&quot; not for CitiDirect !!!&quot;,0)<br />
		error.msg = &quot;Document not for CitiDirect !!!!&quot;<br />
		det = 2<br />
		rprt_send()<br />
		return(false)		<br />
	endselect<br />
<br />
	if tfcmg103.amth &gt; 1000000 then            | Above 10 lakhs not through this route<br />
		error.msg = &quot;Amount exceeds Rs. 10,00,000/- print manually !!!&quot;<br />
		det = 2<br />
		rprt_send()<br />
		return(false)<br />
	endif	<br />
	<br />
	select	tfgld106.*<br />
	from	tfgld106<br />
	where	tfgld106._index1 = {:tfcmg103.ttyp, :tfcmg103.docn}<br />
	selectdo<br />
		select 	tdtcd760.*<br />
		from	tdtcd760<br />
		where	tdtcd760._index1 = {:tfcmg103.ttyp, :tfcmg103.docn}<br />
		selectdo<br />
			mess(&quot;Document &quot;&amp;tfcmg103.ttyp&amp;&quot;-&quot;&amp;str$(tfcmg103.docn)&amp;&quot; already sent !!!&quot;,0)<br />
			det=1<br />
			rprt_send()<br />
			return(false)<br />
		selectempty<br />
			return(true)<br />
		endselect<br />
	selectempty<br />
		mess(&quot;Document &quot;&amp;tfcmg103.ttyp&amp;&quot;-&quot;&amp;str$(tfcmg103.docn)&amp;&quot; not finalised !!!&quot;,0)<br />
		error.msg = &quot;Document not finalised !!!!&quot;<br />
		det = 2<br />
		rprt_send()<br />
		return(false)<br />
	endselect<br />
return(false)	<br />
}<br />
<br />
function update.sent.status()<br />
{<br />
db.retry.point()<br />
db.set.to.default(ttdtcd760)<br />
	select 	tdtcd760.*<br />
	from	tdtcd760 for update<br />
	where	tdtcd760._index1 = {:tfcmg103.ttyp, :tfcmg103.docn}<br />
	selectdo<br />
		message(&quot;ERROR !!! Duplicate Document ???&quot;)<br />
	selectempty<br />
		tdtcd760.ttyp = tfcmg103.ttyp<br />
		tdtcd760.docn = tfcmg103.docn<br />
		tdtcd760.bank = tfcmg103.bank<br />
		tdtcd760.paym = tfcmg103.paym<br />
		if payment.type = &quot;CHK&quot; then<br />
			tdtcd760.cheq = tfcmg100.cheq<br />
		else	<br />
			tdtcd760.cheq = &quot;&quot;<br />
		endif	<br />
		tdtcd760.date = date.num()<br />
		tdtcd760.time = time.num()<br />
		tdtcd760.user = logname$<br />
		db.insert(ttdtcd760, DB.RETRY)	<br />
	endselect<br />
commit.transaction()	<br />
}<br />
<br />
<br />
hope you find this useful. Let me know if you have any suggestions.<br />
<br />
regards,</div></div><hr />


<div class="post"><div class="posttop"><div class="username">wimvg1</div><div class="date">20th November 2003, 13:27</div></div><div class="posttext">Hello John,<br />
<br />
You are trying to use the report editor for something it was not made for. You need to create a file. So in my opionion, the best you can do is to forget your report and create a file directly from your program script. You will have complete control over the way your file looks like and you will have no line length limitation. <br />
<br />
The commands to use are seq.open, seq.close, seq.puts.<br />
<br />
Best regards,<br />
<br />
Wim</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pjohns</div><div class="date">20th November 2003, 16:23</div></div><div class="posttext">Hi Wim,<br />
<br />
Thanks for your comments.<br />
<br />
I have now realised that this is the only way forward for me. <br />
<br />
Just one question with regards to creating this file.<br />
<br />
The file sometimes will have to have more than one line per record. This will be based on certain information within the supplier payment.  So if I look at the example below how do I force an additional line, per record, based on certain logic?<br />
<br />
e = seq.puts(str$(tssma310.orno) &amp; &quot;|&quot; &amp; strip$(tssma301.desc) &amp; &quot;|&quot; &amp; str$(tssma310.seqn) &amp; &quot;|&quot; &amp; tssma310.item &amp; &quot;|&quot; &amp; str$(tssma310.iqan) &amp; &quot;|&quot; &amp; odate, fp.log.file)<br />
<br />
<br />
Regards<br />
<br />
PJ</div></div><hr />


<div class="post"><div class="posttop"><div class="username">wimvg1</div><div class="date">20th November 2003, 16:39</div></div><div class="posttext">Hello PJ,<br />
<br />
You can just use normal program logic. Your program could look something like this :<br />
<br />
<br />
select *<br />
from tssma301<br />
where...<br />
selectdo<br />
         seq.puts....<br />
         if tssma300.cpay = ... then<br />
                 seq.puts....<br />
         endif<br />
endselect<br />
<br />
Best Regards,<br />
<br />
Wim</div></div><hr />



</div>
</body>
</html>