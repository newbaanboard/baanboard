<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="reading Comma Separated file, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] reading Comma Separated file Tools Development" />
	
	<title>reading Comma Separated file [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="../index.html">Newbaanboard</a> &gt; <a href="../index.html">Baan Quick Support: Functional &amp; Technical</a> &gt; <a href="../index.html">Tools Development</a> &gt; reading Comma Separated file</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">defjam90</div><div class="date">21st September 2008, 10:56</div></div><div class="posttext">I would like to read a comma seperated file .<br />
Here is a sample of the file<br />
Order No,Order Pos,Order Currency,PO Qty,Receipt Qty,Price<br />
200058,2,SGD,20,20,25.50000<br />
200519,4,USD,4,4,6.00000<br />
200632,2,USD,2,2,6.00000<br />
200669,1,USD,14,14,6.00000<br />
<br />
Each field is seperated by comma &amp; I would like to hold each of these in variables<br />
Ex Var a = 200058<br />
          b= SGD <br />
<br />
I can use  the function POS/RPOS to find out  the comma &amp; then read the string this is tedious process.<br />
<br />
Is there any other simple  way of reading the string.If so please provide the syntax.<br />
<br />
Thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">garima</div><div class="date">21st September 2008, 15:37</div></div><div class="posttext">Hi <br />
  You can use the string.scan and seq.gets function to read Comma separated file<br />
<br />
#define SCANS    &quot;%s,%s,%s,%s,%s	<br />
<br />
#define	FIELDS   fld1,fld2,fld3,fld4,fld5<br />
function	main()<br />
{<br />
long	fp<br />
string	a(12)<br />
string	b(12)<br />
string	buffer(80)<br />
fp = seq.open(&quot;filename&quot;, &quot;r&quot;)<br />
while not seq.gets(buffer, 1024, fp)<br />
        string.scan(buffer,SCANS,FIELDS)<br />
endwhile<br />
e = seq.close(fp)<br />
}</div></div><hr />


<div class="post"><div class="posttop"><div class="username">defjam90</div><div class="date">22nd September 2008, 04:19</div></div><div class="posttext">Thanks for the feed back.<br />
I am getting a compile  error with this function <br />
string.scan(msg.str,SCANS,FIELDS)<br />
<br />
Based on your systax how does the system know that &quot;,&quot; is the seperator.<br />
<br />
<br />
Thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">vinceco252</div><div class="date">22nd September 2008, 05:29</div></div><div class="posttext">In the example, &quot;%s,%s,%s,%s,%s&quot;, it knows that the comma is the delimeter because there are commas between the arguments &quot;%s&quot;.  So if you used &quot;%s|%s|%s|%s|%s&quot; it would expect you to pass a statement using &quot;|&quot; as the separator...<br />
<br />
Vince</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bdittmar</div><div class="date">22nd September 2008, 14:01</div></div><div class="posttext">I would like to read a comma seperated file .<br />
Here is a sample of the file<br />
Order No,Order Pos,Order Currency,PO Qty,Receipt Qty,Price<br />
200058,2,SGD,20,20,25.50000<br />
200519,4,USD,4,4,6.00000<br />
200632,2,USD,2,2,6.00000<br />
200669,1,USD,14,14,6.00000<br />
<br />
Each field is seperated by comma &amp; I would like to hold each of these in variables<br />
Ex Var a = 200058<br />
          b= SGD <br />
<br />
I can use  the function POS/RPOS to find out  the comma &amp; then read the string this is tedious process.<br />
<br />
Is there any other simple  way of reading the string.If so please provide the syntax.<br />
<br />
Thanks<br />
<br />
Hello,<br />
<br />
your fields are long,long,string,double,double,double<br />
<br />
so your scan should be:<br />
<br />
%d,%d,%s,%f,%f,%f<br />
<br />
Regards</div></div><hr />



</div>
</body>
</html>