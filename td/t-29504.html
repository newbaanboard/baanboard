<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="api.mode not declared - in report script, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] api.mode not declared - in report script Tools Development" />
	
	<title>api.mode not declared - in report script [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="../index.html">Newbaanboard</a> &gt; <a href="../index.html">Baan Quick Support: Functional &amp; Technical</a> &gt; <a href="../index.html">Tools Development</a> &gt; api.mode not declared - in report script</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">Andy..</div><div class="date">4th January 2007, 16:28</div></div><div class="posttext">I have added api.mode into a report script, but it won't compile.  Error is:<br />
api.mode not declared<br />
<br />
Another thread suggested adding : #pragma used dll &quot;ottstpapihand&quot;<br />
but that hasn't worked.  Looking in std session program scripts it looks like that variable should be available as standard.  Has anyone done this within a report script?<br />
<br />
Thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Chematrix</div><div class="date">4th January 2007, 16:49</div></div><div class="posttext">In 4GL scripts, the predefined variable api.mode is present to know whether<br />
the session is started by the AFS. If different behavior is needed for sessions<br />
that run in API-mode and sessions with a normal user-interface, this variable<br />
must be used.<br />
If the variable api.mode is used in a DLL, it must be declared in the dll as<br />
extern long otherwise it will cause compile errors.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">4th January 2007, 16:58</div></div><div class="posttext">No - but I did have to declare it in a dll.<br />
<br />
	extern	domain	tcbool		api.mode<br />
<br />
As Chematrix recommended you probably just need to declare as external.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Andy..</div><div class="date">4th January 2007, 17:41</div></div><div class="posttext">thanks for your swift reply - the problem I have here is trying to use api.mode within a report script.  It doesn't compile if I just add 'api.mode' into the code.<br />
<br />
I just tried adding the declaration mentioned above which obviously gets around the report compilation problem - however the variable remains unset when in api mode!  So I still can't see from the report script code whether it is being run through std session or API :(</div></div><hr />


<div class="post"><div class="posttop"><div class="username">george7a</div><div class="date">4th January 2007, 18:12</div></div><div class="posttext">Hi,<br />
<br />
Try to import api.mode variable using the import function:<br />
http://www.baanboard.com/programmers_manual_baanerp_help_functions_variables_interprocess_transfer_import<br />
<br />
- George</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Chematrix</div><div class="date">4th January 2007, 18:22</div></div><div class="posttext">Transfer the api.mode to the report like parameter..</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Hitesh Shah</div><div class="date">6th January 2007, 16:43</div></div><div class="posttext">As api.mode is a static para , u may transfer the same by using the import statement rather than as an input variable . This will also work in before.program of report and will remain there throughout the report run .</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Andy..</div><div class="date">10th January 2007, 18:44</div></div><div class="posttext">import function worked a treat - thanks guys :)</div></div><hr />



</div>
</body>
</html>