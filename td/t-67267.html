<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="Delete record through AFS Baan5c, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] Delete record through AFS Baan5c Tools Development" />
	
	<title>Delete record through AFS Baan5c [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="../index.html">Newbaanboard</a> &gt; <a href="../index.html">Baan Quick Support: Functional &amp; Technical</a> &gt; <a href="../index.html">Tools Development</a> &gt; Delete record through AFS Baan5c</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">bpanda</div><div class="date">19th January 2015, 11:17</div></div><div class="posttext">Hello,<br />
<br />
I want to delete record from Routing Operations (tirou1502m000) session (type 3).<br />
I am able to find the record by using browse.set and after stpapi.mark() I am able to get the required values.<br />
But when I use stpapi.delete() then it removes the 1st occurence record not the marked one.<br />
<br />
Please share your comments.<br />
<br />
Thanks in advance<br />
<br />
Best Regards,<br />
Biswajyoti Panda</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bhushanchanda</div><div class="date">19th January 2015, 12:08</div></div><div class="posttext">Hi,<br />
<br />
Can you put your code here? That would help to identify the exact cause. <br />
<br />
Just a quick question, have are you following the sequence - put fields, do a find, mark and then delete? Do not do a browse.set; instead of that try with stpapi.find() and check if its working.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">19th January 2015, 19:33</div></div><div class="posttext">I can't remember which session it was - but on one of mine I had to find the record to get the current record &quot;marked&quot;.  I ended up doing it almost like  Bhushan has mentioned. I had to use stpapi browse function to find it, store off the fields - then I had to do a find to get the exact record marked.  Stpapi.mark did not work on the session, but a find with all of the fields now worked.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bpanda</div><div class="date">20th January 2015, 07:46</div></div><div class="posttext">Hello Bhusan,<br />
<br />
Please find the used code attached here.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bpanda</div><div class="date">20th January 2015, 08:41</div></div><div class="posttext">Hi,<br />
<br />
This issue solved.<br />
There was a silly mistake in the code, for operation I was using &quot;tirou102.opro&quot; instead of &quot;tirou102.opno&quot; in find option.<br />
<br />
But if after stpapi.mark() we use stpapi.get() and it returns correct value then why stpapi.delete() deletes the 1st occurence record not the marked record?<br />
<br />
Thanks &amp; Regards<br />
Biswajyoti Panda</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bhushanchanda</div><div class="date">20th January 2015, 09:04</div></div><div class="posttext">Hi,<br />
<br />
Good to know that you got it working. As you were not actually putting the value in right field, mark was not working. You were passing the value to the session and stpapi.get will get the values what you put. May be the assigning was done based on the sequence of values passed.<br />
<br />
E.g. if you have 2 records,<br />
<br />
Number Pos<br />
XYZ 10<br />
ABC 10<br />
<br />
If you were putting ABC correct and position into wrong field, stpapi.get() will get the default value for that i.e. 10<br />
<br />
I guess this is what happened in your case.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">vh3baan</div><div class="date">6th February 2015, 09:33</div></div><div class="posttext">Try using stpapi.find()</div></div><hr />



</div>
</body>
</html>