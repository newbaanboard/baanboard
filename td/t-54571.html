<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="Questions about 3GL/4GL, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] Questions about 3GL/4GL Tools Development" />
	
	<title>Questions about 3GL/4GL [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="../index.html">Newbaanboard</a> &gt; <a href="../index.html">Baan Quick Support: Functional &amp; Technical</a> &gt; <a href="../index.html">Tools Development</a> &gt; Questions about 3GL/4GL</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">drezzzz</div><div class="date">19th December 2008, 15:26</div></div><div class="posttext">Hi there,<br />
I kinda get to the conclusion that programming in 3GL is the only way to get the result I wanted. I then search a lot on the forum to understand some core point about the language but some question stays unresolved or ambiguous like :<br />
- Is 3GL a compiled only language, I hear &quot;script&quot; everywhere ?<br />
- Where can I get a kickoff documentation ?<br />
<br />
Thank you again for your time,<br />
Fred</div></div><hr />


<div class="post"><div class="posttop"><div class="username">george7a</div><div class="date">19th December 2008, 16:13</div></div><div class="posttext">Hi,<br />
<br />
- AFAIK, 3GL will work in all languages. However, some functions won't work with webtop/ThinERP<br />
- In this site you have the BaanERP Programmer's Manual (http://www.baanboard.com/programmers_manual_baanerp). 3GL includes a lot of topics. If you need any specific question, feel free to ask ;)<br />
<br />
- George</div></div><hr />


<div class="post"><div class="posttop"><div class="username">drezzzz</div><div class="date">19th December 2008, 16:36</div></div><div class="posttext">Hi george7a,<br />
I want to find a way to make a script which will run from a unix shell and will query the Baan database and produce an exported file. This is my main motivation in learning 3GL.<br />
<br />
I figure out that I could be able to do that with 3GL.<br />
So where to begin ... I looked at the all the overview in &quot;BaanERP Programmer's Manual&quot; and checked out some function. I gather a small code from the forum to be my first step  :<br />
<br />
|* First program script - zmadmtest<br />
extern  long    ret.val<br />
function        main()<br />
{<br />
long    procid<br />
procid = activate(&quot;ozmadmnp&quot;, &quot;Hello&quot;, &quot;World&quot;, &quot;Testing&quot;)<br />
message(&quot;Procid=%d&quot;, procid)<br />
import(&quot;ret.val&quot;, ret.val)<br />
message(&quot;Return value=%d&quot;, ret.val)<br />
exit(0)<br />
}<br />
<br />
<br />
Now, what do I have to do with it, to make it execute by ba ?<br />
I tryed compile with bic, it seems to have compiled... then I had no idea what it produce... lol<br />
<br />
Still lost in concepts I think.<br />
Thank you,<br />
Fred</div></div><hr />


<div class="post"><div class="posttop"><div class="username">drezzzz</div><div class="date">19th December 2008, 18:16</div></div><div class="posttext">I think I figured out some things while reading post. <br />
<br />
It seems that I could :<br />
- write a file containing 3GL script<br />
- compile it with &quot;&gt; bic6.0 -l ./my3GLscript -o ./myCompiledObject&quot;<br />
- (I am not sure but I tried anyway) Setting some environments variables like : USER, BSE and BSE_TMP<br />
- then run my code using &quot;&gt; ba6.0 ./myCompiledObject&quot;<br />
<br />
Problem is, I got a &quot;Segmentation fault(coredump)&quot; when running the code...<br />
The code used is the same.<br />
<br />
Can somebody helps with the newbs I am ?<br />
<br />
Thank in advance,<br />
Fred</div></div><hr />


<div class="post"><div class="posttop"><div class="username">NPRao</div><div class="date">19th December 2008, 20:48</div></div><div class="posttext">Fred,<br />
<br />
It looks like my example code. Here is the correct thread with that code and also the other replies where I gave the link to the command line execution.<br />
<br />
3GL parameter and return (http://www.baanboard.com/baanboard/showthread.php?t=9316&amp;highlight=ba6.1)<br />
<br />
It seems that I could :<br />
- write a file containing 3GL script<br />
- compile it with &quot;&gt; bic6.0 -l ./my3GLscript -o ./myCompiledObject&quot;<br />
- (I am not sure but I tried anyway) Setting some environments variables like : USER, BSE and BSE_TMP<br />
- then run my code using &quot;&gt; ba6.0 ./myCompiledObject&quot;<br />
Instead of writing command line programs, go to the Program Scripts (ttadv2530m000) and create your 3-GL and compile from there. The command line options requires you to set all the environment variables, paths etc correctly.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">drezzzz</div><div class="date">23rd December 2008, 14:29</div></div><div class="posttext">Thanks NPRao for the hint,<br />
I figure out the way to compile but still have some troubles.<br />
<br />
I successfully compile and run this example code :<br />
|********************************************************<br />
|* Run this from the Baan shell<br />
|* By Stark Springs, 18th June 2002<br />
|********************************************************<br />
function main()<br />
{<br />
    long wnd,i<br />
<br />
    wnd=new.window(22, 80, 1, 1)<br />
    scroll(wnd)<br />
    for i=99 to 1 step -1<br />
        print i, &quot; bottle(s) of beer on the wall,&quot;, cr$(), lf$()<br />
        print i, &quot; bottle(s) of beer.&quot;, cr$(), lf$()<br />
        print i-1, &quot; bottle(s) of beer on the wall.&quot;, cr$(), lf$(2)<br />
        refresh(wnd)<br />
    endfor<br />
    message(&quot;&quot;)<br />
}<br />
<br />
Which is a good start for a beginner.<br />
This morning I come back and get a message when running the script :<br />
&quot;Error: no permission for test.3 or is not defined to runtime&quot;<br />
<br />
Does someone knows something about that ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">raikar_raviraj</div><div class="date">23rd December 2008, 20:11</div></div><div class="posttext">the best way to test the 3gl program is to add the compiled object in BMS Mask, check mark the on boot option...<br />
Login to Baan, and the object will get executed.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">NPRao</div><div class="date">23rd December 2008, 22:09</div></div><div class="posttext">I kinda get to the conclusion that programming in 3GL is the only way to get the result I wanted.<br />
Fred,<br />
<br />
You need to clearly specify what are you trying to do? Instead of trying to build a 3-GL screen and event handling you can easily design the Session and use the standard program's event handling.<br />
I tested your 3-gl code and it worked for me.<br />
This morning I come back and get a message when running the script :<br />
&quot;Error: no permission for test.3 or is not defined to runtime&quot;<br />
Refer to my note:<br />
<br />
It seems that I could :<br />
- write a file containing 3GL script<br />
- compile it with &quot;&gt; bic6.0 -l ./my3GLscript -o ./myCompiledObject&quot;<br />
- (I am not sure but I tried anyway) Setting some environments variables like : USER, BSE and BSE_TMP<br />
- then run my code using &quot;&gt; ba6.0 ./myCompiledObject&quot;<br />
Instead of writing command line programs, go to the Program Scripts (ttadv2530m000) and create your 3-GL and compile from there. The command line options requires you to set all the environment variables, paths etc correctly.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">drezzzz</div><div class="date">23rd December 2008, 22:25</div></div><div class="posttext">I don't really help since I don't understand... I know that I don't have any checkbox at the Baan boot ...<br />
What is a BMS Mask ?<br />
<br />
Sorry for my lack of understanding ... I really appreciate your help !</div></div><hr />


<div class="post"><div class="posttop"><div class="username">drezzzz</div><div class="date">23rd December 2008, 22:35</div></div><div class="posttext">Sorry NPRao, I don't have access to Program Scripts session ...<br />
<br />
What I am trying to do, clearly, is to be able to gather data from the ISAM database. Since I didn't find any way to do it, I figured out, reading all the post here, that a 3GL script should get the job done.<br />
<br />
So here I am, trying to understand the 3GL and even more, the way to execute it.<br />
<br />
I feel like I am near since I wrote a file, compile it, and see the result yesterday, the bottle of beers thing. But I didn't get the same results this morning, with this message : &quot;Error: no permission for test.3 or is not defined to runtime&quot;<br />
<br />
So I am stock again ...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Hitesh Shah</div><div class="date">30th December 2008, 11:46</div></div><div class="posttext">There are many ways to get the data from ISAM  database .<br />
<br />
1. USe the olesql functions in ttdllsql_query in olesql scripting languages .<br />
2. Write a generic 4 GL  program (very complex ) to extract data from any table  as pre-defined criteria , schedule it in Baan job management and write to file the way u want. Writing 3GL  program is not necessary .<br />
3. Use qptool6.1  for the same . Check qptool on this forum for more information .</div></div><hr />


<div class="post"><div class="posttop"><div class="username">shah_bs</div><div class="date">30th December 2008, 12:27</div></div><div class="posttext">Sorry NPRao, I don't have access to Program Scripts session ... <br />
<br />
<br />
Looks like you have a problem here --- if you do not have access to the development tools, then you need to get them established by having your BAAN Administrator set up the developer's authorizations for you. BAAN Tools development environment is so powerful, it seems strange you are struggling like this. Maybe you can even request an introduction programming course. [Still I admire the progress you have made.] Cannot help much more right now, since I am away from my BAAN access for a few days. Maybe catch with this later.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">30th December 2008, 16:01</div></div><div class="posttext">Does mk have exchange schemes available?  Exchange schemes can be used to export data - I am not sure they need a developers license.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">drezzzz</div><div class="date">5th January 2009, 20:19</div></div><div class="posttext">Two related questions :<br />
1. Does anyone have the documentation for qptool6.1 ?<br />
<br />
2. Is there a SQL only way to use the INSERT and UPDATE command ?<br />
As I read, I only see 4GL scripts that update or insert ... No direct SQL call.<br />
<br />
I would like to use qptool to update fields.<br />
<br />
Thank you guys,<br />
Fred<br />
<br />
PS.<br />
<br />
mark_h : sorry really don't know<br />
<br />
shah_bs: Thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Hitesh Shah</div><div class="date">6th January 2009, 05:39</div></div><div class="posttext">1. Here is what qptool help is .<br />
<br />
Usage : qptool script_with_query<br />
   or : qptool [options]<br />
   options: -c compnr<br />
            -q query<br />
            -a actions<br />
                  p: parse query<br />
                  e: execute query<br />
                  f&lt;nr&gt;: fetch &lt;nr&gt; rows from query, '*' is all rows<br />
                  b: break query<br />
                  c: close query<br />
                  t: commit<br />
                  a: abort<br />
                  d&lt;nr&gt;: set rds_full to &lt;nr&gt;<br />
                  s: save retry point<br />
                  r: retry query<br />
                  m: get sql error message<br />
                  n&lt;nr&gt;: set default company number to &lt;nr&gt;<br />
                  o&lt;nr&gt;: set query timeout to &lt;nr&gt;<br />
                  Default actions 'pef*bc'<br />
            -p parse mode<br />
            -f script_with_queries<br />
               Format: [ '@'&lt;actions&gt; ] &lt;query&gt; [ ';' [ '@'&lt;actions&gt; ] &lt;query&gt; .<br />
.. ]<br />
            -r load references<br />
            -o output file for query result<br />
            -b size of rds full<br />
            -t set global query timeout<br />
<br />
2. There are many ways to insert/update records ( viz exchange,import , embedded SQL , dynamic SQL , OLE scripting , db.* functions using db.bind etc ). This board is replete with umpteen illustrations on almost all . If u elaborate ur  query with specific needs anyone in this forum will help u .</div></div><hr />


<div class="post"><div class="posttop"><div class="username">drezzzz</div><div class="date">6th January 2009, 21:05</div></div><div class="posttext">Thank you Hitesh Shah,<br />
<br />
I tried to be generic in my questions since I discover the possibilities as we discuss. I tried to find the most efficient way to access read/write the Bisam DB, outside of the mk interface. It seems that the better solution for me for gathering data is 'qptool', yet. But I didn't succeed with any INSERT/UPDATE. The parser call for unexpected insert. I conclude that 'qptool' can not be use to insert/update ... right?<br />
<br />
It seems to me that the better solution to insert/update is to use the db.* function which I understand is 4GL ...? Which is usable with 'qptool' via the -f parameter (I feel stupid...)...?<br />
<br />
I didn't succeed to use the -a options, don't know why, someone as an example use ?<br />
<br />
Thanks again, again,<br />
Fred</div></div><hr />



</div>
</body>
</html>