<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="Needs help in Program Script, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] Needs help in Program Script Tools Development" />
	
	<title>Needs help in Program Script [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="../index.html">Newbaanboard</a> &gt; <a href="../index.html">Baan Quick Support: Functional &amp; Technical</a> &gt; <a href="../index.html">Tools Development</a> &gt; Needs help in Program Script</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">mnmhema</div><div class="date">23rd April 2012, 09:56</div></div><div class="posttext">I am using the following query in my Program Script. While running the session, if I enter values for citt.f and citt.t as 1 and 2 respectively or 2 and 2, the session returns results to the report. But if I write 1 and 1, the session runs as an infinite loop. What is wrong in this query?<br />
<br />
select  tibom010.*,  tcibd001.kitm:sitm.kitm, tcibd001.dsca:sitm.dsca,<br />
                            tcibd001.eitm:sitm.eitm, tcibd001.umer:sitm.umer,<br />
                            tcibd001.cuni:sitm.cuni, tcibd001.txta:sitm.txta<br />
,tcibd004.*,tccom100.*, tiedm010.*, tdipu001.*<br />
                    from    tibom010, tcibd001, tcibd004, tccom100, tiedm010, tdipu001<br />
                    where   tibom010._index1 &gt; {:tibom010.mitm, :tibom010.pono,                                         :tibom010.seqn}<br />
                    and     tibom010.sitm refers to tcibd001<br />
and  tibom010.sitm = tcibd004.item <br />
and  tibom010.sitm refers to tiedm010.eitm<br />
and tccom100.bpid = tcibd004.bpid<br />
and tcibd004.bpid  = tdipu001.otbp<br />
and tcibd004._index1 between { :citt.f } and { :citt.t }</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bdittmar</div><div class="date">23rd April 2012, 10:27</div></div><div class="posttext">I am using the following query in my Program Script. While running the session, if I enter values for citt.f and citt.t as 1 and 2 respectively or 2 and 2, the session returns results to the report. But if I write 1 and 1, the session runs as an infinite loop. What is wrong in this query?<br />
<br />
select  tibom010.*,  tcibd001.kitm:sitm.kitm, tcibd001.dsca:sitm.dsca,<br />
                            tcibd001.eitm:sitm.eitm, tcibd001.umer:sitm.umer,<br />
                            tcibd001.cuni:sitm.cuni, tcibd001.txta:sitm.txta<br />
,tcibd004.*,tccom100.*, tiedm010.*, tdipu001.*<br />
                    from    tibom010, tcibd001, tcibd004, tccom100, tiedm010, tdipu001<br />
                    where   tibom010._index1 &gt; {:tibom010.mitm, :tibom010.pono,                                         :tibom010.seqn}<br />
                    and     tibom010.sitm refers to tcibd001<br />
and  tibom010.sitm = tcibd004.item <br />
and  tibom010.sitm refers to tiedm010.eitm<br />
and tccom100.bpid = tcibd004.bpid<br />
and tcibd004.bpid  = tdipu001.otbp<br />
and tcibd004._index1 between { :citt.f } and { :citt.t }<br />
<br />
<br />
Hello,<br />
<br />
your profile says B4, the tables are LN, so update your profile, please.<br />
<br />
tcibd004._index1 is citt, bpid, item<br />
<br />
so try:<br />
<br />
inrange {:citt.f, :businespartner, :item}<br />
and {:citt.t, :businespartner, :item}<br />
<br />
e.g.<br />
<br />
inrange {:citt.f , :tccom100.bpid, :tibom010.sitm}<br />
and {:citt.t, :tccom100.bpid, :tibom010.sitm}<br />
<br />
Regards</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mnmhema</div><div class="date">23rd April 2012, 11:00</div></div><div class="posttext">Hi bdittmar<br />
Thanks for your reply.<br />
<br />
If I check as if you have said, the report has has only one tibom010.sitm and there is no data for tcibd004.aitc, tdipu001.otbp, tiedm010.eigp and tcibd004.citt<br />
I am also checking in the query as<br />
tcibd004.bpid  = tdipu001.otbp<br />
where can I add this?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bdittmar</div><div class="date">23rd April 2012, 11:20</div></div><div class="posttext">Hi bdittmar<br />
Thanks for your reply.<br />
<br />
If I check as if you have said, the report has has only one tibom010.sitm and there is no data for tcibd004.aitc, tdipu001.otbp, tiedm010.eigp and tcibd004.citt<br />
I am also checking in the query as<br />
tcibd004.bpid  = tdipu001.otbp<br />
where can I add this?<br />
<br />
Hello,<br />
<br />
it has been an example !<br />
Based on what you want to achive, you have to built your query.<br />
<br />
.... {:citt.f, :tdipu001.otbp .......<br />
<br />
<br />
If you need more and detailed help, describe your .<br />
<br />
Regards</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mnmhema</div><div class="date">23rd April 2012, 12:40</div></div><div class="posttext">Hi bdittmar<br />
I need to display tibom010.sitm, sitm.revi, sitm.dsca, tccom100.bpid,tccom100.nama,tcibd004.aitc, tdipu001.otbp, tiedm010.eigp and tcibd004.citt when the user enters a range for mitm and citt. <br />
Actually I  got my job recently and I am completely new to Baan. The person who has worked before has created a session and I need to remove some fields and add some new fields in the program script <br />
Can you help me with this?<br />
Thanks.<br />
BR<br />
mnmhema</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">23rd April 2012, 16:03</div></div><div class="posttext">Based off your original post and what bernd is saying I think your query should look like:<br />
<br />
select tibom010.*, tcibd001.kitm:sitm.kitm, tcibd001.dsca:sitm.dsca,<br />
tcibd001.eitm:sitm.eitm, tcibd001.umer:sitm.umer,<br />
tcibd001.cuni:sitm.cuni, tcibd001.txta:sitm.txta<br />
,tcibd004.*,tccom100.*, tiedm010.*, tdipu001.*<br />
from tibom010, tcibd001, tcibd004, tccom100, tiedm010, tdipu001<br />
where tibom010._index1 &gt; {:tibom010.mitm, :tibom010.pono, :tibom010.seqn}<br />
and tibom010.sitm refers to tcibd001<br />
and tibom010.sitm = tcibd004.item <br />
and tibom010.sitm refers to tiedm010.eitm<br />
and tccom100.bpid = tcibd004.bpid<br />
and tcibd004.bpid = tdipu001.otbp<br />
and tcibd004._index1 inrange {:citt.f, tdipu001.otbp, tibom010.sitm} and<br />
 {:citt.t, tdipu001.otbp, tibom010.sitm}<br />
<br />
<br />
When working with queries like this it is sometimes best to add one table at a time to make sure they are correct.  Then when it does something like a cartesian product you can tell it is the last table you selected.  If you notice I did not put a : on some of the fields for the example.  That little : can cause some interesting problems at times.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mnmhema</div><div class="date">23rd April 2012, 16:41</div></div><div class="posttext">Hi Mark<br />
When I enter 1 and 1 for citt.f and citt.t respectively with your query, I get an endless loop. I need to end Baan in the Task Manager. There is no record for citt= 1 in the table.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">23rd April 2012, 17:39</div></div><div class="posttext">Does the query run, not work, but just run to completion if you pull out this part of the querey - tcibd004._index1 inrange {:citt.f, tdipu001.otbp, tibom010.sitm} and<br />
 {:citt.t, tdipu001.otbp, tibom010.sitm}?<br />
<br />
If it does then you know the problem is this line, if it still has an issue - then work your way backwards removing one table at a time.  Or you can start the query from scratch adding one piece at a time.  It will help you see what is happening at can look at the data that is returned and how long it takes.  <br />
<br />
There are two possible reasons for it not returning - 1 is a cartesian product and 2 is just a poor query that returns so many rows you just have to wait.   For example - this statement in the query where tibom010._index1 &gt; {:tibom010.mitm, :tibom010.pono, :tibom010.seqn} will return one heck of a lot of data. It is too tough to visualize what you are trying to do and I do not know your data.  When I see that line I think of exploding the BOM and it would have &quot;as set with 1 rows&quot; in it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">BaanInOhio</div><div class="date">23rd April 2012, 19:55</div></div><div class="posttext">I see a few issues with the original SQL statement.  If you are rather new to Baan programming, it is best to break the SQL statement into separate queries/if statements until you get the desired result.  Then, you can start to consolidate the statements back into a single one.  That would have identified a few issues in your query:<br />
<br />
You are asking for 'tdipu001' data yet you never select anything from the table.  You should always try to have the same reference in 'select', 'from', and at least one line in 'where'.  If you have a table in 'where' that isn't in 'from', you will encounter a full table read (all records) on that table for every record that is read from other tables.  You are fortunate if you leave something out and get a compile error.  Much harder to identify when the compile works but the execution doesn't.<br />
<br />
I also try to keep the fields in 'select' as simple as possible.  If you aren't going to use the field, remove it from the 'select' clause.  If you remove everything for that table and don't need it to test a condition, remove it from the 'from' clause.<br />
<br />
I would start by writing a select statement for tibom010 (only), then start putting select statements for the other tables within its selectdo.  This will force you to think about how to define the relationships between the tables and will omit those that are not needed.  Once it runs, you can consolidate the selects to the parent select statement using '=' or 'refers to'.  I have been doing Baan programming for 15 years and will break up/reconstruct SQL statements when they get complicated.  I will often leave statements as separate SQL structures instead of trying to do all in one to make it easier for the folks that have to maintain the code to understand what is happening.  It also removes doubt about how the portingset builds complex queries for the database.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mnmhema</div><div class="date">25th April 2012, 09:39</div></div><div class="posttext">I've attached the program script file. It will be a great help, if anyone will correct it according to my need.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">26th April 2012, 01:41</div></div><div class="posttext">My recommendation is to restore the original code.  Then run it continually in debug mode until you understand the flow and how it works with the original code.<br />
<br />
Next after becoming familiar with the original code decide where you need this new code. Start building it there. You have this code all over the place and I am not sure if it is needed or not.  So decide where this code needs to code?  Is on the next line, next make item, top level, etc.  If it is just to do more reporting I would create a subquery in the loop for just the tables needed.  Something that would not impact the flow of exploding the bom.<br />
<br />
If not reporting then decide if it is actually something to restrict the records that get pulled - again determine at what level - top level, make, line.  Then build it in slowly(one table at a time) - continuing to run it in debug mode.  Then you can see what is actually causing it to take so long.<br />
<br />
A BOM explosion program is not something easy to start with - so run it until you understand the stack tracking, how it gets next line, next build item, how it knows when to decrease a level, etc.  This is not something you want to just throw at a beginner.  I will not attempt to modify the code because I do not know your systems, your data or even what you are trying to accomplish.  It is not something that is easy to accomplish through the board.</div></div><hr />



</div>
</body>
</html>