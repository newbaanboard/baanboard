<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="Filename of File sent through cmf email is not coming as expected, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] Filename of File sent through cmf email is not coming as expected Tools Development" />
	
	<title>Filename of File sent through cmf email is not coming as expected [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="../index.html">Newbaanboard</a> &gt; <a href="../index.html">Baan Quick Support: Functional &amp; Technical</a> &gt; <a href="../index.html">Tools Development</a> &gt; Filename of File sent through cmf email is not coming as expected</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">Ajesh</div><div class="date">1st November 2018, 20:21</div></div><div class="posttext">Hello there<br />
<br />
I was just trying out File attachment sent through cmf email feature. I am getting the file attached, but the attachment name is coming as the same as the subject of the Email, <br />
<br />
<br />
        attachment.ID = cmf.createAttachment(message.ID)<br />
        ret = cmf.setAttachmentBody(attachment.ID,ttyeno.no)<br />
        ret = cmf.setAttachmentMIME(attachment.ID,&quot;text/plain&quot;)<br />
	ret = cmf.setAttachmentFileName(attachment.ID,filename)<br />
<br />
<br />
I am using the Microsoft EMail facility.<br />
<br />
I am creating the file like, Filetext.txt but the File is coming as &lt;SubjectName&gt;.eml <br />
<br />
Any Clues?<br />
<br />
Regards<br />
Ajesh</div></div><hr />


<div class="post"><div class="posttop"><div class="username">oirfeodent</div><div class="date">2nd November 2018, 09:06</div></div><div class="posttext">Hello there<br />
<br />
I was just trying out File attachment sent through cmf email feature. I am getting the file attached, but the attachment name is coming as the same as the subject of the Email, <br />
<br />
<br />
        attachment.ID = cmf.createAttachment(message.ID)<br />
        ret = cmf.setAttachmentBody(attachment.ID,ttyeno.no)<br />
        ret = cmf.setAttachmentMIME(attachment.ID,&quot;text/plain&quot;)<br />
	ret = cmf.setAttachmentFileName(attachment.ID,filename)<br />
<br />
<br />
I am using the Microsoft EMail facility.<br />
<br />
I am creating the file like, Filetext.txt but the File is coming as &lt;SubjectName&gt;.eml <br />
<br />
Any Clues?<br />
<br />
Regards<br />
Ajesh<br />
<br />
The help says <br />
<br />
function long cmf.setattachmentfilename  (long attachment, string filename [, string displayname])<br />
<br />
<br />
Can you try adding the third parameter?<br />
<br />
Regards,</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Ajesh</div><div class="date">2nd November 2018, 15:48</div></div><div class="posttext">Tried that.. But no effect. Its coming as same.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">NPRao</div><div class="date">29th October 2019, 21:56</div></div><div class="posttext">Ajesh,<br />
<br />
Post your complete code for others to help out. It is working for me.<br />
Also refer to the example program - <br />
eMessage Connector examples (http://www.baanboard.com/programmers_manual_baanerp_help_emessage_connector_examples)<br />
<br />
         ret = cmf.setSubject(message.ID, &quot;Sample CMF Message&quot;)<br />
        ret = cmf.setAttachmentFileName(attachment.ID,sourcefile,  &quot;Sample Attachment&quot;)</div></div><hr />



</div>
</body>
</html>