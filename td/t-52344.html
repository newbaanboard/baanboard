<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="The trouble with function mb.import$(), baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] The trouble with function mb.import$() Tools Development" />
	
	<title>The trouble with function mb.import$() [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="../index.html">Newbaanboard</a> &gt; <a href="../index.html">Baan Quick Support: Functional &amp; Technical</a> &gt; <a href="../index.html">Tools Development</a> &gt; The trouble with function mb.import$()</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">assassinator</div><div class="date">26th May 2008, 10:52</div></div><div class="posttext">Now I want to print Item Text in report. And Item Text maybe include Chinese. So I write the code as following:<br />
<br />
txta.num = text.to.buf(&quot;txtn.ptr&quot;,language$,50,text.buf)<br />
    for i = buf.line to txta.num<br />
        txta.str = text.buf(1,i)<br />
        mb.import$(txta.str,txta.str)<br />
<br />
<br />
This would call a trouble. Now the Item Text is &quot;POLARIZER-ASN-3245RTP5700\45&quot;. After executed &quot;mb.import$(txta.str,txta.str)&quot;, the Item Text has changed to &quot;POLARIZER-ASN-3245RTP5700-&quot;. <br />
<br />
I thought function mb.import$() would change the value &quot;\45&quot; to ASCII Code. Because the character &quot;-&quot; corresponding to the digital 45. <br />
<br />
How terrible! What is the right way to solve this problem simply.<br />
(Item Text would include Chinese or &quot;\&quot;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">zardoz</div><div class="date">26th May 2008, 16:55</div></div><div class="posttext">text.buf is declared as mb string array?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">assassinator</div><div class="date">27th May 2008, 08:38</div></div><div class="posttext">text.buf is declared as mb string array?<br />
<br />
No, I declared it as string only.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">zardoz</div><div class="date">27th May 2008, 16:47</div></div><div class="posttext">Try to declare it mb then :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">assassinator</div><div class="date">28th May 2008, 04:44</div></div><div class="posttext">Try to declare it mb then :)<br />
<br />
Oh, I have done as you said. But it can't solve the problem completely. <br />
<br />
    I defined text.buf and text.str as domain Multi byte string. It would be work to the first line. And the first line must include characters and digital only, not for chinese. At second line and the following the characters, digital and chinese all display error. <br />
<br />
    Like: Item Text is &quot;POLARIZER-ASN-3245RTP5700\AA&quot; then display &quot;POLARIZER-ASN-3245RTP5700AA&quot;. The character '\&quot; would nonprinting. If the following character &quot;\&quot; is a digital, it would change to ASCII Code also. Text &quot;POLARIZER-ASN-3245RTP5700\45&quot; would display &quot;POLARIZER-ASN-3245RTP5700-&quot;.<br />
    So only change variable's domain would not in effect.</div></div><hr />



</div>
</body>
</html>