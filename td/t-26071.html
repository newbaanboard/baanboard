<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="switch.to.company() in report script, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] switch.to.company() in report script Tools Development" />
	
	<title>switch.to.company() in report script [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="../index.html">Newbaanboard</a> &gt; <a href="../index.html">Baan Quick Support: Functional &amp; Technical</a> &gt; <a href="../index.html">Tools Development</a> &gt; switch.to.company() in report script</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">spartacus</div><div class="date">12th January 2006, 13:11</div></div><div class="posttext">We habe a starnge behavior with &quot;switch.to.company()&quot;.<br />
<br />
The strange thing is: if we switch in program-script to another company erverything went fine, if wo try the same switch from the report-script, of the same session, we get an error &quot;-2&quot; (no permission). This problem doesn't occur, if the user is a superuser.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">SanttuP</div><div class="date">13th January 2006, 20:49</div></div><div class="posttext">Why would you switch company in a report script? I do not know exactly what you are after but I would assume that in report you would achieve the same result by quering company specific table by adding tablename._compnr = xxx to your where clause.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Rita Kotecha</div><div class="date">1st February 2006, 13:33</div></div><div class="posttext">Hi<br />
<br />
Please read the help, it may help you<br />
Syntax<br />
long switch.to.company( long new_compnr ) <br />
Description<br />
This switches to another company and sets the read-only variable COMPNR to the specified company number. It performs several checks before switching company and switches company only if the checks are successful. For example, it checks if the user is authorized to change to the new company, it checks if the package combination corresponds with the new company number, and it checks if the old and new companies have the same first day of the week.<br />
<br />
Notes<br />
compnr.check() and switch.to.company() perform similar functions, but switch.to.company() performs additional checks. So switch.to.company() makes heavier demands on system resources.<br />
<br />
Be aware that when there is a switch to another company, the user's first day of the week does not change, even if the new company has a different first day of the week. switch.to.company() returns an error value if the old and new companies have different first days of the week. compnr.check() does not.<br />
<br />
Super users are authorized for all company numbers. They always have authority to switch to a different company number. In addition, super users can also use the data dictionary to authorize other users for particular company numbers.<br />
<br />
Return values<br />
1 Success. <br />
 <br />
-1 Company not available.<br />
 <br />
-2 No permission to change to this company.<br />
 <br />
-3 Package combination does not correspond with new company number.<br />
 <br />
-4 First day of the week does not correspond to first day of the week of original company.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mr_suleyman</div><div class="date">1st February 2006, 14:50</div></div><div class="posttext">Control Maintain by Company Authorizations by USER (ttaad2121m000) .<br />
<br />
Good Luck !</div></div><hr />



</div>
</body>
</html>