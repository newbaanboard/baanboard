<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="Getting Login Name From Novell Client, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] Getting Login Name From Novell Client Tools Development" />
	
	<title>Getting Login Name From Novell Client [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="../index.html">Newbaanboard</a> &gt; <a href="../index.html">Baan Quick Support: Functional &amp; Technical</a> &gt; <a href="../index.html">Tools Development</a> &gt; Getting Login Name From Novell Client</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">Ilansu</div><div class="date">24th February 2002, 12:58</div></div><div class="posttext">Hello all<br />
<br />
Im new in this forum and this is my first thread .<br />
 <br />
Im using a Novell NetWare on my PC and I need to get the Novell Login Name.<br />
Any one know how  ?<br />
<br />
Thanks in advance<br />
<br />
Ilan</div></div><hr />


<div class="post"><div class="posttop"><div class="username">alejandro</div><div class="date">24th February 2002, 13:35</div></div><div class="posttext">Here I attach you code in Visual Basic that uses Api Novell.<br />
<br />
I'm not sure if it works for every Novell version.<br />
For me it works in Client Version 3.1.0.0<br />
<br />
In the web it is not easy to find information, at least for me. In this code you have commentaries about web links.<br />
<br />
If you do not use VB, you can insert the whole code in Excel, and it will work too.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Ilansu</div><div class="date">24th February 2002, 16:51</div></div><div class="posttext">Thanks for the quick response <br />
<br />
I need to do it in a number of clients .<br />
I'm using Baan 4 C4 .<br />
<br />
Can I do it without using a third party ?<br />
<br />
Ilan</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">25th February 2002, 02:57</div></div><div class="posttext">Welcome to the forum!!!  This one is much better than the other forum you posted in. :) I check there once in a blue moon.<br />
<br />
Does logname$ not work on a Baan Novell server? I am not real clear if the server is Novell Netware or the client, or both?<br />
<br />
If not, is there a netware command that you can run that gets you the info you want?  If so then in Baan you can write a routine that calls the Novell Netware command.  You could run app_start (sorry I can not remember the format), trap the output, then read it back in all using Baan commands.  There are some samples in the code and utilities forum the include the app_start command.<br />
<br />
Also I wonder if there is an environment variable that has the userid in it and if you can use the same commands in Baan that you use to get Unix variables.<br />
<br />
Mark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">25th February 2002, 19:08</div></div><div class="posttext">Found this on the knowledge quest CD.<br />
<br />
NAME getenv$ - function for retrieving environment variables<br />
SYNOPSIS string     GETENV$( string env_var(256) )<br />
DESCRIPTION The function GETENV$ returns the value of the specified environment variable of the operating system. If the specified variable is not available an empty string (&quot;&quot;) is returned.<br />
Example:<br />
string name(15)<br />
name = getenv$(&quot;LOGNAME&quot;)<br />
<br />
So it looks like if you have an environment variable with the user id you could get it using the getenv command.  I know it works on our UNIX server, but I am not sure about a Novell server.<br />
<br />
Mark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">alejandro</div><div class="date">25th February 2002, 19:45</div></div><div class="posttext">Mark,<br />
<br />
I think Ilansu sholud tell us a little bit information about his needs.<br />
We use Novell too, but only like file server.<br />
<br />
We use BaaN in Unix. Unix's lognames are different than Novell's ones. I think Novell is not for use with BaaN. When I make remotes connections to BaaN, I do not connect to Novell. (Poor transfer speed)<br />
<br />
In previous Novell versions (MS-DOS) there was a command 'whoami' that returned you the logname.<br />
<br />
In windows this command did not work. So I found the VB code attached before. In the example the return value comes with a message box. I use it with BaaN with an app_start, the value returned is written in a file (within the VB code), and from BaaN I read it with seq.open.local to take this value.<br />
<br />
I think getenv$, will return him only UNIX variables, because if they use Novell, I do not beleive they use NT.<br />
<br />
Hope Ilansu will tell us?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Ilansu</div><div class="date">27th February 2002, 14:41</div></div><div class="posttext">Alejandro &amp; Mark<br />
<br />
Thanks for the VB code it works fine. (Im putting the name in a file and read it from three).<br />
Ill try to explain my problem.<br />
We use Baan on Unix and we also have Novell NetWare installed.<br />
The Baan User name is different then the Novell Client User name and what Im trying to do is to get the <br />
Novell User name.<br />
Logname$ &amp; getenv$() give me the Baan User name but the VB code you posted gives the Novell User Name.<br />
My question is can get it without using VB ? Only from Baan script.<br />
<br />
I hope that I explained my need.<br />
<br />
Ilan S</div></div><hr />


<div class="post"><div class="posttop"><div class="username">alejandro</div><div class="date">27th February 2002, 15:47</div></div><div class="posttext">Well,<br />
<br />
The only way I can Imagine to solve your problem is to make direct calls from BaaN to Windws API functions.<br />
<br />
If anybody knows if this is possible, I want to know how too.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">27th February 2002, 16:29</div></div><div class="posttext">On our clients we have an environment variable called IDNAME and USERID, both are the same. To get one of these you could do it all with Baan coding, but it is not pretty. It would look something like this:<br />
<br />
(1) Create tmp file<br />
(2) put in dos command to get variable - example:<br />
    echo %IDNAME%&gt;c:\baan\tmp\idname.txt<br />
(3) Download file to client as a .bat file<br />
(4) Use app start to run the .bat file<br />
(5) Use the seq.open.local to open file on the client<br />
(6) Use seq.read.local to read the file.<br />
<br />
This would work, but there has got to be a better way.  My appologies for such an ugly solution, but it is the best I can come up with on the spur of the moment.<br />
<br />
Good Luck!<br />
<br />
Mark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Ilansu</div><div class="date">27th February 2002, 17:34</div></div><div class="posttext">Mark Hi<br />
<br />
I tried the %IDNAME% and the %USERID% and its not working for me however<br />
I did something different with batch file.<br />
<br />
1) Create a *.bat file containing the command : set&gt;c:\baan\username.txt<br />
2) This file creates a list of parameters from the windows set table.<br />
3) With the seq.open.local and seq.gets.local I search for the key word USER=<br />
4) This line gives me the User name<br />
<br />
Not the nieces solution but it works<br />
<br />
Thanks for the help<br />
<br />
Ilan S</div></div><hr />



</div>
</body>
</html>