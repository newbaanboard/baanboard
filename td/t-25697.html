<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="Add new record at the beginnig of a file, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] Add new record at the beginnig of a file Tools Development" />
	
	<title>Add new record at the beginnig of a file [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="../index.html">Newbaanboard</a> &gt; <a href="../index.html">Baan Quick Support: Functional &amp; Technical</a> &gt; <a href="../index.html">Tools Development</a> &gt; Add new record at the beginnig of a file</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">monica1</div><div class="date">22nd November 2005, 18:31</div></div><div class="posttext">I need to write a text file and at the end of the program I need to write the first line of the file. Is it possible?<br />
<br />
I try with this:<br />
<br />
......all the code<br />
<br />
fp = seq.open(bse.tmp.dir$()&amp;strip$(tfecm007.paths) &amp;&quot;/&quot;&amp; nombre.fichero,&quot;a&quot;, ruta)<br />
<br />
w = seq.seek(0, 0, fp)<br />
<br />
for w=1 to 150 step 1<br />
    seq.putc$(linea.csbbk(w;1),fp)<br />
endfor<br />
seq.putc$(chr$(13),fp)<br />
seq.putc$(chr$(10),fp)<br />
<br />
seq.close(fp)<br />
<br />
<br />
<br />
How can I do that?<br />
<br />
Thank you in advance,</div></div><hr />


<div class="post"><div class="posttop"><div class="username">lbencic</div><div class="date">22nd November 2005, 18:35</div></div><div class="posttext">You can try opening with &quot;w&quot; instead of &quot;a&quot;.  This will allow you to write at your given seq.seek position, but I'm not sure if it over writes or pushes everything down.  Give a try and let us know.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">monica1</div><div class="date">22nd November 2005, 19:05</div></div><div class="posttext">I try with this but the rest of the lines dissapear.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">lbencic</div><div class="date">22nd November 2005, 19:09</div></div><div class="posttext">I was afraid of that.<br />
<br />
You may try using seq.write instead of seq.putc...?<br />
<br />
If that still does not work, you may have to make a 2nd file, if even temporarily.  Put your line in the temp file, then read and add all the other lines from the original file.  Close both, move around and rename if you need to then. <br />
<br />
Maybe someone else has a better idea.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">NPRao</div><div class="date">23rd November 2005, 01:16</div></div><div class="posttext">Refer to the thread -<br />
<br />
Unable to append a string at start of the file (http://www.baanboard.com/baanboard/showthread.php?t=10432&amp;highlight=seq.seek)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">monica1</div><div class="date">23rd November 2005, 12:29</div></div><div class="posttext">Thank you very much.<br />
Finally I use the 2 files option.</div></div><hr />



</div>
</body>
</html>