<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="dir.open(), baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] dir.open() Tools Development" />
	
	<title>dir.open() [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="../index.html">Newbaanboard</a> &gt; <a href="../index.html">Baan Quick Support: Functional &amp; Technical</a> &gt; <a href="../index.html">Tools Development</a> &gt; dir.open()</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">Arlina</div><div class="date">25th April 2019, 13:26</div></div><div class="posttext">Hi<br />
<br />
Does dir.open() open directory from local machine or server?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">eduardourra</div><div class="date">25th April 2019, 13:30</div></div><div class="posttext">Hi,<br />
<br />
dir.open() work on server side</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Arlina</div><div class="date">25th April 2019, 13:35</div></div><div class="posttext">If i want to open local folder, is there any function available?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">25th April 2019, 16:29</div></div><div class="posttext">Not that I am aware.  Search on dir.open and look at the threads.  The older ones talk about executing commands to move the folders to the baan server.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bdittmar</div><div class="date">25th April 2019, 20:30</div></div><div class="posttext">Hi<br />
Does dir.open() open directory from local machine or server?<br />
Client file access overview:<br />
<br />
Client file access overview<br />
Use these functions to perform various operations on client files and other client operations â€“ for example:<br />
<br />
to open, read, write to, close, and delete files on a client<br />
to show a file open or directory chooser dialog on a client<br />
to transfer files between client and server<br />
to retrieve client file information<br />
to create and delete directories on a client<br />
to start an application on a client<br />
to retrieve client hostname and IP address<br />
to show a color selection dialog on a client<br />
Note <br />
You can use most of these functions both with the Baan Windows and with the Webtop client. However, some functions are only supported for the Baan Windows client and therefore deprecated.<br />
<br />
<br />
Client file access synopsis<br />
<br />
long<br />
 client2server() ( string source, string dest, boolean text.mode [, boolean rm.file] [, boolean progress.window] ) <br />
<br />
long<br />
 create.local.directory() ( string dirent ) <br />
<br />
long<br />
 create.local.file() ( string filename ) <br />
<br />
long<br />
 dir.select.dialog.local() ( ref string dirent ) <br />
<br />
long<br />
 get.client.hostname() ( ref string hostname ) <br />
<br />
long<br />
 get.client.ip.address() ( ref string ip.address ) <br />
<br />
string<br />
 get.local.filename() ( ) <br />
<br />
long<br />
 remove.local.directory() ( string dirent ) <br />
<br />
void<br />
 remove.local.file() ( string filename ) <br />
<br />
long<br />
 seq.fstat.local() ( string filename, ref long nr.bytes ) <br />
<br />
long<br />
 seq.open.dialog.local() ( const string defaultname, const string directory, const string filter, ref string filename ) <br />
<br />
boolean<br />
 seq.open.dialog.next() ( ref string filename ) <br />
<br />
long<br />
 seq.saveas.dialog.local() ( const string defaultname, const string directory, const string filter, ref string filename) <br />
<br />
long<br />
 server2client() ( string source, string dest, boolean text.mode [, boolean progress.window] [, boolean read.only] ) <br />
<br />
long<br />
 start.application.local() ( const string commandline, boolean waitFlag, reference long exitCode, [const string verb] ) <br />
<br />
void<br />
 color.dialog() ( reference long io.color ) <br />
 <br />
Deprecated functions<br />
long<br />
 app_start() ( string commandline, string directory, string stdin, string stdout, string stderr ) <br />
<br />
long<br />
 app_status() ( long app.id ) <br />
<br />
void<br />
 seq.close.local() ( long lfn ) <br />
<br />
long<br />
 seq.open.local() ( string filename, string mode(2) [, long remove.after.use] ) <br />
<br />
long<br />
 seq.read.local() ( ref string buf, ref long size, long lfn ) <br />
<br />
<br />
or sec.local functions<br />
<br />
seq.open.local()<br />
Syntax:<br />
<br />
function long seq.open.local  (string filename, string mode(2) [, long remove.after.use])<br />
<br />
Description<br />
<br />
Deprecated. This function is only supported for Baan Windows and its usage is therefore deprecated. Instead you should use functions: server2client() or client2server().<br />
<br />
This opens a specified file on the client system. It returns a file pointer, which you can use to identify the file in subsequent operations.<br />
<br />
Arguments<br />
<br />
string filename The name of the file that must be opened. If you do not specify a path name, the file is searched for in the directory where BW is loaded.<br />
 <br />
string mode(2) The mode in which the file must be opened. This can be one of the following options:<br />
<br />
&quot;r&quot; Open for reading.<br />
<br />
w&quot; Create for writing.<br />
<br />
&quot;a&quot; Open for writing at end of file, or create for writing.<br />
<br />
In addition, you can add &quot;t&quot; to any of the above options if you want the file to be opened in text mode.<br />
 <br />
[long remove.after.use ] Use this optional argument to specify whether or not the file must be removed after it has been closed by seq.close.local():<br />
<br />
&lt;&gt;0 file is removed<br />
0 file is not removed<br />
 <br />
Return values<br />
<br />
&gt;=0 Success. File pointer is returned. <br />
&lt;0 Error. File could not be opened. <br />
 <br />
Context<br />
<br />
This function can be used in all script types.<br />
<br />
Note <br />
You cannot use Client file access overview functions in combination with the seq.*.local() functions. So, you cannot use seq.seek() or seq.rewind(), for example, on a file that was opened with seq.open.local().<br />
<br />
Example<br />
seq.open.local(&quot;C:\Program Files\Test.txt&quot;, &quot;rt&quot;, false)<br />
<br />
<br />
Regards</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Arlina</div><div class="date">26th April 2019, 06:43</div></div><div class="posttext">I came across these functions. But I need functions which can handle local folder the way dir.open() is doing with server, without opening an dialog box as I need these functions for automation.<br />
<br />
We have files in local folder.<br />
Currently user selects Sales Quotation from overview session, click on Attachment button on the session, answers &quot;File Linking&quot; on the following question, then session dmdoc4540m002 appears.User than fills the details and browse file from the local folder and upload it.<br />
<br />
We need to automate it now and run it through job.<br />
The issues I am facing is<br />
How to get file from local folder path (eg.C:\upload\&lt;Quotation No&gt;\) and use it in stpapi.put.field( &quot;dmdoc4540m002&quot;, &quot;filename&quot;, &quot;file_from_local_folder&quot;)?As I am not getting any function like dir.open() for local folder<br />
<br />
Any suggestions?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">26th April 2019, 14:45</div></div><div class="posttext">If you know the directory is c:\upload\&lt;quotation no&gt; here is what I would do.  As part of the automation I would either have the user to give me the quotation number.  Then I would use seq.open.local on the file name to make sure the file exists - if not I would generate an error or give the user a message.  After opening the file I would close it with seq.close.local.  If it existed I would then use client2server to move the file to some place on the baan servers.<br />
<br />
<br />
function domain tcbool open_file()<br />
{<br />
	long rc<br />
| Create temporary file to copy the PC file to<br />
	temp.file = creat.tmp.file$(bse.tmp.dir$())<br />
        temp.file = strip$(temp.file)<br />
<br />
| Open PC file to make sure it exists.<br />
        inputfile = seq.open.local(input.file,&quot;r&quot;,0)<br />
        if(inputfile&lt;0) then<br />
		file_err(inputfile)<br />
		return(true)<br />
        endif<br />
	seq.close.local(inputfile)<br />
	rc = client2server(input.file,temp.file,0)<br />
<br />
| Open Server file for processing.<br />
        inputfile = seq.open(temp.file,&quot;r&quot;)<br />
        if(inputfile&lt;0) then<br />
		file_err(inputfile)<br />
		return(true)<br />
        endif<br />
	return(false)<br />
}<br />
<br />
<br />
Now if when you run you need the file names, then what you could do is run a dos command, put the c:\upload\ files names into a txt file.  Upload and read the file on the server.  I think I saw something like that when I searched on dir.open.  Let me see if I can find it again. Here is one such thread http://www.baanboard.com/baanboard/showthread.php?t=9091&amp;highlight=dir.entry.<br />
<br />
The api code is completely different - never done any kind of attachments with a function server of any sort.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Arlina</div><div class="date">28th April 2019, 10:44</div></div><div class="posttext">What we require is to run the automation without user intervention (as a job probably).<br />
The program needs to find all the subfolders(named as per sales quotation no.) in C:\upload\<br />
For available quotation no. it would run AFS of Sales Quotation Overview and handle File linking session as subprocess to upload the file with path C:\upload\&lt;Quotation no.&gt;\&lt;filename&gt;<br />
Basically I need the local path of each file, not to open the file but to put it as an input in File Linking session.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Arlina</div><div class="date">2nd May 2019, 10:23</div></div><div class="posttext">Thanks all.<br />
Finally what I used is<br />
path.client= &quot;C:\temp\ODM\&quot;<br />
cm = app_start(&quot;cmd.exe /C &quot; &amp;<br />
			&quot;dir /AD /B /ON /S &quot;&amp;strip$(path.client)&amp; <br />
			&quot; &gt;&quot; &amp; strip$(listd.f),<br />
			&quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;)<br />
			suspend(1000) |to list of folders' path<br />
<br />
|move  listd.f to server using client2server()<br />
.<br />
.<br />
.<br />
			<br />
cm1 = app_start(&quot;cmd.exe /C &quot; &amp;<br />
					&quot;dir /b /a-d &quot;&amp;strip$(path.client1)&amp; <br />
					&quot; &gt;&quot; &amp; strip$(listf.f),<br />
					&quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;)  |path.client1 from listd.f <br />
|list of files within the folder<br />
|move  listf.f to server using client2server()</div></div><hr />


<div class="post"><div class="posttop"><div class="username">NPRao</div><div class="date">9th October 2019, 20:41</div></div><div class="posttext">I came across these functions. But I need functions which can handle local folder the way dir.open() is doing with server, without opening an dialog box as I need these functions for automation.<br />
<br />
We have files in local folder.<br />
Currently user selects Sales Quotation from overview session, click on Attachment button on the session, answers &quot;File Linking&quot; on the following question, then session dmdoc4540m002 appears.User than fills the details and browse file from the local folder and upload it.<br />
<br />
We need to automate it now and run it through job.<br />
The issues I am facing is<br />
How to get file from local folder path (eg.C:\upload\&lt;Quotation No&gt;\) and use it in stpapi.put.field( &quot;dmdoc4540m002&quot;, &quot;filename&quot;, &quot;file_from_local_folder&quot;)?As I am not getting any function like dir.open() for local folder<br />
Refer to the latest Programmer's Manual -<br />
<br />
seq.open.dialog.local()<br />
Syntax:<br />
#include &lt;bic_desktop&gt;<br />
<br />
function long seq.open.dialog.local  (boolean mselect, string defaultname, string directory, string filter, ref string filename)<br />
<br />
Description<br />
<br />
Deprecated. This shows the Windows file-open dialog, to allow the user to select one or more local files. <br />
<br />
<br />
Arguments<br />
boolean mselect When true, multiple select is allowed by the user else only one file can be selected by the user. <br />
 <br />
string defaultname The default filename shown in the file-open dialog. <br />
 <br />
string directory The startup directory for this dialog. In case of an empty string the &quot;My Documents&quot; directory will be the default. This parameter may include the string ${BSE_TMP} which indicates the ${BSE}\tmp directory in case of Baan Windows or Windows temp directory in case of WebUI. <br />
 <br />
string filter This argument specifies all possible file extensions for the file. The string must contain pairs of strings that are separated by a &quot;|&quot; character. The first string in each pair is a filter name (for example: &quot;Text Files&quot;). The second string must be a filter patern (for example: &quot;*.txt&quot;). Multiple filter patters can be specified by separating the filter patterns with a semicolon. Example: &quot;All Files(*.*)|*.*|Text Files(*.txt) Word documents(*.doc)|*.txt;*.doc&quot; <br />
 <br />
ref string filename Output argument which will contain the full path of the file selected by the user. In case mselect is true possible other selected file names can be retrieved using function seq.open.dialog.next()<br />
 <br />
 <br />
Return values<br />
&gt;0 Number of files selected by the user. <br />
0 File open dialog canceled by the user. <br />
-1 Error occurred <br />
 <br />
Context<br />
This function is implemented in the 4GL Engine and can be used in all script types. <br />
<br />
This function is marked as 'untrusted' and can therefore only be used in trusted objects. More about trusted and not trusted objects can be found in the section about managed execution.. <br />
<br />
Notes<br />
This function is not supported in LN UI. See the Implementing LN UI support for more information.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">NPRao</div><div class="date">9th October 2019, 20:47</div></div><div class="posttext">Also refer to these threads for the select.file() usage -<br />
<br />
http://www.baanboard.com/baanboard/showthread.php?t=1844&amp;highlight=select.file<br />
<br />
 How can I copy a file from the server to a certain path  (http://www.baanboard.com/baanboard/showthread.php?t=10603&amp;highlight=otgbrg0019)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ren_bsi</div><div class="date">4th July 2020, 12:24</div></div><div class="posttext">Refer to the latest Programmer's Manual -<br />
<br />
Dear NPRao,<br />
<br />
Sorry for asking this ridiculous question since i'm still newbie in LN programming.<br />
What is the meaning of &quot;ref&quot; in ref string filename ?<br />
Why don't we add another &quot;ref&quot; before string directory, string filter ? :confused:<br />
function long seq.open.dialog.local (boolean mselect, string defaultname, string directory, string filter, ref string filename)<br />
<br />
Thank you :)<br />
<br />
Best regards,<br />
ren_bsi</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DDPatel</div><div class="date">4th July 2020, 13:38</div></div><div class="posttext">Hiiii @ren_bsi<br />
<br />
<br />
ref is use for return the reference value via function.<br />
<br />
I show you one example for better understanding.<br />
<br />
Example<br />
You have item code and you are calling item description from ref variable.<br />
<br />
<br />
domain tcdsca	ret.dsca<br />
<br />
<br />
|Function call<br />
item.description (tdpur401.item ,ret.dsca) | tdpur401.item is I/P field and ret.dsca is O/P field<br />
<br />
|Functions definition <br />
Function item.description(	  domain tcibd001 fn.item,<br />
						  ref domain tcdsca	fnr.dsca)<br />
{<br />
	select tcibd001.dsca:fnr.dsca<br />
	from tcibd001<br />
	where tcibd001.item = :fn.item<br />
	selectdo<br />
	endselect<br />
}<br />
<br />
I hope your doubt will be cleared for &quot;ref&quot;...<br />
<br />
Regard,<br />
DDPatel</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ren_bsi</div><div class="date">8th July 2020, 04:18</div></div><div class="posttext">Hiiii @ren_bsi<br />
<br />
<br />
ref is use for return the reference value via function.<br />
<br />
I show you one example for better understanding.<br />
<br />
Example<br />
You have item code and you are calling item description from ref variable.<br />
<br />
<br />
domain tcdsca	ret.dsca<br />
<br />
<br />
|Function call<br />
item.description (tdpur401.item ,ret.dsca) | tdpur401.item is I/P field and ret.dsca is O/P field<br />
<br />
|Functions definition <br />
Function item.description(	  domain tcibd001 fn.item,<br />
						  ref domain tcdsca	fnr.dsca)<br />
{<br />
	select tcibd001.dsca:fnr.dsca<br />
	from tcibd001<br />
	where tcibd001.item = :fn.item<br />
	selectdo<br />
	endselect<br />
}<br />
<br />
I hope your doubt will be cleared for &quot;ref&quot;...<br />
<br />
Regard,<br />
DDPatel<br />
<br />
<br />
Dear DDPatel,<br />
<br />
Thank you so much for your kind explanation :)<br />
<br />
Best regards,<br />
ren_bsi</div></div><hr />



</div>
</body>
</html>