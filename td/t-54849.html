<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="Spool.close keeps busy in WebTop, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] Spool.close keeps busy in WebTop Tools Development" />
	
	<title>Spool.close keeps busy in WebTop [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="../index.html">Newbaanboard</a> &gt; <a href="../index.html">Baan Quick Support: Functional &amp; Technical</a> &gt; <a href="../index.html">Tools Development</a> &gt; Spool.close keeps busy in WebTop</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">d.schingenga</div><div class="date">22nd January 2009, 16:51</div></div><div class="posttext">We use the Infor Webtop for our clients. I made a report for orderconfirmation, which will be printed three times (nr.copy variable). We now need a report that will print this confirmation just one time.<br />
<br />
I copied the first report and added the following code in the first before layout:<br />
<br />
if nr.copy &lt;&gt; 0<br />
then<br />
   spool.close()<br />
   end()<br />
endif<br />
<br />
In BaanIV this works fine, even with the Infor Worktop this works fine. However when using with the webtop, it is executed but the execution will not stop. The indicator at the top right keeps moving. The only way to get out this is to close the webbrowser.<br />
<br />
What can be the reason for this? And how to solve this of is there a easy way to stop the report after 1 copy is printed?<br />
<br />
Thanks inadvance,<br />
<br />
Dirk</div></div><hr />


<div class="post"><div class="posttop"><div class="username">NvpBaaN</div><div class="date">26th January 2009, 00:15</div></div><div class="posttext">At the time when you issue the spool.close() command, how many spoolers are open?  If there are multiple, you may need to specify the spooler that you want to close, by assigning the spooler ID to spool.id before spool.close().<br />
If that doesn't work, maybe you can try using some other way to return control to the script instead of end()...there are still some open issues with WebTop and some commands donot work in WebTop the way they work in Worktop.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Mario</div><div class="date">2nd February 2011, 13:29</div></div><div class="posttext">Is there a solution yet for this problem? In a reportscript I do a spool.close, after I found the contact email address I want to fill it as output file in the device. Works perfect in bw but not in webtop. Also when I reuse the print.id it does not help. <br />
(ERPLN fp6) .</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Mario</div><div class="date">2nd February 2011, 17:15</div></div><div class="posttext">just found the problem: it seems webtop is not able to use spool.open with mode 1 (window is displayed and user can change settings / cancel). If you use mode 0 (no window) it also works in webtop. <br />
If there's a way to have the interaction work in webtop (mode 1), it would be nice to know!</div></div><hr />



</div>
</body>
</html>