<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="Writing your own code in QKey generated script, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] Writing your own code in QKey generated script Tools Development" />
	
	<title>Writing your own code in QKey generated script [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="../index.html">Newbaanboard</a> &gt; <a href="../index.html">Baan Quick Support: Functional &amp; Technical</a> &gt; <a href="../index.html">Tools Development</a> &gt; Writing your own code in QKey generated script</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">VishalMistry</div><div class="date">14th August 2019, 19:15</div></div><div class="posttext">Hi Everyone,<br />
<br />
Following is the code generated using QKey:<br />
 <br />
|***************************************************************************<br />
|* Autogenerated subsections for main.table.io<br />
|***************************************************************************<br />
<br />
after.read:<br />
	_pobj_exe1(&quot;after.read&quot;)<br />
<br />
after.write:<br />
	_pobj_exe1(&quot;after.write&quot;)<br />
<br />
after.rewrite:<br />
	_pobj_exe1(&quot;after.rewrite&quot;)<br />
<br />
before.delete:<br />
	_pobj_exe1(&quot;before.delete&quot;)<br />
<br />
	|#end add by QKEY<br />
<br />
I want to write some code when a new sales order header record is saved. I know i have to write it in after.write: section but I am not able to recall how I can achieve this as it has been a long time since I touched QKey. There has been a lot of custom code already written by other developers.<br />
<br />
Any urgent help will be highly appreciated.<br />
<br />
Vishal</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">14th August 2019, 20:55</div></div><div class="posttext">Basically you would add in a |#end then add in the code.  Kind of like this:<br />
<br />
<br />
	|#end add by QKEY<br />
<br />
choice.cont.process:<br />
after.choice:<br />
|20060828.st<br />
| Try testing here for production orders with subcontracting operations.<br />
| The production order number is on the PO line table tdpur041.  Any<br />
| production order found with any PO line not fully received should<br />
| not be completed.<br />
| 20060828.end<br />
	if comp.frm = tcyesno.yes then<br />
		select	tisfc010.cwoc, tisfc010.opno, tirou001.kowc<br />
		from	tisfc010, tirou001<br />
		where	tisfc010._index1 = {:tisfc001.pdno}<br />
		and	tirou001._index1 = {tisfc010.cwoc}<br />
		and	tirou001.kowc = tckowc.subcontracting<br />
		selectdo<br />
			select	tdpur041.*<br />
			from	tdpur041<br />
			where	tdpur041._index6 = {:tisfc001.pdno, :tisfc010.opno}<br />
			selectdo<br />
				if double.cmp(tdpur041.dqua, tdpur041.oqua, .0001)&gt;=0<br />
					and double.cmp(tdpur041.bqua, 0.0, .0001)=0 then<br />
					if double.cmp(tdpur041.quap, tdpur041.oqua, .0001)&lt;0 then<br />
						message(&quot;Purchase order %d line %d needs maintain approvals.&quot;<br />
						,tdpur041.orno,tdpur041.pono)<br />
						choice.again()<br />
					endif<br />
				else<br />
					message(&quot;Purchase order %d line %d not fully received.&quot;<br />
					,tdpur041.orno,tdpur041.pono)<br />
					choice.again()<br />
				endif<br />
			selectempty<br />
				message(&quot;Production order %d operation %d not tied to a purchase order.&quot;<br />
					,tisfc001.pdno,tisfc010.opno)<br />
				if ask.enum(&quot;ticontactpsa&quot;,tcyesno.yes) = tcyesno.yes then<br />
					if ask.enum(&quot;tpbop39003&quot;,tcyesno.yes) = tcyesno.yes then<br />
|*						message(&quot;OK - will continue process&quot;)<br />
					else<br />
						choice.again()<br />
					endif<br />
				else<br />
					choice.again()<br />
				endif	<br />
			endselect<br />
		endselect<br />
| 20130617.st - Made it thru the checks lets check for VSS.<br />
		select	tcudi006.*<br />
		from	tcudi006<br />
		where 	tcudi006._index1 = {:tisfc001.cwar}<br />
		as set with 1 rows<br />
		selectdo<br />
		endselect<br />
		if tcudi006.site &lt;&gt; tcudi.site.lsvl then<br />
			|vss.checks = false<br />
			| No VSS checks needed.<br />
		else<br />
			if tcudi006.wuse = tcudi.wuse.logical or tcudi006.wuse = tcudi.wuse.mrb or <br />
				tcudi006.wuse = tcudi.wuse.parent or tcudi006.wuse = tcudi.wuse.unique then<br />
				|vss.checks = false<br />
				| No vss checks needed.<br />
			else<br />
				select	tdvss001.*, tdvss010.*<br />
				from	tdvss001, tdvss010<br />
				where	tdvss001._index1 = {:tisfc001.mitm}<br />
				and	tdvss010._index1 = {tdvss001.item, :tisfc001.ccot.a}<br />
				as set with 1 rows<br />
				selectdo<br />
				selectempty<br />
					message(&quot;Needs VSS PFEP Data.&quot;)<br />
					choice.again()<br />
				endselect<br />
				if is.warehouse.vss(tisfc001.cwar) then<br />
					if tdvss001.proc = tcyesno.no or tdvss001.subm = tcyesno.no then<br />
						message(&quot;VSS record needs to be submitted.&quot;)<br />
						choice.again()<br />
					endif<br />
				endif<br />
				if tdvss010.cwar &lt;&gt; tisfc001.cwar then<br />
					message(&quot;PFEP Warehouse does not match production order warehouse.&quot;)<br />
					choice.again()<br />
				endif<br />
				if tdvss001.leng = 0 or tdvss001.heig = 0 or tdvss001.widt = 0 then<br />
					message(&quot;%s needs PFEP data completed or processed to VSS set.&quot;, trim$(tisfc001.mitm))<br />
					choice.again()<br />
				endif<br />
			endif<br />
		endif<br />
	endif<br />
| 20130617.end<br />
	|#call<br />
	|#pobj added by QKEY 3.70<br />
	_pobj_exe1(&quot;after.choice.cont.process&quot;)<br />
	|#end add by QKEY<br />
| Go set the current status of the order in<br />
| tisfc970.<br />
	update_completed_status()<br />
	|#pobj added by QKEY 3.70<br />
<br />
|***************************************************************************<br />
|* Autogenerated subsections for choice.cont.process<br />
|***************************************************************************<br />
<br />
before.choice:<br />
	_pobj_exe1(&quot;before.choice.cont.process&quot;)</div></div><hr />



</div>
</body>
</html>