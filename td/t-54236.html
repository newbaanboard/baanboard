<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="Incomplete FTP of file / UNIX shell script &amp; run.prog, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] Incomplete FTP of file / UNIX shell script &amp; run.prog Tools Development" />
	
	<title>Incomplete FTP of file / UNIX shell script &amp; run.prog [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="../index.html">Newbaanboard</a> &gt; <a href="../index.html">Baan Quick Support: Functional &amp; Technical</a> &gt; <a href="../index.html">Tools Development</a> &gt; Incomplete FTP of file / UNIX shell script &amp; run.prog</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">BaanInOhio</div><div class="date">10th November 2008, 06:21</div></div><div class="posttext">I need some recommendations from the HP/Unix pros in the house.<br />
<br />
I have a requirement to FTP files from a HP/UX server to a windows-based FTP site.  Since the FTP server is in the DMZ, I can't access it like other boxes in the network (RCP in a shell script, 'file.mv.across.hosts', 'server2client', etc.).<br />
<br />
My first try was to create a shell script that accepts the from and to locations/filenames then execute the FTP (connect using server/password, set ascii, set locations on unix server and ftp site, put filename, bye) and execute it thru 'run.prog'.  The files are ascii, around 500 byte records.  The number of lines varies from a few to thousands.<br />
<br />
Running the script from a unix prompt after shelling from Baan copies the file as expected.  -- BUT --  Executing the Baan session that calls the same shell script using 'run.prog' with mode = &quot;RP_WAIT&quot; consistently cuts off the last 1000 or so bytes of the file.  The break isn't consistent, and normally not at the end of a line.  I tried to replace the run.prog with shell using options to run the script in a separate window with requiring &lt;enter&gt; to complete -same result.  Even used FTP thru 'curl' and received the same truncated file.  The FTP does not return an error, only results in a file on the ftp site that's smaller than the one sent.<br />
<br />
Any recommendations on where to start looking?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">spartacus</div><div class="date">10th November 2008, 11:53</div></div><div class="posttext">We use a job to send data from Baan to a remote recipient. Data is generated by a &quot;normal&quot; Baan-Session. The ftp-script ist executed from the same job with: ttaad5205m000. <br />
Perhaps can you also make a short test with ttaad5205m000 and a job?<br />
<br />
Regards</div></div><hr />


<div class="post"><div class="posttop"><div class="username">_Ralph_</div><div class="date">10th November 2008, 16:59</div></div><div class="posttext">In this thread<br />
http://www.baanboard.com/baanboard/showthread.php?t=53937&amp;<br />
<br />
I posted a sample script using tools ftp functions documented on only one version of programmers guide. You can try it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dorleta</div><div class="date">10th November 2008, 17:34</div></div><div class="posttext">I did it using a net.rec file. It may be works for you also.<br />
<br />
good luck <br />
<br />
function extern long aepurdll0002.export.sap(domain tcmcs.str80 fich, long proceso)	<br />
{<br />
	table	taepur001<br />
<br />
	string scomando(200)<br />
	string linea.ftp(200)<br />
	long file.ftp, file.null<br />
<br />
	select  aepur001.*<br />
	from	aepur001<br />
	where	aepur001._index1={:proceso}<br />
	selectdo<br />
	endselect<br />
	|Genera el fichero txt del ftp batch<br />
	file.ftp = seq.open(&quot;.netrc&quot;, &quot;w&quot;)<br />
	if file.ftp &lt; 1 then<br />
		message(&quot;No se puede exportar el fichero&quot;)<br />
		return (0)	| Error openning file<br />
	endif<br />
	linea.ftp = sprintf$(&quot;%s %s &quot;,&quot;machine&quot;,strip$(aepur001.dire))													|OPEN<br />
	linea.ftp = linea.ftp &amp; sprintf$(&quot;login %s &quot;,strip$(aepur001.user))												|USUARIO <br />
	linea.ftp = linea.ftp &amp; sprintf$(&quot;password %s&quot;,strip$(aepur001.pass))											|PASSWORD <br />
	seq.puts(linea.ftp, file.ftp)<br />
	linea.ftp = sprintf$(&quot;macdef init&quot;)																				|INIT <br />
	seq.puts(linea.ftp, file.ftp)<br />
	linea.ftp = sprintf$(&quot;%s&quot;,&quot;ascii&quot;)																				|ASCII<br />
	seq.puts(linea.ftp, file.ftp)<br />
	linea.ftp = sprintf$(&quot;%s %s&quot;,&quot;cd&quot;,strip$(aepur001.path))														|CD **<br />
	seq.puts(linea.ftp, file.ftp)<br />
	linea.ftp = sprintf$(&quot;%s %s&quot;,&quot;delete&quot;,strip$(fich))																|erase remote file<br />
	seq.puts(linea.ftp, file.ftp)	<br />
<br />
<br />
	linea.ftp = &quot;append &quot; &amp; strip$(aepur001.dir2) &amp; strip$(fich) &amp; &quot; &quot; &amp; strip$(aepur001.path) &amp; strip$(fich)|APPEND **		<br />
	seq.puts(linea.ftp, file.ftp)												<br />
<br />
	linea.ftp = sprintf$(&quot;%s&quot;,&quot;quit&quot;)																				|QUIT<br />
	seq.puts(linea.ftp, file.ftp)<br />
	seq.puts(&quot;&quot;, file.ftp)<br />
	seq.close(file.ftp)<br />
<br />
	|Cambia el modo del fichero .netrc<br />
	scomando = &quot;chmod 600 .netrc&quot;				<br />
	if shell(scomando , 0) &lt;&gt; 0 then<br />
		message(&quot;it is not possible to send file&quot;)<br />
		return(0)<br />
	endif<br />
<br />
	|Ejecuta el ftp batch<br />
	scomando = &quot;ftp &quot; &amp; strip$(aepur001.dire)<br />
	if shell(scomando , 0) &lt;&gt; 0 then<br />
		message(&quot;&quot;)<br />
		return(0)<br />
	endif<br />
<br />
<br />
	|Borra el fichero ftp batch<br />
	scomando = &quot;rm .netrc&quot;<br />
	<br />
	if shell(scomando , 0) &lt;&gt; 0 then<br />
		message(&quot;it´s not posible to delete sender file&quot;)<br />
		return(0)			<br />
	endif<br />
	return(1)			<br />
}</div></div><hr />


<div class="post"><div class="posttop"><div class="username">NPRao</div><div class="date">11th November 2008, 01:00</div></div><div class="posttext">I have a requirement to FTP files from a HP/UX server to a windows-based FTP site. Since the FTP server is in the DMZ, I can't access it like other boxes in the network (RCP in a shell script, 'file.mv.across.hosts', 'server2client', etc.).<br />
Since you are already on HP-UX, have you considered to use the sftp:<br />
$ man sftp<br />
 SFTP(1)                                                             SFTP(1)<br />
<br />
 NAME<br />
      sftp - secure file transfer program<br />
<br />
 SYNOPSIS<br />
      sftp [-1Cv] [-B buffer_size] [-b batchfile] [-F ssh_config] [-o<br />
      ssh_option] [-P sftp_server_path] [-R num_requests] [-S program] [-s<br />
      subsystem | sftp_server] host<br />
      sftp [[user@] host[:file[file]]]<br />
      sftp [[user@] host[:dir[/]]]<br />
      sftp -b batchfile [user@]host<br />
<br />
 DESCRIPTION<br />
      sftp is an interactive file transfer program, similar to ftp(1), which performs all operations over an encrypted ssh(1) transport.  It may also use many features of ssh, such as public key authentication and compression. sftp connects and logs into the specified host, then enters an interactive command mode.<br />
<br />
      The second usage format will retrieve files automatically if a non- interactive authentication method is used; otherwise it will do so after successful interactive authentication.<br />
<br />
      The third usage format allows sftp to start in a remote directory. Ralph, those ftp functions are valid for LN/6.1 Tools. I am not sure if they work in Baan-4/5 versions.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">BaanInOhio</div><div class="date">11th November 2008, 04:40</div></div><div class="posttext">those ftp functions are valid for LN/6.1 Tools. I am not sure if they work in Baan-4/5 versions.<br />
<br />
I tried those a while ago and couldn't compile - figured that they weren't available in IV - couldn't locate them in any of the includes.<br />
<br />
I will try the batch job - but wanted it to be interactive if possible.<br />
<br />
Interesting thing is that the FTP script works perfect when running from ksh, but cuts the end off of the file when running the exact same script and files from Baan's 'shell' or 'run.prog'.  Even more interesting that running FTP thru 'curl' provided the same incomplete file.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">frigyesg</div><div class="date">11th November 2008, 11:13</div></div><div class="posttext">We are using the same functionalaty from Linux to Windows2003 without problmes with run.prog.<br />
But You could also try the shell command. I don´t know if it makes a difference, but you could test it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Hitesh Shah</div><div class="date">11th November 2008, 13:44</div></div><div class="posttext">As suggested by NP  sftp  should work  for this server in DMZ .</div></div><hr />



</div>
</body>
</html>