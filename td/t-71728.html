<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="How to get previous month from starting date of given fiscal period, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] How to get previous month from starting date of given fiscal period Tools Development" />
	
	<title>How to get previous month from starting date of given fiscal period [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="../index.html">Newbaanboard</a> &gt; <a href="../index.html">Baan Quick Support: Functional &amp; Technical</a> &gt; <a href="../index.html">Tools Development</a> &gt; How to get previous month from starting date of given fiscal period</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">TejashreeDesai</div><div class="date">21st February 2019, 16:07</div></div><div class="posttext">Dear All,<br />
<br />
Please assist me on how to get previous month from starting date of given fiscal period and year?<br />
<br />
Thanks &amp; Regards,<br />
Tejashree<br />
:)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Ajesh</div><div class="date">21st February 2019, 17:11</div></div><div class="posttext">tfgld.dll5005.get.last.date.of.previous.period<br />
<br />
function extern boolean tfgld.dll5005.get.last.date.of.previous.period(<br />
		domain	tcncmp		i.fin.company,<br />
		domain	tfgld.ptyp	i.period.type,<br />
		domain	tcdate		i.date.utc,<br />
	ref	domain	tcdate		o.last.date.prev.peri)<br />
{<br />
	DLLUsage<br />
	Expl	: This function gets the last date of the previous period based<br />
		  on the given input date. This is independent of the period<br />
		  status.<br />
	Pre	: N.a.<br />
	Post	: N.a.<br />
	Input	: i.fin.company		- Financial Company<br />
		  i.period.type		- Period Type<br />
		  i.date.utc		- Date (UTC)<br />
	Output	: o.last.date.prev.peri	- Last Date of the Previous Period (UTC)<br />
	Return 	: true	-<br />
		  false	-<br />
	Moved from tfgld.dll6012.get.last.date.of.previous.period(<br />
	EndDLLUsage<br />
<br />
<br />
<br />
Once you get the last date of previous period, you can easily get the month number from utc.to.date function.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">TejashreeDesai</div><div class="date">22nd February 2019, 06:06</div></div><div class="posttext">Thanks Ajesh for helping me.<br />
 <br />
Is there any same function for getting previous starting date of previous period?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Ajesh</div><div class="date">22nd February 2019, 09:18</div></div><div class="posttext">You mean start date of previous period?<br />
<br />
Once you get last date of previous period, you can get the previous period and year from (But bfore that you need to convert last.date.utc to last.date.normal)<br />
<br />
<br />
<br />
function extern long tfgld.dll5005.determine.year.period.from.date(<br />
		domain tcncmp      	i.financial.company,<br />
		domain tfgld.ptyp	i.period.type,<br />
		domain tfgld.date	i.date,<br />
	ref	domain tfgld.year	o.year,<br />
	ref	domain tfgld.prod	o.period)<br />
{<br />
	DllUsage<br />
	Expl:	This function determines the year and period based on the input<br />
		date.<br />
	Pre:	-<br />
	Post:	In case Reporting Periods are not used in group company<br />
		parameters and i.period.type = tfgld.ptyp.reporting, the I/O<br />
		arguments are set to 0 and no(!) DALHOOKERROR is returned.<br />
	Input:	i.financial.company	- Financial Company<br />
		i.period.type		- Period Type<br />
		i.date			- Date<br />
	Output:	o.year		- Year<br />
		o.period	- Period<br />
	Return:	0/DALHOOKERROR 	- DAL buffer filled in case of error.<br />
	EndDllUsage<br />
<br />
<br />
<br />
<br />
Then once you get last period and year number.you can get start date of that period from<br />
<br />
<br />
<br />
function extern boolean tfgld.dll5005.read.start.date.period(<br />
		domain	tfgld.ptyp 	i.period.type,<br />
		domain 	tfgld.year 	i.year,<br />
		domain 	tfgld.prod	i.period.number,<br />
	ref	domain 	tfgld.date 	o.date)<br />
{<br />
	DLLUSAGE<br />
<br />
	This dll will read the start date for a given period type, year and<br />
	period number.<br />
<br />
	Returns true if period type, year and period number is found, else<br />
	returns false<br />
<br />
	i.period.type  	period type<br />
	i.year  	year<br />
	i.period.number	period number<br />
	o.date  	start date of period<br />
<br />
	Moved from tfgld.dll1032.read.start.date.period<br />
	ENDDLLUSAGE</div></div><hr />


<div class="post"><div class="posttop"><div class="username">TejashreeDesai</div><div class="date">25th February 2019, 14:20</div></div><div class="posttext">Thank You once again for helping.:)</div></div><hr />



</div>
</body>
</html>