<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="VB script and Baan DLL, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] VB script and Baan DLL Tools Development" />
	
	<title>VB script and Baan DLL [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="../index.html">Newbaanboard</a> &gt; <a href="../index.html">Baan Quick Support: Functional &amp; Technical</a> &gt; <a href="../index.html">Tools Development</a> &gt; VB script and Baan DLL</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">avpatil</div><div class="date">19th March 2002, 18:52</div></div><div class="posttext">Hi,<br />
I am trying to USE OLE automation, calling Baan DLL from VB script. The VB script and DLL works fine if I run with one instance. I tried executing the VB script twice simulatenously and I get a BW error &quot;message_loop_nesting error, nesting<br />
level = 2(should be 1)&quot; and &quot;message_loop_nesting error, nesting level =1(should be 0)&quot;. THe DLL got excecuted fine, but the BW messages stays there and a hanging bshell. Is something different needs to be done with multiple user accessing the VB script.<br />
<br />
Arvind Patil</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">19th March 2002, 21:33</div></div><div class="posttext">I get mixed results when doing this.  When I run certain macros at the same time I get exactly the error you talk about and yet with another one of my macros I can run two of them at once. It looks like both of them use the same shell.  The one that aborts with the error like yours does a lot of selects to return production order information. The one that works runs a DLL which has a function server in it.  <br />
<br />
On the one that produces the error the second run starts giving me messages about &quot;Waiting for another Ole automation to complete&quot;. I did not write down the exact message. Not sure how to fix it to run the same code twice on my machine, but the good news is that I can run the same macro on multiple clients without problems.  Try it from two separate machines. Not really sure if you need to run the same VB code on one client multiple times or just on multiple clients.<br />
<br />
Since I am not a VB expert and most of my stuff is simple Excel macros I am not really sure how to coordinate two macros running on the same machine at the same time.<br />
<br />
Mark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">avpatil</div><div class="date">19th March 2002, 21:42</div></div><div class="posttext">Hi Mark,<br />
My VB script is very simple. All I am doing in that script is calling a Baan DLL and passing the parameter. That DLL does lot of stuff. My DLL gets executed fine without any issue. But I land up in BW error (The nesting error) and with BW being hanging. I am sure if I run from multiple client this wouldn't happen. And where do I see that &quot;OLE Automaion in Use function&quot;. Is there a way to check if the OLE Automation is free.<br />
<br />
Arvind</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">19th March 2002, 22:46</div></div><div class="posttext">I have tried working with the getobject function to see if it was already open and running. I have not had any luck with it.  I also seem to recal that in one of the baan examples they had something that checked to see if the baan application was already running, but I can not seem to find that.  Maybe it was in Gordons Xbrp program and I no longer have a copy of that. I am sure Gordon will come along with a suggestion or two. :)<br />
<br />
The error message I got was only popped up on one of the sessions, but this was after I got the error that you first mentioned.  I just do not know enough about VB code to get the communication issues worked out.<br />
<br />
Mark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">gfasbender</div><div class="date">19th March 2002, 23:16</div></div><div class="posttext">If you need a multi-thread process, you can always create multiple Baan Objects by declaring an object array.<br />
<br />
Dim BaanObj(10) As Object<br />
<br />
Of course, a new BW (and license) will be created with each BaanObj(i) = CreateObject(&quot;...&quot;) call.<br />
<br />
I don't know how you can check to see if the Baan Object is currently running a process. Sorry.</div></div><hr />



</div>
</body>
</html>