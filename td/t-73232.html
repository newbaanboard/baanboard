<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="To print address by format, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] To print address by format Tools Development" />
	
	<title>To print address by format [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="../index.html">Newbaanboard</a> &gt; <a href="../index.html">Baan Quick Support: Functional &amp; Technical</a> &gt; <a href="../index.html">Tools Development</a> &gt; To print address by format</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">pegaga1979</div><div class="date">17th June 2020, 12:41</div></div><div class="posttext">Hi,<br />
<br />
I would like to print BP address based on format.<br />
currently i used namc,namd, ln02.<br />
i noticed that some of standard report used array.<br />
May i know how to design?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bdittmar</div><div class="date">17th June 2020, 13:19</div></div><div class="posttext">Hello,<br />
<br />
Using address formats<br />
<br />
You use address formats to define how addresses must be printed on documents.<br />
<br />
The address lines on a document are usually 35 positions. The maximum is 60 positions. For this reason, two fields are available for the Name, Street, and City name fields in the Addresses (tccom4130s000) session. This enables you to print parts of the name, address, and city on separate lines, or to print only the first parts.<br />
Address format and address lines format<br />
<br />
In the Addresses (tccom4130s000) session, you can link an address format in these fields:<br />
<br />
    Address Format for Address Lines<br />
    Address Format<br />
<br />
The Address Format for Address Lines is used to retrieve the correct address data for the Address Line 1 through Address Line 6 fields in the Addresses (tccom4130s000) session. These address line (1-6) fields are mainly used to exchange address data between LN and an external package.<br />
<br />
If you do not want these address line (1-6) fields to be updated each time an update is made to a field that is specified in the address format, you must leave the Address Format for Address Lines field empty. If required, you can upload address lines from the Update Address Formats (tccom4235m000) session.<br />
<br />
The Address Format in the Addresses (tccom4130s000) session, is the standard format for the specified address. If this field is empty, LN retrieves a country address format or a default format.<br />
Country address format<br />
<br />
You can define an address format for a country in the Countries (tcmcs0110s000) session. You use this to specify if the house number precedes or follows the name of the street, and if the ZIP/postal code precedes or follows the name of the city, in a specific country. The country address format is used for all addresses in that country for which you do not specify a specific address format.<br />
Default format<br />
<br />
When you specify or select an address, you can optionally link an address format to it. However, LN cannot print an address if it cannot find the format to be used. You must specify a default format to avoid that addresses cannot be printed.<br />
<br />
To use the default format, specify an address format for the address of the company in which you are working. You can specify an address for a company in the General Company Data (tccom0502m000) details session. From the Address Code field in the General Company Data (tccom0102s000) session, you can zoom to the Addresses (tccom4530m000) in which you can view the linked (default) address format.<br />
<br />
LN uses the most specific format to print an address. It searches for and uses the address formats in this order:<br />
<br />
    The format linked to the address<br />
    The format defined for the country of the address<br />
    The default format<br />
<br />
One address in different formats<br />
<br />
If the same address must be printed in different formats, you must make a copy of the address and specify a different format for the copy. You must specify a new, unique code for the copied address.<br />
<br />
You use this, for example, if on a request for quotation you want to print the fax number and e-mail address, but on a shipping order this information is not necessary. You can also achieve this by specifying a lower priority for the fax number and e-mail address.<br />
<br />
<br />
Defining address formats<br />
<br />
You define an address format by using the Address Formats (tccom4135s000) session.<br />
<br />
Define for each address field where and how it must be printed, by specifying:<br />
<br />
    Line<br />
    The number of the address line.<br />
    Sequence<br />
    The sequence number of this field on the line.<br />
    Priority<br />
    The priority of this field.<br />
    Space<br />
    The number of spaces to follow this field.<br />
<br />
Sequence<br />
<br />
You can use the sequence number to print more than one field on a line. If the fields do not fit on the line, the information is truncated at the end of the line. LN does not check the priorities of the fields in this case.<br />
Priority<br />
<br />
You can use the priority to indicate which address fields can be skipped. If there are not enough lines available to print the complete address according to the specified format, the lines that contain fields with a low priority are not printed. 1 = highest priority, 2 = second priority, and so on.<br />
Free text<br />
<br />
You can specify free text that will be inserted between the address fields. You can use this to add commas, or the text P.O. Box or CEDEX to the address.<br />
<br />
Use the Communication tab of the Address Formats (tccom4135s000) session to define the free texts of a format.<br />
<br />
You define the position of the free text in the same way as for the other address fields. You can define only one position for a free text. For example, if you need two commas, you must define two free texts with a comma.<br />
<br />
For each format you can define:<br />
<br />
    Three long free texts, of up to 20 characters each.<br />
    Six short free texts, of up to 6 characters each.<br />
<br />
Free text is treated as prefix and tag to the other address fields. These rules apply:<br />
<br />
    A short free text at the end of a line is not printed (a long free text is).<br />
    If there is only free text on a line, the line is not printed. The free text can be long free text or short free text.<br />
<br />
For example, if you specify a format in which Name 2 is printed on line 2 followed by a free text, the entire line is skipped if the Name 2 field of the address is empty.<br />
Note<br />
<br />
You can specify the same combination of line, sequence, and priority for only one address field.<br />
Example<br />
<br />
Required printing address:<br />
line 1:	Name<br />
line 2:	Name 2<br />
line 3:	P.O. Box (space) P.O. Box Number<br />
line 4:	City, (space) City 2<br />
line 5:	ZIP Code/Postal Code (space) (space) Country<br />
<br />
 <br />
<br />
Address Format	Line	Sequence	Priority	Space<br />
Name	1	1	1	0<br />
Name 2	2	1	1	0<br />
P.O. Box Number	3	2	1	0<br />
City	4	1	1	0<br />
City 2	4	3	1	0<br />
Country	5	3	1	0<br />
ZIP Code/Postal Code	5	1	1	2<br />
P.O. Box	3	1	1	1<br />
,	4	2	1	2<br />
<br />
 <br />
<br />
where:<br />
<br />
    P.O. Box is a long free text<br />
    The comma is a short free text</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pegaga1979</div><div class="date">18th June 2020, 03:44</div></div><div class="posttext">Hi Bernd,<br />
Thank you for the note.<br />
The format actually already setup and available in the system.<br />
However, i would like to print the same at my report which currently i used by standard field from table tccom130.<br />
i checked from other standard reports, they used array.<br />
so, i'm not sure how the script is designed.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">tmannais</div><div class="date">18th June 2020, 05:42</div></div><div class="posttext">Check this out.<br />
http://www.baanboard.com/baanboard/showthread.php?t=28007<br />
for function tccom.dll4030.format.address()</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pegaga1979</div><div class="date">18th June 2020, 07:24</div></div><div class="posttext">hi,<br />
actually i already read through the link. however, i'm not understand.<br />
do i need to insert the function in my report script?<br />
and how?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">tmannais</div><div class="date">19th June 2020, 05:11</div></div><div class="posttext">First, you declare a variable as an array of string.<br />
<br />
extern	domain	tcmcs.str100m	addr(7)<br />
<br />
or you can create in the input field of the report. Whatever makes it work for you, just try both options.<br />
<br />
Then you call the function providing Address Code, Number of Line, and the array.<br />
<br />
tccom.dll4030.format.address(tccom112.cadr,7,addr)<br />
<br />
After the execution of that function, your array will have the formatted address data in separate lines. For example, you can just call addr(1,3) when you want the 3rd line of the text.<br />
<br />
Note that I usually use tccom.dll4035.format.address instead of tccom.dll4030.format.address because it works for me; however, I don't know the difference between these two. Maybe one works in some versions and the other doesn't, or maybe it just works differently somehow.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DDPatel</div><div class="date">19th June 2020, 14:20</div></div><div class="posttext">This will be working fine....<br />
We also used same method to print the address...:p</div></div><hr />



</div>
</body>
</html>