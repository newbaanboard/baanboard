<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="Is there &quot;Join&quot; concept in BaaN Query, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] Is there &quot;Join&quot; concept in BaaN Query Tools Development" />
	
	<title>Is there &quot;Join&quot; concept in BaaN Query [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="../index.html">Newbaanboard</a> &gt; <a href="../index.html">Baan Quick Support: Functional &amp; Technical</a> &gt; <a href="../index.html">Tools Development</a> &gt; Is there &quot;Join&quot; concept in BaaN Query</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">cuiwenyuan</div><div class="date">11th July 2006, 04:48</div></div><div class="posttext">Dear all,<br />
Do you know how to use &quot;left join&quot; or &quot;left join&quot; in BaaN SQL Query?<br />
Please see below example in access,thanks in advance.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bigjack</div><div class="date">11th July 2006, 07:09</div></div><div class="posttext">Hi,<br />
<br />
I assume by &quot;Left Join&quot; you mean selecting all records from your &quot;Tbl365&quot; and selecting only those records from &quot;TblAstro&quot; where joined fields are equal.<br />
<br />
I dont think there  is standard functionality of &quot;Joins&quot; in BaaN SQL. You will have to program explicitly as follows,<br />
<br />
select Tbl365.*<br />
from    Tbl365<br />
selectdo<br />
         db.set.to.default(tTblAstro)   | Reset table fields<br />
         select    TblAstro.*<br />
         from      TblAstro<br />
         where    TblAstro.ID = Tbl365.Astro<br />
         selectdo<br />
         endselect<br />
         | Your Code here<br />
endselect</div></div><hr />


<div class="post"><div class="posttop"><div class="username">cuiwenyuan</div><div class="date">11th July 2006, 08:38</div></div><div class="posttext">Hi bigjack,<br />
Thanks for you reply, may i have more question? what should i do when i use SQL Query in BaaN?<br />
I mean i can use your method in report script and session script, but i do not know how to get the data in SQL Query.<br />
<br />
thanks again.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bigjack</div><div class="date">11th July 2006, 09:38</div></div><div class="posttext">hmmm....i dont think that is possible in &quot;Easy SQL&quot; .  As the name suggests &quot;Easy SQL&quot; can't handle complex(?) things like selectdo.<br />
<br />
However if you are insisting on using &quot;easy sql&quot; for your requirement then i will suggest following workaround,<br />
<br />
1. Use Easy SQL to build a query on your Tbl365 table.<br />
2. Edit the report generated by &quot;easy sql&quot; thro &quot;Report Data&quot; button on &quot;Maintain Query Data&quot; session<br />
3. Create &amp; Edit the report script. Code the selection logic for table TblAstro in follwoing section<br />
<br />
detail.1:<br />
before.layout:<br />
     db.set.to.default(tTblAstro) | Reset table fields<br />
     select TblAstro.*<br />
     from TblAstro<br />
     where TblAstro.ID = Tbl365.Astro<br />
     selectdo<br />
     endselect<br />
<br />
Im not sure whether such long excercise is of any worth (except perhaps when you dont want to generate new session for small requirements)<br />
<br />
Perhaps someone has a better solution for your requirement<br />
<br />
Bye</div></div><hr />


<div class="post"><div class="posttop"><div class="username">cuiwenyuan</div><div class="date">11th July 2006, 09:46</div></div><div class="posttext">That is enough, i can get the data for my user now.<br />
Thanks so much!!!:)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">en@frrom</div><div class="date">11th July 2006, 09:50</div></div><div class="posttext">This is very easy in Baan-SQL, using:<br />
<br />
<br />
select     table365.*, tableastro.*<br />
from       table365, tableastro<br />
where     ....... --&gt; all your conditions<br />
and        table365.astro refers to tableastro<br />
selectdo<br />
selectempty <br />
endselect<br />
<br />
<br />
Note: refers to is always a reference to the primary key of the table referred to (in this case tableastro) If it is not concerning an index field, then you can just write something like:<br />
and table365.xxx = :table999.xxx<br />
Performance-wise however, it is often recommended to break the query into two this case, more like Bigjack's example..</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">11th July 2006, 15:49</div></div><div class="posttext">En - he wanted all the records from table365 and only those with matches in tableastro.  So your query would only retrieve linked records, but not all of the table365 records.<br />
<br />
Bigjack - if you edit one of your posts you can see the code tags I included.  It just makes it easier to read the code - at least to me.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">lbencic</div><div class="date">11th July 2006, 17:44</div></div><div class="posttext">You can use the Reference modes to simulate the left join and still get the all the main records and only those records from the related table that exist.  With this it will fill the linked records with blanks or an 'undefined reference' symbol when there is not a linked record.  See the WIKI Link:<br />
<br />
http://www.baanboard.com/programmers_manual_baanerp_help_functions_database_handling_references<br />
<br />
In your example, if there is a direct reference from table365 on the main index of table &quot;tableastro&quot;, then En's statement just needs a little tweek:<br />
<br />
<br />
select     table365.*, tableastro.*<br />
from       table365, tableastro<br />
where     ....... --&gt; all your conditions<br />
and        table365.astro refers to tableastro UNREF SETUNREF<br />
selectdo<br />
selectempty <br />
endselect</div></div><hr />


<div class="post"><div class="posttop"><div class="username">en@frrom</div><div class="date">11th July 2006, 17:48</div></div><div class="posttext">Sorry for my suggestion, I didn't read the requirement well. With Lisa's suggestion it will work fine.</div></div><hr />



</div>
</body>
</html>