<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="How to add specific no of months to a date field, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] How to add specific no of months to a date field Tools Development" />
	
	<title>How to add specific no of months to a date field [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="../index.html">Newbaanboard</a> &gt; <a href="../index.html">Baan Quick Support: Functional &amp; Technical</a> &gt; <a href="../index.html">Tools Development</a> &gt; How to add specific no of months to a date field</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">VishalMistry</div><div class="date">20th August 2007, 10:03</div></div><div class="posttext">Hi all,<br />
<br />
     Can anyone help me on how i can add no.of.months/no.of.days to a specific date field.<br />
<br />
<br />
Thanking in advance,<br />
Vishal L. Mistry</div></div><hr />


<div class="post"><div class="posttop"><div class="username">en@frrom</div><div class="date">20th August 2007, 11:31</div></div><div class="posttext">I assume you mean how to programmatically add x months and/or x days to a given date...? Since your profile shows that you are on Baan IV, I also assume you mean regular date fields rather than utc fields?<br />
<br />
Assuming the above, the following will work:<br />
<br />
Let's say date contains a date entered by the user on the form, let's say it contains now 20/08/2007, And user inputs on form how many days and how many months he/she wants to add to selected date. User selected 6 months and 20 days.<br />
<br />
extern domain tcmcs.long dys, mnths, numdate, retval, year, month, day<br />
<br />
retval = num.to.date(numdate, year, month, day)<br />
numdate = date.to.num(year + (month + mnths) / 12, (month + mnths) \ 12, day)<br />
numdate = numdate + dys<br />
<br />
numdate will now correctly contain 11/03/2008.<br />
<br />
Hope this helps you and that it is clear to you. In case of any further questions, do not hesitate to ask.<br />
<br />
<br />
Regards,<br />
Eli Nager</div></div><hr />


<div class="post"><div class="posttop"><div class="username">VishalMistry</div><div class="date">21st August 2007, 11:19</div></div><div class="posttext">Hi,<br />
<br />
     Thanks for ur reply. Can u tell me if given a particular date, how i can separate year month and day and store them in separate variable.<br />
<br />
Thanking u in advance,<br />
Vishal</div></div><hr />


<div class="post"><div class="posttop"><div class="username">en@frrom</div><div class="date">21st August 2007, 11:26</div></div><div class="posttext">Vishal,<br />
<br />
I see you don't quite understand the syntax of what I did in my example.<br />
<br />
retval = num.to.date(numdate, year, month, day)<br />
<br />
<br />
This part takes the numeric date 'numdate' (number of days since 01/01/0001) and assigns the year,month and day values to the declared variables (of type long) year, month &amp; date (could be any other name as well).<br />
<br />
Regards,<br />
Eli Nager</div></div><hr />


<div class="post"><div class="posttop"><div class="username">preethish</div><div class="date">20th December 2010, 06:54</div></div><div class="posttext">I assume you mean how to programmatically add x months and/or x days to a given date...? Since your profile shows that you are on Baan IV, I also assume you mean regular date fields rather than utc fields?<br />
<br />
Assuming the above, the following will work:<br />
<br />
Let's say date contains a date entered by the user on the form, let's say it contains now 20/08/2007, And user inputs on form how many days and how many months he/she wants to add to selected date. User selected 6 months and 20 days.<br />
<br />
extern domain tcmcs.long dys, mnths, numdate, retval, year, month, day<br />
<br />
retval = num.to.date(numdate, year, month, day)<br />
numdate = date.to.num(year + (month + mnths) / 12, (month + mnths) \ 12, day)<br />
numdate = numdate + dys<br />
<br />
numdate will now correctly contain 11/03/2008.<br />
<br />
Hope this helps you and that it is clear to you. In case of any further questions, do not hesitate to ask.<br />
<br />
<br />
Regards,<br />
Eli Nager<br />
<br />
<br />
<br />
Hi Eli nager,<br />
<br />
Good ligic but there is a small bug if you are adding only 12 months to the date 20122010 then month feild will be zero (remainder is zero). it wont work out. <br />
<br />
Regards,<br />
Preeth</div></div><hr />


<div class="post"><div class="posttop"><div class="username">vinceco252</div><div class="date">20th December 2010, 21:46</div></div><div class="posttext">In LN, there is a utc.add function for adding dates...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Roeland</div><div class="date">16th March 2011, 12:24</div></div><div class="posttext">The utc.add function is now also available in Baan IV:<br />
<br />
retval = num.to.date(numdate, year, month, day)		<br />
in_utc = date.to.utc(year,month,day,0,0,0)<br />
retval = utc.add(in_utc, 0, mnths, 0, 0, 0, 0, out_utc)<br />
retval = utc.to.date(out_utc, year, month, day, dummy, dummy, dummy)<br />
numdate = date.to.num(year, month, day)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">v_kewl</div><div class="date">25th April 2018, 17:56</div></div><div class="posttext">very old thread, but searching for the same, below code I have written for Baan IV<br />
<br />
num.to.date(r.date, o.year, o.mnth, o.dayn)	<br />
		o.mnth = o.mnth + month_to_be_added<br />
		if (o.mnth\12) = 0 then<br />
			o.year = o.year + ((o.mnth/12)-1)<br />
			o.mnth = 12<br />
		else<br />
			o.year = o.year + (o.mnth/12)<br />
			o.mnth = (o.mnth\12)<br />
		endif<br />
		<br />
		r.date = date.to.num(o.year, o.mnth, o.dayn)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">giggty</div><div class="date">26th April 2018, 10:22</div></div><div class="posttext">v_kewl, why not use utc.add? Adding months like is error-prone.</div></div><hr />



</div>
</body>
</html>