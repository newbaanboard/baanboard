<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="Problem with VBS Extern Script, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] Problem with VBS Extern Script Tools Development" />
	
	<title>Problem with VBS Extern Script [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="../index.html">Newbaanboard</a> &gt; <a href="../index.html">Baan Quick Support: Functional &amp; Technical</a> &gt; <a href="../index.html">Tools Development</a> &gt; Problem with VBS Extern Script</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">gget79</div><div class="date">28th November 2009, 00:23</div></div><div class="posttext">Hi Friends,<br />
<br />
I am working with LN 6.1 FP3, with bw 8.5 version.<br />
<br />
<br />
I have used the solution posted in this forum talking about send mails with Visual basic code.<br />
<br />
My first attempt was in Baan V and It worked fine for me, but now I am making in the LN and it isn't working for me, appears me a Windows script host message. It tell me &quot;Not specified a script&quot;.<br />
<br />
My source code is<br />
<br />
<br />
function extern enviar_email()<br />
{<br />
	long   ret<br />
	string commandline(2560)<br />
	<br />
	frmTo 	   = g.destinatario<br />
	frmSubject = g.subject<br />
	frmBody	   = g.body<br />
	frmAtt	   = g.ruta<br />
	<br />
 	varfrom 	= &quot;&quot;&quot;&quot; &amp; frmFrom &amp; &quot;&quot;&quot;&quot;<br />
	varto  		= &quot;&quot;&quot;&quot; &amp; frmTo &amp; &quot;&quot;&quot;&quot;<br />
	varsubject 	= &quot;&quot;&quot;&quot; &amp; frmSubject &amp; &quot;&quot;&quot;&quot;<br />
	varbody 	= &quot;&quot;&quot;&quot; &amp; frmBody &amp; &quot;&quot;&quot;&quot;<br />
	varcat 	= &quot;&quot;&quot;&quot; &amp; &quot;&quot; &amp; &quot;&quot;&quot;&quot;<br />
	varbcc 	= &quot;&quot;&quot;&quot; &amp; &quot;&quot; &amp; &quot;&quot;&quot;&quot;<br />
	varcc 	= &quot;&quot;&quot;&quot; &amp; &quot;&quot; &amp; &quot;&quot;&quot;&quot;<br />
	varatt   = &quot;&quot;&quot;&quot; &amp; &quot;C:\BaanEma\tmp\outlook.pdf&quot; &amp; &quot;&quot;&quot;&quot;<br />
	varaction 	= &quot;&quot;&quot;send&quot;&quot;&quot;	| or copy or save or send cfr script below<br />
	<br />
	commandline = &quot;C:\vbbaan\Outlook.vbs &quot; &amp; varfrom &amp; &quot; &quot; &amp; varto &amp; &quot; &quot; &amp; varsubject &amp; &quot; &quot; &amp; varbody &amp; &quot; &quot; &amp; varcat &amp; &quot; &quot; &amp; varbcc &amp; &quot; &quot; &amp; varcc &amp; &quot; &quot; &amp; varatt &amp; &quot; &quot; &amp; varaction<br />
	commandline = &quot;Outlook.vbs &quot; &amp; varfrom &amp; &quot; &quot; &amp; varto &amp; &quot; &quot; &amp; varsubject &amp; &quot; &quot; &amp; varbody &amp; &quot; &quot; &amp; varcat &amp; &quot; &quot; &amp; varbcc &amp; &quot; &quot; &amp; varcc &amp; &quot; &quot; &amp; varatt &amp; &quot; &quot; &amp; varaction |get.n<br />
	ret = app_start(commandline,&quot;C:\vbbaan&quot;,&quot;&quot;,&quot;/home/get/out.txt&quot;,&quot;/home/get/errstd.txt&quot;)  |get.n<br />
}<br />
<br />
My VBS is:<br />
<br />
Dim obj, nCount, i, vfrom, vto, vsubject, vbody, vcat, vbcc, vcc, vatt, vaction<br />
<br />
'nCount = WScript.Arguments.Count<br />
'wscript.echo ncount<br />
'for i = 0 to nCount-1<br />
'	wscript.echo Wscript.Arguments(i)<br />
'next<br />
<br />
vfrom = cstr(Wscript.arguments(0))<br />
vto = cstr(Wscript.arguments(1))<br />
vsubject = cstr(Wscript.arguments(2))<br />
vbody = cstr(Wscript.arguments(3))<br />
vcat = cstr(Wscript.arguments(4))<br />
vbcc = cstr(Wscript.arguments(5))<br />
vcc = cstr(Wscript.arguments(6))<br />
vatt = cstr(Wscript.arguments(7))<br />
vaction = cstr(Wscript.arguments(8))<br />
<br />
set obj = CreateObject(&quot;VBBAAN.BAANVB&quot;)<br />
i = obj.sendBaanEmail(cstr(vfrom), cstr(vto), cstr(vsubject), cstr(vbody), cstr(vcat), cstr(vbcc), cstr(vcc), cstr(vatt), cstr(vaction))<br />
<br />
set obj = Nothing<br />
<br />
<br />
Attach message.</div></div><hr />



</div>
</body>
</html>