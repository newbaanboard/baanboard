<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="Sorting in the report, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] Sorting in the report Tools Development" />
	
	<title>Sorting in the report [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="../index.html">Newbaanboard</a> &gt; <a href="../index.html">Baan Quick Support: Functional &amp; Technical</a> &gt; <a href="../index.html">Tools Development</a> &gt; Sorting in the report</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">mprakash</div><div class="date">20th July 2004, 10:48</div></div><div class="posttext">My requirement:<br />
<br />
Want all the customised items sorted as per the item code excluding the project part in the report (Baa5c)<br />
i.e, item should be sorted from 10th position of the item code<br />
<br />
below Solution tried but doesn't work so need help:<br />
<br />
defined a report input variable itempart and used in the report script to take only item part as shown below<br />
say,<br />
<br />
after.whinr140.item.1:<br />
before.layout:<br />
	itempart = whinr140.item(10;15)<br />
<br />
Sorted the report input variable itempart as ascending with proper sort order.<br />
<br />
Still output is not sorting the way I want<br />
<br />
Question:<br />
Sort order(sort mode and sort seq) defined in the report input varible session will take into consideration if the value of the same variable is changed in the report script? and sort the records according to the new value? (which it got in the report script) <br />
<br />
If this is not the option how can I achieve my requirement? note that we dont have the source</div></div><hr />


<div class="post"><div class="posttop"><div class="username">günther</div><div class="date">20th July 2004, 13:37</div></div><div class="posttext">Have a look at my thread:<br />
<br />
http://www.baanboard.com/baanboard/showthread.php?t=9090&amp;highlight=advanced<br />
<br />
to get the basics.<br />
<br />
Try the following way:<br />
* add a report input variable &quot;itempart&quot; (don't worry about the fact, that that input variable won't be set by the session script).<br />
* sort on that variable  -- This is essential, that bic_gen generates the r.write.seq.file() calls that we use.<br />
* in the report script, add code similiar to my thread, except that you initialized your variable *before* ORIGINALFUNCTION() -- and you can remove the other stuff.<br />
<br />
So it should look like:<br />
<br />
|**<br />
|* Report Script<br />
|**<br />
<br />
declaration:<br />
<br />
|**<br />
|* rename the function that will be generated by bic_repgen<br />
|**<br />
#define ORIGINAL.FUNCTION()     originally.generated.r.write.seq.file()<br />
#define r.write.seq.file()      ORIGINAL.FUNCTION()<br />
<br />
functions:<br />
<br />
#undef  r.write.seq.file()<br />
<br />
function        extern r.write.seq.file()<br />
{<br />
        |**<br />
        |* initialize your sorting variable here, e.g.<br />
        |**<br />
        itempart = whinr140.item(10;15)<br />
<br />
        |**<br />
        |* call the original function<br />
        |**<br />
        ORIGINAL.FUNCTION()<br />
}</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mprakash</div><div class="date">20th July 2004, 16:03</div></div><div class="posttext">Thanks a lot Gunthar!!!!. It worked perfectly! great<br />
<br />
I achieved my results 50%. To achieve it fully I have something left over<br />
<br />
In Baan5, item code includes prefixed project code with it. So in any print session I cannot give a range for only the item part, and get the report for the only specific item (specif item which is there in all the projects)<br />
<br />
for example say A and Z are the projects, A1 and Z1 are the customised items<br />
<br />
If I select the item range in the print session as 1 to Z1, report prints all the items within this range including A1 and Z1. <br />
<br />
How can I get the report output which containes only A1 and Z1 items?? (including 1, A1, B1, C1,.....,Z1)<br />
<br />
Without the sourcecode is it possible to achieve?<br />
<br />
Thanks again</div></div><hr />


<div class="post"><div class="posttop"><div class="username">günther</div><div class="date">21st July 2004, 07:03</div></div><div class="posttext">Hmh, I see. I assume you have a standard session with input fields like cprj.f / cprj.t and item.f / item.t. That session delivers too much data for your requirement. So you could try to filter out the data that you don't want to see on the report itself (well, its not the best performance but anyway).<br />
<br />
Since I only have IVc4, the following might work but is untested:<br />
<br />
|**<br />
|* Report Script<br />
|**<br />
<br />
declaration:<br />
<br />
|**<br />
|* rename the function that will be generated by bic_repgen<br />
|**<br />
#define ORIGINAL.FUNCTION()     originally.generated.r.write.seq.file()<br />
#define r.write.seq.file()      ORIGINAL.FUNCTION()<br />
<br />
functions:<br />
<br />
#undef  r.write.seq.file()<br />
<br />
function        extern r.write.seq.file()<br />
{<br />
        domain tccprj cprj.part<br />
        domain tcitem item.part<br />
<br />
        |**<br />
        |* initialize your variables here<br />
        |**<br />
        cprj.part = ...<br />
        item.part = ...<br />
<br />
        if item.part &gt;= item.f and item.part &lt;= item.t then<br />
            |**<br />
            |* call the original function<br />
            |**<br />
            ORIGINAL.FUNCTION()<br />
        else<br />
            |**<br />
            |* simply do nothing; no spooling<br />
            |**<br />
        endif<br />
}</div></div><hr />



</div>
</body>
</html>