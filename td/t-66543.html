<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="Word formatted text, text.to.buf works not., baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] Word formatted text, text.to.buf works not. Tools Development" />
	
	<title>Word formatted text, text.to.buf works not. [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="../index.html">Newbaanboard</a> &gt; <a href="../index.html">Baan Quick Support: Functional &amp; Technical</a> &gt; <a href="../index.html">Tools Development</a> &gt; Word formatted text, text.to.buf works not.</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">pellus</div><div class="date">18th June 2014, 15:07</div></div><div class="posttext">Hello, I have a text problem. LN fp7.<br />
A text is sometimes formatted with RTF by the user . I get problems to get hold of the text content, for example to use in an xml-file?<br />
<br />
Example:<br />
We have 10 lines (with RTF-formatting) of which the last is &quot;Thankyou and good night&quot;. Looks fine when looking at it in LN text editor. <br />
I do a text.to.buf. In the receiving Array, occurence 10,  I see only &quot;Tha&quot;. All before is fine. But &quot;Tha&quot; is the last I get.<br />
I read the tttxt010 directly. After the last Control characters in the last record, there is only &quot;Tha&quot; <br />
<br />
So how can I get the all textlines, all 10 lines uncorrupted, to use.<br />
<br />
There is a specific flag for rtf in text.to.buf -command but when I use this I get some unreadable data which I can not use.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bdittmar</div><div class="date">18th June 2014, 15:52</div></div><div class="posttext">Hello, I have a text problem. LN fp7.<br />
A text is sometimes formatted with RTF by the user . I get problems to get hold of the text content, for example to use in an xml-file?<br />
<br />
Example:<br />
We have 10 lines (with RTF-formatting) of which the last is &quot;Thankyou and good night&quot;. Looks fine when looking at it in LN text editor. <br />
I do a text.to.buf. In the receiving Array, occurence 10,  I see only &quot;Tha&quot;. All before is fine. But &quot;Tha&quot; is the last I get.<br />
I read the tttxt010 directly. After the last Control characters in the last record, there is only &quot;Tha&quot; <br />
<br />
So how can I get the all textlines, all 10 lines uncorrupted, to use.<br />
<br />
There is a specific flag for rtf in text.to.buf -command but when I use this I get some unreadable data which I can not use.<br />
<br />
Hello,<br />
<br />
for it seems like &quot;buf&quot; maybe to small ?<br />
<br />
text.to.buf()<br />
Syntax:<br />
<br />
function long  text.to.buf  (string text_field, string lang, long nr_lines, ref string buf [, long rtf.text])<br />
<br />
Description<br />
<br />
<br />
This stores the text of a specified text field in a two-dimensional string array.<br />
<br />
<br />
Arguments<br />
<br />
string text_field The name of the text field that must be retrieved. See Text fields overview.<br />
 <br />
string lang This specifies the relevant language.<br />
 <br />
long nr_lines This specifies the maximum number of lines that can be stored in the buffer.<br />
 <br />
ref string buf This specifies the buffer in which the text must be stored.<br />
 <br />
[long rtf.text ] Set this argument to true if you want the text to be stored in RTF format instead of ASCII format. This is possible only when using a text group that supports RTF data.<br />
 <br />
 <br />
Return values<br />
<br />
&gt;0        number of stored lines<br />
<br />
  0        error<br />
<br />
- 1        no permission to store the text<br />
<br />
Check :<br />
<br />
Change Thankyou and good night to to something like 1234567890........ and if your Output is 123 the buffer is too small.<br />
<br />
Regards</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pellus</div><div class="date">19th June 2014, 10:55</div></div><div class="posttext">Thankyou Bernd, bigger buffer solved it.</div></div><hr />



</div>
</body>
</html>