<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="AFS picking data from excel, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] AFS picking data from excel Tools Development" />
	
	<title>AFS picking data from excel [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="../index.html">Newbaanboard</a> &gt; <a href="../index.html">Baan Quick Support: Functional &amp; Technical</a> &gt; <a href="../index.html">Tools Development</a> &gt; AFS picking data from excel</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">dhruv_x0</div><div class="date">18th July 2011, 06:51</div></div><div class="posttext">Hi,<br />
<br />
I am writing AFS for generating a production order, in which item and order quantity should be picked from excel file and then that AFS will be executed.<br />
<br />
How can i get that item and and its quantity from that excel file.<br />
<br />
If anybody have some source code or link, please help me out.<br />
<br />
<br />
<br />
Thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">royspk</div><div class="date">18th July 2011, 07:35</div></div><div class="posttext">YOu can directly convert the excel file to CSV(Comma Seperated Value) File.<br />
Using string.scan() function you can read from this file.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dhruv_x0</div><div class="date">18th July 2011, 07:48</div></div><div class="posttext">Dear royspk,<br />
<br />
There is bulk of data in that file....then how will this string.scan() work.<br />
If You have any source code related to this then please mail me dhruv.333.sharma@gmail.com or paste it here.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">royspk</div><div class="date">18th July 2011, 08:06</div></div><div class="posttext">In the file each field is seperated by | in my case. You can use, or any other field seperator.<br />
<br />
function open.file()<br />
{<br />
fp = seq.open(s.file,&quot;w+&quot;)		<br />
if fp &lt; 1 then<br />
	message(&quot;Error in opening file for data upload.&quot;)<br />
	end()<br />
endif<br />
<br />
process.file()<br />
<br />
seq.close(fp)<br />
}<br />
<br />
function process.file()<br />
{<br />
line.no = 1<br />
	if fp &gt; 0 then<br />
		seq.seek(0, 0, fp)<br />
		while seq.gets(line, 300, fp) = 0 <br />
		{<br />
			ret2 = string.scan(line, &quot;%d|%s|%d|%s|%s|%s|%s|%s|%f|%f|%s|%d|%d|%d|%d|&quot;,<br />
			hold.line,<br />
			hold.item,	|Item<br />
			hold.date,<br />
			hold.cntr,<br />
			hold.cwar,<br />
			hold.loca,<br />
			hold.stun,<br />
			hold.clot,<br />
			hold.stks,<br />
			hold.strs,<br />
			hold.suno,<br />
			hold.oudt,<br />
			hold.cert,<br />
			hold.mfdt,<br />
			hold.mrdt<br />
			)<br />
|			cnt = cnt + 1<br />
			line.no = line.no + 1<br />
		}<br />
	endwhile<br />
endif<br />
}</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dhruv_x0</div><div class="date">18th July 2011, 08:12</div></div><div class="posttext">Thanks royspk....i think it will work.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dhruv_x0</div><div class="date">18th July 2011, 09:09</div></div><div class="posttext">Dear royspk,<br />
<br />
It is not reading any data from the file....file is opened but when it comes to <br />
seq.gets(line,1024,FP)..it gets blank  &quot;line&quot;.<br />
<br />
I have saved that excel file on desktop.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">royspk</div><div class="date">18th July 2011, 13:16</div></div><div class="posttext">Oh no no.<br />
 You need to save the file in text format not notepad.<br />
 Please save the fExcel file in .csv format from save as menu in Excel.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">royspk</div><div class="date">18th July 2011, 13:46</div></div><div class="posttext">Dear Dhruv,<br />
Save the file in .csv or .txt format to be opened in Notepad using Excel Save as Option. <br />
It does not open Excel file directly.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dhruv_x0</div><div class="date">18th July 2011, 14:21</div></div><div class="posttext">Dear roy..<br />
its done..actually it need to be written on server first by client2server()<br />
<br />
<br />
<br />
<br />
Anyways thanks very much.</div></div><hr />



</div>
</body>
</html>