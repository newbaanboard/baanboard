<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="How to write record one by one into the file, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] How to write record one by one into the file Tools Development" />
	
	<title>How to write record one by one into the file [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="../index.html">Newbaanboard</a> &gt; <a href="../index.html">Baan Quick Support: Functional &amp; Technical</a> &gt; <a href="../index.html">Tools Development</a> &gt; How to write record one by one into the file</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">pralash</div><div class="date">6th October 2017, 16:48</div></div><div class="posttext">Hi....<br />
<br />
I'm fresher in LN Programming...I write a data into the file by using seq.puts function.  But I want to know that how to write the data one by one into the file... Is there any switch are available in baan like \n or \t to do this task.  Can anybody please let me know that about this task.<br />
<br />
Regards,<br />
Pralash</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bhushanchanda</div><div class="date">7th October 2017, 07:39</div></div><div class="posttext">Hi Pralash,<br />
<br />
seq.puts() will take care of adding a new line character.<br />
<br />
seq.open(file.name,&quot;w+&quot;)<br />
select ...<br />
from ...<br />
selectdo<br />
       seq.puts(...,fp)  |# Insert data in the text file<br />
endselect<br />
<br />
seq.close(fp)<br />
<br />
So, with every seq.puts() a new line character is added and every record will be added to a new line in the text file.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pralash</div><div class="date">8th October 2017, 17:21</div></div><div class="posttext">Thanks for your information.... But how can I apply the new line char in seq.puts() function...<br />
Thanks,<br />
Pralash</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pralash</div><div class="date">9th October 2017, 08:14</div></div><div class="posttext">Hi, I'm new to LN Programming.  I have stored some data into the file by using seq.open().  But I don't know how to write the record one by one into the file...<br />
We can write the records one by one in &quot;C&quot; Language by using the switch '\n' char...Similarly is there any characters are available in Bann for seq.put() in order to write the records one by one...<br />
Can anybody assist me how to write the record one by one in with sample script...<br />
<br />
Regards,<br />
Senthil</div></div><hr />


<div class="post"><div class="posttop"><div class="username">JaapJD</div><div class="date">9th October 2017, 09:25</div></div><div class="posttext">seq.puts() writes a new line character. So for each line you need to write call the seq,puts() function with the data to write.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bdittmar</div><div class="date">9th October 2017, 10:01</div></div><div class="posttext">Hello,<br />
<br />
avoid double posting, please 1<br />
http://www.baanboard.com/baanboard/showthread.php?t=70483<br />
<br />
Regards</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bhushanchanda</div><div class="date">9th October 2017, 11:05</div></div><div class="posttext">Please do not create new threads if one already exists. As already said and confirmed by Jaap, seq.puts() will add new line character automatically. You just need to pass the string you want to write to the file. <br />
<br />
e.g. Lets write item code and description from tcibd001 to a file.<br />
<br />
string filename(100)<br />
long fp<br />
string str(100)<br />
<br />
filename = creat.tmp.file$( bse.tmp.dir$() ) |# Create temp file<br />
fp = seq.open(filename,&quot;w+&quot;)                    |# Open temp file<br />
<br />
select tcibd001.item, tcibd001.dsca<br />
from tcibd001<br />
selectdo<br />
         str = tcibd001.item &amp; &quot;,&quot; &amp; tcibd001.dsca |# Item Code , Description<br />
         seq.puts(str,fp)                                   |# Write to file<br />
endselect<br />
<br />
seq.close(fp)         |# Close file<br />
<br />
This should create and write the item code and description with comma separator the the output file in bse\temp directory. Each item will be written to a new line.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bhushanchanda</div><div class="date">9th October 2017, 11:06</div></div><div class="posttext">Please do not create new threads if one already exists. Merged threads now. As already said and confirmed by Jaap, seq.puts() will add new line character automatically. You just need to pass the string you want to write to the file. <br />
<br />
e.g. Lets write item code and description from tcibd001 to a file.<br />
<br />
string filename(100)<br />
long fp<br />
string str(100)<br />
<br />
filename = creat.tmp.file$( bse.tmp.dir$() ) |# Create temp file<br />
fp = seq.open(filename,&quot;w+&quot;)                    |# Open temp file<br />
<br />
select tcibd001.item, tcibd001.dsca<br />
from tcibd001<br />
selectdo<br />
         str = tcibd001.item &amp; &quot;,&quot; &amp; tcibd001.dsca |# Item Code , Description<br />
         seq.puts(str,fp)                                   |# Write to file<br />
endselect<br />
<br />
seq.close(fp)         |# Close file<br />
<br />
This should create and write the item code and description with comma separator the the output file in bse\temp directory. Each item will be written to a new line.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pralash</div><div class="date">10th October 2017, 15:34</div></div><div class="posttext">Thanks for your information...<br />
Actually I read record from the table and also store a particular field in the text file...<br />
But some additional value is automatically added with the end of the file as shown in the attachment... Also the records are not added one by one if I using the seq.put function...<br />
Here is my script as follows.<br />
<br />
function extern  control.users.function()<br />
{<br />
	file.name=&quot;c:\erpln\proj\users.txt&quot;<br />
	file.pointer = seq.open(file.name, &quot;w&quot;)<br />
	<br />
	if file.pointer &lt; 0 then<br />
		message(&quot;Can not find the file&quot;)<br />
		e = seq.close(file.pointer)<br />
		exit(1)<br />
	endif<br />
<br />
	select 	tccom200.user<br />
	from	tccom200<br />
	where	tccom200.stus=&quot;inactive&quot; <br />
	selectdo<br />
		user.name=tccom200.user<br />
		seq.puts(strip$(shiftl$(user.name)),file.pointer)<br />
			<br />
	selectempty<br />
<br />
       endselect<br />
}<br />
Can you please assist me to resolving this problem...<br />
Thanks,<br />
Pralash</div></div><hr />


<div class="post"><div class="posttop"><div class="username">JaapJD</div><div class="date">10th October 2017, 15:37</div></div><div class="posttext">You need to do this:<br />
<br />
file.pointer = seq.open(file.name, &quot;wt&quot;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pralash</div><div class="date">11th October 2017, 08:25</div></div><div class="posttext">The issue is resolved right now...<br />
Thanks a lot Jaapjd....<br />
Regards,<br />
Pralash</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bdittmar</div><div class="date">11th October 2017, 10:08</div></div><div class="posttext">Hello,<br />
<br />
seq.open()<br />
Syntax:<br />
<br />
function long  seq.open  (string file, string openmode, ref string pathnm)<br />
<br />
Description<br />
<br />
This opens a specified file. It uses the file $BSE/lib/fd ver.pack_combination to find the file. ver refers to a particular release of the software; pack_combination refers to a particular package combination (see pathname() ).<br />
<br />
Arguments<br />
<br />
string file The file name.<br />
 <br />
string openmode The mode in which the file must be opened. This can be one of the following options:<br />
<br />
&quot;r&quot; Open for reading. The current file position is placed at the start of the file. <br />
&quot;w&quot; Open for writing. The file is created if it does not already exist. The current file position is placed at the start of the file. <br />
&quot;a&quot; Open for writing. The file is created if it does not already exist. The current file position is placed at the end of the file.<br />
<br />
The file position is placed at end of the file before every write statement, even if the previous file action was a seq.seek().<br />
 <br />
&quot;x&quot; Open for writing. This is the same as &quot;w&quot;, except that the function fails if the file already exists. <br />
&quot;r+&quot; Same as &quot;r&quot;, but the file can also be written to. <br />
&quot;w+&quot; Same as &quot;w&quot;, but the file can also be read. <br />
&quot;a+&quot; Same as &quot;a&quot;, but the file can also be read. <br />
&quot;x+&quot; Same as &quot;x&quot;, but the file can also be read. <br />
Use the following modes to indicate whether the file is a binary or a text file. You can combine one of these modes with any one of the previous modes (for example, &quot;rt+&quot;). <br />
&quot;b&quot; Use for binary files. This is the default mode and need not be specified. <br />
&quot;t&quot; The line separator(s) for text-files are different on Windows NT and UNIX systems. CRLF on the former; LF only on the latter. In addition, a Windows NT text file can include an EOF-character (^Z) that indicates the end of the file. This character should not be returned to a program reading the file.<br />
<br />
So, you must specify the &quot;t&quot; option when reading from or writing to a text file on Windows NT systems (for example, &quot;at+&quot;.) This ensures that line separators and EOF characters are handled correctly. Never use the &quot;t&quot; option when opening a binary file; on Windows NT systems this will corrupt the file data. The &quot;t&quot; option has no effect on UNIX systems.<br />
 <br />
 <br />
 <br />
ref string pathnm This returns the full path to the file.<br />
 <br />
 <br />
Return values<br />
<br />
&gt;= 1 Success; File pointer returned for use in subsequent operations. <br />
&lt;1 Error; that is, the negative value of the system error (for example, for a permission error, the system returns 13 and the function returns -13, or if the internal table is full, the function returns -EAGAIN). <br />
<br />
<br />
Regards</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rohithdas</div><div class="date">23rd September 2019, 12:55</div></div><div class="posttext">( bse.tmp.dir$() ) |# Create temp file <br />
 how to create a temp file <br />
on desktop or in becs <br />
on desktop i created tempfile.text</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">23rd September 2019, 17:24</div></div><div class="posttext">I just create a temp file on the server.  Then I user the server2client function to transfer the file to a location on the desktop.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DDPatel</div><div class="date">26th August 2020, 09:14</div></div><div class="posttext">I just create a temp file on the server.  Then I user the server2client function to transfer the file to a location on the desktop.<br />
<br />
Hii,<br />
<br />
How server2client function is actually works?<br />
How can i transfer that file from temp folder to other location (Users Location)?<br />
<br />
Thanks in advance...<br />
Regards,<br />
DDPatel</div></div><hr />


<div class="post"><div class="posttop"><div class="username">andreas.toepper</div><div class="date">26th August 2020, 09:31</div></div><div class="posttext">Be aware that those client access functions are no longer working with LNUI.<br />
<br />
This is a quote from the programmers guide:<br />
<br />
client2server()<br />
Syntax:<br />
#include &lt;bic_desktop&gt;<br />
<br />
function long client2server  (string source, string dest, boolean text.mode [, boolean rm.file] [, boolean progress.window])<br />
<br />
Description<br />
<br />
Deprecated. This copies a specified file from the client to the server. <br />
<br />
<br />
Arguments<br />
string source The source file name, on the client. When this is an empty string, this function will show the file open dialog, through which the user can select an existing file on the client. The function get.local.filename() can be used afterwards to retrieve the actual filename on the client which was copied. The source parameter may include the string ${BSE_TMP} which indicates the ${BSE}\tmp directory in case of Baan Windows or Windows temp directory in case of WebUI. <br />
 <br />
string dest The destination file name, on the server.<br />
 <br />
boolean text.mode This is a boolean value that specifies whether the file is to be copied in text or binary mode: <br />
<br />
true text mode<br />
<br />
false binary mode<br />
 <br />
[boolean rm.file]  Use this optional argument to specify whether the source file must be deleted after it has been copied: <br />
<br />
true source file is deleted<br />
<br />
false source file is not deleted<br />
 <br />
[boolean progress.window]  Use this optional argument to specify whether a progress indicator must be displayed to indicate the progress of the copy action: <br />
<br />
true progress indicator is displayed<br />
<br />
false progress indicator is not displayed<br />
 <br />
 <br />
Return values<br />
0 File copy success. <br />
1 Error. File copy canceled by the user. <br />
&lt;0 Error. Source file not copied to the destination file.  <br />
 <br />
Context<br />
This function is implemented in the 4GL Engine and can be used in all script types. <br />
<br />
This function is marked as 'untrusted' and can therefore only be used in trusted objects. More about trusted and not trusted objects can be found in the section about managed execution.. <br />
<br />
Notes<br />
In order to use a progress indicator, you must first create it with create.progress.indicator(). When you want the progress indicator to start with another value then 0, you must use change.progress.indicator() to change its initial value. If you specify the PROGRESS.STOP and/or PROGRESS.CANCEL modes when creating the indicator, the user can stop or cancel the copy operation before it has completed. In both cases, the destination file is deleted. <br />
This function is not supported in LN UI. See the Implementing LN UI support for more information. <br />
Example<br />
create.progress.indicator(&quot;Title&quot;, PROGRESS.BAR + PROGRESS.STOP)<br />
client2server<br />
      (&quot;C:\Program Files\Test.txt2&quot;, bse.tmp.dir$() &amp;<br />
&quot;/test1.txt&quot;,<br />
      false, false, true)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">GeekGirlAkshara</div><div class="date">3rd September 2020, 08:36</div></div><div class="posttext">How server2client function is actually works?<br />
How can i transfer that file from temp folder to other location (Users Location)?<br />
<br />
<br />
Hi!,<br />
Function server2client copies a specified file from the server to the client.<br />
I'm giving a small code snippet as an example for file creation and transfer using server2client function.<br />
<br />
<br />
function create.file()<br />
{<br />
	string server.input.file(100),server.output.file(100)<br />
	long fp.in,ret<br />
<br />
<br />
	server.input.file             =             creat.tmp.file$(&quot;$BSE/tmp/&quot;) &amp; &quot;File_Name.csv&quot;	<br />
	server.output.file            =             &quot;c:\temp\File_Name.csv&quot;		|The desired path &amp; file name of your client machine <br />
<br />
	fp.in       =             seq.open(server.input.file,&quot;w+&quot;)<br />
 <br />
                process.file()        | Your Functionality<br />
	<br />
        ret          =             seq.close(fp.in)<br />
		<br />
        if get.ui.mode() = 1 then<br />
          		<br />
		server2client(server.input.file,server.output.file,1)	<br />
                message(&quot;Report Generated&quot;)	|If any<br />
		ret = app_start(server.output.file,&quot;c:&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;)<br />
        else<br />
                client.download.file(server.input.file)<br />
        endif<br />
}<br />
<br />
<br />
Regards,<br />
Akshara</div></div><hr />



</div>
</body>
</html>