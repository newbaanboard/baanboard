<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="press ok in a stpapi commande, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] press ok in a stpapi commande Tools Development" />
	
	<title>press ok in a stpapi commande [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="../index.html">Newbaanboard</a> &gt; <a href="../index.html">Baan Quick Support: Functional &amp; Technical</a> &gt; <a href="../index.html">Tools Development</a> &gt; press ok in a stpapi commande</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">blanchap</div><div class="date">5th January 2023, 23:52</div></div><div class="posttext">Hi,<br />
<br />
i have a script that inserts a line in the sales order line session.<br />
but i need to press ok before doing the insert.<br />
<br />
if i insert manually the line, i have a window that pops where i need to press ok to continue and then i save.<br />
<br />
if i do it in the stpapi script, using stpapi.continue.process, it hangs (because i do it before the stp.insert i guess).  how can i select 'ok' in the stpapi?<br />
the message pops after an input on field tdsls041.prdt<br />
<br />
<br />
here is my code<br />
<br />
error.mess = &quot;&quot;<br />
stpapi.put.field(&quot;tdslsc104m000&quot;,&quot;tdsls040.orno&quot;,str$(i.orno))<br />
    ret = stpapi.find(&quot;tdslsc104m000&quot;, error.mess)<br />
    if ret = 1 then<br />
        stpapi.handle.subproc(&quot;tdslsc104m000&quot;,&quot;tdslsc105s000&quot;,&quot;add&quot;)<br />
        stpapi.handle.subproc(&quot;tdslsc104m000&quot;,&quot;tdsls0130s000&quot;,&quot;kill&quot;)<br />
        stpapi.continue.process(&quot;tdslsc104m000&quot;,error.mess)<br />
        stpapi.put.field(&quot;tdslsc105s000&quot;,&quot;tdsls041.orno&quot;,str$(i.orno))<br />
        stpapi.put.field(&quot;tdslsc105s000&quot;,&quot;tdsls041.pono&quot;,str$(i.pono))<br />
	stpapi.put.field(&quot;tdslsc105s000&quot;,&quot;tdsls041.cuno&quot;,tdsls002.cuno)<br />
	stpapi.put.field(&quot;tdslsc105s000&quot;,&quot;tdsls041.citt&quot;,tdsls002.citt)<br />
	stpapi.put.field(&quot;tdslsc105s000&quot;,&quot;tdsls041.item&quot;,k.item)<br />
	stpapi.put.field(&quot;tdslsc105s000&quot;,&quot;tdsls041.cntr&quot;,tdsls002.cntr)<br />
	stpapi.put.field(&quot;tdslsc105s000&quot;,&quot;tdsls041.cprj&quot;,tdsls002.cprj)<br />
	stpapi.put.field(&quot;tdslsc105s000&quot;,&quot;tdsls041.opol&quot;,str$(tdsls002.opol))<br />
	stpapi.put.field(&quot;tdslsc105s000&quot;,&quot;tdsls041.drct&quot;,str$(tdsls002.drct))<br />
	stpapi.put.field(&quot;tdslsc105s000&quot;,&quot;tdsls041.cpva&quot;,tdsls002.cpva)<br />
	find.product.variant()<br />
	stpapi.put.field(&quot;tdslsc105s000&quot;,&quot;tdsls041.sdsc&quot;,str$(tdsls002.sdsc))<br />
	stpapi.put.field(&quot;tdslsc105s000&quot;,&quot;tdsls041.pric&quot;,str$(i.pric))<br />
	stpapi.put.field(&quot;tdslsc105s000&quot;,&quot;tdsls041.plev&quot;,str$(tdsls002.plev))<br />
	stpapi.put.field(&quot;tdslsc105s000&quot;,&quot;tdsls041.stpr&quot;,str$(tdsls002.stpr))<br />
	stpapi.put.field(&quot;tdslsc105s000&quot;,&quot;tdsls041.cups&quot;,tdsls002.cups)<br />
	stpapi.put.field(&quot;tdslsc105s000&quot;,&quot;tdsls041.cvps&quot;,str$(tdsls002.cvps))<br />
	stpapi.put.field(&quot;tdslsc105s000&quot;,&quot;tdsls041.citg&quot;,itm.citg)<br />
	stpapi.put.field(&quot;tdslsc105s000&quot;,&quot;tdsls041.csgs&quot;,itm.csgs)<br />
	stpapi.put.field(&quot;tdslsc105s000&quot;,&quot;tdsls041.odat&quot;,str$(date.num()))<br />
	if tdsls002.dtme &lt;&gt; 0 then<br />
	   stpapi.put.field(&quot;tdslsc105s000&quot;,&quot;tdsls041.ddta&quot;,str$(tdsls002.dtme))<br />
	else<br />
	   stpapi.put.field(&quot;tdslsc105s000&quot;,&quot;tdsls041.ddta&quot;,str$(tdsls002.ddta))<br />
	endif<br />
	stpapi.put.field(&quot;tdslsc105s000&quot;,&quot;tdsls041.oqua&quot;,str$(tdsls002.qtya * i.quantity))<br />
	stpapi.put.field(&quot;tdslsc105s000&quot;,&quot;tdsls041.cuqs&quot;,tdsls002.cuqs)<br />
	stpapi.put.field(&quot;tdslsc105s000&quot;,&quot;tdsls041.cvqs&quot;,str$(tdsls002.cvqs))<br />
	stpapi.put.field(&quot;tdslsc105s000&quot;,&quot;tdsls041.leng&quot;,str$(tdsls002.leng))<br />
	stpapi.put.field(&quot;tdslsc105s000&quot;,&quot;tdsls041.widt&quot;,str$(tdsls002.widt))<br />
	stpapi.put.field(&quot;tdslsc105s000&quot;,&quot;tdsls041.thic&quot;,str$(tdsls002.thic))<br />
	stpapi.put.field(&quot;tdslsc105s000&quot;,&quot;tdsls041.disc&quot;,str$(tdsls002.disc))<br />
	stpapi.put.field(&quot;tdslsc105s000&quot;,&quot;tdsls041.ldam&quot;,str$(tdsls002.ldam))<br />
	stpapi.put.field(&quot;tdslsc105s000&quot;,&quot;tdsls041.dmth&quot;,str$(tdsls002.dmth))<br />
	stpapi.put.field(&quot;tdslsc105s000&quot;,&quot;tdsls041.cdis&quot;,str$(tdsls002.cdis))<br />
	stpapi.put.field(&quot;tdslsc105s000&quot;,&quot;tdsls041.dlev&quot;,str$(tdsls002.dlev))<br />
	stpapi.put.field(&quot;tdslsc105s000&quot;,&quot;tdsls041.cdel&quot;,tdsls002.cdel)<br />
	stpapi.put.field(&quot;tdslsc105s000&quot;,&quot;tdsls041.amta&quot;,str$((tdsls041.oqua * tdsls041.pric) - (tdsls041.oqua * tdsls041.pric * (tdsls041.disc(1) / 100.00))))<br />
	stpapi.put.field(&quot;tdslsc105s000&quot;,&quot;tdsls041.ccty&quot;,tdsls002.ccty)<br />
	stpapi.put.field(&quot;tdslsc105s000&quot;,&quot;tdsls041.cvat&quot;,tdsls002.cvat)<br />
	stpapi.put.field(&quot;tdslsc105s000&quot;,&quot;tdsls041.scom&quot;,str$(tdsls002.scom))<br />
	stpapi.put.field(&quot;tdslsc105s000&quot;,&quot;tdsls041.ctrj&quot;,tdsls002.ctrj)<br />
	stpapi.put.field(&quot;tdslsc105s000&quot;,&quot;tdsls041.prdt&quot;,str$(sales.dates))				<br />
        stpapi.continue.process(&quot;tdslsc105s000&quot;,error.mess)<br />
	stpapi.put.field(&quot;tdslsc105s000&quot;,&quot;tdsls041.cwar&quot;,tdsls002.cwar)<br />
	stpapi.put.field(&quot;tdslsc105s000&quot;,&quot;tdsls041.isss&quot;,str$(tdsls002.isss))<br />
	stpapi.put.field(&quot;tdslsc105s000&quot;,&quot;tdsls041.qono&quot;,str$(tdsls002.qono))<br />
	stpapi.put.field(&quot;tdslsc105s000&quot;,&quot;tdsls041.qpon&quot;,str$(tdsls002.pono))<br />
	ret = stpapi.insert(&quot;tdslsc105s000&quot;,true,error.mess)<br />
            if not isspace(error.mess) then<br />
                    message(error.mess,0)<br />
                    stpapi.recover(&quot;tdslsc105s000&quot;,add.mess)<br />
             endif           <br />
        endif<br />
	stpapi.end.session(&quot;tdsls0130s000&quot;)<br />
	stpapi.end.session(&quot;tdslsc105s000&quot;)<br />
        stpapi.end.session(&quot;tdslsc104m000&quot;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">vinceco252</div><div class="date">6th January 2023, 16:23</div></div><div class="posttext">I think you need the function stpapi.enum.answer.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">9th January 2023, 14:48</div></div><div class="posttext">I think Vincent is correct.  And put the answer before the question pops up. I usually put mine right after I get the session started in the back ground.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">OmeLuuk</div><div class="date">10th January 2023, 14:52</div></div><div class="posttext">... if i insert manually the line, i have a window that pops where i need to press ok to continue and then i save....<br />
This window however gives you a clue on the question asked. The code is mentioned in the caption. Then look up the question to know what enum is used and which answer to select.<br />
You may also be able to get these details on pressing Ctrl-Shift-7 instead of enter...</div></div><hr />



</div>
</body>
</html>