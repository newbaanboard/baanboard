<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="Client ASCII File, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] Client ASCII File Tools Development" />
	
	<title>Client ASCII File [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="../index.html">Newbaanboard</a> &gt; <a href="../index.html">Baan Quick Support: Functional &amp; Technical</a> &gt; <a href="../index.html">Tools Development</a> &gt; Client ASCII File</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">sanjaykathuria</div><div class="date">26th August 2003, 10:09</div></div><div class="posttext">Dear/s All,<br />
<br />
I have ascii file on personal PC i  want to open same file by using any session rather than BaaN Utilities Module. I also don't  want to put same onto server.<br />
<br />
Can provide few commands which i can use sole problem.<br />
<br />
Sanjay Kathuria</div></div><hr />


<div class="post"><div class="posttop"><div class="username">NPRao</div><div class="date">26th August 2003, 10:15</div></div><div class="posttext">Sanjay,<br />
<br />
Refer to - seq.open.local()  (http://www.baanboard.com/programmers_manual_baanerp_help_functions_client_file_access_seq_open_local) <br />
<br />
Also look up for more info about other functions -<br />
<br />
Client file access synopsis  (http://www.baanboard.com/programmers_manual_baanerp_help_functions_client_file_access_synopsis)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sanjaykathuria</div><div class="date">26th August 2003, 11:27</div></div><div class="posttext">When i have used function seq.open.local() message is coming at the time of compiling as Unresolved Refernce to function 'Seq.open.local'.<br />
<br />
<br />
It's Urgent.<br />
<br />
<br />
Sanjay Kathuria</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Juergen</div><div class="date">26th August 2003, 12:03</div></div><div class="posttext">Hi sanjay,<br />
<br />
you have to put<br />
<br />
#pragma used dll ottdllbw<br />
<br />
into the declaration section.<br />
<br />
Rgds,<br />
Juergen</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sanjaykathuria</div><div class="date">26th August 2003, 13:05</div></div><div class="posttext">Thax sir<br />
<br />
It's working.<br />
<br />
Sanjay Kathuria</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sanjaykathuria</div><div class="date">27th August 2003, 12:14</div></div><div class="posttext">Dear/s All.<br />
<br />
I am able to open local system file but still no getting output. <br />
<br />
I am sending code. pls rectify it<br />
<br />
declaration:<br />
    extern string file(128),tts(100)<br />
 <br />
        extern  domain  tfgld.dimx  code<br />
<br />
#pragma used dll ottdllbw<br />
|****************************** Program section **********************************<br />
before.program:<br />
       file = &quot;C:/tt.txt&quot;<br />
       pict()<br />
functions:<br />
function pict()<br />
{<br />
    string bufr(1)  based<br />
    long buflen, fp<br />
    long idc, idp, image<br />
  <br />
    fp = seq.open.local(file, &quot;r&quot;,false)<br />
    <br />
  if fp&gt;=0 then<br />
     message(&quot;ok&quot;)<br />
    seq.rewind(fp)<br />
     seq.gets(tts,100,fp)<br />
     strip$(shiftl$(tts))<br />
    seq.close.local(fp)<br />
 endif<br />
}</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Juergen</div><div class="date">27th August 2003, 12:34</div></div><div class="posttext">Please read the description to seq.open.local() (http://www.baanboard.com/programmers_manual_baanerp_help_functions_client_file_access_seq_open_local) <br />
<br />
You cannot use seq.*() functions in combination with the seq.*.local() functions.<br />
<br />
Rgds,<br />
Juergen</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sanjaykathuria</div><div class="date">27th August 2003, 13:05</div></div><div class="posttext">Dear/s all,<br />
<br />
when i am using seq.*.local family facing problem in function seq.rewind.local and seq.puts.local as  unresolved refence to function seq.rewind.local.<br />
<br />
<br />
Sanjay Kathuria</div></div><hr />


<div class="post"><div class="posttop"><div class="username">NvanBeest</div><div class="date">27th August 2003, 13:20</div></div><div class="posttext">Have a good look at this (http://www.baanboard.com/programmers_manual_baanerp_help_functions_client_file_access_synopsis) list of functions.  These are the ONLY available functions for access to files on the client machine!  There are none other.  :(</div></div><hr />


<div class="post"><div class="posttop"><div class="username">günther</div><div class="date">27th August 2003, 16:06</div></div><div class="posttext">1. You don't need seq.rewind -- you just opened the file.<br />
2. What is &gt;&gt; strip$(shiftl$(tts)) &lt;&lt;?<br />
3. Try something like message( sprintf(&quot;Got &gt;%s&lt;&quot;, strip$(shiftl$(tts))) ).<br />
<br />
Günther</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sanjaykathuria</div><div class="date">28th August 2003, 10:03</div></div><div class="posttext">Dear/s all,<br />
<br />
I am able to open txt file from my local system. but i am not able to read text in the file. pls. arrange all codes for same.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">günther</div><div class="date">28th August 2003, 11:45</div></div><div class="posttext">Okay, here is my example:<br />
<br />
<br />
#define PATHLEN 256<br />
#define BUFSIZ  2048    | 2k<br />
<br />
function pict()<br />
{<br />
        long    fp1, fp2<br />
        long    n, rc, lineno<br />
<br />
        string  fname(PATHLEN)<br />
        string  buf(BUFSIZ)<br />
<br />
        |----------------------------------------------------------------------<br />
        | part 1: copy a local (client-side) file onto the server<br />
        |----------------------------------------------------------------------<br />
   <br />
        fp1 = seq.open.local(file, &quot;r&quot;, false)<br />
        if fp1 &lt; 0 then<br />
                message(&quot;cannot open file %s for reading&quot;, file)<br />
                return<br />
        endif<br />
<br />
        fname = creat.tmp.file$( bse.dir$() )<br />
        fp2 = seq.open(fname, &quot;w&quot;)<br />
        if fp2 &lt; 0 then                    <br />
                message(&quot;cannot open file %s for writing&quot;, fname)<br />
                return<br />
        endif<br />
        repeat<br />
                rc = seq.read.local(buf, n, fp1)<br />
                if rc &lt;&gt; 0 then<br />
                        message(&quot;error in read&quot;)<br />
                        break<br />
                endif<br />
                if n = 0 then<br />
                        | reached EOF<br />
                        break<br />
                endif<br />
<br />
                rc = seq.write(buf, n, fp2)<br />
                if rc &lt;&gt; n then<br />
                        message(&quot;error in write: %d bytes instead %d&quot;, rc, n)<br />
                        break<br />
                endif<br />
        until false<br />
        <br />
        seq.close.local(fp1)<br />
        seq.close(fp2)<br />
<br />
        |----------------------------------------------------------------------<br />
        | part 2: read the file line by line<br />
        |----------------------------------------------------------------------<br />
<br />
        fp2 = seq.open(fname, &quot;r&quot;)<br />
        if fp2 &lt; 0 then<br />
                message(&quot;cannot open file %s for reading&quot;, fname)<br />
                return<br />
        endif<br />
<br />
        | loops as usual<br />
        seq.gets(buf, 100, fp2)<br />
        message(&quot;1st line: '%s'&quot;, buf)<br />
<br />
        seq.gets(buf, 100, fp2)<br />
        message(&quot;2nd line: '%s'&quot;, buf)<br />
<br />
         seq.close(fp2)<br />
<br />
        |----------------------------------------------------------------------<br />
        | part 3: cleanup<br />
        |----------------------------------------------------------------------<br />
<br />
        seq.unlink(fname)<br />
}<br />
<br />
<br />
I decided to copy the client-side &quot;local&quot; file to the server, because there is no seq.local.gets() function.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">NvanBeest</div><div class="date">28th August 2003, 12:24</div></div><div class="posttext">Good example!  But, make your life easier using existing functions. Consider this:<br />
<br />
<br />
        ...<br />
<br />
        long    n, rc, lineno, nrbytes<br />
<br />
        ...<br />
<br />
        |----------------------------------------------------------------------<br />
        | part 1: copy a local (client-side) file onto the server<br />
        |----------------------------------------------------------------------<br />
<br />
        |* Check whether the file exists and can be read<br />
        rc = seq.fstat.local(file, nrbytes)<br />
        if rc &lt; 0 then<br />
                message(&quot;Error %d accessing file %s&quot;, rc, strip$(file))<br />
                return<br />
        endif<br />
        <br />
        |* Copy the file<br />
        fname = creat.tmp.file$(bse.tmp.dir$())<br />
        rc = client2server(file, fname, 0)<br />
        if rc &lt;&gt; 0 then                    <br />
                message(&quot;Error %d: cannot copy file %s to %s&quot;, rc, strip$(file), strip$(fname))<br />
                return<br />
        endif<br />
<br />
        ...</div></div><hr />



</div>
</body>
</html>