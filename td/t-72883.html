<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="SUM Aggregate function, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] SUM Aggregate function Tools Development" />
	
	<title>SUM Aggregate function [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="../index.html">Newbaanboard</a> &gt; <a href="../index.html">Baan Quick Support: Functional &amp; Technical</a> &gt; <a href="../index.html">Tools Development</a> &gt; SUM Aggregate function</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">JanePapa</div><div class="date">13th March 2020, 11:46</div></div><div class="posttext">Hi all,<br />
<br />
I need to use SUM function to calculate the cost of Assembly Order.<br />
I try to develop in LN Studio source code as below but I got the error message &quot;SQLState 42I51: Aggregate function applied to array column (error 302)&quot;<br />
<br />
Could you please advise me about this one ?<br />
<br />
Select 	tiasc710.orno, <br />
		SUM(tiasc710.amto):r.summary<br />
from	tiasc710<br />
where	(tiasc710.tror = 38) and (tiasc710.fitr = 52) <br />
	and ( tiasc710.cocf = &quot;MATTH01&quot;) <br />
group by tiasc710.orno<br />
<br />
Many thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bdittmar</div><div class="date">13th March 2020, 12:19</div></div><div class="posttext">Hello,<br />
<br />
amfr and amto are array fields !<br />
<br />
amfr Amount from tcamnt Double 3 x 8 No Yes Not applicab<br />
amto Amount tcamnt Double 3 x 8 No Yes Not applicab<br />
<br />
<br />
42I51 - Aggregate function applied to array column<br />
An SQL statement contains an expression in which a set function (for example SUM or MAX) is applied to an array column. A set function is also called an aggregate function. <br />
<br />
Example 1<br />
select max(phoneno)<br />
from   dbtst120<br />
   Column phoneno is an array column. A set function like MAX cannot be applied to an array column. The expression MAX(phoneno) will cause the error: <br />
<br />
SQLState 42I51: Aggregate function applied to array column <br />
<br />
Regards</div></div><hr />


<div class="post"><div class="posttop"><div class="username">JanePapa</div><div class="date">16th March 2020, 04:14</div></div><div class="posttext">Hi Bernd,<br />
<br />
Could you please advise can I summary array fields ?<br />
<br />
I need to use summary amount to show on the report.<br />
<br />
Many thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">tmannais</div><div class="date">16th March 2020, 09:03</div></div><div class="posttext">You can do something like this:<br />
<br />
domain tcamnt sum.amto<br />
select ...<br />
from ...<br />
where ...<br />
selectdo<br />
  sum.amto = sum.amto + tiasc710.amto(1)<br />
endselect<br />
<br />
As a result, you will get the sum amount of the field when the query ends.<br />
It's not the best solution though but it works as expected.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">JanePapa</div><div class="date">16th March 2020, 09:40</div></div><div class="posttext">Hi tmannais,<br />
<br />
Thank you for your advise. :)<br />
I try to this solution, it's work.</div></div><hr />



</div>
</body>
</html>