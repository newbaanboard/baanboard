<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="When function marked as string, how to converted back function, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] When function marked as string, how to converted back function Tools Development" />
	
	<title>When function marked as string, how to converted back function [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="../index.html">Newbaanboard</a> &gt; <a href="../index.html">Baan Quick Support: Functional &amp; Technical</a> &gt; <a href="../index.html">Tools Development</a> &gt; When function marked as string, how to converted back function</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">assassinator</div><div class="date">18th March 2010, 11:24</div></div><div class="posttext">When function marked as string, how to converted back function<br />
Now I want to change one Baan default output report to output as txt file in Unix sever. <br />
I meet this trouble. In Statement of Accont Letters, output mode of customer's detail informations had been defined in the header text. Such like: &quot;Customer : $nama&quot;,&quot;$namb&quot;,&quot;$namc&quot; etc. Yes, I can hardcode the output data in txt file. But I can't promise whether user would change them. If them been changed, we should modify the report script angain.<br />
So I want to ask. Is there a method I can use like this. When I get the text data, if there is Baan default functions like &quot;$nama&quot;, &quot;$cuno&quot;, I can obtain the followed results:<br />
customer.name.1 = $nama<br />
customer.name.2 = $namb<br />
output.cuno = $cuno<br />
How can I tell the computer, when it meet string &quot;$nama&quot;, automatically execute function $nama, meet string &quot;$cuno&quot; then execute function $cuno?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">18th March 2010, 15:00</div></div><div class="posttext">Maybe I do not understand something.  To print a baan report as a file all you have to do is define a printer as file.  On the UNIX platform I can print to a file using the ASCIF device - you do not have to change the report.  Just run the report and send it to a file.  So you might need to explain why you need to change the report - I am not understanding that.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bdittmar</div><div class="date">18th March 2010, 17:09</div></div><div class="posttext">When function marked as string, how to converted back function<br />
Now I want to change one Baan default output report to output as txt file in Unix sever. <br />
I meet this trouble. In Statement of Accont Letters, output mode of customer's detail informations had been defined in the header text. Such like: &quot;Customer : $nama&quot;,&quot;$namb&quot;,&quot;$namc&quot; etc. Yes, I can hardcode the output data in txt file. But I can't promise whether user would change them. If them been changed, we should modify the report script angain.<br />
So I want to ask. Is there a method I can use like this. When I get the text data, if there is Baan default functions like &quot;$nama&quot;, &quot;$cuno&quot;, I can obtain the followed results:<br />
customer.name.1 = $nama<br />
customer.name.2 = $namb<br />
output.cuno = $cuno<br />
How can I tell the computer, when it meet string &quot;$nama&quot;, automatically execute function $nama, meet string &quot;$cuno&quot; then execute function $cuno?<br />
<br />
Hello,<br />
<br />
as Mark suggest,<br />
use ASCIIF Device and your Report will be stored at the users homedir.<br />
<br />
Regards</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Hitesh Shah</div><div class="date">18th March 2010, 18:24</div></div><div class="posttext">If i recollect correctly , while maintaining letter header/footer , baan allows u to zoom to a session where u can select all such variables .<br />
<br />
If  u want to use the same text in ur program , u need to set the variable lattr.textexpand variable in ur report script to true . That will actually replace these variables in text with actual runtime values of the variables.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">18th March 2010, 19:09</div></div><div class="posttext">If i recollect correctly , while maintaining letter header/footer , baan allows u to zoom to a session where u can select all such variables .<br />
<br />
If  u want to use the same text in ur program , u need to set the variable lattr.textexpand variable in ur report script to true . That will actually replace these variables in text with actual runtime values of the variables.<br />
<br />
Now that makes much more sense based off the original post.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">assassinator</div><div class="date">19th March 2010, 03:07</div></div><div class="posttext">Maybe I do not understand something.  To print a baan report as a file all you have to do is define a printer as file.  On the UNIX platform I can print to a file using the ASCIF device - you do not have to change the report.  Just run the report and send it to a file.  So you might need to explain why you need to change the report - I am not understanding that.<br />
<br />
OK, that is my false. I didnot explain why I should do a new report instead of use the Baan default report to output NotePad in detail.<br />
According to  Finacial Department's requirement, we should print &quot;Statement of Accounts&quot;, output as many different txt files, which are group by costumers. Each file only includes one customer's invoice data and the file's name is named the costumer's code. For example, one file named &quot;MOTO01&quot;, and the file only includes the invoice data for &quot;MOTO01&quot;. The other one named &quot;SIEM02&quot; and only includes data for &quot;SIEM02&quot;. So that we can send(though Email, Louts Note) the statement files to customers base on the matched file's name. Louts would get customers' Email Address according to the files' name. Baan default NotePad output file can not satify our requirement.<br />
In this case, I should add a new report to achieve.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">22nd March 2010, 02:20</div></div><div class="posttext">Do you own source code?  It would probably be easier with source code.  Then you could sort the data going to the report, create an ascii file for each customer, run report to that file for the customer.<br />
<br />
Almost like this - we run the print production order by priority report to disk.  Then I have another program which pulls out each work center for a user.  The program basically reads in the input file, writes the output for a main work center(to a file or printer), then closes. The program works by parsing each line looking for a work center - does not start printing until it hits the selected main work center and stops as soon as it hits the next main work center.  Something like you were talking about.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">assassinator</div><div class="date">22nd March 2010, 03:07</div></div><div class="posttext">Do you own source code?  It would probably be easier with source code.  Then you could sort the data going to the report, create an ascii file for each customer, run report to that file for the customer.<br />
<br />
Almost like this - we run the print production order by priority report to disk.  Then I have another program which pulls out each work center for a user.  The program basically reads in the input file, writes the output for a main work center(to a file or printer), then closes. The program works by parsing each line looking for a work center - does not start printing until it hits the selected main work center and stops as soon as it hits the next main work center.  Something like you were talking about.<br />
<br />
Yse, it is something like you had done. But there are some difference. We set a job to do this, is differ from manual like your discription. We should output files in Unix Sever, then Lotus reads the files, judges the match Email Address by customers' code. Lotus how to achieve Email address, that is not my concern.<br />
<br />
And I would like to know is how can I execute function which is marked as a string.<br />
<br />
customer.name.1 = &quot;$nama&quot;<br />
Actually execute is: <br />
customer.name.1 = $nama</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pconde</div><div class="date">22nd March 2010, 11:29</div></div><div class="posttext">As far as I understand your problem (correct me if I'm false)<br />
you have a report with a text containing some fields $nama, $cuno that need to be replaced with the data from the report.(field nama, cuno)<br />
I suppose that you use the standard report functionnality <br />
This can be achieved by expanding text variable (see manual for report)<br />
You must set the variable lattr.textexpand=TRUE if you want this to happen. Expressions are internally evaluated by the function expr.compile(). <br />
see http://www.baanboard.com/programmers_manual_baanerp_help_report_scripts_expanding_text_variables<br />
<br />
Regards<br />
Philippe</div></div><hr />


<div class="post"><div class="posttop"><div class="username">assassinator</div><div class="date">22nd March 2010, 15:30</div></div><div class="posttext">As far as I understand your problem (correct me if I'm false)<br />
you have a report with a text containing some fields $nama, $cuno that need to be replaced with the data from the report.(field nama, cuno)<br />
I suppose that you use the standard report functionnality <br />
This can be achieved by expanding text variable (see manual for report)<br />
You must set the variable lattr.textexpand=TRUE if you want this to happen. Expressions are internally evaluated by the function expr.compile(). <br />
see http://www.baanboard.com/programmers_manual_baanerp_help_report_scripts_expanding_text_variables<br />
<br />
Regards<br />
Philippe<br />
<br />
Thanks for your reply. But this is what I want is just the opposite. Now the user had defined the variables in the textline. As before, we used the Baan Standard report would be OK. But now, I want to output as many txt files. So I want to know, how to convert the variables which were used in the text to output data.<br />
Examples of what you said, and I met is very similar to.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Hitesh Shah</div><div class="date">22nd March 2010, 17:26</div></div><div class="posttext">u may either run the report in AFS or fix the variable position in letter text and let lotus notes use that fixed positioned information to send the same to right people.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pconde</div><div class="date">22nd March 2010, 22:55</div></div><div class="posttext">Hi,<br />
<br />
the first option that I see is printing to a file (device ascif) closing the file after each customer. ==&gt; you  need modifying the session script<br />
Second option is to do what the report script does <br />
analyze the text, extracting the variable starting with $ and replace using expr.compile and s.expr <br />
see http://www.baanboard.com/programmers_manual_baanerp_help_functions_expressions_runtime_expr_compile<br />
A lot of programming if you want also suppressing the blank characters;:D<br />
<br />
Good luck<br />
Philippe</div></div><hr />


<div class="post"><div class="posttop"><div class="username">assassinator</div><div class="date">23rd March 2010, 05:48</div></div><div class="posttext">OK, I have tested the expr.compile(), but it isnot work. And I read a lot of the related posts, most of them were output as Baan standard report. The other were not like as I met. I do not get the &quot;device ascif&quot;, is it means to printed as Notepad?<br />
 <br />
Now my script is lile this:<br />
<br />
........<br />
file.name = strip$(store.file.path) &amp; strip$(shiftl$(cuno)) &amp; &quot;.txt&quot;<br />
file.no = seq.open.local(file.name, &quot;w&quot;, false)<br />
........<br />
if text.to.buf(&quot;htxt&quot;, report.language, MAX.TEXT.LINE, text.line) &gt; 0 then<br />
for i = 1 to MAX.TEXT.LINE<br />
tmp.str = strip$(shiftl$(text.line(1,i)))<br />
Then the string array text.line are:<br />
 <br />
text.line(1,1) = &quot;Customer : $nama Customer A/C : $cuno&quot;<br />
text.line(1,2) = &quot; : $namb&quot;<br />
 ........<br />
<br />
So, how can I get the result to be this:<br />
 <br />
tmp.str = &quot;Customer : VISTEON KOREA CO.LTD. Customer A/C : CVIS12&quot;<br />
tmp.str = &quot; YESAN PLANT, 2-5 YONGGUNG-RI&quot; <br />
........<br />
<br />
 <br />
Thanks!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rahul.kolhe22</div><div class="date">23rd March 2010, 09:12</div></div><div class="posttext">Hi,<br />
     I would like to suggest another option for achieving this:<br />
<br />
If the format of text TEXT is going to be fixed like:<br />
<br />
text.line(1,1) = &quot;Customer : $nama Customer A/C : $cuno&quot;<br />
text.line(1,2) = &quot; : $namb&quot;<br />
.....<br />
<br />
<br />
then try modifying this text to<br />
<br />
text.line(1,1) = &quot;Customer : %1$s Customer A/C : %2$s&quot;<br />
text.line(1,2) = &quot; : %1$s&quot;<br />
.....<br />
<br />
<br />
Once you get this text in some string varibale you can substitute the variable value in the string using sprintf$ function. eg:<br />
<br />
|* If variable tmp.str = &quot;Customer : %1$s Customer A/C : %2$s&quot; then<br />
tmp.str = sprintf$(tmp.str, nama, cuno)<br />
<br />
<br />
Hope I understand your problem correctelly and this solution helps you.<br />
<br />
Regards,<br />
--Rahul</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Hitesh Shah</div><div class="date">23rd March 2010, 19:28</div></div><div class="posttext">U r reading text in array and want to replace the variable values therein . But in fact there is no need whatsoever to do so much effort .  U print the text to a report with right input variables and the text in the report will have right values . And re-direct the output to whatever file u want.<br />
<br />
Maybe i am missing something . please elaborate so everybody incl me can give right answers in that case.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">assassinator</div><div class="date">24th March 2010, 05:52</div></div><div class="posttext">Hi,<br />
I would like to suggest another option for achieving this:<br />
 <br />
If the format of text TEXT is going to be fixed like:<br />
 <br />
 <br />
then try modifying this text to<br />
 <br />
 <br />
Once you get this text in some string varibale you can substitute the variable value in the string using sprintf$ function. eg:<br />
|* If variable tmp.str = &quot;Customer : %1$s Customer A/C : %2$s&quot; then<br />
tmp.str = sprintf$(tmp.str, nama, cuno) <br />
Hope I understand your problem correctelly and this solution helps you.<br />
 <br />
Regards,<br />
--Rahul<br />
 <br />
Thanks for your reply. <br />
But you had some mistake. Yes your method was work, but the main key point and also is what I wonder to know is that how to know we should use tmp.str = sprintf$(tmp.str, nama, cuno)  or use tmp.str = sprintf$(tmp.str, namb)  or use tmp.str = sprintf$(tmp.str, cpay)  or tmp.str = sprintf$(tmp.str, cdec) . The varibales in the textline was unknow and maybe not static.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rahul.kolhe22</div><div class="date">24th March 2010, 07:37</div></div><div class="posttext">Hi,<br />
        For the alternative which I suggested, I have specified a condition:<br />
If the format of text TEXT is going to be fixed <br />
<br />
Anyways, I even would like to suggest you one more option.<br />
<br />
1.  You are getting all the data in the text in an array of a string. (in your case here, you get it in text.line variable). That is fine<br />
<br />
2. Then try to concat all the sentences with some an appropriate seperator (sample code: hold.str = text.line(1,1) &amp; &quot;|&quot; &amp; text.line(1,2) &amp; ...). Just take care that concating all the text to form a single string does not exceed the length of your string variable i.e. hold.str<br />
<br />
3. Now you can just mention to the person who will maintain the text that where the expect to print &quot;Customer&quot; use %1$s, &quot;Customer A/C&quot; use %2$s<br />
<br />
4. Then use sprintf$ function to replace %1$s with value of nama, %2$s with cuno.<br />
<br />
5. Here you have to fix the sequence like:<br />
%1$s for Customer<br />
%2$s for Customer A/C<br />
.....<br />
<br />
Again please take care that, in text if user types say for example %5$s and you are passing only 4 variables to be substituted in the string then it will give fatal e.g.: sprintf$(&quot;Var1 = %1$s, Var2 = %2$s&quot;, &quot;abc&quot;)<br />
<br />
But passing an extra variable will not create any problem. e.g. <br />
sprintf$(&quot;Var1 = %1$s, Var2 = %2$s&quot;, &quot;abc&quot;, &quot;xyz&quot;, &quot;ijk&quot;)<br />
<br />
This option I think will give some flexibility as compared to previous I mention for the person who will maintain the TEXT and will also reduce some chances of error.<br />
<br />
Hope I am clear and it helps you.<br />
<br />
Regards,<br />
--Rahul</div></div><hr />


<div class="post"><div class="posttop"><div class="username">assassinator</div><div class="date">24th March 2010, 08:40</div></div><div class="posttext">U r reading text in array and want to replace the variable values therein . But in fact there is no need whatsoever to do so much effort . U print the text to a report with right input variables and the text in the report will have right values . And re-direct the output to whatever file u want.<br />
 <br />
Maybe i am missing something . please elaborate so everybody incl me can give right answers in that case.<br />
 <br />
Thanks for your attention.<br />
text.line(1,1) = &quot;Customer : $nama Customer A/C : $cuno&quot;<br />
text.line(1,2) = &quot; : $namb&quot;<br />
Then write the resturn string to txt files would be like this in the statement header:<br />
<br />
Customer : $nama                                 Customer A/C : $cuno<br />
$namb $cpay<br />
<br />
This is not I want. I would get the variables return values. <br />
<br />
$nama = &quot; VISTEON KOREA CO.LTD.&quot;<br />
$cuno = &quot;CVIS12&quot;<br />
$namb = &quot;YESAN PLANT, 2-5 YONGGUNG-RI&quot;<br />
<br />
So that the output statement files' header like this:<br />
Customer : VISTEON KOREA CO.LTD.                                 Customer A/C : CVIS12<br />
YESAN PLANT, 2-5 YONGGUNG-RI <br />
And as you said to output the right variables' value to a reprot. I know it would work, but I should output two type reoprts. One is store the right text data, the other are customers' statement files. It is so trouble.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">assassinator</div><div class="date">24th March 2010, 08:57</div></div><div class="posttext">Hi,<br />
For the alternative which I suggested, I have specified a condition:<br />
 <br />
 <br />
Anyways, I even would like to suggest you one more option.<br />
 <br />
1. You are getting all the data in the text in an array of a string. (in your case here, you get it in text.line variable). That is fine<br />
 <br />
2. Then try to concat all the sentences with some an appropriate seperator (sample code: hold.str = text.line(1,1) &amp; &quot;|&quot; &amp; text.line(1,2) &amp; ...). Just take care that concating all the text to form a single string does not exceed the length of your string variable i.e. hold.str<br />
 <br />
3. Now you can just mention to the person who will maintain the text that where the expect to print &quot;Customer&quot; use %1$s, &quot;Customer A/C&quot; use %2$s<br />
 <br />
4. Then use sprintf$ function to replace %1$s with value of nama, %2$s with cuno.<br />
 <br />
5. Here you have to fix the sequence like:<br />
%1$s for Customer<br />
%2$s for Customer A/C<br />
.....<br />
 <br />
Again please take care that, in text if user types say for example %5$s and you are passing only 4 variables to be substituted in the string then it will give fatal e.g.: sprintf$(&quot;Var1 = %1$s, Var2 = %2$s&quot;, &quot;abc&quot;)<br />
 <br />
But passing an extra variable will not create any problem. e.g. <br />
sprintf$(&quot;Var1 = %1$s, Var2 = %2$s&quot;, &quot;abc&quot;, &quot;xyz&quot;, &quot;ijk&quot;)<br />
 <br />
This option I think will give some flexibility as compared to previous I mention for the person who will maintain the TEXT and will also reduce some chances of error.<br />
 <br />
Hope I am clear and it helps you.<br />
 <br />
Regards,<br />
--Rahul<br />
 <br />
Thank you.<br />
But as you know, this text had been used in so many reports, so we cannot use the method like you suggest. :(<br />
In case we can modify the text, as well I hardcode the statement header to get the fields (like &quot;nama&quot;, &quot;namb&quot;, &quot;namc&quot;) values is better.:D</div></div><hr />


<div class="post"><div class="posttop"><div class="username">goooch</div><div class="date">25th March 2010, 10:41</div></div><div class="posttext">Hi<br />
In my opinion, Mark is right<br />
You have already got the standard report, so you can modify it to put data in order you want.<br />
Add special marks (f.e. -----CUNO START HEAR:&lt;CUNO&gt;) in before field layout<br />
And use this information in your parsing script that devides your total report into parts.<br />
It is no mater if there is a job or any user starts this task. The program may be outer or new device script, or AFS, or something else. There are many variants. <br />
<br />
But<br />
If you will make a new version of 'r_print_text' function, I ask you to share it with me. <br />
<br />
Best regards,<br />
goooch</div></div><hr />


<div class="post"><div class="posttop"><div class="username">assassinator</div><div class="date">29th March 2010, 11:51</div></div><div class="posttext">OK, I still did not get your point. How to use Baan standard report output txt files which are divided up by customers' name. Because I had not did this before. <br />
So I had hardcode the information data to each customer.<br />
<br />
Thanks for your replies.</div></div><hr />



</div>
</body>
</html>