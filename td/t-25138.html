<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="Trying to utilise &quot;TEXT.READ&quot; function, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] Trying to utilise &quot;TEXT.READ&quot; function Tools Development" />
	
	<title>Trying to utilise &quot;TEXT.READ&quot; function [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="../index.html">Newbaanboard</a> &gt; <a href="../index.html">Baan Quick Support: Functional &amp; Technical</a> &gt; <a href="../index.html">Tools Development</a> &gt; Trying to utilise &quot;TEXT.READ&quot; function</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">GillSmith</div><div class="date">19th September 2005, 18:22</div></div><div class="posttext">I am trying to utilise the &quot;TEXT.READ&quot; function to read text within a program script, as i need to set up a sort on a value in the text. I call the routine with the string text_field set to a valid text number, and the texting sub-process is launched, which I didn't expect. I hoped that the text for that text number would be returned in the field tmp_file. I also tried running it with the text number in both text_field and tmp_file, but it still launched the sub-process. This is the code I am using:<br />
<br />
string txt_f(17),lang,tmp_file(128)<br />
string kw1(17) mb, kw2(17) mb, kw3(17) mb, kw4(17) mb, tgroup(8), edit_opt(15)<br />
long lock,i,xtxt<br />
txt_f=str$(tipcs022.txta)<br />
if tipcs022.txta&gt;0 then<br />
xtxt = text.read(txt_f, lang, kw1, kw2, kw3, kw4, tgroup, edit_opt, tmp_file, lock)<br />
<br />
At this point it immediately launches the sub-process, and returns &quot;&quot; in both txt_f and tmp_file. Any ideas please?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">just_fro</div><div class="date">20th September 2005, 00:45</div></div><div class="posttext">Seems you're making this a bit to complex....<br />
since you have the textnumber you could simply get the value of the string(s) in table tttxt010.....</div></div><hr />


<div class="post"><div class="posttop"><div class="username">nikos1</div><div class="date">20th September 2005, 08:17</div></div><div class="posttext">Hi, <br />
<br />
try this:<br />
xtxt = text.read(&quot;tipcs022.txta&quot;, lang, kw1, kw2, kw3, kw4, tgroup, edit_opt, tmp_file, lock)<br />
It should work.<br />
<br />
Another option is the function text.to.buf:<br />
string	tmp.buf(80, 2)<br />
<br />
xtxt = text.to.buf(&quot;tipcs022.txta&quot;, language$, 2, tmp.buf)<br />
<br />
Regards</div></div><hr />


<div class="post"><div class="posttop"><div class="username">GillSmith</div><div class="date">20th September 2005, 11:46</div></div><div class="posttext">Thankyou. The first option stopped the texting sub-process running, but still returned zero, and no text. So possibly this function is not working as intended? The second option worked beautifully.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">GillSmith</div><div class="date">20th September 2005, 11:47</div></div><div class="posttext">Seems you're making this a bit to complex....<br />
since you have the textnumber you could simply get the value of the string(s) in table tttxt010.....<br />
 Agreed, and I had been doing this as a work-around. I felt to use a designed function was neater.</div></div><hr />



</div>
</body>
</html>