<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="as set with 1 rows, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] as set with 1 rows Tools Development" />
	
	<title>as set with 1 rows [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="../index.html">Newbaanboard</a> &gt; <a href="../index.html">Baan Quick Support: Functional &amp; Technical</a> &gt; <a href="../index.html">Tools Development</a> &gt; as set with 1 rows</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">django25</div><div class="date">19th March 2009, 13:21</div></div><div class="posttext">Sir/Madam<br />
What does the sql statement &quot;as set with 1 rows&quot; do.<br />
Regards<br />
Django</div></div><hr />


<div class="post"><div class="posttop"><div class="username">george7a</div><div class="date">19th March 2009, 13:30</div></div><div class="posttext">Hi,<br />
<br />
With this option you can indicate the maximum number of records the query can produce<br />
Source:<br />
http://www.baanboard.com/programmers_manual_baanerp_help_functions_database_handling_set_specification<br />
<br />
I hope it helps,<br />
<br />
- George</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ashraf_here</div><div class="date">19th March 2009, 13:42</div></div><div class="posttext">it improves the performance of the queries by letting the bshell to know the number of rows to fetch from the table beforehand itself.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">baan.kmurali</div><div class="date">19th March 2009, 14:07</div></div><div class="posttext">this is used to get the no of records from the table.<br />
ex:<br />
   as set with 1 rows - returns the first record of the of the particualr table and if you use order by fieldname desc, it will get last record.<br />
   as set with 5 rows  - returns the first five records of the particuar table.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">django25</div><div class="date">19th March 2009, 14:10</div></div><div class="posttext">Thanks Sir</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MilindV</div><div class="date">10th February 2011, 07:20</div></div><div class="posttext">Hi All,<br />
<br />
I want to know how exactly as set with 'n' rows works?<br />
How it help in increasing the performance?<br />
Is it required to use in a query which is going to return me a unique record?<br />
e.g. select	tccom100.nama<br />
from	tccom100<br />
where	tccom100._index1 = {:i.bpid}<br />
|* as set with 1 rows<br />
selectdo<br />
endselect<br />
Will using as set with 1 rows in this query improve the performance?<br />
<br />
I have read all above post. But I want to know 'HOW' it works and 'HOW' it improves the performance in case of above example if it really does?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">10th February 2011, 15:31</div></div><div class="posttext">From baan optimization guide:<br />
<br />
Problem<br />
Extra communication is done in the level 2 driver on each query to know whether<br />
more records are present or not. This creates some overhead.<br />
Solution<br />
If the number of returning records is known beforehand, implement the as set with x<br />
rows.<br />
It is especially preferable for situations where the select statement has a high hit ratio<br />
(frequently carried out).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">skgupta</div><div class="date">11th February 2011, 13:30</div></div><div class="posttext">as set with 1 rows selected the last record of the condition selection.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Hitesh Shah</div><div class="date">12th February 2011, 10:39</div></div><div class="posttext">as set with 1 rows is also used in many cases when the program logic so requires like whether any matching record exists or to get the highest or lowest number (used in conjunction with order by clause) .</div></div><hr />


<div class="post"><div class="posttop"><div class="username">MilindV</div><div class="date">12th February 2011, 18:51</div></div><div class="posttext">Thanks Mark,<br />
<br />
This is what I was looking for. But after reading, this next question that pops in my mind is, why even for the index, there is a second search in level 2 driver?<br />
But at least I found the valid/correct reason why I have to use as set with 1 rows even in case of index.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">shekhawatr</div><div class="date">12th February 2011, 19:25</div></div><div class="posttext">Dear MilindV,<br />
no this command will select only 1 record from the table instead of unique record.<br />
<br />
if you want to pick only 1 record from the multiple lines/record<br />
then you can use this command, but not for the unique record.<br />
<br />
example :<br />
<br />
table have records<br />
<br />
code	Date		intime	 	outtime<br />
A001	01-01-2010	10.10		10.30<br />
A001	01-01-2010	11.00		11.30<br />
A001	01-01-2010	12.00		02.00<br />
<br />
if you want to pick last record from the table then query will be.<br />
<br />
<br />
select tablename.* <br />
from tablename<br />
where tablename._index1 ={:}<br />
order by index1 desc<br />
as set with 1 rows<br />
selectdo<br />
endselect</div></div><hr />



</div>
</body>
</html>