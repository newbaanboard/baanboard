<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="Total Aggregate Function?, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] Total Aggregate Function? Tools Development" />
	
	<title>Total Aggregate Function? [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="../index.html">Newbaanboard</a> &gt; <a href="../index.html">Baan Quick Support: Functional &amp; Technical</a> &gt; <a href="../index.html">Tools Development</a> &gt; Total Aggregate Function?</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">Eddie Monster</div><div class="date">8th March 2002, 18:38</div></div><div class="posttext">I have a report written by one of the consultants that aided us in our implementation.  The consultant used the Total Aggreagate Function to get the total for a grouping.  For Example (report layouts)...<br />
<br />
Detail Record 1:  variable amnt.copr = 100.00<br />
Detail Record 1:  variable amnt.copr = 230.00<br />
Detail Record 1:  variable amnt.copr = 900.00<br />
<br />
After.grouping:  variable amnt.corp = 1123.00<br />
<br />
The same report field variable is used in the detail section and the after.grouping section of the report, but because the after.grouping report field has the aggregate function set to 'Total', the total is printing.  I understand the functionality.<br />
<br />
However, I am now trying to use a db.insert command to populate a new table with the grouping totals for this report (to be used with another session).  When I run the report, the report prints as it always has, and I get data in my table where I want to, but instead of getting the value 1123 for amnt.copr I get 900.  Is there any way to get the total aggregate value of amnt.copr?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">8th March 2002, 19:33</div></div><div class="posttext">Hello Eric!<br />
<br />
You can run the report in debug mode and see which of the total fields has the value you are looking for - by this I mean the total..1,total..2 fields. Each field that you do a total on gets a variable like this. Just remember that if you use this type of variable and you change the report, then the total..x variable may change.  I do not recommend this and I even use it in some cases.  <br />
<br />
The way I would do this, is in the report script create a new variable. Then in the detail event(after layout) I would add the value to the new variable.  Then use this to update the table - much cleaner and easier to update. <br />
<br />
Mark<br />
<br />
Quick example<br />
<br />
declaration:<br />
extern double x<br />
<br />
before.program:<br />
x=0<br />
<br />
detail.1:<br />
after.layout:<br />
  x = x + amnt.copr</div></div><hr />



</div>
</body>
</html>