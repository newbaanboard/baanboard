<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="Problemas con subsesión tdilc4113s000 desde sesión tisfc0202m000, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] Problemas con subsesión tdilc4113s000 desde sesión tisfc0202m000 AFS/DDC/OLE: Function servers" />
	
	<title>Problemas con subsesión tdilc4113s000 desde sesión tisfc0202m000 [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="index.html">Newbaanboard</a> &gt; <a href="index.html">Baan SIGs</a> &gt; <a href="index.html">AFS/DDC/OLE: Function servers</a> &gt; Problemas con subsesión tdilc4113s000 desde sesión tisfc0202m000</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">RafaPros</div><div class="date">25th October 2016, 10:29</div></div><div class="posttext">He probado con todas las posibilidades que he encontrado en el foro y no hay manera de conseguir que funcione correctamente:<br />
<br />
 Baanobj.ParseExecFunction(&quot;ottstpapihand&quot;, &quot;stpapi.put.field(&quot; &amp; Chr(34) &amp; Sesion &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; &quot;tisfc001.cprj&quot; &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; codobra &amp; Chr(34) &amp; &quot;)&quot;)<br />
            Baanobj.ParseExecFunction(&quot;ottstpapihand&quot;, &quot;stpapi.put.field(&quot; &amp; Chr(34) &amp; Sesion &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; &quot;tisfc001.mitm&quot; &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; articulo &amp; Chr(34) &amp; &quot;)&quot;)<br />
<br />
            If Baanobj.Error &lt;&gt; 0 Then<br />
                ErrDon = &quot;Error al poner valor de Obra y Pieza&quot;<br />
                MsgBox(&quot;Baan IV automatización  &quot; &amp; Baanobj.Error &amp; vbCrLf &amp; &quot;Valor de retorno de la función: &quot; &amp; Baanobj.Error.ToString &amp; vbCrLf &amp; &quot;Donde: &quot; &amp; ErrDon)<br />
                Baanobj.ParseExecFunction(&quot;ottstpapihand&quot;, &quot;stpapi.end.session(&quot; &amp; Chr(34) &amp; Sesion &amp; Chr(34) &amp; &quot;)&quot;)<br />
                Baanobj.Quit<br />
                Baanobj = Nothing<br />
                Exit Sub<br />
            End If<br />
<br />
            RetVal = Baanobj.ParseExecFunction(&quot;ottstpapihand&quot;, &quot;stpapi.find(&quot; &amp; Chr(34) &amp; Sesion &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; valor &amp; Chr(34) &amp; &quot;)&quot;)<br />
            Dim tempstr2 = Baanobj.FunctionCall<br />
            ' MsgBox(&quot;PARADA DE COMPROBACION, RESULTADO DE FIND =  &quot; &amp; tempstr2)<br />
            If Baanobj.Error &lt;&gt; 0 Then<br />
                ErrDon = &quot;Error en la búsqueda de la OF &quot; &amp; OF_cod<br />
                MsgBox(&quot;Baan IV automatización  &quot; &amp; Baanobj.Error &amp; vbCrLf &amp; &quot;Valor de retorno de la función: &quot; &amp; Baanobj.Error.ToString &amp; vbCrLf &amp; &quot;Donde: &quot; &amp; ErrDon)<br />
                Baanobj.ParseExecFunction(&quot;ottstpapihand&quot;, &quot;stpapi.end.session(&quot; &amp; Chr(34) &amp; Sesion &amp; Chr(34) &amp; &quot;)&quot;)<br />
                Baanobj.Quit<br />
                Baanobj = Nothing<br />
                Exit Sub<br />
            End If<br />
 Baanobj.ParseExecFunction(&quot;ottstpapihand&quot;, &quot;stpapi.get.field(&quot; &amp; Chr(34) &amp; Sesion &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; &quot;tisfc001.pdno&quot; &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; valor &amp; Chr(34) &amp; &quot;)&quot;)<br />
If V_pdno &lt;&gt; CInt(tempstr2) Then<br />
                MsgBox(&quot;Hay un problema entre el número de orden leida en el grid (&quot; &amp; V_pdno &amp; &quot;) y el número obtenido en BaaN (&quot; &amp; CInt(tempstr2) &amp; &quot;)&quot;)<br />
                Baanobj.ParseExecFunction(&quot;ottstpapihand&quot;, &quot;stpapi.end.session(&quot; &amp; Chr(34) &amp; Sesion &amp; Chr(34) &amp; &quot;)&quot;)<br />
                Baanobj.Quit<br />
                Baanobj = Nothing<br />
                Exit Sub<br />
                ' V_pdno = CInt(tempstr2)<br />
            End If<br />
Baanobj.ParseExecFunction(&quot;ottstpapihand&quot;, &quot;stpapi.put.field(&quot; &amp; Chr(34) &amp; Sesion &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; &quot;qdlv.frm&quot; &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; valor &amp; Chr(34) &amp; &quot;)&quot;)<br />
 Baanobj.ParseExecFunction(&quot;ottstpapihand&quot;, &quot;stpapi.put.field(&quot; &amp; Chr(34) &amp; Sesion &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; &quot;tisfc001.dldt&quot; &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; Temp_fecha1 &amp; Chr(34) &amp; &quot;)&quot;)<br />
 Baanobj.ParseExecFunction(&quot;ottstpapihand&quot;, &quot;stpapi.get.field(&quot; &amp; Chr(34) &amp; Sesion &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; &quot;tisfc001.qrdr&quot; &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; valor &amp; Chr(34) &amp; &quot;)&quot;)<br />
                    tempstr = Baanobj.FunctionCall<br />
                    tempstr = Mid(tempstr, 25 + Len(Sesion) + 13, 3)<br />
                    total = Val(tempstr)<br />
<br />
                    Baanobj.ParseExecFunction(&quot;ottstpapihand&quot;, &quot;stpapi.get.field(&quot; &amp; Chr(34) &amp; Sesion &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; &quot;qdlv.frm&quot; &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; valor &amp; Chr(34) &amp; &quot;)&quot;)<br />
                    Dim tempstr1 = Baanobj.FunctionCall<br />
                    tempstr1 = Mid(tempstr1, 25 + Len(Sesion) + 8, 3)<br />
                    cantidad1 = Val(tempstr1)<br />
<br />
                    'Controlamos que la serie de &quot; &amp; tempstr2 &amp; &quot; esté o no completa  &quot; &amp; cantidad1.ToString &amp; &quot; de &quot; &amp; total.ToString)<br />
                    If cantidad1 = total Then<br />
                        RetVal = Baanobj.ParseExecFunction(&quot;ottstpapihand&quot;, &quot;stpapi.put.field(&quot; &amp; Chr(34) &amp; Sesion &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; &quot;comp.frm&quot; &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; &quot;1&quot; &amp; Chr(34) &amp; &quot;)&quot;)<br />
                    Else<br />
                        RetVal = Baanobj.ParseExecFunction(&quot;ottstpapihand&quot;, &quot;stpapi.put.field(&quot; &amp; Chr(34) &amp; Sesion &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; &quot;comp.frm&quot; &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; &quot;2&quot; &amp; Chr(34) &amp; &quot;)&quot;)<br />
                    End If<br />
RetVal = Baanobj.ParseExecFunction(&quot;ottstpapihand&quot;, &quot;stpapi.enum.answer(&quot; &amp; Chr(34) &amp; Sesion &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; &quot;tisfc02023&quot; &amp; Chr(34) &amp; &quot;,&quot; &amp; &quot;1&quot; &amp; &quot;)&quot;)<br />
RetVal = Baanobj.ParseExecFunction(&quot;ottstpapihand&quot;, &quot;stpapi.enum.answer(&quot; &amp; Chr(34) &amp; Sesion &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; &quot;tisfc02024&quot; &amp; Chr(34) &amp; &quot;,&quot; &amp; &quot;1&quot; &amp; &quot;)&quot;)<br />
RetVal = Baanobj.ParseExecFunction(&quot;ottstpapihand&quot;, &quot;stpapi.enum.answer(&quot; &amp; Chr(34) &amp; Sesion &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; &quot;tisfc02029&quot; &amp; Chr(34) &amp; &quot;,&quot; &amp; &quot;1&quot; &amp; &quot;)&quot;)<br />
 RetVal = Baanobj.parseexecfunction(&quot;ottstpapihand&quot;, &quot;stpapi.handle.subproc(&quot; &amp; Chr(34) &amp; Sesion &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; subsesion &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; &quot;add&quot; &amp; Chr(34) &amp; &quot;)&quot;)<br />
                        If Baanobj.error &lt;&gt; 0 Then<br />
                            MsgBox(&quot;¡¡¡¡¡¡¡¡¡¡¡¡¡¡¡¡¡¡Error al lanzar la subsesión &quot; &amp; subsesion &amp; &quot;, Handle = &quot; &amp; Baanobj.error &amp; &quot; obj &quot; &amp; Baanobj.ToString)<br />
                        End If<br />
'*******************************************************************************************************************<br />
                '* 25/10/2016 - Rafa Pros - Esta sección se utiliza para probar las posibles soluciones encontradas *<br />
                '*                          No se corresponde con lo que es la secuencia lógica de instrucciones                   *<br />
                '*******************************************************************************************************************<br />
                RetVal = Baanobj.ParseExecFunction(&quot;ottstpapihand&quot;, &quot;stpapi.end.session(&quot; &amp; Chr(34) &amp; Sesion &amp; Chr(34) &amp; &quot;)&quot;)<br />
                If RetVal &lt;&gt; 0 Then<br />
                    MsgBox(&quot;*** ERROR *** end.session tisfc0202m000&quot;)<br />
                End If<br />
<br />
                MsgBox(&quot;PARADA DE COMPROBACION, ENTRADA EN PUESTA DE DATOS 4113 - QSTC, SUBSESIÓN =  &quot; &amp; subsesion)<br />
<br />
Hasta aquí, se supone que, funciona bien. No da ningún tipo de error,<br />
En el momento que pasa el mensaje de comprobación y cuando, supuestamente, hace la siguiente línea de código se queda colgado sin mensajes de error:<br />
retval3 = Baanobj.parseexecfunction(&quot;ottstpapihand&quot;, &quot;stpapi.put.field(&quot; &amp; Chr(34) &amp; subsesion &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; &quot;tdilc402.qstc&quot; &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; cantidad &amp; Chr(34) &amp; &quot;)&quot;)<br />
                    If retval3 &lt;&gt; 0 Then<br />
                        MsgBox(&quot;Retval3 Put qstc = &quot; &amp; retval3)<br />
                    End If<br />
<br />
Agradeceré que alguien me eche una mano.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">25th October 2016, 19:45</div></div><div class="posttext">I went a head and left this post here.  If you can put it in English you might get some responses.  I don't have access to a translator here at work.  Will try later.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">26th October 2016, 04:25</div></div><div class="posttext">Well we do not run session tdilc4113m000 from session tisfc0202m000 - we do not build lots. But I do recall when we do receipts it does pop up.  I also recall I had to do something different for that session.  Not sure if I posted that on here or not - let me search.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">26th October 2016, 04:39</div></div><div class="posttext">Is all of the code there?  The reason I ask is I see where you put all of the fields on tisfc0202m000, but I do not see where you actually execute a save, update or continue on the session where it would initiate tdilc4113m000.  What I see is this(I edited out one error code check for simplicity):<br />
<br />
If cantidad1 = total Then<br />
    RetVal = Baanobj.ParseExecFunction(&quot;ottstpapihand&quot;, &quot;stpapi.put.field(&quot; &amp; Chr(34) &amp; Sesion &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; &quot;comp.frm&quot; &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; &quot;1&quot; &amp; Chr(34) &amp; &quot;)&quot;)<br />
Else<br />
     RetVal = Baanobj.ParseExecFunction(&quot;ottstpapihand&quot;, &quot;stpapi.put.field(&quot; &amp; Chr(34) &amp; Sesion &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; &quot;comp.frm&quot; &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; &quot;2&quot; &amp; Chr(34) &amp; &quot;)&quot;)<br />
 End If<br />
RetVal = Baanobj.ParseExecFunction(&quot;ottstpapihand&quot;, &quot;stpapi.enum.answer(&quot; &amp; Chr(34) &amp; Sesion &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; &quot;tisfc02023&quot; &amp; Chr(34) &amp; &quot;,&quot; &amp; &quot;1&quot; &amp; &quot;)&quot;)<br />
RetVal = Baanobj.ParseExecFunction(&quot;ottstpapihand&quot;, &quot;stpapi.enum.answer(&quot; &amp; Chr(34) &amp; Sesion &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; &quot;tisfc02024&quot; &amp; Chr(34) &amp; &quot;,&quot; &amp; &quot;1&quot; &amp; &quot;)&quot;)<br />
RetVal = Baanobj.ParseExecFunction(&quot;ottstpapihand&quot;, &quot;stpapi.enum.answer(&quot; &amp; Chr(34) &amp; Sesion &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; &quot;tisfc02029&quot; &amp; Chr(34) &amp; &quot;,&quot; &amp; &quot;1&quot; &amp; &quot;)&quot;)<br />
 RetVal = Baanobj.parseexecfunction(&quot;ottstpapihand&quot;, &quot;stpapi.handle.subproc(&quot; &amp; Chr(34) &amp; Sesion &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; subsesion &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; &quot;add&quot; &amp; Chr(34) &amp; &quot;)&quot;)<br />
               RetVal = Baanobj.ParseExecFunction(&quot;ottstpapihand&quot;, &quot;stpapi.end.session(&quot; &amp; Chr(34) &amp; Sesion &amp; Chr(34) &amp; &quot;)&quot;)<br />
                If RetVal &lt;&gt; 0 Then<br />
                    MsgBox(&quot;*** ERROR *** end.session tisfc0202m000&quot;)<br />
                End If<br />
<br />
Basically what I see is put fields to tisfc0202m000, if all went well then do an end session.  So you do an handle.subproc on the subsession tdilc4113m000, but then end 4113. That might be why you put field is hanging.  <br />
<br />
On my system if I put something like this in debug mode I can get to the option dialog box from the log in.  I can do a ps as I step thru the code to make sure the session is still running and when a subsession gets kicked off.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">26th October 2016, 04:43</div></div><div class="posttext">Should have searched first - see this link http://www.baanboard.com/baanboard/showthread.php?t=31085 that shows code that works.  See how they have a continue in the process.  Now as for what fields they put versus what you put you will need to figure out.  I am not sure of the differences and all of the questions.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">RafaPros</div><div class="date">26th October 2016, 17:15</div></div><div class="posttext">thank you very much for your answers Mark<br />
<br />
Excuse my bad English.<br />
Attached you the complete code. The link to the solution set I had already seen and I tried but did not work either.<br />
<br />
I have given many laps do not know if the code attached will be entirely correct.<br />
<br />
regards</div></div><hr />



</div>
</body>
</html>