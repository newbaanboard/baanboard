<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="whinh2520m000 advice shortage message, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] whinh2520m000 advice shortage message AFS/DDC/OLE: Function servers" />
	
	<title>whinh2520m000 advice shortage message [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="index.html">Newbaanboard</a> &gt; <a href="index.html">Baan SIGs</a> &gt; <a href="index.html">AFS/DDC/OLE: Function servers</a> &gt; whinh2520m000 advice shortage message</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">Andy..</div><div class="date">2nd September 2006, 22:38</div></div><div class="posttext">Hi, I've been doing stuff with outbound and cannot find the error/warning/message that appears in the normal Baan(5c) session whinh2520m000 when trying to direct release<br />
<br />
The test data has a (valid) error reporting a shortage:<br />
&quot;advice shortage of XXqty for item YY&quot;<br />
<br />
having marked the line - I then run:<br />
|direct release<br />
stpapi.form.command( &quot;whinh2520m000&quot;, 5, &quot;exec.user.5&quot;, error )<br />
	if error = &quot;&quot; then    |if error not produced by form.command above...<br />
		error=( stpapi.get.error( ) )<br />
	endif<br />
	if error &lt;&gt; &quot;&quot; then<br />
		message(&quot;direls error &quot; &amp; error)<br />
		stpapi.end.session( &quot;whinh2520m000&quot; , error  )<br />
	endif<br />
the command works if there is stock, but if there's a shortage I can't see the warning message.  I have got round this by checking ship qty afterwards - but would be better to see the Baan error produced.  I've never had to use stpapi.get.error before - is this the correct way of using it?  thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">3rd September 2006, 02:08</div></div><div class="posttext">Right after the form command try using the stpapi.get.mess command.  At least that is what I think it is.  This should get you any warning messages.  I do not recall ever using stpapi.get.error.  Not sure of the format of the stpapi.get.mess or maybe it is stpapi.get.mess.code.  Well good luck!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Andy..</div><div class="date">3rd September 2006, 12:27</div></div><div class="posttext">thanks for the quick reply - I tried stpapi.get.mess.code as well - but that didn't produce anything either!  See error message attached, not sure whether its an 'error' or 'message' ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">3rd September 2006, 17:16</div></div><div class="posttext">It is a warning message.  Did you try it write after the form command?  You may also need to run it more than once - I doubt this but it was in the documentation.  You may not actually get the warning in the api commands - seems to me that happened once to me.  If you had source you can debug why the message is not returned.  Good luck - on vacation for a week.</div></div><hr />



</div>
</body>
</html>