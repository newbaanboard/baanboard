<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="afs and print, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] afs and print AFS/DDC/OLE: Function servers" />
	
	<title>afs and print [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="index.html">Newbaanboard</a> &gt; <a href="index.html">Baan SIGs</a> &gt; <a href="index.html">AFS/DDC/OLE: Function servers</a> &gt; afs and print</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">crincoli</div><div class="date">31st January 2002, 14:14</div></div><div class="posttext">I call a session A via function server.<br />
Session A call a subsession B.<br />
B normally print a report.<br />
<br />
But apparently, when in api mode, sessions don't print anything. Don't execute on.choice of print.data.<br />
Open.report fails.<br />
<br />
My client wish report.<br />
<br />
The only solution I see is to use zoom.to instead of afs.<br />
<br />
What do you think?    Bye     Pietro<br />
<br />
Note: A=tisfc0202m000, B=tihra1211s000</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Smiffy</div><div class="date">31st January 2002, 15:01</div></div><div class="posttext">Hi, I had a similar problem to yourself.  Please search for my previous postings.  Search on STPAPI.<br />
<br />
<br />
cheers</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Smiffy</div><div class="date">31st January 2002, 15:17</div></div><div class="posttext">I cant seem to find my posting to do with printing with STPAPI functionality.  <br />
<br />
Basically my solution required source code, so if you dont have it, it wont work.<br />
<br />
Please find attached a document, which I wrote for the attentinon of other developers that work with me.  Please ignore any reference to specific 'bespoke' sessions in the document.<br />
<br />
I hope this document helps (I couldnt be bothered editing it to make it more generic).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Smiffy</div><div class="date">31st January 2002, 16:42</div></div><div class="posttext">If the session you call using STPAPI calls a subsession, you will need to use the command stpapi.handle.subproc.  Otherwise, your session may hang !</div></div><hr />


<div class="post"><div class="posttop"><div class="username">crincoli</div><div class="date">31st January 2002, 17:00</div></div><div class="posttext">Thanks Smiffy your document was very useful.<br />
<br />
Basically, to print the report I added the instructions:<br />
<br />
choice.print.data:<br />
before.choice:<br />
save.api.mode=api.mode<br />
api.mode=false<br />
<br />
after.choice:<br />
api.mode=save.api.mode<br />
<br />
thanks again             Pietro</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bh_vfp</div><div class="date">28th February 2002, 17:21</div></div><div class="posttext">Originally posted by crincoli <br />
Thanks Smiffy your document was very useful.<br />
<br />
Basically, to print the report I added the instructions:<br />
<br />
choice.print.data:<br />
before.choice:<br />
save.api.mode=api.mode<br />
api.mode=false<br />
<br />
after.choice:<br />
api.mode=save.api.mode<br />
<br />
thanks again             Pietro <br />
<br />
Crincoli,<br />
<br />
:confused: Where do you add this instruction ?<br />
In the reportscript or in the scource where you use the stpapi ?<br />
<br />
Bas</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">28th February 2002, 17:34</div></div><div class="posttext">These commands go into the session that the function server is running against.  So you need the session source script that the FS will run against.<br />
<br />
Good Luck!<br />
<br />
Mark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">crincoli</div><div class="date">28th February 2002, 17:36</div></div><div class="posttext">In the script of the subsession, that is, the script of the session that print report.<br />
I hope this is clear, bye    Pietro</div></div><hr />



</div>
</body>
</html>