<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="tdrecl102m000, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] tdrecl102m000 AFS/DDC/OLE: Function servers" />
	
	<title>tdrecl102m000 [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="index.html">Newbaanboard</a> &gt; <a href="index.html">Baan SIGs</a> &gt; <a href="index.html">AFS/DDC/OLE: Function servers</a> &gt; tdrecl102m000</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">aaguiar</div><div class="date">8th June 2004, 16:59</div></div><div class="posttext">Hi All,<br />
<br />
Anybody already make insertion using tdrecl102m000 with AFS ?? if already, can post piece of code ??<br />
<br />
I make this :<br />
<br />
	refi.f = 0 <br />
	fl102m000.put.tdrec937.refi.l(refi.f)<br />
	fl102m000.put.tdrec937.cgcc.l(cgcc.f)<br />
	fl102m000.put.tdrec937.cgce.l(cgce.f)<br />
	fl102m000.put.tdrec937.cgcd.l(cgcd.f)<br />
	fl102m000.put.tdrec937.docn.l(docn.f)<br />
	fl102m000.put.tdrec937.seri.l(seri.f)<br />
	fl102m000.put.tdrec937.ccfo.l(ccfo.f)<br />
	fl102m000.put.tdrec937.tpdo.l(tpdo.f)<br />
	fl102m000.put.tdrec937.totv.l(totv.f)<br />
	fl102m000.insert(0,errorMessage)<br />
	fl102m000.end()<br />
<br />
the functions have the codes:<br />
<br />
function extern void fl102m000.put.tdrec937.refi.l( const domain tcrefi.l value )<br />
{<br />
DLLUSAGE<br />
	Function to set tdrec937.refi.l ( tdrec937.refi.l ) in session tdrecl102m000<br />
	arg: - value to put in tdrec937.refi.l<br />
ENDDLLUSAGE<br />
	stpapi.put.field( &quot;tdrecl102m000&quot;, &quot;tdrec937.refi.l&quot;, str$(value) )<br />
}<br />
function extern void fl102m000.put.tdrec937.docn.l( const domain tcdocn value )<br />
{<br />
DLLUSAGE<br />
	Function to set tdrec937.docn.l ( tdrec937.docn.l ) in session tdrecl102m000<br />
	arg: - value to put in tdrec937.docn.l<br />
ENDDLLUSAGE<br />
	stpapi.put.field( &quot;tdrecl102m000&quot;, &quot;tdrec937.docn.l&quot;, str$(value) )<br />
}<br />
function extern long fl102m000.insert( long do.update, ref string error )<br />
{<br />
DLLUSAGE<br />
	Function to insert a record in session tdrecl102m000<br />
	Fields must be put before calling this function<br />
ENDDLLUSAGE<br />
	return( stpapi.insert( &quot;tdrecl102m000&quot;, do.update, error ) )<br />
}<br />
etc....<br />
<br />
nothing happen...<br />
<br />
Please,<br />
Alessandro</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">8th June 2004, 17:32</div></div><div class="posttext">Not familiar with this session - Is it Baan 5?  Are you getting any thing in the error message of the insert?<br />
<br />
Mark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">aaguiar</div><div class="date">8th June 2004, 19:09</div></div><div class="posttext">Not familiar with this session - Is it Baan 5?  Are you getting any thing in the error message of the insert?<br />
<br />
Mark<br />
Sorry,<br />
<br />
This localization's session for Brazil... But, my question is ?? Need I, fill all fields of session for call stapi.insert ?? In debug i see wich nothing check.input, before.input are executed..<br />
<br />
PS: Baan IV c4<br />
<br />
Thank's</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">8th June 2004, 19:40</div></div><div class="posttext">Sorry,<br />
<br />
This localization's session for Brazil... But, my question is ?? Need I, fill all fields of session for call stapi.insert ?? In debug i see wich nothing check.input, before.input are executed..<br />
<br />
PS: Baan IV c4<br />
<br />
Thank's<br />
 No you do not always have to fill all fields for an insert to work.  If the session lets a field be empty(or 0) then you do not have to fill that field.  If a field needs to be filled and you leave it empty, you will typically get an error message back on the insert.  <br />
<br />
Mark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">aaguiar</div><div class="date">8th June 2004, 19:55</div></div><div class="posttext">Ok.. Imagine, the sales orders, dou you have an example of code wich use AFS ?? Sorry, but i need help for this..<br />
<br />
Thank's</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">8th June 2004, 20:14</div></div><div class="posttext">There are a lot of samples in this forum.  The sales order is one module we do not use.  Here is one link (http://www.baanboard.com/baanboard/showthread.php?t=9586&amp;highlight=tdilc1120m000) to some inventory transfer code.  I am sure other searches will turn up examples on sales orders.<br />
<br />
From your snippet of code I would expect that if the insert did not work you would have some type of error message.  I just noticed this in your code:<br />
refi.f = 0 <br />
fl102m000.put.tdrec937.refi.l(refi.f)<br />
<br />
Is this a counter or sequence number?  I know on some sessions you do not fill calculated fields.  Like purchase orders.  You input the order series and then it generates the actual order number.  You can see something like this in the inventory transfer example.<br />
<br />
Mark</div></div><hr />



</div>
</body>
</html>