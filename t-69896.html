<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="tcqms1204m000 AFS doesn't work, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] tcqms1204m000 AFS doesn't work AFS/DDC/OLE: Function servers" />
	
	<title>tcqms1204m000 AFS doesn't work [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="index.html">Newbaanboard</a> &gt; <a href="index.html">Baan SIGs</a> &gt; <a href="index.html">AFS/DDC/OLE: Function servers</a> &gt; tcqms1204m000 AFS doesn't work</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">cherokee</div><div class="date">27th March 2017, 16:14</div></div><div class="posttext">Hello all,<br />
<br />
I am trying to run session tcqms1204m000 (Process Inspection Orders) but, doesn't work, no error, no nothing.<br />
<br />
The session has three forms. Running the session manually; I noticed that when hit continue on form 1, <br />
the session jumps to form two to request for fields values(I enter them) and then hit continue (on form 2) and works.<br />
<br />
I tried to mimic the same process with api's and does nothing this session.<br />
<br />
&quot; stpapi.put.field(&quot;tcqms1204m000&quot;,&quot;mpro.f&quot;,str$(etol(tcqms.mpro.by.origin)))<br />
        stpapi.continue.process(&quot;tcqms1204m000&quot;,error.mess) |--&gt;&gt; first continue<br />
        stpapi.put.field(&quot;tcqms1204m000&quot;,&quot;orgn.f&quot;,str$(etol(tcqms.orgn.purchase)))<br />
        stpapi.put.field(&quot;tcqms1204m000&quot;,&quot;orgn.t&quot;,str$(etol(tcqms.orgn.purchase)))<br />
        stpapi.put.field(&quot;tcqms1204m000&quot;,&quot;orno.f&quot;,str$(i.orno))<br />
        stpapi.put.field(&quot;tcqms1204m000&quot;,&quot;orno.t&quot;,str$(i.orno))<br />
        stpapi.put.field(&quot;tcqms1204m000&quot;,&quot;pono.f&quot;,str$(i.pono))<br />
        stpapi.put.field(&quot;tcqms1204m000&quot;,&quot;pono.t&quot;,str$(i.pono))<br />
        stpapi.put.field(&quot;tcqms1204m000&quot;,&quot;opno.f&quot;,str$(i.opno))<br />
        stpapi.put.field(&quot;tcqms1204m000&quot;,&quot;opno.t&quot;,str$(i.opno))<br />
        stpapi.put.field(&quot;tcqms1204m000&quot;,&quot;srnb.f&quot;,str$(i.srnb))<br />
        stpapi.put.field(&quot;tcqms1204m000&quot;,&quot;srnb.t&quot;,str$(i.srnb))<br />
	stpapi.continue.process(&quot;tcqms1204m000&quot;,error.mess)| -&gt;&gt; second continue&quot;<br />
 if not isspace(error.mess) then<br />
                message(error.mess,0)<br />
                stpapi.end.session(&quot;tcqms1204m000&quot;)<br />
                return(false)<br />
        endif<br />
        stpapi.end.session(&quot;tcqms1204m000&quot;)<br />
		<br />
Any ideas?<br />
<br />
Thanks,</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">27th March 2017, 19:48</div></div><div class="posttext">Okay a few things to try based off just looking at the session on our system.  <br />
(1) Try removing the first continue.  Maybe it is doing something in the background you can't see.<br />
(2) Remove the first continue on form 1 and then try a save and then a continue after putting all the fields for form 1 and form 2.  <br />
<br />
All I did was run ttstpcreatdll to see what functions might be available.  It would be nice if you had source code to debug.  Then you could see what is happening in the background.  Have to look around a little more.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">cherokee</div><div class="date">27th March 2017, 21:15</div></div><div class="posttext">Hello Mark,<br />
<br />
Thanks.. I removed the before.choice: for continue. and forced form.curr to 2 then the back and forth of the before.choice does not affects the continue process. It does work now.<br />
<br />
Thanks again.</div></div><hr />



</div>
</body>
</html>