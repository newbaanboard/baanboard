<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="AFS and session tfgld1107s000, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] AFS and session tfgld1107s000 AFS/DDC/OLE: Function servers" />
	
	<title>AFS and session tfgld1107s000 [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="index.html">Newbaanboard</a> &gt; <a href="index.html">Baan SIGs</a> &gt; <a href="index.html">AFS/DDC/OLE: Function servers</a> &gt; AFS and session tfgld1107s000</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">jhargett</div><div class="date">26th January 2006, 19:07</div></div><div class="posttext">I am trying to automate a GL transaction using AFS.<br />
I have successfully created the batch in session tfgld1101m000 and I have successfully created the document in session tfgld1115s000. However, when I create a document of type Recurring/Reversing, I need to fill out session tfgld1107s000. So, in the AFS I handle this subsession and fill out the data and insert it. But when called from AFS, the insert fails with the message &quot;Reversal of Transactions not allowed&quot;. This data works fine when inserted manually in Baan. <br />
Here is the AFS Log for this series of updates:<br />
<br />
&gt;tfgld1115s000 handle.subproc tfgld1107s000 add<br />
&gt;tfgld1115s000 application.option 1 of form:1<br />
5-&gt;application.option^A1^A49<br />
5&lt;-application.option^A0<br />
&lt;tfgld1115s000<br />
&gt;tfgld1107s000 change.view<br />
6-&gt;get.fields<br />
6&lt;-get.fields^A0^Atfgld103.year^A1^Atfgld006.ydsc^A0^Atfgld103.btno^A1^Atfgld103.ttyp^A1^Atfgld011.desc^A0^Atfgld103.trdt^A1^A<br />
tfgld103.nyer^A1^Atfgld103.fprd^A1^Atfgld103.rprd^A1^Atfgld103.tyer^A1^Atfgld103.vprd^A1^Atfgld103.revt^A1<br />
6-&gt;start.set<br />
6&lt;-start.set^A0^A1<br />
&lt;tfgld1107s000 1 view found<br />
&gt;tfgld1107s000 put.field:tfgld103.trdt 732283<br />
&gt;tfgld1107s000 put.field:tfgld102.nyer 2005<br />
&gt;tfgld1107s000 put.field:tfgld102.fper 12<br />
&gt;tfgld1107s000 put.field:tfgld102.tyer 2005<br />
&gt;tfgld1107s000 put.field:tfgld102.vprd 12<br />
&gt;tfgld1107s000 put.field:tfgld102.revt 2<br />
&gt;tfgld1107s000 insert<br />
6-&gt;add.set+save<br />
6&lt;-add.set+save^A1<br />
&lt;tfgld1107s000 Reversal of Transactions not allowed<br />
&gt;tfgld1107s000 end.session</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jhargett</div><div class="date">26th January 2006, 19:36</div></div><div class="posttext">Don't you love it when you find the answer after you post?<br />
You may notice that in the put statements, the first line is:tfgld103.trdt. The lines after that use tfgld102. They should all be tfgld103.</div></div><hr />



</div>
</body>
</html>