<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="AFS Question..., baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] AFS Question... AFS/DDC/OLE: Function servers" />
	
	<title>AFS Question... [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="index.html">Newbaanboard</a> &gt; <a href="index.html">Baan SIGs</a> &gt; <a href="index.html">AFS/DDC/OLE: Function servers</a> &gt; AFS Question...</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">r_nagu</div><div class="date">24th June 2003, 17:35</div></div><div class="posttext">Hi,<br />
	I wrote an AFS script to Maintain Engineering Item Revsions (tiedm1101m000). Here is the script.<br />
	<br />
************************************************<br />
		|*** Set up Revision<br />
mess(&quot;tiedmn220.4&quot;,0,eitm)<br />
stpapi.put.field(&quot;tiedm1101m000&quot;, &quot;tiedm100.eitm&quot;, eitm)<br />
stpapi.change.view(&quot;tiedm1101m000&quot;)<br />
stpapi.put.field(&quot;tiedm1101m000&quot;, &quot;tiedm100.revi&quot;, &quot;A&quot;)<br />
stpapi.put.field(&quot;tiedm1101m000&quot;, &quot;tiedm100.dsca&quot;, tipcs021.dsca)<br />
stpapi.put.field(&quot;tiedm1101m000&quot;, &quot;tiedm100.indt&quot;, str$(date.num()))<br />
stpapi.put.field(&quot;tiedm1101m000&quot;, &quot;tiedm100.engi&quot;, str$(tccom001.emno))<br />
stpapi.enum.answer(&quot;tiedm1101m000&quot;, &quot;ttstpq0103&quot;, ttskipmod.skip)<br />
stpapi.insert(&quot;tiedm1101m000&quot;, true, err.msg)<br />
**************************************************<br />
<br />
	Everything works fine except that when it sets up the revision, the values assigned to field tiedm100.engi is not getting saved. For that matter when i tested it further, it is not saving any values assigned to fields that are on the form 2 and form 3 of this session and field tiedm100.engi is on the form 2 of this session.<br />
<br />
	Any ideas what's going on. Appriciate your feedback.<br />
<br />
Thanks,<br />
NS</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">28th June 2003, 05:07</div></div><div class="posttext">I have done some session with multiple forms that worked just like you showed.  It may mean that you will need to do the insert.  The go back and update the fields with a update/save command.  Sometimes fields get changed with an insert and they do not get your original values that you put. I have also had fields not update at all, because of the Baan coding.  I was lucky and able just to go update one table on those.<br />
<br />
Good Luck!<br />
<br />
Mark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">PeterH</div><div class="date">30th June 2003, 12:18</div></div><div class="posttext">As you can read in this thread http://www.baanboard.com/baanboard/showthread.php?s=&amp;threadid=10544 <br />
I'm facing a similar problem. I 've just changed the forms of my session, and placed the fields, they were on form 2 &amp; 3, I wanted to update on form 1. Problem was solved. But there's still that question, what's causing this?????:confused: :confused: <br />
<br />
Hi.<br />
Peter</div></div><hr />


<div class="post"><div class="posttop"><div class="username">NvanBeest</div><div class="date">30th June 2003, 13:48</div></div><div class="posttext">Maybe you can try the same trick that I use for hours accounting (http://www.baanboard.com/baanboard/showthread.php?s=&amp;threadid=10511), namely to do an insert/update without save, then update the fields again before the stpapi.save() command.</div></div><hr />



</div>
</body>
</html>