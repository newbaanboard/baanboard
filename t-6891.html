<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="adding SO line with api, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] adding SO line with api AFS/DDC/OLE: Function servers" />
	
	<title>adding SO line with api [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="index.html">Newbaanboard</a> &gt; <a href="index.html">Baan SIGs</a> &gt; <a href="index.html">AFS/DDC/OLE: Function servers</a> &gt; adding SO line with api</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">mzbella</div><div class="date">26th September 2002, 18:06</div></div><div class="posttext">I am trying to put the position number on a new order line.  the line get added, but it just akes the next line number, not what I have put.  Anyone successfully in doing this?  here is my code.<br />
<br />
<br />
	api.pono = add.pono<br />
	api.item = last.item<br />
	api.oqua = tot.dqua<br />
<br />
	f4101m000.put.Sales_Order(api.orno)<br />
	find.err = f4101m000.find()<br />
	f4101m000.handle.sub.process(&quot;tdsls4105s000&quot;,&quot;add&quot;)<br />
	f4101m000.continue(err)<br />
<br />
	f4105s000.put.Position_Number(api.pono)<br />
	f4105s000.put.tdsls041.item(api.item)<br />
	f4105s000.put.Ordered_Quantity(api.oqua)<br />
	f4105s000.insert(1,err)<br />
	f4105s000.save(err)<br />
	rep.orno = f4105s000.get.tdsls041.orno()<br />
	rep.pono = f4105s000.get.Position_Number()<br />
	f4105s000.end()<br />
	f4101m000.end()<br />
<br />
Thank you for the help<br />
<br />
Michael Z</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">26th September 2002, 23:32</div></div><div class="posttext">Do you get any errors from the find or the insert? Are you sure the find is working? When it zooms to the subsession you may want to check and make sure you have the correct order.<br />
<br />
Since I am not familiar with these sessions I do not know how they work.  On my purchase order FS session I just let it default the line number to the next available. Is it possible that the position already exists and it is defaulting to something else?<br />
<br />
Mark</div></div><hr />



</div>
</body>
</html>