<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="stpapi for Release to Warehouse, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] stpapi for Release to Warehouse AFS/DDC/OLE: Function servers" />
	
	<title>stpapi for Release to Warehouse [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="index.html">Newbaanboard</a> &gt; <a href="index.html">Baan SIGs</a> &gt; <a href="index.html">AFS/DDC/OLE: Function servers</a> &gt; stpapi for Release to Warehouse</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">tomlbacon</div><div class="date">20th October 2010, 19:53</div></div><div class="posttext">Trying to Release to Warehouse session tdsls4246m000 Baan V.<br />
<br />
<br />
 stpapi.put.field(&quot;tdsls4246m000&quot;, &quot;orno.f&quot;, &quot;orno.f&quot;)<br />
 stpapi.put.field(&quot;tdsls4246m000&quot;, &quot;orno.t&quot;, &quot;orno.f&quot;)<br />
 stpapi.put.field(&quot;tdsls4246m000&quot;, &quot;cotp.f&quot;, &quot;   &quot;) <br />
 stpapi.put.field(&quot;tdsls4246m000&quot;, &quot;cotp.t&quot;, &quot;ZZZ&quot;)<br />
 stpapi.put.field(&quot;tdsls4246m000&quot;, &quot;coft.f&quot;, &quot;      &quot;)<br />
 stpapi.put.field(&quot;tdsls4246m000&quot;, &quot;coft.t&quot;, &quot;ZZZZZZ&quot;)<br />
 stpapi.put.field(&quot;tdsls4246m000&quot;, &quot;ofbp.f&quot;, &quot;         &quot;)<br />
 stpapi.put.field(&quot;tdsls4246m000&quot;, &quot;ofbp.t&quot;, &quot;ZZZZZZZZZ&quot;)<br />
 stpapi.put.field(&quot;tdsls4246m000&quot;, &quot;stbp.f&quot;, &quot;         &quot;)<br />
 stpapi.put.field(&quot;tdsls4246m000&quot;, &quot;stbp.t&quot;, &quot;ZZZZZZZZZ&quot;)<br />
 stpapi.put.field(&quot;tdsls4246m000&quot;, &quot;ref.date&quot;, &quot;odat.to&quot;)<br />
 stpapi.put.field(&quot;tdsls4246m000&quot;, &quot;log.report&quot;, &quot;tcyesno.yes&quot;)<br />
 stpapi.put.field(&quot;tdsls4246m000&quot;, &quot;log.success&quot;, &quot;tcyesno.yes&quot;)<br />
 stpapi.put.field(&quot;tdsls4246m000&quot;, &quot;rel.man&quot;, &quot;tcyesno.no&quot;<br />
 stpapi.insert(&quot;tdsls4246m000&quot;, do.save, err.msg)<br />
          Received Command Disabled in err.msg.<br />
 stpapi.update(&quot;tdsls4246m000&quot;, do.save, err.msg)<br />
          No error messge<br />
 stpapi.continue.process(&quot;tdsls4246m000&quot;,err.msg)<br />
           Received Comman Disabled in err.msg    <br />
 stpapi.end.session(&quot;tdsls4246m000&quot;) <br />
<br />
   any one done this session before or have any ideas.<br />
Thanks,<br />
<br />
Tom<br />
<br />
Tom</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">20th October 2010, 22:06</div></div><div class="posttext">Why the insert and update?  Looks more like my outbound session.  I would just have the continue.  Also - does it generate a report?  I would also include the stpapi.set.report command.  Not sure those will fix it but first things I noticed.<br />
<br />
PS - This is the correct forum for stpapi type questions.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">tomlbacon</div><div class="date">21st October 2010, 17:43</div></div><div class="posttext">Session tdsls4246m000 starts the bhell but doesn't process, also tried to do as report but changed the to reports to no so it doesn't print.  Any suggestions?<br />
<br />
function  process.release()<br />
{<br />
<br />
	       do.save = 1<br />
               stpapi.put.field(&quot;tdsls4246m000&quot;, &quot;orno.f&quot;, &quot;orno.f&quot;)<br />
               stpapi.put.field(&quot;tdsls4246m000&quot;, &quot;orno.t&quot;, &quot;orno.f&quot;)<br />
               stpapi.put.field(&quot;tdsls4246m000&quot;, &quot;cotp.f&quot;, &quot;   &quot;) <br />
 	       stpapi.put.field(&quot;tdsls4246m000&quot;, &quot;cotp.t&quot;, &quot;ZZZ&quot;)<br />
               stpapi.put.field(&quot;tdsls4246m000&quot;, &quot;coft.f&quot;, &quot;      &quot;)<br />
               stpapi.put.field(&quot;tdsls4246m000&quot;, &quot;coft.t&quot;, &quot;ZZZZZZ&quot;)<br />
               stpapi.put.field(&quot;tdsls4246m000&quot;, &quot;ofbp.f&quot;, &quot;         &quot;)<br />
               stpapi.put.field(&quot;tdsls4246m000&quot;, &quot;ofbp.t&quot;, &quot;ZZZZZZZZZ&quot;)<br />
               stpapi.put.field(&quot;tdsls4246m000&quot;, &quot;stbp.f&quot;, &quot;         &quot;)<br />
               stpapi.put.field(&quot;tdsls4246m000&quot;, &quot;stbp.t&quot;, &quot;ZZZZZZZZZ&quot;)<br />
               stpapi.put.field(&quot;tdsls4246m000&quot;, &quot;ref.date&quot;, &quot;odat.to +30&quot;)<br />
               stpapi.put.field(&quot;tdsls4246m000&quot;, &quot;log.report&quot;, &quot;tcyesno.no&quot;)<br />
               stpapi.put.field(&quot;tdsls4246m000&quot;, &quot;log.success&quot;, &quot;tcyesno.no&quot;)<br />
               stpapi.put.field(&quot;tdsls4246m000&quot;, &quot;rel.man&quot;, &quot;tcyesno.no&quot;)<br />
|	       stpapi.set.report(&quot;tdsls4246m000&quot;, &quot;rtdsls424611000&quot;, &quot;D&quot;, err.msg)<br />
|	       stpapi.print.report(&quot;tdsls4246m000&quot;, err.msg)<br />
                 stpapi.update(&quot;tdsls4246m000&quot;, do.save, err.msg)<br />
	       stpapi.end.session(&quot;tdsls4246m000&quot;) <br />
<br />
}</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">22nd October 2010, 15:27</div></div><div class="posttext">Does this work?<br />
<br />
<br />
do.save = 1<br />
stpapi.put.field(&quot;tdsls4246m000&quot;, &quot;orno.f&quot;, str$(orno.f))<br />
stpapi.put.field(&quot;tdsls4246m000&quot;, &quot;orno.t&quot;, str$(orno.f))<br />
stpapi.put.field(&quot;tdsls4246m000&quot;, &quot;cotp.f&quot;, &quot; &quot;) <br />
stpapi.put.field(&quot;tdsls4246m000&quot;, &quot;cotp.t&quot;, &quot;ZZZ&quot;)<br />
stpapi.put.field(&quot;tdsls4246m000&quot;, &quot;coft.f&quot;, &quot; &quot;)<br />
stpapi.put.field(&quot;tdsls4246m000&quot;, &quot;coft.t&quot;, &quot;ZZZZZZ&quot;)<br />
stpapi.put.field(&quot;tdsls4246m000&quot;, &quot;ofbp.f&quot;, &quot; &quot;)<br />
stpapi.put.field(&quot;tdsls4246m000&quot;, &quot;ofbp.t&quot;, &quot;ZZZZZZZZZ&quot;)<br />
stpapi.put.field(&quot;tdsls4246m000&quot;, &quot;stbp.f&quot;, &quot; &quot;)<br />
stpapi.put.field(&quot;tdsls4246m000&quot;, &quot;stbp.t&quot;, &quot;ZZZZZZZZZ&quot;)<br />
stpapi.put.field(&quot;tdsls4246m000&quot;, &quot;ref.date&quot;,  str$(odat.to +30))<br />
stpapi.put.field(&quot;tdsls4246m000&quot;, &quot;log.report&quot;, str$(etol(tcyesno.no)))<br />
stpapi.put.field(&quot;tdsls4246m000&quot;, &quot;log.success&quot;, str$(etol(tcyesno.no)))<br />
stpapi.put.field(&quot;tdsls4246m000&quot;, &quot;rel.man&quot;, str$(etol(tcyesno.no)))<br />
stpapi.set.report(&quot;tdsls4246m000&quot;, &quot;rtdsls424611000&quot;, &quot;D&quot;, err.msg)<br />
| stpapi.print.report(&quot;tdsls4246m000&quot;, err.msg)<br />
stpapi.continue.process(&quot;tdsls4246m000&quot;,err.msg)<br />
stpapi.end.session(&quot;tdsls4246m000&quot;) <br />
<br />
<br />
Notice I just put the continue in there and included the set report.  This session does not exist on our 4c4 system so I can't even look at it.  I also found other items in the code to change - I assumed orno.f and orno.t are longs,  I did the date in the str$ format expected and the tcyesno variables.  Remember when calling a session all the variables need to be in string format.  Also - the only reason I included the report name is that one time I did a session even without printing it still expected a report name.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">tomlbacon</div><div class="date">25th October 2010, 20:04</div></div><div class="posttext">Go it working; Baan V release to Warehouse Code below:<br />
function  process.release()<br />
{	       <br />
	       do.save = 1<br />
               stpapi.put.field(&quot;tdsls4246m000&quot;, &quot;orno.f&quot;, str$(tdsls401.orno))<br />
               stpapi.put.field(&quot;tdsls4246m000&quot;, &quot;orno.t&quot;, str$(tdsls401.orno))<br />
               stpapi.put.field(&quot;tdsls4246m000&quot;, &quot;cotp.f&quot;, str$(&quot;   &quot;)) <br />
 	       stpapi.put.field(&quot;tdsls4246m000&quot;, &quot;cotp.t&quot;, str$(&quot;ZZZ&quot;))<br />
               stpapi.put.field(&quot;tdsls4246m000&quot;, &quot;coft.f&quot;, str$(&quot;      &quot;))<br />
               stpapi.put.field(&quot;tdsls4246m000&quot;, &quot;coft.t&quot;, str$(&quot;ZZZZZZ&quot;))<br />
               stpapi.put.field(&quot;tdsls4246m000&quot;, &quot;ofbp.f&quot;, str$(&quot;         &quot;))<br />
               stpapi.put.field(&quot;tdsls4246m000&quot;, &quot;ofbp.t&quot;, str$(&quot;ZZZZZZZZZ&quot;))<br />
               stpapi.put.field(&quot;tdsls4246m000&quot;, &quot;stbp.f&quot;, str$(&quot;         &quot;))<br />
               stpapi.put.field(&quot;tdsls4246m000&quot;, &quot;stbp.t&quot;, str$(&quot;ZZZZZZZZZ&quot;))<br />
               stpapi.put.field(&quot;tdsls4246m000&quot;, &quot;ref.date&quot;, str$(w.date))<br />
               stpapi.put.field(&quot;tdsls4246m000&quot;, &quot;log.report&quot;, str$(etol(tcyesno.no)))<br />
               stpapi.put.field(&quot;tdsls4246m000&quot;, &quot;log.success&quot;, str$(etol(tcyesno.no)))<br />
               stpapi.put.field(&quot;tdsls4246m000&quot;, &quot;rel.man&quot;, str$(etol(tcyesno.no)))<br />
               stpapi.put.field(&quot;tdsls4246m000&quot;, &quot;proc.device&quot;, str$(etol(tcyesno.no)))<br />
	       stpapi.put.field(&quot;tdsls4246m000&quot;, &quot;alt.dev&quot;, &quot;        &quot;)<br />
	       stpapi.put.field(&quot;tdsls4246m000&quot;, &quot;alt.spoolout&quot;, str$(&quot;&lt;path&gt;&quot;))<br />
	       stpapi.set.report(&quot;tdsls4246m000&quot;, &quot;rtdsls424611000&quot;, &quot;D&quot;, err.msg)<br />
	       stpapi.form.command(&quot;tdsls4246m000&quot;, 5, &quot;exec.cont.process&quot;, err.msg)<br />
	       stpapi.update(&quot;tdsls4246m000&quot;, do.save, err.msg)     <br />
	       stpapi.end.session(&quot;tdsls4246m000&quot;) <br />
<br />
}</div></div><hr />



</div>
</body>
</html>