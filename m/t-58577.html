<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="How to read XML node with properties (not just with data), baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] How to read XML node with properties (not just with data) Miscellaneous" />
	
	<title>How to read XML node with properties (not just with data) [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="../index.html">Newbaanboard</a> &gt; <a href="../index.html">Baan Quick Support: Functional &amp; Technical</a> &gt; <a href="../index.html">Miscellaneous</a> &gt; How to read XML node with properties (not just with data)</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">gorbeia</div><div class="date">8th June 2010, 12:30</div></div><div class="posttext">Hi,<br />
I'm trying to read an XML file, and I can get the data element of a &quot;Normal Node&quot;, but some nodes of this XML file contains format information:<br />
How can I get the data of : UoM = &quot;SET&quot; or Format=&quot;YYYYMMDD&quot; ??<br />
Thesese are node properties but not data.<br />
I get the data with the:<br />
xmlGetDataElement(senddate.id,&quot;Date&quot;, xml.data1)<br />
but cannot get the properties.<br />
<br />
Thanks in advance.<br />
<br />
e.g:<br />
<br />
&lt;PkgItem&gt;<br />
 &lt;PositionNumber&gt;0010&lt;/PositionNumber&gt;<br />
&lt;DeliveredQuantity&gt;<br />
 &lt;Quantity UoM=&quot;SET&quot;&gt;6&lt;/Quantity&gt;<br />
 &lt;/DeliveredQuantity&gt;<br />
&lt;ProductId&gt;<br />
 &lt;MakerCode&gt;TMD&lt;/MakerCode&gt;<br />
 &lt;ProductNumber&gt;C6024NA014&lt;/ProductNumber&gt;<br />
 &lt;Ean&gt;4007590083426&lt;/Ean&gt;<br />
 &lt;/ProductId&gt;<br />
&lt;ProductDescription&gt;<br />
 &lt;ProductName1&gt;WVA-N.: 291220,9 mm&lt;/ProductName1&gt;<br />
 &lt;/ProductDescription&gt;<br />
&lt;OrderRef&gt;<br />
 &lt;SellerOrderNumber&gt;548833&lt;/SellerOrderNumber&gt;<br />
 &lt;BuyerOrderNumber&gt;100000795&lt;/BuyerOrderNumber&gt;<br />
 &lt;Date Format=&quot;YYYYMMDD&quot; Qualifier=&quot;At&quot;&gt;20100113&lt;/Date&gt;<br />
 &lt;/OrderRef&gt;<br />
&lt;OrderItemRef&gt;<br />
 &lt;SellerOrderItemRef&gt;80981393&lt;/SellerOrderItemRef&gt;<br />
 &lt;BuyerOrderItemRef&gt;0089&lt;/BuyerOrderItemRef&gt;<br />
 &lt;/OrderItemRef&gt;<br />
 &lt;/PkgItem&gt;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">wiggum</div><div class="date">8th June 2010, 12:52</div></div><div class="posttext">Use function xmlGetAttribute()</div></div><hr />


<div class="post"><div class="posttop"><div class="username">gorbeia</div><div class="date">14th June 2010, 00:20</div></div><div class="posttext">Use function xmlGetAttribute()<br />
<br />
Thanks a lot Wiggum..!! It is working with it..!! :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">georgelc</div><div class="date">22nd June 2016, 23:54</div></div><div class="posttext">Please can you tell me what the solution is , I have the following xml:<br />
<br />
&lt;InfoAdditional &gt;<br />
		&lt;fieldAdditional name=&quot;TOTAL TO PAY&quot;&gt;7.36&lt;/fieldAdditional&gt;<br />
		&lt;fieldAdditional name=&quot;TOTAL INVOICE&quot;&gt;7.36&lt;/fieldAdditional&gt;<br />
		&lt;fieldAdditional name=&quot;Period&quot;&gt;August 2015&lt;/fieldAdditional&gt;<br />
		&lt;fieldAdditional name=&quot;Pay day&quot;&gt;04 - OCTOBER - 2015&lt;/fieldAdditional&gt;<br />
		&lt;fieldAdditional name=&quot;Number&quot;&gt;22235887&lt;/fieldAdditional&gt;<br />
		&lt;fieldAdditional name=&quot;RUC&quot;&gt;1710246040&lt;/fieldAdditional&gt;<br />
&lt;/InfoAdditional&gt;<br />
<br />
as I can get the data node 22235887<br />
<br />
&lt;fieldAdditional name=&quot;Number&quot;&gt;22235887&lt;/fieldAdditional&gt;<br />
<br />
Thanks for your help</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rahul ingale</div><div class="date">23rd June 2016, 11:49</div></div><div class="posttext">use function xmlGetData()</div></div><hr />


<div class="post"><div class="posttop"><div class="username">georgelc</div><div class="date">23rd June 2016, 18:37</div></div><div class="posttext">I use the function xmlGetData() as follows :<br />
<br />
node.infoAditional = xmlFindFirst(&quot;fieldAdditional&quot;, cmfId)<br />
while node.infoAditional &lt;&gt; 0<br />
	dummy.ret = xmlGetData(node.infoAditional, Data.Number)<br />
	node.infoAditional = xmlGetRightSibling(node.infoAditional)		<br />
endwhile<br />
<br />
but it returns the data from all nodes in the variable Data.Number<br />
<br />
as I can get the specific data of this node?<br />
<br />
&lt;fieldAdditional name=&quot;Number&quot;&gt;22235887&lt;/fieldAdditional&gt;<br />
<br />
Thanks for your help</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rahul ingale</div><div class="date">24th June 2016, 23:08</div></div><div class="posttext">try this code<br />
<br />
node.infoAditional = xmlFindFirst(&quot;fieldAdditional&quot;, cmfId)<br />
while node.infoAditional &lt;&gt; 0<br />
ret=xmlGetAttribute(node.infoAditional ,&quot;Number&quot;,Data.Number)<br />
dummy.ret = xmlGetData(node.infoAditional, Data.Number)<br />
node.infoAditional = xmlGetRightSibling(node.infoAditional)	<br />
endwhile</div></div><hr />


<div class="post"><div class="posttop"><div class="username">georgelc</div><div class="date">24th June 2016, 23:54</div></div><div class="posttext">it did not work, the second iteration gets the same data on two lines: <br />
<br />
ret=xmlGetAttribute(node.infoAditional ,&quot;Number&quot;,Data.Number) <br />
dummy.ret = xmlGetData(node.infoAditional, Data.Number)<br />
and not only when it is equal to &quot;Number&quot;<br />
<br />
I tried this code<br />
<br />
node.infoAditional = xmlFindFirst(&quot;fieldAdditional&quot;, cmfId)<br />
while node.infoAditional &lt;&gt; 0<br />
ret=xmlGetAttribute(node.infoAditional ,&quot;Number&quot;,Data.Number.2)<br />
dummy.ret = xmlGetData(node.infoAditional, Data.Number)<br />
node.infoAditional = xmlGetRightSibling(node.infoAditional)	<br />
endwhile<br />
<br />
and the variable Data.Number.2 is always empty</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bhushanchanda</div><div class="date">27th June 2016, 18:13</div></div><div class="posttext">Hi,<br />
<br />
Your attribute name is &quot;name&quot; and the value is &quot;Number&quot; so you need to tweak the code a little. Try this - <br />
<br />
<br />
        node.infoAditional = xmlFindFirst(&quot;fieldAdditional&quot;, id)<br />
	<br />
	while node.infoAditional &lt;&gt; 0<br />
		Data.Number = &quot;&quot;<br />
		ret=xmlGetAttribute(node.infoAditional ,&quot;name&quot;,Data.Number)<br />
                |Get the data only if the attribute value is &quot;Number&quot; and do processing[/COLOR]<br />
		if trim$(Data.Number) = &quot;Number&quot; then           <br />
			dummy.ret = xmlGetData(node.infoAditional, Data.Number)<br />
		endif<br />
		node.infoAditional = xmlGetRightSibling(node.infoAditional)	<br />
	endwhile</div></div><hr />


<div class="post"><div class="posttop"><div class="username">georgelc</div><div class="date">28th June 2016, 02:16</div></div><div class="posttext">thank you very much Bhushan , it is running fine.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">richard</div><div class="date">29th June 2019, 18:34</div></div><div class="posttext">Hello,<br />
I was trying to read an xml file with several attributes, and didn't succeed with xmldataelement. This post gave me the solution.</div></div><hr />



</div>
</body>
</html>