<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="AFS Fatal Error, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] AFS Fatal Error AFS/DDC/OLE: Function servers" />
	
	<title>AFS Fatal Error [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="index.html">Newbaanboard</a> &gt; <a href="index.html">Baan SIGs</a> &gt; <a href="index.html">AFS/DDC/OLE: Function servers</a> &gt; AFS Fatal Error</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">Hiba_t</div><div class="date">28th October 2004, 18:17</div></div><div class="posttext">Hi all,<br />
<br />
I'm using function servers with the session tfgld1101m000. Doing the following<br />
<br />
   stpapi.put.field(&quot;tfgld1101m000&quot;, &quot;tfgld101.year&quot;, &quot;2000&quot;)<br />
   stpapi.put.field(&quot;tfgld1101m000&quot;, &quot;tfgld101.btno&quot;, &quot;340&quot; )<br />
   stpapi.find(&quot;tfgld1101m000&quot;)<br />
   stpapi.get.field(&quot;tfgld1101m000&quot;, &quot;tfgld101.ttyp&quot;, vall )<br />
   stpapi.end.session(&quot;tfgld1101m000&quot;)<br />
<br />
The value returned in the variable vall is correct.. The problem is when it gets to end.session I get the following error and it stucks..<br />
<br />
Fatal error: index 31 out of dims [0] 20<br />
Fatal error: Can not continue in ... in DLL: ottstpapihand ()[bms.receive$]<br />
<br />
The same code works for other sessions.. <br />
Can anyone help me ?<br />
<br />
Thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">28th October 2004, 21:08</div></div><div class="posttext">Dropped your code in one of my test function servers and it worked just fine. I would say you need an update on the session or the stpapi libraries.  I do not think this would make a difference, but you could always try stpapi.change.view and stpapi.browse.set to read through each of the tfgld101.ttyp fields.  I think those commands are bettor suited for this type of multi-occurance session.<br />
<br />
Mark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Hiba_t</div><div class="date">29th October 2004, 11:07</div></div><div class="posttext">Thanks for your reply mark..<br />
<br />
I tried to use stpapi.change.view but I get the following error when it comes to execute it..<br />
<br />
Fatal error : Link on stack failed zero pointer pushed<br />
Fatal error : Can not continue in tfgld1101m000 in DLL: ottstpstandard ()[exec_function]</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">29th October 2004, 15:24</div></div><div class="posttext">I would now try to get a more current version of the session code there could be a problem with it.  Then if that does not work I would recommend updating the stpapi objects.  Both sets of code work on our 4c4 system.<br />
<br />
Mark</div></div><hr />



</div>
</body>
</html>