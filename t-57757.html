<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="Changing company number, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] Changing company number AFS/DDC/OLE: Function servers" />
	
	<title>Changing company number [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="index.html">Newbaanboard</a> &gt; <a href="index.html">Baan SIGs</a> &gt; <a href="index.html">AFS/DDC/OLE: Function servers</a> &gt; Changing company number</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">sramage</div><div class="date">3rd February 2010, 16:55</div></div><div class="posttext">Hi all !<br />
<br />
I just discover AFS + COM Automation and it's really amazing what we can do, it makes Baan my new friend.<br />
But I have a question :<br />
Is there any way to change the company number ? <br />
I know there is a function : switch.to.company but where is that function ? <br />
<br />
seb</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bdittmar</div><div class="date">3rd February 2010, 17:02</div></div><div class="posttext">Hi all !<br />
<br />
I just discover AFS + COM Automation and it's really amazing what we can do, it makes Baan my new friend.<br />
But I have a question :<br />
Is there any way to change the company number ? <br />
I know there is a function : switch.to.company but where is that function ? <br />
<br />
seb<br />
<br />
Hello,<br />
<br />
BaanERP Programmers Guide<br />
<br />
 <br />
switch.to.company() <br />
<br />
--------------------------------------------------------------------------------<br />
<br />
Syntax<br />
long switch.to.company( long new_compnr ) <br />
Description<br />
This switches to another company and sets the read-only variable COMPNR to the specified company number. It performs several checks before switching company and switches company only if the checks are successful. For example, it checks if the user is authorized to change to the new company, it checks if the package combination corresponds with the new company number, and it checks if the old and new companies have the same first day of the week.<br />
<br />
Notes<br />
compnr.check() and switch.to.company() perform similar functions, but switch.to.company() performs additional checks. So switch.to.company() makes heavier demands on system resources.<br />
<br />
Be aware that when there is a switch to another company, the user's first day of the week does not change, even if the new company has a different first day of the week. switch.to.company() returns an error value if the old and new companies have different first days of the week. compnr.check() does not.<br />
<br />
Super users are authorized for all company numbers. They always have authority to switch to a different company number. In addition, super users can also use the data dictionary to authorize other users for particular company numbers.<br />
<br />
Return values<br />
1 Success. <br />
 <br />
-1 Company not available.<br />
 <br />
-2 No permission to change to this company.<br />
 <br />
-3 Package combination does not correspond with new company number.<br />
 <br />
-4 First day of the week does not correspond to first day of the week of original company.<br />
 <br />
Regards</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sramage</div><div class="date">3rd February 2010, 17:12</div></div><div class="posttext">Thank you<br />
<br />
Finally I found it the funtion is in ottstp_stddll<br />
<br />
BaanObj.ParseExecFunction(&quot;ottstp_stddll&quot;,&quot;switch.to.company(400)&quot;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">3rd February 2010, 19:48</div></div><div class="posttext">Hi all !<br />
<br />
I just discover AFS + COM Automation and it's really amazing what we can do, it makes Baan my new friend.<br />
But I have a question :<br />
Is there any way to change the company number ? <br />
I know there is a function : switch.to.company but where is that function ? <br />
<br />
seb<br />
<br />
Becareful of your new best friend.  Baan support is not always the best in this area.  Plus I have had tools updates and portingset updates actually break things.  It is cool, but just keep these things in mind. :)</div></div><hr />



</div>
</body>
</html>