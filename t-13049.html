<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="vba call to Baan IV c4, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] vba call to Baan IV c4 AFS/DDC/OLE: Function servers" />
	
	<title>vba call to Baan IV c4 [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="index.html">Newbaanboard</a> &gt; <a href="index.html">Baan SIGs</a> &gt; <a href="index.html">AFS/DDC/OLE: Function servers</a> &gt; vba call to Baan IV c4</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">aldero</div><div class="date">19th September 2003, 12:44</div></div><div class="posttext">Hi all,<br />
<br />
I'm working on automating some Baan sessions and run into the following:<br />
I try to use the stpapi.getfield function but get nothing returned from Baan.<br />
Does anybody have a working example which I can try??<br />
<br />
Thanks a lot in advance</div></div><hr />


<div class="post"><div class="posttop"><div class="username">NvanBeest</div><div class="date">19th September 2003, 13:49</div></div><div class="posttext">Hi aldero<br />
<br />
Please complete your profile with the Baan version, database and O/S used.  Makes life easier for all of us if we don;t have to ask for it every time.  The example will also be depending in the version of Baan!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">zardoz</div><div class="date">19th September 2003, 13:50</div></div><div class="posttext">Can you explain better your problem?<br />
The function stpapi.getfield doesn't return any value -OR- the VBA application doesn't get any value?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">aldero</div><div class="date">19th September 2003, 14:13</div></div><div class="posttext">Hi,<br />
<br />
I try to do an api call to a simple session tccom0101m000 and want to get the field value tccom001.nama into a var in my VB application.<br />
I do this with the line below:<br />
BaanObj.ParseExecFunction &quot;ottstpapihand&quot;, &quot;stpapi.get.field(&quot; &amp; Chr(34) &amp; &quot;tccom0101m000&quot; &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; &quot;tccom001.nama&quot; &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; &quot;value&quot; &amp; Chr(34) &amp; &quot;)&quot;<br />
<br />
But nothing comes back in var value<br />
<br />
Pls help</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">19th September 2003, 15:14</div></div><div class="posttext">Is there any more code?  Did you do a find first? Did it work?  Let me try a search I know there are some samples in this forum.<br />
<br />
Mark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">aldero</div><div class="date">19th September 2003, 15:18</div></div><div class="posttext">Mark,<br />
<br />
Thanks for your reply, and yes I did a put.field first and after that a find.<br />
But still no result from the get.field command.<br />
<br />
I hope you can find a good sample for me ....<br />
<br />
Thanks in advance</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Al Smith</div><div class="date">19th September 2003, 15:26</div></div><div class="posttext">Hi,<br />
A couple of things come to mind.<br />
First you have to set a current record by doing a stpapi.find as Mark mentioned or a Browse.Set.<br />
Second, you can't populate a VB variable directly. The returned information is retrieved in the BaanObj.Functioncall. It your case it would look like this.? baanobj.FunctionCall<br />
stpapi.get.field(&quot;tccom0101m000&quot;,&quot;tccom001.nama&quot;,&quot;Legacy buyer-items for Review&quot;)The &quot;variable&quot; is really a buffer area for the FunctionCall and needs to be the proper length to hold the data. I personally use Space(x) for all of my stpapi.gets with x being the length of the data to be returned.<br />
I hope this helps.<br />
Al.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">zardoz</div><div class="date">19th September 2003, 15:32</div></div><div class="posttext">What means &quot;... nothing returns in var value&quot;?<br />
The variable value cannot be tested from VB, because remains unchanged after the ParseExecFunction call. <br />
You have to test the BaaNObj.FunctionCall instead. <br />
In it you'll find the entire call to the DLL, with the returned value in it (just try to debug the VBA application and you will see what I mean). <br />
The var value has to be initiallized (in VBA) to the lenght of the field you want before calling the parseexecfunction....</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">19th September 2003, 15:34</div></div><div class="posttext">Here is one sample (http://www.baanboard.com/baanboard/showthread.php?s=&amp;threadid=10395&amp;highlight=stpapi.get.field).  A couple more threads are here (http://www.baanboard.com/baanboard/showthread.php?s=&amp;threadid=6168&amp;highlight=Print+and+report) and here (http://www.baanboard.com/baanboard/showthread.php?s=&amp;threadid=774&amp;highlight=excel).  You can try other searchs.  And Al knows a lot more about this than me.<br />
<br />
Good Luck!<br />
<br />
Mark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">aldero</div><div class="date">19th September 2003, 17:51</div></div><div class="posttext">Hi all,<br />
<br />
I am a very happy man, the VBA script works and I can retrieve data from Baan into VB.<br />
<br />
Thanks a lot for all the help from averybody<br />
<br />
Greetings and have a good weekend</div></div><hr />



</div>
</body>
</html>