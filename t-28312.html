<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="AFS problem on tfcmg2120s000, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] AFS problem on tfcmg2120s000 AFS/DDC/OLE: Function servers" />
	
	<title>AFS problem on tfcmg2120s000 [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="index.html">Newbaanboard</a> &gt; <a href="index.html">Baan SIGs</a> &gt; <a href="index.html">AFS/DDC/OLE: Function servers</a> &gt; AFS problem on tfcmg2120s000</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">veyant</div><div class="date">4th October 2006, 16:55</div></div><div class="posttext">Hi,<br />
<br />
I am facing problem in tfcmg2120s000 in inserting a transaction thru AFS.<br />
<br />
I created one batch in tfgld1101m000 with transaction type and then called session tfcmg2100s000 to insert record with Type as &quot;journal&quot; and populated the fields with required data and called stpapi.insert and saved the document. It is working fine<br />
<br />
Now i call tfcmg2120s000 (Enter Transaction) and try to populate data in fields thru AFS but when i send stpapi.insert, i returns back error &quot;Batch Number not Allowed&quot;.<br />
<br />
Can somebody help me in this. Given below is the source code which i am using for inserting transction thru tfcmg2120s000.<br />
<br />
stpapi.handle.subproc(&quot;tfcmg2100s000&quot;,&quot;tfcmg2120s000&quot;,&quot;add&quot;)<br />
stpapi.form.command(&quot;tfcmg2100s000&quot;,2,&quot;tfcmg2120s000&quot;,cmg.error)<br />
<br />
stpapi.put.field( &quot;tfcmg2120s000&quot;, &quot;tfgld102.cono&quot;, str$(comp.no) ) <br />
stpapi.put.field( &quot;tfcmg2120s000&quot;, &quot;tfgld102.year&quot;, str$(fiscal.year) )<br />
stpapi.put.field( &quot;tfcmg2120s000&quot;, &quot;tfgld102.btno&quot;, str$(batch.no) )<br />
stpapi.put.field( &quot;tfcmg2120s000&quot;, &quot;tfgld102.ttyp&quot;, ttyp )<br />
stpapi.put.field( &quot;tfcmg2120s000&quot;, &quot;tfgld102.docn&quot;, str$(docno) )   <br />
stpapi.put.field( &quot;tfcmg2120s000&quot;, &quot;tfgld102.lino&quot;, str$(1) ) <br />
stpapi.put.field( &quot;tfcmg2120s000&quot;, &quot;tfgld102.serl&quot;, str$(1) ) <br />
stpapi.put.field( &quot;tfcmg2120s000&quot;, &quot;tfgld102.srno&quot;, str$(0) )  <br />
stpapi.put.field( &quot;tfcmg2120s000&quot;, &quot;tfgld102.tcom&quot;, str$(comp.no) )<br />
stpapi.put.field( &quot;tfcmg2120s000&quot;, &quot;tfgld102.leac&quot;, tfsol912.leac ) <br />
if not isspace(tfsol912.dim1) then<br />
    stpapi.put.field( &quot;tfcmg2120s000&quot;, &quot;tfgld102.dim1&quot;, tfsol912.dim1 )<br />
endif<br />
if not isspace(tfsol912.dim2) then<br />
    stpapi.put.field( &quot;tfcmg2120s000&quot;, &quot;tfgld102.dim2&quot;, tfsol912.dim2 )<br />
endif<br />
if not isspace(tfsol912.dim3) then<br />
    stpapi.put.field( &quot;tfcmg2120s000&quot;, &quot;tfgld102.dim3&quot;, tfsol912.dim3 )<br />
endif<br />
if not isspace(tfsol912.dim4) then<br />
    stpapi.put.field( &quot;tfcmg2120s000&quot;, &quot;tfgld102.dim4&quot;, tfsol912.dim4 )<br />
endif<br />
if not isspace(tfsol912.dim5) then<br />
    stpapi.put.field( &quot;tfcmg2120s000&quot;, &quot;tfgld102.dim5&quot;, tfsol912.dim5 )<br />
endif<br />
get.country.from.company.data(comp.no)<br />
stpapi.put.field( &quot;tfcmg2120s000&quot;, &quot;tfgld102.ccty&quot;, tccom000.ccty )<br />
stpapi.put.field( &quot;tfcmg2120s000&quot;, &quot;tfgld102.cvat&quot;, &quot; &quot;)<br />
stpapi.put.field( &quot;tfcmg2120s000&quot;, &quot;form.amount&quot;, str$(tfsol912.amnt) )<br />
if tfsol912.tpay = tfacp.tpay.invoice then<br />
     stpapi.put.field( &quot;tfcmg2120s000&quot;, &quot;tfgld102.dbcr&quot;,str$(tfgld.dbcr.debit) )<br />
else<br />
     if tfsol912.tpay = tfacp.tpay.sales then<br />
          stpapi.put.field( &quot;tfcmg2120s000&quot;, &quot;tfgld102.dbcr&quot;, str$(tfgld.dbcr.credit) )<br />
     endif<br />
endif<br />
stpapi.put.field( &quot;tfcmg2120s000&quot;, &quot;tfgld102.qty1&quot;, str$(0))<br />
stpapi.put.field( &quot;tfcmg2120s000&quot;, &quot;tfgld102.qty2&quot;, str$(0))  <br />
stpapi.put.field( &quot;tfcmg2120s000&quot;, &quot;tfgld102.fyer&quot;, str$(fiscal.year) )              <br />
stpapi.put.field( &quot;tfcmg2120s000&quot;, &quot;tfgld102.fprd&quot;, str$(fiscal.prod) )<br />
stpapi.put.field( &quot;tfcmg2120s000&quot;, &quot;tfgld102.ryer&quot;, str$(fiscal.year) )              <br />
stpapi.put.field( &quot;tfcmg2120s000&quot;, &quot;tfgld102.rprd&quot;, str$(rep.prod) )<br />
stpapi.put.field( &quot;tfcmg2120s000&quot;, &quot;tfgld102.vyer&quot;, str$(tax.year) )<br />
stpapi.put.field( &quot;tfcmg2120s000&quot;, &quot;tfgld102.vprd&quot;, str$(tax.prod) )<br />
stpapi.put.field( &quot;tfcmg2120s000&quot;, &quot;tfgld102.refr&quot;, tfsol912.esdb)<br />
stpapi.insert( &quot;tfcmg2120s000&quot;, true, cmg.error )<br />
     <br />
if isspace(cmg.error) then<br />
         stpapi.save( &quot;tfcmg2120s000&quot;, cmg.error )<br />
else<br />
         stpapi.recover( &quot;tfcmg2120s000&quot;, cmg.error )<br />
endif <br />
<br />
on stpapi.isert,it returns cmg.error = &quot;batch Number not Allowed&quot;.<br />
<br />
can somebody help me in this. how i should handle this issue.<br />
<br />
thanks<br />
Veyant</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">4th October 2006, 18:27</div></div><div class="posttext">Question - do you have source code for tfcmg2120s000?  This way you could debug the problem and someone might be able to make a recommendation. When running manually do you actually enter those fields or do they come from the calling session?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">veyant</div><div class="date">5th October 2006, 10:56</div></div><div class="posttext">Yaah, i have source code for the session. While maintaining transaction manually, Batch No, Year and Company, Transcation type, Document No, Line No, Seq # comes by default. Batch No, Year, Transaction Type and Company are imported from tfcmg2100s000.<br />
<br />
i will try to debug session tfcmg2120s000 and will update about things later in forum.<br />
<br />
thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jatin_sanghi</div><div class="date">18th October 2006, 11:03</div></div><div class="posttext">Hi,<br />
<br />
Just a suggesstion as i faced something similar.<br />
As i can see that the session tfcmg2120s000 has view fields.Just try to put the view fields and then find and then set.current.view.<br />
<br />
regards,<br />
<br />
Jatin Sanghi</div></div><hr />


<div class="post"><div class="posttop"><div class="username">lbencic</div><div class="date">18th October 2006, 22:42</div></div><div class="posttext">Also note that there is a standard way to generate Journal Vouchers from an external/coding standpoint.  You can fill the tfgld936, tfgld938 and tfgld940 and call the Session &quot;Import Journal Voucher Batches by ID Number&quot; (tfgld2215m000).  I use that, we have an extensive set of automated JV transactions.  Then I call that Import session via an API, it's MUCH easier to control than the actual input sessions.<br />
<br />
There is even a standard, if old, JVIMPORT Exchange scheme which will fill those tables from a flat file, if you are comfortable with those.  Some info here on another post:<br />
<br />
http://www.baanboard.com/baanboard/showthread.php?t=22732&amp;highlight=Import</div></div><hr />



</div>
</body>
</html>