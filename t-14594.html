<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="Trailing empty lines when printing via afs, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] Trailing empty lines when printing via afs AFS/DDC/OLE: Function servers" />
	
	<title>Trailing empty lines when printing via afs [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="index.html">Newbaanboard</a> &gt; <a href="index.html">Baan SIGs</a> &gt; <a href="index.html">AFS/DDC/OLE: Function servers</a> &gt; Trailing empty lines when printing via afs</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">Thomasm</div><div class="date">25th February 2004, 21:19</div></div><div class="posttext">I have developed a session that is using the afs functionality to print adress labels. The (underlying) session to print adress labels have been in us in the system for several years and it is printing to a (not sure about the terminology here) a printer with labels on a long long roll of paper running through the printer (not laser).<br />
<br />
Now, when I use the (underlying) print session manually each adress label printed moves the paper roll forward the exact lenght of a label, just as you would expect. The next printing therefore starts at the top of the next label.<br />
<br />
The problem is that when I call this session from via the stpapi quite a few empty rows are added at the end of each print, so that the next print will start at the middle of the 3:rd label. I have checked the printer settings, the device drivers and everything. All is up to date. I have tried setting the paper type via the afs, but no change, and really the default paper type in the device is indeed the correct one.<br />
<br />
Greatful for help<br />
-- Thomas Marten</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">25th February 2004, 22:43</div></div><div class="posttext">I take it this is a company owned session?  Can you put the report or label in debug mode to where you can see what you are getting from the api code? If you can do this you may want to check all your spool settings to see if when running in api mode something is getting set differently than when running manually.<br />
<br />
First you may want to make sure your update to the latest stpapi objects.<br />
<br />
Mark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Thomasm</div><div class="date">26th February 2004, 00:35</div></div><div class="posttext">The session is company owned, so I can get in there. It sounds like a good idea to do it that way to do the compare. I will get back to you sometime next week and let you know. I'm not in my own office this week but stealing some time form another project posting this.<br />
<br />
Thanks!<br />
<br />
/Thomas</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kbartelds</div><div class="date">27th February 2004, 10:48</div></div><div class="posttext">Hi,<br />
<br />
Does the afs session have it's own report? If so, the printer properties are not always picked up correctly, if the output is send to a printer (not display), the session triggered through afs used the properties of that printer in stead of from it's own printer, causing different behaviour then expected. A defect has already been made for this problem.<br />
<br />
Regards,<br />
Klaas</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Thomasm</div><div class="date">27th February 2004, 17:06</div></div><div class="posttext">Thank you for your reply.<br />
<br />
Yes, the afs session is indeed printing, and on a different paper size. I have been thinking it these terms already, so I tried to set the paper via afs, but it did not help.<br />
<br />
I have looked at the Baan site for solutions, but did not find any. You would not know what solution number it is, or is it just reported?<br />
<br />
Thanks,<br />
/Thomas</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kbartelds</div><div class="date">1st March 2004, 11:31</div></div><div class="posttext">It has been reported to PEG. Still waiting for a solution.<br />
<br />
Regards,<br />
Klaas</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kbartelds</div><div class="date">1st March 2004, 12:05</div></div><div class="posttext">defect = 144900<br />
<br />
Regards,<br />
Klaas</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Thomasm</div><div class="date">9th March 2004, 15:01</div></div><div class="posttext">Yes, that was indeed the problem. I solved it via a workaround by selecting the same paper form when printing from the AFS calling (the main) session.<br />
<br />
Thanks a lot for your contributions.<br />
<br />
/Thomas</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Hitesh Shah</div><div class="date">5th October 2005, 16:04</div></div><div class="posttext">Does spool.preview and spool.fileout work in AFS . Any tested example .</div></div><hr />



</div>
</body>
</html>