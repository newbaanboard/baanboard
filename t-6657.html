<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="stpapi.insert / stpapi.save .....???????, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] stpapi.insert / stpapi.save .....??????? AFS/DDC/OLE: Function servers" />
	
	<title>stpapi.insert / stpapi.save .....??????? [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="index.html">Newbaanboard</a> &gt; <a href="index.html">Baan SIGs</a> &gt; <a href="index.html">AFS/DDC/OLE: Function servers</a> &gt; stpapi.insert / stpapi.save .....???????</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">rohan_rege</div><div class="date">12th September 2002, 03:28</div></div><div class="posttext">In my code to simualte Maintain Transactions<br />
<br />
even after I put in all the fields  ,and use stpapi.insert .<br />
i get an error saying &quot; Value cannot be Zero..&quot;<br />
I dont know for which field its saying so , bcoz i have put in values  for each input field on the session.<br />
<br />
and so i removed the stpapi.insert command and <br />
instead put in a stpapi.save command<br />
<br />
now the prog runs sucessfully w/o the above error message<br />
implying that it saved the record<br />
but the record doesnt get saved...when i try to check for it in the session<br />
<br />
<br />
pls any suggestions<br />
<br />
foll is the log whn i use stpapi.insert  :<br />
<br />
LOGGING STARTED<br />
09-11-2002<br />
&gt;tfgld1100m000 browse.set<br />
152-&gt;get.fields<br />
152&lt;-get.fields...<br />
152-&gt;last.set<br />
152&lt;-last.set0<br />
&lt;tfgld1100m000 1 ok<br />
&gt;tfgld1100m000 get.field:tfgld100.btno<br />
&lt;tfgld1100m000 get.field:tfgld100.btno=16745<br />
&gt;tfgld1100m000 put.field:tfgld100.tedt 09112002<br />
&gt;tfgld1100m000 get.field:tfgld100.tedt<br />
&lt;tfgld1100m000 get.field:tfgld100.tedt=09112002<br />
&gt;tfgld1100m000 put.field:tfgld100.year 2002<br />
&gt;tfgld1100m000 get.field:tfgld100.year<br />
&lt;tfgld1100m000 get.field:tfgld100.year=2002<br />
&gt;tfgld1100m000 put.field:tfgld100.btno 16746<br />
&gt;tfgld1100m000 get.field:tfgld100.btno<br />
&lt;tfgld1100m000 get.field:tfgld100.btno=16746<br />
&gt;tfgld1100m000 put.field:tfgld100.btno jai gurudeva<br />
&gt;tfgld1100m000 get.field:tfgld100.btno<br />
&lt;tfgld1100m000 get.field:tfgld100.btno=jai gurude<br />
&gt;tfgld1100m000 put.field:tfgld100.fprd 9<br />
&gt;tfgld1100m000 get.field:tfgld100.fprd<br />
&lt;tfgld1100m000 get.field:tfgld100.fprd=9<br />
&gt;tfgld1100m000 put.field:tfgld100.rprd 3<br />
&gt;tfgld1100m000 get.field:tfgld100.rprd<br />
&lt;tfgld1100m000 get.field:tfgld100.rprd=3<br />
&gt;tfgld1100m000 put.field:tfgld100.vyer 2002<br />
&gt;tfgld1100m000 get.field:tfgld100.vyer<br />
&lt;tfgld1100m000 get.field:tfgld100.vyer=2002<br />
&gt;tfgld1100m000 put.field:tfgld100.vprd 9<br />
&gt;tfgld1100m000 get.field:tfgld100.vprd<br />
&lt;tfgld1100m000 get.field:tfgld100.vprd=9<br />
&gt;tfgld1100m000 insert<br />
152-&gt;add.set+save<br />
152&lt;-add.set+save1<br />
&lt;tfgld1100m000 Value cannot be zero<br />
&gt;tfgld1100m000 get.mess.code<br />
&lt;tfgld1100m000 tfgldd0004          <br />
&gt;tfgld1100m000 end.session<br />
152-&gt;end.program<br />
152&lt;-end.program1<br />
<br />
<br />
and what follows is the log when i only use stpapi.save<br />
&gt;tfgld1100m000 browse.set<br />
249-&gt;get.fields<br />
249&lt;-get.fields...<br />
249-&gt;last.set<br />
249&lt;-last.set0<br />
&lt;tfgld1100m000 1 ok<br />
&gt;tfgld1100m000 get.field:tfgld100.btno<br />
&lt;tfgld1100m000 get.field:tfgld100.btno=16745<br />
&gt;tfgld1100m000 put.field:tfgld100.tedt 09112002<br />
&gt;tfgld1100m000 get.field:tfgld100.tedt<br />
&lt;tfgld1100m000 get.field:tfgld100.tedt=09112002<br />
&gt;tfgld1100m000 put.field:tfgld100.year 2002<br />
&gt;tfgld1100m000 get.field:tfgld100.year<br />
&lt;tfgld1100m000 get.field:tfgld100.year=2002<br />
&gt;tfgld1100m000 put.field:tfgld100.btno 16746<br />
&gt;tfgld1100m000 get.field:tfgld100.btno<br />
&lt;tfgld1100m000 get.field:tfgld100.btno=16746<br />
&gt;tfgld1100m000 put.field:tfgld100.btno jai gurudeva<br />
&gt;tfgld1100m000 get.field:tfgld100.btno<br />
&lt;tfgld1100m000 get.field:tfgld100.btno=jai gurude<br />
&gt;tfgld1100m000 put.field:tfgld100.fprd 9<br />
&gt;tfgld1100m000 get.field:tfgld100.fprd<br />
&lt;tfgld1100m000 get.field:tfgld100.fprd=9<br />
&gt;tfgld1100m000 put.field:tfgld100.rprd 3<br />
&gt;tfgld1100m000 get.field:tfgld100.rprd<br />
&lt;tfgld1100m000 get.field:tfgld100.rprd=3<br />
&gt;tfgld1100m000 put.field:tfgld100.vyer 2002<br />
&gt;tfgld1100m000 get.field:tfgld100.vyer<br />
&lt;tfgld1100m000 get.field:tfgld100.vyer=2002<br />
&gt;tfgld1100m000 put.field:tfgld100.vprd 9<br />
&gt;tfgld1100m000 get.field:tfgld100.vprd<br />
&lt;tfgld1100m000 get.field:tfgld100.vprd=9<br />
&gt;tfgld1100m000 save<br />
249-&gt;update.db<br />
249&lt;-update.db0<br />
&lt;tfgld1100m000 <br />
&gt;tfgld1100m000 end.session<br />
249-&gt;end.program<br />
249&lt;-end.program1<br />
<br />
<br />
ofcourse i tried a combn of both stpapi.insert(0 , err)<br />
and then stpapi.save<br />
<br />
but same thing....insert gives a error message as above <br />
and save says successful....<br />
But when i check whether it has inserted the record...the answer is always - NO<br />
<br />
regards<br />
Rohan</div></div><hr />


<div class="post"><div class="posttop"><div class="username">**SAT**</div><div class="date">12th September 2002, 08:34</div></div><div class="posttext">Can you please post your code here, so that someone can find out what the error is.<br />
Regards,</div></div><hr />


<div class="post"><div class="posttop"><div class="username">lbencic</div><div class="date">12th September 2002, 17:18</div></div><div class="posttext">the message tfgldd0004 message comes up when the tedt.f field on the form is 0.  That's the Transaction Entry Date field.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ssellens</div><div class="date">12th September 2002, 17:26</div></div><div class="posttext">Hi Rohan,<br />
<br />
I am not 100% sure on this but I think save will only work to an already existing record, and does not invoke the insert function on the table.<br />
<br />
Steve</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rohan_rege</div><div class="date">12th September 2002, 18:03</div></div><div class="posttext">Hi , <br />
i am posting my code wrt my prev post.<br />
<br />
as i said, even after putting all the  fields i am getting the error<br />
&quot;Value cannot be Zero&quot; when i use stpapi.insert <br />
<br />
any suggestions ?????????<br />
function in.tfgld1100m000()<br />
{<br />
string inpdate(8)<br />
<br />
string transaction_date(10)<br />
string fiscal_year(10)<br />
string batch_descr(10)<br />
string fiscal_period(10)<br />
string rprt_period(10)<br />
string tax_year(10)<br />
string tax_period(10)<br />
string batch_no(10)<br />
long rc , batno<br />
<br />
rc = f1100m000.last( )<br />
stpapi.get.field( &quot;tfgld1100m000&quot;, &quot;tfgld100.btno&quot;, batch_no )<br />
message(batch_no)<br />
<br />
<br />
<br />
<br />
inpdate = date.to.inputstr$( date.num() , &quot;%D002&quot;, 8 )<br />
<br />
<br />
<br />
stpapi.put.field( &quot;tfgld1100m000&quot;, &quot;tfgld100.tedt&quot;, inpdate)<br />
stpapi.get.field( &quot;tfgld1100m000&quot;, &quot;tfgld100.tedt&quot;, transaction_date)<br />
message(transaction_date)<br />
<br />
<br />
<br />
<br />
stpapi.put.field( &quot;tfgld1100m000&quot;, &quot;tfgld100.year&quot;, &quot;2002&quot; )<br />
stpapi.get.field( &quot;tfgld1100m000&quot;, &quot;tfgld100.year&quot;, fiscal_year )<br />
message(fiscal_year )<br />
<br />
batno = val(batch_no)<br />
batno = batno+1<br />
batch_no = str$(batno)<br />
<br />
stpapi.put.field( &quot;tfgld1100m000&quot;, &quot;tfgld100.btno&quot;, batch_no )<br />
stpapi.get.field( &quot;tfgld1100m000&quot;, &quot;tfgld100.btno&quot;, batch_no )<br />
message(batch_no)<br />
<br />
|f1100m000.put.Batch_Reference(&quot;test&quot;)<br />
<br />
stpapi.put.field( &quot;tfgld1100m000&quot;, &quot;tfgld100.btno&quot;, &quot;test&quot; )<br />
stpapi.get.field( &quot;tfgld1100m000&quot;, &quot;tfgld100.btno&quot;, batch_descr)<br />
<br />
<br />
message(batch_descr)<br />
<br />
stpapi.put.field( &quot;tfgld1100m000&quot;, &quot;tfgld100.fprd&quot;, &quot;9&quot; )<br />
stpapi.get.field( &quot;tfgld1100m000&quot;, &quot;tfgld100.fprd&quot;, fiscal_period )<br />
message(fiscal_period)<br />
<br />
stpapi.put.field( &quot;tfgld1100m000&quot;, &quot;tfgld100.rprd&quot;, &quot;3&quot; )<br />
stpapi.get.field( &quot;tfgld1100m000&quot;, &quot;tfgld100.rprd&quot;, rprt_period )<br />
message(rprt_period)<br />
<br />
<br />
stpapi.put.field( &quot;tfgld1100m000&quot;, &quot;tfgld100.vyer&quot;, &quot;2002&quot; )<br />
stpapi.get.field( &quot;tfgld1100m000&quot;, &quot;tfgld100.vyer&quot;, tax_year )<br />
message(tax_year)<br />
<br />
<br />
stpapi.put.field( &quot;tfgld1100m000&quot;, &quot;tfgld100.vprd&quot;, &quot;9&quot; )<br />
stpapi.get.field( &quot;tfgld1100m000&quot;, &quot;tfgld100.vprd&quot;, tax_period )<br />
message(tax_period)<br />
<br />
<br />
<br />
<br />
| f1100m000.insert(0,err)<br />
<br />
<br />
ret = stpapi.insert(&quot;tfgld1100m000&quot; , true , err)<br />
<br />
<br />
if(strip$(err)&lt;&gt;&quot;&quot;) then<br />
	msg = f1100m000.get.last.message.code()<br />
	msg = &quot;tfgld1100m000 insert: &quot;&amp; strip$(err)&amp;&quot; &quot;&amp; strip$(msg)<br />
<br />
	message(msg)<br />
else <br />
	message(&quot; test successfull &quot; )<br />
endif<br />
<br />
<br />
<br />
<br />
f1100m000.end( )	<br />
}</div></div><hr />


<div class="post"><div class="posttop"><div class="username">lbencic</div><div class="date">12th September 2002, 18:28</div></div><div class="posttext">The error comes when the transaction date is 0.<br />
<br />
I think when you fill the date, you should just use<br />
<br />
<br />
<br />
stpapi.put.field( &quot;tfgld1100m000&quot;, &quot;tfgld100.tedt&quot;, str$(date.num()))<br />
<br />
<br />
<br />
That's what the help example shows in the AFS Developer's guide.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rohan_rege</div><div class="date">12th September 2002, 19:29</div></div><div class="posttext">hi ,<br />
<br />
thanks for fixing the problem...<br />
<br />
its working fine now......<br />
<br />
i just wanted  to know one more thing...<br />
<br />
whenever i got to enter a system date into the field , i now know that i have to use str$(date.num() as in<br />
<br />
stpapi.put.field( &quot;tfgld1100m000&quot;, &quot;tfgld100.tedt&quot;, str$(date.num()))<br />
<br />
But suppose the input is to be read from an ascii file.<br />
since the date there is in string format...<br />
how do we transform it into a date which has the same domain format as req by the table field where it will be inserted.<br />
<br />
eg. suppose the corr.  date field in the table has a domain : tfgld.date.<br />
<br />
i tried using the date commands in baan , but was not successful at it as of yet....being very new to coding in baan<br />
<br />
this is what i tried :<br />
<br />
num.day   = val(budt(3;2))<br />
        num.month = val(budt(1;2))<br />
        num.year  = val(budt(5;4))<br />
        tfgld998.budt = date.to.num(num.year, num.month, num.day)<br />
<br />
but it gives a fatal error 205..out of range..when i try to insert this fiel in the table <br />
<br />
obviously , bcoz the tfgld998.budt ..didnt receive the date input in the format desired....<br />
<br />
the domain of tfgld998.budt is tfgld.date ,with format %D002<br />
<br />
pls give some suggestions if possible<br />
<br />
regards,<br />
Rohan</div></div><hr />


<div class="post"><div class="posttop"><div class="username">lbencic</div><div class="date">12th September 2002, 19:39</div></div><div class="posttext">If the date itself is an illegal format - the domain error is 'Date not allowed'.  Since you are getting the 205 / out of range error, I think maybe it's not the date command.  The date.to.num syntax looks fine.<br />
<br />
The out of range maybe has to do with the string parsing - although the syntax looks fine here too.  Try through debug and make sure your num.day, num.month and num.year are having the values you expect.  They should be declared as longs.  Also, maybe use the 'lval' instead of 'val'.  It's a little quicker anyway even if it is not the problem.</div></div><hr />



</div>
</body>
</html>