<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="Try to create AFS for session ttadv6420m000, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] Try to create AFS for session ttadv6420m000 AFS/DDC/OLE: Function servers" />
	
	<title>Try to create AFS for session ttadv6420m000 [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="index.html">Newbaanboard</a> &gt; <a href="index.html">Baan SIGs</a> &gt; <a href="index.html">AFS/DDC/OLE: Function servers</a> &gt; Try to create AFS for session ttadv6420m000</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">gous99</div><div class="date">8th January 2003, 23:01</div></div><div class="posttext">Hi,<br />
<br />
Is it possible to create AFS for tools sessions?<br />
<br />
I tried with session ttadv6420m000, and it does not print anything, does not even give me any error message...  Here is the code, I tried with both, stpapi.continue.process() as well as with stpapi.print.report() and nothing happens. It goes through the code, end the session with no problem, but it never print anything...<br />
<br />
function start.process()		<br />
{<br />
	stpapi.put.field(&quot;ttadv6420m000&quot;, &quot;cpac&quot;, &quot;tp&quot;)<br />
	stpapi.put.field(&quot;ttadv6420m000&quot;, &quot;vers&quot;, &quot;B40o&quot;)<br />
	stpapi.put.field(&quot;ttadv6420m000&quot;, &quot;rele&quot;, &quot;22&quot;)<br />
	stpapi.put.field(&quot;ttadv6420m000&quot;, &quot;cust&quot;, &quot;prd&quot;)<br />
	stpapi.put.field(&quot;ttadv6420m000&quot;, &quot;labels&quot;, &quot;ttyeno.yes&quot;)<br />
	stpapi.put.field(&quot;ttadv6420m000&quot;, &quot;forms&quot;, &quot;ttyeno.yes&quot;)<br />
	stpapi.put.field(&quot;ttadv6420m000&quot;, &quot;menus&quot;, &quot;ttyeno.yes&quot;)<br />
	stpapi.put.field(&quot;ttadv6420m000&quot;, &quot;reports&quot;, &quot;ttyeno.yes&quot;)<br />
	stpapi.put.field(&quot;ttadv6420m000&quot;, &quot;sessions&quot;, &quot;ttyeno.yes&quot;)<br />
	stpapi.put.field(&quot;ttadv6420m000&quot;, &quot;ifunctions&quot;, &quot;ttyeno.yes&quot;)<br />
	stpapi.put.field(&quot;ttadv6420m000&quot;, &quot;functions&quot;, &quot;ttyeno.yes&quot;)<br />
	stpapi.put.field(&quot;ttadv6420m000&quot;, &quot;scripts&quot;, &quot;ttyeno.yes&quot;)<br />
	stpapi.put.field(&quot;ttadv6420m000&quot;, &quot;charts&quot;, &quot;ttyeno.yes&quot;)<br />
	stpapi.put.field(&quot;ttadv6420m000&quot;, &quot;messages&quot;, &quot;ttyeno.yes&quot;)<br />
	stpapi.put.field(&quot;ttadv6420m000&quot;, &quot;questions&quot;, &quot;ttyeno.yes&quot;)<br />
	stpapi.put.field(&quot;ttadv6420m000&quot;, &quot;tables&quot;, &quot;ttyeno.yes&quot;)<br />
	stpapi.put.field(&quot;ttadv6420m000&quot;, &quot;domains&quot;, &quot;ttyeno.yes&quot;)<br />
	stpapi.put.field(&quot;ttadv6420m000&quot;, &quot;clan.f&quot;, &quot;2&quot;)		<br />
	stpapi.put.field(&quot;ttadv6420m000&quot;, &quot;clan.t&quot;, &quot;2&quot;)<br />
	stpapi.put.field(&quot;ttadv6420m000&quot;, &quot;also.reln&quot;, &quot;ttyeno.no&quot;)<br />
	stpapi.put.field(&quot;ttadv6420m000&quot;, &quot;also.docu&quot;, &quot;ttyeno.no&quot;)<br />
<br />
<br />
<br />
	stpapi.set.report(&quot;ttadv6420m000&quot;, &quot;rttadv642001000&quot;, device, gapi.error.code)<br />
     if strip$(gapi.error.code) &lt;&gt; &quot;&quot; then<br />
          message(&quot;Could not open report&quot;)<br />
          message(&quot;The error is: &quot; &amp; gapi.error.code)<br />
          stpapi.end.session(&quot;ttadv6420m000&quot;)<br />
     else<br />
          |stpapi.continue.process(&quot;ttadv6420m000&quot;, gapi.error.code)<br />
	stpapi.print.report(&quot;ttadv6420m000&quot;, gapi.error.code)<br />
          if strip$(gapi.error.code) &lt;&gt; &quot;&quot; then<br />
               message(&quot;Could not process session Print Component by VRC&quot;)<br />
               message(&quot;The error is: &quot; &amp; gapi.error.code)<br />
               stpapi.end.session(&quot;ttadv6420m000&quot;)<br />
          endif<br />
     endif<br />
     stpapi.end.session(&quot;ttadv6420m000&quot;)<br />
}</div></div><hr />


<div class="post"><div class="posttop"><div class="username">NPRao</div><div class="date">8th January 2003, 23:13</div></div><div class="posttext">Yes it is possible to make AFS/API for the tools sessions.<br />
<br />
Refer to the thread on the board - AFS and ttstpapi (http://www.baanboard.com/baanboard/showthread.php?s=&amp;threadid=1227&amp;highlight=afs) <br />
<br />
You might need to take precautions to remove the user defaults for that session and also to set the proper device or redirect to a file (the &quot;D&quot; doesnt work).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">9th January 2003, 00:38</div></div><div class="posttext">NPR is correct - you can create AFS function servers on tools sessions.  I know there has been a couple of posts on this in the past, so you might want to try searching this forum.<br />
<br />
I also noticed like NPR that there is nothing defining device in the code, is this a mistake? I have created some function servers that ran to the device D, but none of them were tools sessions.<br />
<br />
Mark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">gous99</div><div class="date">9th January 2003, 16:41</div></div><div class="posttext">If the user slects to output to a file (ASCII device, for example), how do I set the location of the file, is it possible, or will it always be put in the home directory of the user under Fileout?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">9th January 2003, 18:30</div></div><div class="posttext">Typically what I do in function servers that generate reports is to use spool.open.  Something like rprt_id = spool.open(&quot;&quot;,spool.device,1) - this way the user gets to pick where the report is sent.  If they want it in a file, then they pick ASCIF and change the FILEOUT to whatever filename and location they want.  Of course your ASCIF device must have change allowed selected so they can change fileout.  <br />
<br />
Also when I hard code in the device of ASCIF I also set the spool.fileout variable to what I want it to be. Hope this helps.<br />
<br />
Mark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">gous99</div><div class="date">9th January 2003, 18:33</div></div><div class="posttext">Thanks.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">9th January 2003, 19:27</div></div><div class="posttext">This is from a session that prints PO's:<br />
<br />
<br />
	rpt_id = spool.open(&quot;&quot;,spool.device,1)<br />
<br />
| Make sure screen was not selected<br />
	if(orno.t - orno.f &gt;10) then<br />
		select	ttaad300.devt<br />
		from	ttaad300<br />
		where	ttaad300.devc = :spool.device<br />
		and	ttaad300._compnr = 0<br />
		selectdo<br />
		endselect<br />
		if(ttaad300.devt = ttaad.devt.stepw.display) then<br />
			message(&quot;Only 10 Purchase Orders can be displayed on the screen&quot;)<br />
			rpt_id=0<br />
		endif<br />
	endif<br />
	if( rpt_id = 0) then		| Status for cancel<br />
		choice.again()<br />
	endif<br />
	spool.close()<br />
	select.po.to.print()<br />
<br />
<br />
Notice how I do spool.close before calling the subroutine to print the PO range.<br />
<br />
Sample of ASCIF:<br />
<br />
| Create temporary file for error records.<br />
	spool.device = &quot;ASCIF&quot;  | To file<br />
	tmp.rpt.name = creat.tmp.file$(bse.tmp.dir$())<br />
        tmp.rpt.name = strip$(tmp.rpt.name)<br />
        spool.fileout = tmp.rpt.name<br />
<br />
| Generate Report<br />
	stpapi.set.report(&quot;tppss9269m00b&quot;,&quot;rtppss92690100b&quot;,spool.device,errmsg)<br />
<br />
<br />
In this example I create a temporary file to write the report to, then later in the report I copy it down to the users PC using server2client.<br />
<br />
Mark</div></div><hr />



</div>
</body>
</html>