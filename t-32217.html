<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="AFS / BWC problem, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] AFS / BWC problem AFS/DDC/OLE: Function servers" />
	
	<title>AFS / BWC problem [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="index.html">Newbaanboard</a> &gt; <a href="index.html">Baan SIGs</a> &gt; <a href="index.html">AFS/DDC/OLE: Function servers</a> &gt; AFS / BWC problem</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">RobertB</div><div class="date">6th March 2007, 11:25</div></div><div class="posttext">Hi all,<br />
<br />
I've created an AFS &quot;project&quot; consisting of an Excel/VBA file and a custom session in Baan. All runs well on my test machine, where the following VBA code creates a VBA-global object:<br />
<br />
  Set oBaanObj = CreateObject(&quot;Baan.Application.SpecialServerLogin&quot;)<br />
However, whe we came to install this Excel file on another machine where the &quot;SpecialServerLogin&quot; BWC client has also been configured, we encountered an error where the VBA oBaanObj object could not be initialized. Investigation quickly showed that, although the BWC had been configured by our admin correctly, the &quot;Automation&quot; tab-page on the BWC client configuration window revealed that the Class Name for this client had been saved as &quot;Baan.Application.SpecialServerLogin.1&quot; - note the &quot;.1&quot; at the end.<br />
<br />
Firstly, we suspect that this fourth part to the class name is not accepable to the Excel/VBA &quot;automation engine&quot;, and hence the object cannot be created; and secondly, that we have no idea where the &quot;.1&quot; comes from, and no idea of how to remove it, or prevent it from appearing in the Class Name.<br />
<br />
The question is: has anybody else here come across this problem, and do they know how to fix it?<br />
<br />
TIA,<br />
Rob</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Al Smith</div><div class="date">6th March 2007, 21:52</div></div><div class="posttext">Hi,<br />
Usually the .# after the class name is the current version of multi-version classes.<br />
I didn't think Baan created multi-version automation objects but to determine if this is indeed the case, you'll have to explore the registry in the machine.<br />
<br />
Warning:  Incorrectly editing the registry may severely damage your system.<br />
<br />
If you're comfortable doing this:<br />
<br />
Run regedit.exe<br />
Expand the HKCR tree.<br />
Scroll down to the Baan.Application... keys.<br />
There will be a Baan.Application... key for each bwc on the machine.<br />
<br />
There also may be orphaned Baan.Application... keys for bwc's that no longer exist.<br />
When a bwc is removed from a machine, its automation object is not un-registered.<br />
<br />
The next steps to take depend on what you find with the above process.<br />
<br />
Al.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">RobertB</div><div class="date">14th March 2007, 08:16</div></div><div class="posttext">Hi Al,<br />
<br />
Sorry for the delay - I had a few days vacation. I'll have to wait until tomorrow until our admin guy gets back from a meeting, then we'll try your suggestions. Understand, as programmer, I'm not allowed to touch anything in kase I scruw sumthin up reel bad :rolleyes:  <br />
<br />
Rob</div></div><hr />


<div class="post"><div class="posttop"><div class="username">RobertB</div><div class="date">16th March 2007, 08:45</div></div><div class="posttext">Hi Al,<br />
<br />
Your tip proved to be correct - we cleared out the orphaned registry entries and all is running OK - thanks!<br />
<br />
Rob</div></div><hr />



</div>
</body>
</html>