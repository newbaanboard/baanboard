<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="CODE: Table Loader, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] CODE: Table Loader Code &amp; Utilities" />
	
	<title>CODE: Table Loader [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="index.html">Newbaanboard</a> &gt; <a href="index.html">Baan SIGs</a> &gt; <a href="index.html">Code &amp; Utilities</a> &gt; CODE: Table Loader</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">~Vamsi</div><div class="date">3rd December 2001, 21:23</div></div><div class="posttext">Norbert Wimmer sent this one in. Thanks Norbert.<br />
<br />
<br />
|******************************************************************************<br />
|* tdzus9400msql  0  VRC B40C c4 RUG<br />
|* Title	: Table Loader - Source and Data Generator<br />
|*		: Erzeuge Prog. fuer SQL-Export<br />
|* Author	: Norbert Wimmer<br />
|* Date		: 2001-09-19<br />
|******************************************************************************<br />
|* Main table tdzus900 Historie Schnittstelle Export, Form Type 4<br />
|******************************************************************************<br />
|* Script Type	: Type 4 Without Main Table<br />
|* Description	: &lt;library description&gt;<br />
|* Category	: Utility<br />
|* License	:<br />
|* Copyright 2001 by Norbert Wimmer<br />
|*<br />
|* All Rights Reserved<br />
|*<br />
|* Permission to use, copy, modify, and distribute this software and its<br />
|* documentation for any purpose and without fee is hereby granted,<br />
|* provided that the above copyright notice appear in all copies and that<br />
|* both that copyright notice and this permission notice appear in<br />
|* supporting documentation.<br />
|*<br />
|* Norbert Wimmer and Baanboard.com DISCLAIM ALL WARRANTIES WITH REGARD TO THIS<br />
|* SOFTWARE, INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY<br />
|* AND FITNESS, IN NO EVENT SHALL Norbert Wimmer nor Baanboard.com BE LIABLE FOR ANY<br />
|* SPECIAL, INDIRECT OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES<br />
|* WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS,<br />
|* WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER<br />
|* TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE<br />
|* OR PERFORMANCE OF THIS SOFTWARE.<br />
|******************************************************************************<br />
|* What it does:<br />
|* you enter a table and its PC. A script is produced, which, when compiled and<br />
|* run, produces two files: xxxx.sql contains the SQL statements needed to<br />
|* create this table in a database, xxxx.dat contains the data of this table,<br />
|* ready to be loaded into the new database table.<br />
|* <br />
|* The form is missing, but simple.<br />
|* 7 input fields: 3 for table package/module/name. 3 for  package combination<br />
|* like B40C c4 namx and a string containing the directory for the output file.<br />
|* This program creates an ascii file which can be loaded as a source and then<br />
|* be compiled.<br />
|* The only fault it has is that it assumes that the PVRC is derived from<br />
|* B40Uc4stnd, which itself is derived from B40c4. This may have to be changed<br />
|* in the source.<br />
|******************************************************************************<br />
|****************************** declaration section ***************************<br />
declaration:<br />
<br />
	table	tttadv400       | domains<br />
	table	tttadv401       | enums + constraints<br />
	table	tttadv402       | enum Description<br />
	table	tttadv420       | table definitions<br />
	table	tttadv421       | table indices<br />
	table	tttadv422       | table fields<br />
	table	tttadv423       | child fields<br />
<br />
<br />
	extern	domain	tcmcs.str2      t1<br />
	extern	domain	tcmcs.str3      t2<br />
	extern	domain	tcmcs.str3      t3<br />
	extern	domain	tcmcs.str4      t4<br />
	extern	domain	tcmcs.str2      t5<br />
	extern	domain	tcmcs.str4      t6<br />
	extern	domain	tcmcs.str70     dirnam<br />
	      	domain	tcmcs.str2      cpac<br />
	      	domain	tcmcs.str12     cdom<br />
	      	domain	tcmcs.str4      vers<br />
         	domain	tcmcs.str2      rele<br />
	      	domain	tcmcs.str4      cust<br />
                        string          buff(300)<br />
                        string          tabnam(8)<br />
.....................<br />
<br />
<br />
<br />
Please see the attached file for the full code</div></div><hr />


<div class="post"><div class="posttop"><div class="username">csekhar</div><div class="date">13th March 2002, 22:42</div></div><div class="posttext">Vamsi,<br />
   What is the usage of this script ?? I downloaded the script and from the documentation also it is not clear what this script does. The reason I'm asking is we are planning to move to IVc4. We are right now on Baan IVc. We modified some of the table definitions like making some fields mandatory / adding additional fields etc. Please let me know the usage of this script. Where can I use this script ??<br />
Regards<br />
Chandu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">~Vamsi</div><div class="date">14th March 2002, 03:32</div></div><div class="posttext">This was one of the first scripts that got uploaded to this forum. Norbert is the Author. I have not used it and am unable to explain the full use of it. May be Norbert will notice the thread and reply.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">norwim</div><div class="date">26th February 2003, 14:05</div></div><div class="posttext">sorry for this VERY late reply.<br />
The idea of this script is the following:<br />
you need to create a seq. dump of table but can't use bdbpre.<br />
So what this script does is:<br />
read in the PVRC and a table name (from a form to be created)<br />
plus a directory-name.<br />
<br />
Now the program reads the information about the table from the tools tables (indices, fields, domains etc.) and creates a seq. file:<br />
<br />
This (newly created) file is a template ready to be translated with Baan compiler and contains two functions:<br />
1) first function to create a file containing the field descriptions (to be used later to create that table under mysql)<br />
2) second function to write one record of that table<br />
 <br />
The program created has a select statement that reads the table and calls the second function for each record.<br />
<br />
Note that the directoryname passed will be used for the output commands in both functions.<br />
<br />
We use this script here from time to time to append an existing program script that dumps a load of tables each night.<br />
<br />
hth<br />
<br />
Norbert</div></div><hr />



</div>
</body>
</html>