<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="Problem with API tdpur4210m100, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] Problem with API tdpur4210m100 AFS/DDC/OLE: Function servers" />
	
	<title>Problem with API tdpur4210m100 [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="index.html">Newbaanboard</a> &gt; <a href="index.html">Baan SIGs</a> &gt; <a href="index.html">AFS/DDC/OLE: Function servers</a> &gt; Problem with API tdpur4210m100</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">gget79</div><div class="date">11th September 2008, 15:56</div></div><div class="posttext">Hi BaanExperts,  <br />
  <br />
I am using Infor SSA LN  <br />
  <br />
I am making a session that by means API can use the logic the approvals purchase orders (tdpur4210m100), but I always get the same error &quot;No process data found.&quot;, but with the same information by the functional session I don't get the error message and all the process have been completed with success.  <br />
  <br />
I am using the following code<br />
<br />
<br />
function extern domain tcbool tccpedll.aporc.aprobar.ordenes.compras(<br />
						|Rango de selección						<br />
						domain 	tcorno		p.orno.f,			| De - Orden de compra<br />
						domain 	tcorno		p.orno.t,			| A - Orden de compra<br />
						domain 	tccom.bpid	p.otbp.f,			| De - Partner proveedor<br />
						domain 	tccom.bpid	p.otbp.t,			| A - Partner proveedor<br />
						domain 	tccwoc		p.cofc.f,			| De - Departamento de compras<br />
						domain 	tccwoc		p.cofc.t,			| A - Departamento de compras<br />
						domain 	tcemno		p.ccon.f,			| De - Comprador<br />
						domain 	tcemno		p.ccon.t,			| A - Comprador<br />
						domain 	tcemno		p.plnr.f,			| De - Planificador<br />
						domain 	tcemno		p.plnr.t,			| A - Planificador<br />
						domain 	tcdate		p.ref.date.f,		| De - fecha de referencia<br />
						domain 	tcdate		p.ref.date.t,		| A - fecha de referencia<br />
						|Criterio de aprobación<br />
						domain 	tcyesno		p.appr.rules,		| ¿Aplicar reglas de aprobación?<br />
						domain 	tcamnt		p.amnt.upto,		| Importe maximo<br />
						domain 	tcccur		p.ccur,				| Divisa<br />
						|Opciones<br />
						domain 	tcyesno		p.log.success,		| ¿Listar órdenes aprobadas?<br />
						domain 	tcyesno		p.log.report,		| ¿Listar errores?<br />
						ref		String 		p.mensaje.error	| Devuelve mensajes de error<br />
				)<br />
{<br />
				<br />
			|Rango de selección<br />
			stpapi.put.field(&quot;tdpur4210m100&quot;,&quot;orno.f&quot;,str$(p.orno.f))						| De - Orden de compra<br />
			stpapi.put.field(&quot;tdpur4210m100&quot;,&quot;orno.t&quot;,str$(p.orno.t))						| A - Orden de compra<br />
			stpapi.put.field(&quot;tdpur4210m100&quot;,&quot;otbp.f&quot;,str$(p.otbp.f))						| De - Partner proveedor<br />
			stpapi.put.field(&quot;tdpur4210m100&quot;,&quot;otbp.t&quot;,str$(p.otbp.t))						| A - Partner proveedor<br />
			stpapi.put.field(&quot;tdpur4210m100&quot;,&quot;cofc.f&quot;,str$(p.cofc.f))						| De - Departamento de compras<br />
			stpapi.put.field(&quot;tdpur4210m100&quot;,&quot;cofc.t&quot;,str$(p.cofc.t))						| A - Departamento de compras<br />
			stpapi.put.field(&quot;tdpur4210m100&quot;,&quot;ccon.f&quot;,str$(p.ccon.f))						| De - Comprador<br />
			stpapi.put.field(&quot;tdpur4210m100&quot;,&quot;ccon.t&quot;,str$(p.ccon.t))						| A - Comprador<br />
			stpapi.put.field(&quot;tdpur4210m100&quot;,&quot;plnr.f&quot;,str$(p.plnr.f))						| De - Planificador<br />
			stpapi.put.field(&quot;tdpur4210m100&quot;,&quot;plnr.t&quot;,str$(p.plnr.t))						| A - Planificador<br />
			stpapi.put.field(&quot;tdpur4210m100&quot;,&quot;ref.date.f&quot;,str$(p.ref.date.f))				| De - fecha de referencia<br />
			stpapi.put.field(&quot;tdpur4210m100&quot;,&quot;ref.date.t&quot;,str$(p.ref.date.t))				| A - fecha de referencia<br />
			<br />
			<br />
			|Criterio de aprobación<br />
 			<br />
			<br />
			stpapi.put.field(&quot;tdpur4210m100&quot;,&quot;appr.rules&quot;,str$(etol(p.appr.rules)))		| ¿Aplicar reglas de aprobación?<br />
			<br />
			if p.appr.rules = tcyesno.no then														| Si aplica reglas de aprobación<br />
				stpapi.put.field(&quot;tdpur4210m100&quot;,&quot;amnt.upto&quot;,str$(p.amnt.upto))				| Importe maximo<br />
				stpapi.put.field(&quot;tdpur4210m100&quot;,&quot;ccur&quot;,str$(p.ccur))								| Divisa<br />
			endif<br />
			<br />
			<br />
			|Opciones<br />
			stpapi.put.field(&quot;tdpur4210m100&quot;,&quot;log.success&quot;,str$(etol(p.log.success)))	| ¿Listar órdenes aprobadas?<br />
			stpapi.put.field(&quot;tdpur4210m100&quot;,&quot;log.report&quot;,str$(etol(p.log.report)))		| ¿Listar errores?<br />
<br />
			| obtener reportes<br />
			stpapi.set.report(&quot;tdpur4210m100&quot;, &quot;rtdpur421010001&quot;, &quot;NULO&quot;, g.err.rpt)<br />
			stpapi.set.report(&quot;tdpur4210m100&quot;, &quot;rtdpur421010002&quot;, &quot;NULO&quot;, g.err.rpt)<br />
			| ejecutar boton aprobar<br />
			stpapi.form.command(&quot;tdpur4210m100&quot;, 5, &quot;exec.cont.process&quot;,g.err.aprobar)<br />
			| obtener errores<br />
			g.err.code = stpapi.get.mess.code(&quot;tdpur4210m100&quot;,g.err.text)				<br />
			<br />
			if g.err.text=&quot;Proceso completado.&quot; then				| si g.err.text= &quot;Proceso completado.&quot;<br />
				g.err.text=&quot;&quot;												| excluir como error<br />
			endif<br />
			| cerrar la sesion tdpur4210m100<br />
			stpapi.end.session(&quot;tdpur4210m100&quot;, g.err.end)<br />
		<br />
			| Verifico que no existan errores<br />
			p.mensaje.error = trim$(g.err.aprobar &amp; &quot; &quot; &amp; g.err.text &amp; &quot; &quot; &amp; g.err.end)<br />
<br />
	return( isspace( p.mensaje.error ) )<br />
}<br />
<br />
<br />
Anybody can help me?<br />
<br />
Thak you very much</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">13th September 2008, 19:03</div></div><div class="posttext">I do not know about LN, but on 4C4 I have had several that worked that did generate return(or error) messages like &quot;no data&quot;.  In those cases I just ignored the error or programmed around it.</div></div><hr />



</div>
</body>
</html>