<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="API for the session timps4701m000, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] API for the session timps4701m000 AFS/DDC/OLE: Function servers" />
	
	<title>API for the session timps4701m000 [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="index.html">Newbaanboard</a> &gt; <a href="index.html">Baan SIGs</a> &gt; <a href="index.html">AFS/DDC/OLE: Function servers</a> &gt; API for the session timps4701m000</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">lli-baan</div><div class="date">30th March 2005, 12:49</div></div><div class="posttext">Hello,<br />
<br />
we are using the API-Functioanlity quiet often!<br />
Now we will use the API for the session timps4701m000 (rough capacty utilisation).<br />
Unfortunately we can't find the APT-function for the &quot;next.frm&quot;. With the next.frm the session normally calculate the capacity!<br />
Does anybody now, how to use the API in ASCII-Session timps4701m000?<br />
<br />
Thank u 4 your help!!!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">RobertB</div><div class="date">30th March 2005, 15:51</div></div><div class="posttext">Hi,<br />
<br />
Try creating an AFS-DLL for your session with ttstpcreatdll to see what wrapper functions are generated. These should give you a clue as to how to proceed.<br />
<br />
HTH,<br />
Rob</div></div><hr />


<div class="post"><div class="posttop"><div class="username">lli-baan</div><div class="date">30th March 2005, 16:04</div></div><div class="posttext">These are the &quot;action&quot;-functions in the AFS! We tried a few, but without the right result. Which one is the right one?<br />
<br />
function extern void timpsf4701m000.end([string error(500)])<br />
{<br />
DLLUSAGE<br />
	Function to end connection to session timps4701m000<br />
ENDDLLUSAGE<br />
	if get.argc() = 0 then<br />
		stpapi.end.session( &quot;timps4701m000&quot; ) <br />
	else<br />
		error = get.string.arg(1)<br />
		stpapi.end.session( &quot;timps4701m000&quot; , error  )<br />
		put.string.arg(1, error)<br />
	endif<br />
}<br />
<br />
function extern long timpsf4701m000.update( long do.update, ref string error )<br />
{<br />
DLLUSAGE<br />
	Function to update a record in session timps4701m000<br />
	Record must be made current and fields to be changed before calling<br />
	this function<br />
ENDDLLUSAGE<br />
	return( stpapi.update( &quot;timps4701m000&quot;, do.update, error ) )<br />
}<br />
<br />
function extern long timpsf4701m000.mark([string error (500)])<br />
{<br />
DLLUSAGE<br />
	Function to mark the current record in session timps4701m000<br />
ENDDLLUSAGE<br />
	long ret<br />
	if get.argc() = 0 then<br />
		return( stpapi.mark( &quot;timps4701m000&quot; ) ) <br />
	else<br />
		error = get.string.arg(1)<br />
		ret =  stpapi.mark( &quot;timps4701m000&quot; , error  )<br />
		put.string.arg(1, error)<br />
		return( ret ) <br />
	endif<br />
}<br />
<br />
function extern long timpsf4701m000.save( ref string error )<br />
{<br />
DLLUSAGE<br />
	Function to save an update/insert/delete in session timps4701m000<br />
ENDDLLUSAGE<br />
	return( stpapi.save( &quot;timps4701m000&quot;, error ) )<br />
}<br />
<br />
function extern long timpsf4701m000.find( [string error(500)] )<br />
{<br />
DLLUSAGE<br />
	Function to find a record in session timps4701m000<br />
	Search fields must be put before calling this function<br />
ENDDLLUSAGE<br />
	long ret<br />
	if get.argc() = 0 then<br />
		return( stpapi.find( &quot;timps4701m000&quot;  ) )<br />
	else<br />
		error = get.string.arg(1)<br />
		ret =  stpapi.find( &quot;timps4701m000&quot; , error  )<br />
		put.string.arg(1, error)<br />
		return( ret ) <br />
	endif<br />
}<br />
<br />
function extern void timpsf4701m000.clear( )<br />
{<br />
DLLUSAGE<br />
	Function to clear the current record in session timps4701m000<br />
ENDDLLUSAGE<br />
	stpapi.clear( &quot;timps4701m000&quot; )<br />
}<br />
<br />
function extern void timpsf4701m000.set.report( const string reportname, const string device, ref string error )<br />
{<br />
DLLUSAGE<br />
	Function to set report name and device for a subsequent print action<br />
	in session timps4701m000<br />
ENDDLLUSAGE<br />
	stpapi.set.report( &quot;timps4701m000&quot;, reportname, device, error )<br />
}<br />
<br />
function extern long timpsf4701m000.next([string error(500)] )<br />
{<br />
DLLUSAGE<br />
	Function to find the next record in session timps4701m000<br />
ENDDLLUSAGE<br />
	long ret<br />
	if get.argc() = 0 then<br />
		return( stpapi.browse.set( &quot;timps4701m000&quot;, &quot;next.set&quot; ) )<br />
	else<br />
		error = get.string.arg(1)<br />
		ret = stpapi.browse.set( &quot;timps4701m000&quot;, &quot;next.set&quot; , error )<br />
		put.string.arg(1, error)<br />
		return( ret )<br />
	endif<br />
}<br />
<br />
function extern long timpsf4701m000.previous([string error(500)] )<br />
{<br />
DLLUSAGE<br />
	Function to find the previous record in session timps4701m000<br />
ENDDLLUSAGE<br />
	long ret<br />
	if get.argc() = 0 then<br />
		return( stpapi.browse.set( &quot;timps4701m000&quot;, &quot;prev.set&quot; ) )<br />
	else<br />
		error = get.string.arg(1)<br />
		ret = stpapi.browse.set( &quot;timps4701m000&quot;, &quot;prev.set&quot; , error )<br />
		put.string.arg(1, error)<br />
		return( ret )<br />
	endif<br />
}<br />
<br />
function extern long timpsf4701m000.set.view( [string error(500)] )<br />
{<br />
DLLUSAGE<br />
	Function to define another view in session timps4701m000<br />
ENDDLLUSAGE<br />
	long ret<br />
	if get.argc() = 0 then<br />
		return( stpapi.change.view( &quot;timps4701m000&quot; ) )<br />
	else<br />
		error = get.string.arg(1)<br />
		ret = stpapi.change.view( &quot;timps4701m000&quot;,  error )<br />
		put.string.arg(1, error)<br />
		return( ret )<br />
	endif<br />
}<br />
<br />
function extern long timpsf4701m000.first.view([string error(500)] )<br />
{<br />
DLLUSAGE<br />
	Function to read the first view in session timps4701m000<br />
ENDDLLUSAGE<br />
	long ret<br />
	if get.argc() = 0 then<br />
		return( stpapi.browse.view( &quot;timps4701m000&quot; , &quot;first.view&quot; ) )<br />
	else<br />
		error = get.string.arg(1)<br />
		ret = stpapi.browse.view( &quot;timps4701m000&quot;, &quot;first.view&quot;, error )<br />
		put.string.arg(1, error)<br />
		return( ret )<br />
	endif<br />
}<br />
<br />
function extern long timpsf4701m000.next.view([string error(500)] )<br />
{<br />
DLLUSAGE<br />
	Function to read the next view in session timps4701m000<br />
ENDDLLUSAGE<br />
	long ret<br />
	if get.argc() = 0 then<br />
		return( stpapi.browse.view( &quot;timps4701m000&quot; , &quot;next.view&quot; ) )<br />
	else<br />
		error = get.string.arg(1)<br />
		ret = stpapi.browse.view( &quot;timps4701m000&quot;, &quot;next.view&quot;, error )<br />
		put.string.arg(1, error)<br />
		return( ret )<br />
	endif<br />
}<br />
<br />
function extern long timpsf4701m000.previous.view([string error(500)] )<br />
{<br />
DLLUSAGE<br />
	Function to read the previous view in session timps4701m000<br />
ENDDLLUSAGE<br />
	long ret<br />
	if get.argc() = 0 then<br />
		return( stpapi.browse.view( &quot;timps4701m000&quot; , &quot;prev.view&quot; ) )<br />
	else<br />
		error = get.string.arg(1)<br />
		ret = stpapi.browse.view( &quot;timps4701m000&quot;, &quot;prev.view&quot;, error )<br />
		put.string.arg(1, error)<br />
		return( ret )<br />
	endif<br />
}<br />
<br />
function extern long timpsf4701m000.last.view([string error(500)] )<br />
{<br />
DLLUSAGE<br />
	Function to read the last view in session timps4701m000<br />
ENDDLLUSAGE<br />
	long ret<br />
	if get.argc() = 0 then<br />
		return( stpapi.browse.view( &quot;timps4701m000&quot; , &quot;last.view&quot; ) )<br />
	else<br />
		error = get.string.arg(1)<br />
		ret = stpapi.browse.view( &quot;timps4701m000&quot;, &quot;last.view&quot;, error )<br />
		put.string.arg(1, error)<br />
		return( ret )<br />
	endif<br />
}</div></div><hr />


<div class="post"><div class="posttop"><div class="username">RobertB</div><div class="date">30th March 2005, 16:24</div></div><div class="posttext">OK,<br />
<br />
I don't know this session, but reading the &quot;Guidelines for Baan 4GL application sessions&quot; in the &quot;Developer's Guide for Application Server&quot;, I read thatIf the session has more than one form, keep the form commands (standard and specific) the same (across all forms- Rob). AFS does not have a notion of current form.So, AFS does not have any knowledge of which form a field is on.<br />
<br />
HTH,<br />
Robert</div></div><hr />


<div class="post"><div class="posttop"><div class="username">lli-baan</div><div class="date">30th March 2005, 16:40</div></div><div class="posttext">Thank u,<br />
<br />
in this case it seems that it is not possible to start the session via API!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">RobertB</div><div class="date">30th March 2005, 16:50</div></div><div class="posttext">Might i suggest that you move your code for calculating capacity from the form section of your script to a separate function, which you can then also call from a menu item or button. <br />
<br />
This menu item or button can then be called via AFS.<br />
<br />
HTH, <br />
Servus, Robert</div></div><hr />



</div>
</body>
</html>