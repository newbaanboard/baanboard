<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="AFS for the session tdpcg0200m200, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] AFS for the session tdpcg0200m200 AFS/DDC/OLE: Function servers" />
	
	<title>AFS for the session tdpcg0200m200 [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="index.html">Newbaanboard</a> &gt; <a href="index.html">Baan SIGs</a> &gt; <a href="index.html">AFS/DDC/OLE: Function servers</a> &gt; AFS for the session tdpcg0200m200</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">kingsley143</div><div class="date">4th April 2008, 07:22</div></div><div class="posttext">For the session maintain sales order lines(tdsls4101m000) when i am tring to maintain using afs i am not able to use the line discounts afs-tdpcg0200m200.<br />
The error that i get is &quot;command disabled&quot; .<br />
<br />
<br />
stpapi.handle.subproc( &quot;tdsls4101m000&quot;, &quot;tdpcg0200m200&quot;, &quot;add&quot; )<br />
	stpapi.put.field( &quot;tdpcg0200m200&quot;, &quot;disc.percentage&quot;, str$(disc), 1 )<br />
	stpapi.put.field( &quot;tdpcg0200m200&quot;, &quot;disc.percentage&quot;, str$(disc1), 2 )<br />
	stpapi.put.field( &quot;tdpcg0200m200&quot;, &quot;disc.percentage&quot;, str$(disc2), 3 )<br />
	stpapi.put.field( &quot;tdpcg0200m200&quot;, &quot;disc.percentage&quot;, str$(disc3), 4 )<br />
	stpapi.put.field( &quot;tdpcg0200m200&quot;, &quot;disc.percentage&quot;, str$(disc4), 5 )<br />
	stpapi.put.field( &quot;tdpcg0200m200&quot;, &quot;disc.percentage&quot;, str$(disc5), 6 )<br />
	stpapi.put.field( &quot;tdpcg0200m200&quot;, &quot;disc.percentage&quot;, str$(disc6), 7 )<br />
	stpapi.put.field( &quot;tdpcg0200m200&quot;, &quot;disc.percentage&quot;, str$(disc7), 8 )<br />
	stpapi.put.field( &quot;tdpcg0200m200&quot;, &quot;disc.percentage&quot;, str$(disc8), 9 )<br />
	stpapi.put.field( &quot;tdpcg0200m200&quot;, &quot;disc.percentage&quot;, str$(disc9), 10 )<br />
	stpapi.put.field( &quot;tdpcg0200m200&quot;, &quot;disc.percentage&quot;, str$(disc10), 11 )<br />
	stpapi.put.field( &quot;tdpcg0200m200&quot;, &quot;disc.code&quot;, &quot;&quot;, 1 )<br />
	stpapi.put.field( &quot;tdpcg0200m200&quot;, &quot;disc.code&quot;, &quot;&quot;, 2 )<br />
	stpapi.put.field( &quot;tdpcg0200m200&quot;, &quot;disc.code&quot;, &quot;&quot;, 3 )<br />
	stpapi.put.field( &quot;tdpcg0200m200&quot;, &quot;disc.code&quot;, &quot;&quot;, 4 )<br />
	stpapi.put.field( &quot;tdpcg0200m200&quot;, &quot;disc.code&quot;, &quot;&quot;, 5 )<br />
	stpapi.put.field( &quot;tdpcg0200m200&quot;, &quot;disc.code&quot;, &quot;&quot;, 6 )<br />
	stpapi.put.field( &quot;tdpcg0200m200&quot;, &quot;disc.code&quot;, &quot;&quot;, 7 )<br />
	stpapi.put.field( &quot;tdpcg0200m200&quot;, &quot;disc.code&quot;, &quot;&quot;, 8 )<br />
	stpapi.put.field( &quot;tdpcg0200m200&quot;, &quot;disc.code&quot;, &quot;&quot;, 9 )<br />
	stpapi.put.field( &quot;tdpcg0200m200&quot;, &quot;disc.code&quot;, &quot;&quot;, 10 )<br />
	stpapi.put.field( &quot;tdpcg0200m200&quot;, &quot;disc.code&quot;, &quot;&quot;, 11 )<br />
	stpapi.put.field( &quot;tdpcg0200m200&quot;, &quot;disc.method&quot;, str$(1), 1 )<br />
	stpapi.put.field( &quot;tdpcg0200m200&quot;, &quot;disc.method&quot;, str$(1), 2 )<br />
	stpapi.put.field( &quot;tdpcg0200m200&quot;, &quot;disc.method&quot;, str$(1), 3 )<br />
	stpapi.put.field( &quot;tdpcg0200m200&quot;, &quot;disc.method&quot;, str$(1), 4 )<br />
	stpapi.put.field( &quot;tdpcg0200m200&quot;, &quot;disc.method&quot;, str$(1), 5 )<br />
	stpapi.put.field( &quot;tdpcg0200m200&quot;, &quot;disc.method&quot;, str$(1), 6 )<br />
	stpapi.put.field( &quot;tdpcg0200m200&quot;, &quot;disc.method&quot;, str$(1), 7 )<br />
	stpapi.put.field( &quot;tdpcg0200m200&quot;, &quot;disc.method&quot;, str$(1), 8 )<br />
	stpapi.put.field( &quot;tdpcg0200m200&quot;, &quot;disc.method&quot;, str$(1), 9 )<br />
	stpapi.put.field( &quot;tdpcg0200m200&quot;, &quot;disc.method&quot;, str$(1), 10 )<br />
	stpapi.put.field( &quot;tdpcg0200m200&quot;, &quot;disc.method&quot;, str$(1), 11 )<br />
	stpapi.update( &quot;tdpcg0200m200&quot;, 1, error )<br />
	stpapi.save( &quot;tdpcg0200m200&quot;, error )<br />
	stpapi.end.session( &quot;tdpcg0200m200&quot; , error )</div></div><hr />


<div class="post"><div class="posttop"><div class="username">george7a</div><div class="date">4th April 2008, 08:01</div></div><div class="posttext">Hi,<br />
<br />
Two advices:<br />
<br />
1) Post your code. The others might help you more when you do.<br />
2) Search this forum (AFS Forum) for the session tdsls4101m000.<br />
<br />
I hope it helps,<br />
<br />
- George</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kingsley143</div><div class="date">4th April 2008, 10:55</div></div><div class="posttext">I have added the code in the inital post.<br />
<br />
One more thing ,Can i use dal for updating the values of discount.<br />
For ex:  dal.start.business.method  ()<br />
Can this function be used to call the external function .<br />
If yes ,how do i use it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pconde</div><div class="date">4th April 2008, 11:55</div></div><div class="posttext">Hi,<br />
<br />
if you want to update an existing record you must first retrieve the record via stpapi.find<br />
   process should be<br />
     fill key fields with stpapi.put.field<br />
     find via stpapi.find ==&gt; test if find successful<br />
     fill fields via stapi.put.field<br />
     save via stpapi.update/stpapi.save<br />
<br />
if you want to insert a new record then <br />
   fill fields with stpapi.put.field<br />
   insert record via stpapi.insert<br />
<br />
regards<br />
Philippe</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kingsley143</div><div class="date">4th April 2008, 14:02</div></div><div class="posttext">Thanks for ur reply but i am creating a sales order line and then before ending the session(tdsls4101m000) i am calling the afs of tdpcg0200m200.<br />
And the dll generated for the session tdpcg0200m200 does not create the function stpapi.insert() . And for finding a record i need to put in the search parameters but the search parameters ie; Item code or order number ,Pos. no are not getting generated as dll functions.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">4th April 2008, 14:18</div></div><div class="posttext">I see this in the code:<br />
<br />
stpapi.handle.subproc( &quot;tdsls4101m000&quot;, &quot;tdpcg0200m200&quot;, &quot;add&quot; )<br />
stpapi.put.field( &quot;tdpcg0200m200&quot;, &quot;disc.percentage&quot;, str$(disc), 1 )<br />
<br />
What I do not see is something to activate the tdpcg0200m200 program.  Yes the first put.field would activate it, but there is no control over it from tdsls4101m000.  So how <br />
do you activate the session from tdsls4101m000?  Is it a menu option?  Does it happen on a save or update?  So when inserting these discounts manually how do you activate the tdpcg0200m200 program?<br />
<br />
Last, but not least, just because the stpcreatdll does not generate a command does not mean it is not available.  The command may not be available, but the stpcreatdll is not perfect.  I have had issues with it before.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kingsley143</div><div class="date">5th April 2008, 06:12</div></div><div class="posttext">There is a form command on the session tdsls4101m000 ie;Line discounds.<br />
This commands logic is in the code of the session tdsls4101m000 .<br />
<br />
In the above code i am calling  the afs of tdpcg0200m200 after inserting a line using the afs of sales order lines and before<br />
stpapi.end.session(&quot;tdsls4101m000&quot;, error)<br />
<br />
<br />
Here i have tried calling the session tdpcg0200m200 from a different session but still i am getting the same error.<br />
The code is as follows:<br />
stpapi.put.field(&quot;tdsls4101m000&quot;, &quot;tdsls401.orno&quot;,sales.order)<br />
stpapi.put.field( &quot;tdsls4101m000&quot;, &quot;tdsls401.pono&quot;, str$(pono1) )<br />
hh =  stpapi.find( &quot;tdsls4101m000&quot; , error  )<br />
stpapi.mark( &quot;tdsls4101m000&quot; , error  )<br />
stpapi.get.field( &quot;tdsls4101m000&quot;, &quot;tdsls401.item&quot;, item.code )<br />
stpapi.form.command( &quot;tdsls4101m000&quot;, 5, &quot;price.inquiry&quot;, error )<br />
stpapi.form.command( &quot;tdpcg0250m000&quot;, 5, &quot;price.calculator&quot;, error )<br />
stpapi.get.field( &quot;tdpcg0200m100&quot;, &quot;item.code&quot;, item.code )<br />
stpapi.form.command( &quot;tdpcg0200m100&quot;, 5, &quot;exec.user.1&quot;, error )<br />
stpapi.put.field( &quot;tdpcg0200m200&quot;, &quot;disc.percentage&quot;, str$(disc), 1 )<br />
stpapi.put.field( &quot;tdpcg0200m200&quot;, &quot;disc.percentage&quot;, str$(disc1), 2 )<br />
stpapi.put.field( &quot;tdpcg0200m200&quot;, &quot;disc.percentage&quot;, str$(disc2), 3 )<br />
stpapi.put.field( &quot;tdpcg0200m200&quot;, &quot;disc.percentage&quot;, str$(disc3), 4 )<br />
stpapi.put.field( &quot;tdpcg0200m200&quot;, &quot;disc.percentage&quot;, str$(disc4), 5 )<br />
stpapi.put.field( &quot;tdpcg0200m200&quot;, &quot;disc.percentage&quot;, str$(disc5), 6 )<br />
stpapi.put.field( &quot;tdpcg0200m200&quot;, &quot;disc.percentage&quot;, str$(disc6), 7 )<br />
stpapi.put.field( &quot;tdpcg0200m200&quot;, &quot;disc.percentage&quot;, str$(disc7), 8 )<br />
stpapi.put.field( &quot;tdpcg0200m200&quot;, &quot;disc.percentage&quot;, str$(disc8), 9 )<br />
stpapi.put.field( &quot;tdpcg0200m200&quot;, &quot;disc.percentage&quot;, str$(disc9), 10 )<br />
stpapi.put.field( &quot;tdpcg0200m200&quot;, &quot;disc.percentage&quot;, str$(disc10), 11 )<br />
stpapi.put.field( &quot;tdpcg0200m200&quot;, &quot;disc.code&quot;, &quot;&quot;, 1 )<br />
stpapi.put.field( &quot;tdpcg0200m200&quot;, &quot;disc.code&quot;, &quot;&quot;, 2 )<br />
stpapi.put.field( &quot;tdpcg0200m200&quot;, &quot;disc.code&quot;, &quot;&quot;, 3 )<br />
stpapi.put.field( &quot;tdpcg0200m200&quot;, &quot;disc.code&quot;, &quot;&quot;, 4 )<br />
stpapi.put.field( &quot;tdpcg0200m200&quot;, &quot;disc.code&quot;, &quot;&quot;, 5 )<br />
stpapi.put.field( &quot;tdpcg0200m200&quot;, &quot;disc.code&quot;, &quot;&quot;, 6 )<br />
	stpapi.put.field( &quot;tdpcg0200m200&quot;, &quot;disc.code&quot;, &quot;&quot;, 7 )<br />
	stpapi.put.field( &quot;tdpcg0200m200&quot;, &quot;disc.code&quot;, &quot;&quot;, 8 )<br />
	stpapi.put.field( &quot;tdpcg0200m200&quot;, &quot;disc.code&quot;, &quot;&quot;, 9 )<br />
	stpapi.put.field( &quot;tdpcg0200m200&quot;, &quot;disc.code&quot;, &quot;&quot;, 10 )<br />
	stpapi.put.field( &quot;tdpcg0200m200&quot;, &quot;disc.code&quot;, &quot;&quot;, 11 )<br />
	stpapi.put.field( &quot;tdpcg0200m200&quot;, &quot;disc.method&quot;, str$(1), 1 )<br />
	stpapi.put.field( &quot;tdpcg0200m200&quot;, &quot;disc.method&quot;, str$(1), 2 )<br />
	stpapi.put.field( &quot;tdpcg0200m200&quot;, &quot;disc.method&quot;, str$(1), 3 )<br />
	stpapi.put.field( &quot;tdpcg0200m200&quot;, &quot;disc.method&quot;, str$(1), 4 )<br />
	stpapi.put.field( &quot;tdpcg0200m200&quot;, &quot;disc.method&quot;, str$(1), 5 )<br />
	stpapi.put.field( &quot;tdpcg0200m200&quot;, &quot;disc.method&quot;, str$(1), 6 )<br />
	stpapi.put.field( &quot;tdpcg0200m200&quot;, &quot;disc.method&quot;, str$(1), 7 )<br />
	stpapi.put.field( &quot;tdpcg0200m200&quot;, &quot;disc.method&quot;, str$(1), 8 )<br />
	stpapi.put.field( &quot;tdpcg0200m200&quot;, &quot;disc.method&quot;, str$(1), 9 )<br />
	stpapi.put.field( &quot;tdpcg0200m200&quot;, &quot;disc.method&quot;, str$(1), 10 )<br />
	stpapi.put.field( &quot;tdpcg0200m200&quot;, &quot;disc.method&quot;, str$(1), 11 )<br />
	stpapi.insert( &quot;tdpcg0200m200&quot;, 1, error )<br />
	stpapi.save( &quot;tdpcg0200m200&quot;, error )<br />
	stpapi.end.session( &quot;tdpcg0200m200&quot; , error )<br />
	stpapi.end.session( &quot;tdpcg0200m100&quot; , error )<br />
	stpapi.end.session( &quot;tdpcg0250m000&quot; , error )<br />
	stpapi.end.session( &quot;tdsls4101m000&quot; , error )</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">5th April 2008, 14:09</div></div><div class="posttext">Which command actually gives the error &quot;command disabled&quot;?  I am wondering if all you need is the save command.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kingsley143</div><div class="date">7th April 2008, 06:12</div></div><div class="posttext">I get command disabled on Save......<br />
&quot;&quot;stpapi.save( &quot;tdpcg0200m200&quot;, error )&quot;&quot;<br />
<br />
<br />
I have tried using <br />
continue.process() but nothing seems to work.<br />
I have tried updating the record using dal but the logic for calculating discount on amount is not available on the table (tdsls401).<br />
<br />
Can i some how call the internal function of the session tdsls4101m000,the function which is getting called from the form of the session tdsls4101m000 has to be declared as function extern name().Is there a way ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pconde</div><div class="date">7th April 2008, 09:05</div></div><div class="posttext">Hi,<br />
<br />
I think that the sub-session tdpcg0200m200 accept input and then for each fields starts the  calculation: this is done in the sub-sections &quot;when.field.changes&quot;. so the stpapi.insert and stpapi.save should not work: they can even not been defined on the form<br />
continue .process is only valid for baanIV and not valid in LN.<br />
<br />
this session is a case where the stpapi has problem to simulate the manual job. <br />
<br />
stpapi.put.field help says <br />
&quot;Note that no field sections in the script are executed during the put.field call, so no validation is performed. These sections are called when all fields are processed for an insert or update call&quot;<br />
<br />
I'm not sure that the when.field.changes is activated via AFS.<br />
<br />
Regards<br />
Philippe</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kingsley143</div><div class="date">7th April 2008, 10:36</div></div><div class="posttext">Thanks for ur reply.<br />
But this does not solve the problem....????</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pconde</div><div class="date">7th April 2008, 13:19</div></div><div class="posttext">Hi,<br />
<br />
No this doesn't solve your problem but I know that some session cannot be handle via AFS<br />
In ERP LN6.1 the support for AFS is now minimal because Infor ask using DAL and DAL2.<br />
Maybe you should look at the different DLL present in package tdpcg: you can may be find therein a function that does the work (use bic_info6.x) <br />
<br />
Regards<br />
Philippe</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kingsley143</div><div class="date">8th April 2008, 06:27</div></div><div class="posttext">I have tried using bic_info on the Ln server(windows2003) but i am getting an error that shared memory not attached.<br />
<br />
What can be the reason?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pconde</div><div class="date">8th April 2008, 11:28</div></div><div class="posttext">Hi,<br />
<br />
Windows is every time painful compared to Unix.:mad:<br />
<br />
My 5 cent advice : environment problem<br />
the user that you use must have the $BSE defined, the correct path ($BSE/bin)  , and must be known in baan ==&gt; he must have a valid package combination<br />
<br />
Regards<br />
Philippe</div></div><hr />



</div>
</body>
</html>