<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="spool copies random results, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] spool copies random results AFS/DDC/OLE: Function servers" />
	
	<title>spool copies random results [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="index.html">Newbaanboard</a> &gt; <a href="index.html">Baan SIGs</a> &gt; <a href="index.html">AFS/DDC/OLE: Function servers</a> &gt; spool copies random results</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">Andy..</div><div class="date">17th May 2009, 21:18</div></div><div class="posttext">Hi, I've setup a load of API reports to print in succession.  Everything was working fine until it was requested to print multiple copies of certain reports.  This has shown up various problems in the area of multi-copies.<br />
<br />
There seems to be random results from printing 2 copies of 2 reports.<br />
<br />
I setup the following test session for simplicity (yes its that old favourite 'print areas'):<br />
<br />
	copies=lval(&quot;2&quot;)<br />
	spool.pr.copies=copies<br />
	stpapi.set.report( &quot;tcmcs0445m000&quot;, &quot;rtcmcs044501000&quot;, &quot;WINDOWS&quot;, error )<br />
	stpapi.continue.process( &quot;tcmcs0445m000&quot;, error )<br />
	stpapi.end.session(&quot;tcmcs0445m000&quot;)<br />
<br />
then the code repeats to represent printing the 2nd report.  If you step through the code slowly in debug and wait until the first report is printed, then you USUALLY (but not always) get 2 copies of both reports.<br />
<br />
If you run the code without debug (or hit continue in debug) you sometimes get 2 copies of the first report, sometimes only 1 copy of the first report - but NEVER any copies of the 2nd report!<br />
<br />
The weird thing is, when you look in device history, all the prints are there with 'copies=2' set.  I've tried this on BaanIVc4 sp16 and sp20 servers and they behave the same.<br />
<br />
When you try running these reports from the BW standard session, you can print copies fine every time.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">18th May 2009, 01:43</div></div><div class="posttext">There should be some posts in this forum on this topic.  I found a couple spool variables that did not work in AFS code. I think for spool.copies I actually export it and import it into a couple of sessions.  In another case I think I just run the report twice - a for loop for the number of copies.</div></div><hr />



</div>
</body>
</html>