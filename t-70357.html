<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="Unable to get error message in AFS call, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] Unable to get error message in AFS call AFS/DDC/OLE: Function servers" />
	
	<title>Unable to get error message in AFS call [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="index.html">Newbaanboard</a> &gt; <a href="index.html">Baan SIGs</a> &gt; <a href="index.html">AFS/DDC/OLE: Function servers</a> &gt; Unable to get error message in AFS call</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">VishalMistry</div><div class="date">21st August 2017, 14:13</div></div><div class="posttext">Hi all,<br />
<br />
I want to bulk update order system system (tiitm001.osys) to MRP. For this I am passing a text file that contains list of items.<br />
<br />
I am deliberately passing an item with MPS order system to check if the system returns same error message as if I am working with Item master session (tiitm0101m000). But, If I check value of error.desc, it remains empty. In fact when I try to change the order system directly through session, I get the error message &quot;Item found in MPS&quot;. My code is as given below:<br />
<br />
stpapi.put.field(&quot;tiitm0101m000&quot;, &quot;tiitm001.osys&quot;, str$(tcosys.mrp))<br />
stpapi.save(&quot;tiitm0101m000&quot;, error.desc)<br />
<br />
Can anybody guide me how to get the error message ?<br />
<br />
Vishal</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">21st August 2017, 15:06</div></div><div class="posttext">Have you tried stpapi.get.mess.code?  Are you sure it is an error and not just a warning?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">VishalMistry</div><div class="date">21st August 2017, 15:26</div></div><div class="posttext">Hello Mark,<br />
<br />
Yes. It is an error. I tried to execute the session directly and change the order system, it gave an error message and reverted back to old order system.<br />
<br />
I tried to check the value of error as well as mess. <br />
mess = stpapi.get.mess.code(&quot;tiitm0101m000&quot;, error) <br />
<br />
Both are empty after stpapi.save.<br />
<br />
Vishal</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">21st August 2017, 16:14</div></div><div class="posttext">Have you tried stpapi.update versus save?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">VishalMistry</div><div class="date">21st August 2017, 16:36</div></div><div class="posttext">Hi Mark, <br />
<br />
My problem got solved after replacing stpapi.save with stpapi.update call.<br />
<br />
Thank you for your guidance.<br />
<br />
Vishal</div></div><hr />



</div>
</body>
</html>