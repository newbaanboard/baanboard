<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="Progress Indicator Bar in BaanIV - Just One Line of Code, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] Progress Indicator Bar in BaanIV - Just One Line of Code Code &amp; Utilities" />
	
	<title>Progress Indicator Bar in BaanIV - Just One Line of Code [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="index.html">Newbaanboard</a> &gt; <a href="index.html">Baan SIGs</a> &gt; <a href="index.html">Code &amp; Utilities</a> &gt; Progress Indicator Bar in BaanIV - Just One Line of Code</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">baanprog</div><div class="date">12th April 2005, 14:09</div></div><div class="posttext">Hi,<br />
<br />
Code for getting Progress Indicator Bar in BaanIV.<br />
<br />
Just One Line of Code and Its Cute!!.<br />
<br />
Regards</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">12th April 2005, 18:52</div></div><div class="posttext">Great solution! Just tried it in one of my programs I am writing.  It works, but I did have to add a display for the str.bar and I also had to make str.bar fixed.  But it was simple and a great solution. :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">baanprog</div><div class="date">13th April 2005, 13:57</div></div><div class="posttext">I made the changes recommended by you and re-attached the document.<br />
<br />
Regards</div></div><hr />


<div class="post"><div class="posttop"><div class="username">NPRao</div><div class="date">13th April 2005, 21:33</div></div><div class="posttext">baanprog,<br />
<br />
Its good but I cant test it. I had few points to mention that your progress indicator would not work for 3-GL code and not portable on BaaN-V series.<br />
<br />
The other solution works for both. Now I have them in a library and just call like the tools create.progress.indicator()<br />
<br />
<br />
create.trans.progress.indicator<br />
void create.trans.progress.indicator( const string title(), <br />
[ long fg.color ], [ long bg.color ] )<br />
 <br />
Transparent Graphical Progress Indicator Bar<br />
for 3-GL program there would not be a main window hence cannot set a<br />
background color.<br />
Input:	title - title/caption for the progress indicator<br />
	fg.color - foreground colors - rgb schemes<br />
	bg.color - background colors - rgb schemes<br />
You can use the following predefined colors:<br />
RGB.BLACK	RGB.BLUE	RGB.YELLOW	RGB.MAGENTA<br />
RGB.GREEN	RGB.GRAY	RGB.RED 	RGB.WHITE<br />
RGB.CYAN<br />
<br />
change.trans.progress.indicator<br />
void change.trans.progress.indicator( long perc, [ const string mesg() ] )<br />
<br />
Change Transparent Graphical Progress Indicator Bar<br />
inputs:	perc - integer 0-100<br />
<br />
destroy.trans.progress.indicator<br />
void destroy.trans.progress.indicator( )<br />
Destroys transparent progress indicator</div></div><hr />


<div class="post"><div class="posttop"><div class="username">baanprog</div><div class="date">14th April 2005, 08:17</div></div><div class="posttext">Hi NPRao,<br />
<br />
I would wonder why it wont work in BaanV series, because both the functions string.set$ and chr$  are available for BaanV also.<br />
<br />
I dont know whether in 3GL it would work I would have to test it.<br />
<br />
Regards</div></div><hr />


<div class="post"><div class="posttop"><div class="username">NPRao</div><div class="date">14th April 2005, 09:01</div></div><div class="posttext">baanprog,<br />
<br />
I meant bold and reverse on the form editor (DFE) and not string.set$ and chr$.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">NPRao</div><div class="date">14th April 2005, 21:30</div></div><div class="posttext">baanprog -<br />
<br />
Updates -<br />
<br />
Functionality that is not supported with Webtop 3.0 for BaanIVc<br />
Author	S Woessmann	Creation Date:	11 Oct 2004	Alternate ID:	<br />
Solution No:	166790	Last Modified:	12 Oct 2004	Status:	Published<br />
Product:	ttB40c4	Sub Product:		Session:	Webtop<br />
Package:	tt	Version:	B40	Release:	c4<br />
Solution Type:	OT: Standard Functionality<br />
<br />
Progress Sessions<br />
----------------------------<br />
<br />
When the BaanIVc applications where developed, the tools did not yet offer a progress indicator facility. Therefore BaanIVc applications which want to show some kind of progress for a long lasting operation use a 4GL-form. This 4GL-form is updated on a regular basis to indicate to the end user the progress of the operation. This mechanism is not supported in the Webtop. When running such a long lasting operation in the Webtop, no form updates are sent to the user as long as the operation is running. The end-user will only see the busy indicator of the Webtop but will not get any feedback about the progress of the operation.<br />
<br />
Since the BaanIVc tools now offer a progress indicator facility which is supported in both Webtop and Baan Windows, applications can be modified to show a proper progress indicator. The available progress indicator functions are implemented in library ottstpprogress and are identical to the functions available in BaanV.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">baanprog</div><div class="date">15th April 2005, 09:13</div></div><div class="posttext">NPRao,<br />
<br />
Thats really cool. <br />
<br />
If I want to use it, should I download some tools patches?? Please advise.<br />
<br />
Regards</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Hitesh Shah</div><div class="date">27th April 2005, 10:54</div></div><div class="posttext">Hi,<br />
<br />
Which inlcude we have to use so that compiler recognizes the mode argument of long  type in ttstpprogress in Baan IV .</div></div><hr />


<div class="post"><div class="posttop"><div class="username">NPRao</div><div class="date">27th April 2005, 20:28</div></div><div class="posttext">Hitesh, BaaN-Prog,<br />
<br />
I do not have access to BaaN-4 system, either someone else can give more information or you can contact the local BaaN/SSA support.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">lbencic</div><div class="date">27th April 2005, 21:05</div></div><div class="posttext">It's a library in the tools, like ottstpapihand.  Check if you have it in your:<br />
<br />
$BSE/tools/ttB40_c4/ottstp <br />
<br />
directory.  If so, you can attach it as a library to your script using the library button, or simply put the following in the code:<br />
<br />
#pragma used dll ottstpprogress<br />
<br />
I have not used that progress library in Baan IV yet, but that's how we use the ottstpapihand library stored in the same place.<br />
<br />
Edited:  If you have it included and it is not recognizing a long where you think it should, do a bic_info6.1 on the object and see what your version is expecting.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Hitesh Shah</div><div class="date">28th April 2005, 16:31</div></div><div class="posttext">Lisa , <br />
The dll is existing. bic info has the function prototype but compiler does not accept the mode argument in the code.<br />
<br />
		<br />
if not create.progress.indicator(&quot;Productivity Progress&quot;,<br />
progress.text.with.stop + progress.bar.with.stop) then</div></div><hr />


<div class="post"><div class="posttop"><div class="username">lbencic</div><div class="date">28th April 2005, 16:54</div></div><div class="posttext">When in doubt, find an example.  It looks like the standard script tccom0214 uses this in Baan IV.  They don't use the mode flags, they just pass a long:<br />
<br />
		create.progress.indicator(&quot;&quot;, 1)<br />
		change.progress.indicator(0, &quot;Read Company Data&quot;)<br />
	destroy.progress.indicator()<br />
<br />
Maybe play with it that way, it's not really documented.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">NPRao</div><div class="date">28th April 2005, 20:07</div></div><div class="posttext">Hitesh,<br />
<br />
Can you try to change the Mode options to capitals, I think they are #define declarations else try to use numbers: 1-4.<br />
function extern create.progress.indicator(<br />
	const string title(),<br />
   	long mode )<br />
Desc: Create a progress indicator window<br />
Args: - title of new window<br />
Mode (	PROGRESS.TEXT, PROGRESS.TEXT.WITH.STOP,<br />
	PROGRESS.BAR, PROGRESS.BAR.WITH.STOP)<br />
Ret : 	0  Ok<br />
	-1 Error (probably another progress window exists)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">lbencic</div><div class="date">28th April 2005, 20:47</div></div><div class="posttext">I tried with both.  I think they are probably defines somewhere.  The convention is to make defines all caps, but in reality defines are not case sensitive.   In fact, when you compile with the option 'PROGRESS.TEXT', it throws the compile error &quot; 'progress.text' not declared &quot;.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Hitesh Shah</div><div class="date">29th April 2005, 11:48</div></div><div class="posttext">Lisa , I too thought of trying some long at random. But then thought of having the others experience in this regard. Still we don't know what 1 means for this dll . I have registered a case with SSA support to indicate how to use the dll.<br />
<br />
NP , For constants it does not make any difference whether we write in small or upper case as Lisa said.<br />
<br />
Thanks both of u for the help.</div></div><hr />



</div>
</body>
</html>