<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="Problem to insert item in a job, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] Problem to insert item in a job AFS/DDC/OLE: Function servers" />
	
	<title>Problem to insert item in a job [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="index.html">Newbaanboard</a> &gt; <a href="index.html">Baan SIGs</a> &gt; <a href="index.html">AFS/DDC/OLE: Function servers</a> &gt; Problem to insert item in a job</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">DietrichS</div><div class="date">22nd September 2015, 12:44</div></div><div class="posttext">Hey,<br />
<br />
I made a session to create items with the data from a text-file. It works well when I run it manually. It works well when I run it with ttaad5203m000. But when I run it from the Unix Shell with <br />
/opt/BAAN/soft/etc/rc.startjob500 TEST<br />
no item is created. I get no error message, so I do not have an idea what the problem is. Everything looks fine, but no item....<br />
<br />
stpapi.put.field(&quot;tiitm0101m000&quot;, &quot;tiitm001.item&quot;, strip$(itm.item))<br />
stpapi.put.field(&quot;tiitm0101m000&quot;, &quot;tiitm001.dsca&quot;, strip$(itm.dsca))<br />
stpapi.put.field(&quot;tiitm0101m000&quot;, &quot;tiitm001.dscd&quot;, &quot;TC-Imp.&quot;)<br />
stpapi.put.field(&quot;tiitm0101m000&quot;, &quot;tiitm001.kitm&quot;, str$(etol(itm.kitm)))<br />
stpapi.put.field(&quot;tiitm0101m000&quot;, &quot;tiitm001.citg&quot;, itm.citg)<br />
stpapi.put.field(&quot;tiitm0101m000&quot;, &quot;tiitm001.wght&quot;, str$(itm.wght))<br />
<br />
dum = stpapi.insert(&quot;tiitm0101m000&quot;, 1, error.msg)<br />
if not dum then						<br />
	dum1 = stpapi.recover(&quot;tiitm0101m000&quot;, error.msg1) <br />
endif<br />
if isspace(error.msg) then<br />
	error.msg = &quot;ok&quot;<br />
else<br />
	error.msg = &quot;ERROR&quot;<br />
endif<br />
stpapi.end.session(&quot;tiitm0101m000&quot;, error.msg3)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">22nd September 2015, 16:32</div></div><div class="posttext">Make sure all the correct variables and paths are in place for the job.  Maybe even add some messages to show where in the script the job is.  My first suspicion is that the script is not opening the file with part numbers in it correctly.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DietrichS</div><div class="date">13th October 2015, 10:20</div></div><div class="posttext">Ok, I have it.<br />
<br />
I took the original object oitm0101 and it worked. So it was clear that the problem was somewhere in my customization of tiitm0101m000. I found the bad parts by commenting line by line out. That was no so funny but I managed it.<br />
<br />
Dietrich</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">13th October 2015, 14:58</div></div><div class="posttext">Glad you found the solution.  I would have never guessed it was a personalization.</div></div><hr />



</div>
</body>
</html>