<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="baan version and stpapi, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] baan version and stpapi AFS/DDC/OLE: Function servers" />
	
	<title>baan version and stpapi [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="index.html">Newbaanboard</a> &gt; <a href="index.html">Baan SIGs</a> &gt; <a href="index.html">AFS/DDC/OLE: Function servers</a> &gt; baan version and stpapi</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">lehighwiz</div><div class="date">22nd April 2002, 21:26</div></div><div class="posttext">does it matter which version of baan i am running as to the usability of stpapi?  I am running 4c2, and am having problems utilizing this method.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">gfasbender</div><div class="date">22nd April 2002, 21:40</div></div><div class="posttext">Make sure you have the latest updates of Baan solutions 10923 and 14719.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Youp2001</div><div class="date">23rd April 2002, 13:56</div></div><div class="posttext">As far as I know the first supported version is Baan IV c4. I think you need at least the Baan IV c4 tools. <br />
<br />
Youp</div></div><hr />


<div class="post"><div class="posttop"><div class="username">lehighwiz</div><div class="date">23rd April 2002, 15:17</div></div><div class="posttext">thanks guys,<br />
<br />
pardon my ignorance, but is there another way for me to automate sessions from an outside language (ie VB)?  STPAPI calls from vb start baan in the background for me and actually start the session that i want, but they do not put the data into the fields like they should.  I get the message 'unknown message' after sending stpapi.put data to the form.<br />
<br />
Thanks in advance for all your help.<br />
<br />
Matt</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">23rd April 2002, 15:53</div></div><div class="posttext">You may want to check on those patches that Gordon recommended.  This may be causing the problem that you are encountering with the VB Code. Search through the tools forum I posted an example somewhere that Gordon helped me to get working.<br />
<br />
And for Youp - the stpapi commands are available on 4c3. <br />
<br />
Good Luck!<br />
<br />
Mark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">lehighwiz</div><div class="date">23rd April 2002, 17:31</div></div><div class="posttext">I got those patches installed on our test server and i attempted to use the stpapi methods.  I no longer get any errors, rather i get nothing at all...I see the 'option dialog' box appear at the bottom after a successful logon, then it accepts all my commands, but there is no response...then the baan session exits normally.  here is my code:<br />
<br />
Set BaanObj = CreateObject(&quot;Baan4.Application&quot;)<br />
SessionName = &quot;tdsst9402m000&quot;<br />
FieldName = &quot;yrno.f&quot;<br />
FieldValue = &quot;2001&quot;<br />
BaanObj.ParseExecFunction &quot;ottstpapihand&quot;, &quot;stpapi.put.field(&quot; &amp; Chr(34) &amp; SessionName &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; FieldName &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; FieldValue &amp; Chr(34) &amp; &quot;)&quot;<br />
<br />
FieldName = &quot;yrno.t&quot;<br />
FieldValue = &quot;2001&quot;<br />
BaanObj.ParseExecFunction &quot;ottstpapihand&quot;, &quot;stpapi.put.field(&quot; &amp; Chr(34) &amp; SessionName &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; FieldName &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; FieldValue &amp; Chr(34) &amp; &quot;)&quot;<br />
<br />
FieldName = &quot;yrpt.f&quot;<br />
FieldValue = &quot;4&quot;<br />
BaanObj.ParseExecFunction &quot;ottstpapihand&quot;, &quot;stpapi.put.field(&quot; &amp; Chr(34) &amp; SessionName &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; FieldName &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; FieldValue &amp; Chr(34) &amp; &quot;)&quot;<br />
<br />
FieldName = &quot;yrpt.t&quot;<br />
FieldValue = &quot;4&quot;<br />
BaanObj.ParseExecFunction &quot;ottstpapihand&quot;, &quot;stpapi.put.field(&quot; &amp; Chr(34) &amp; SessionName &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; FieldName &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; FieldValue &amp; Chr(34) &amp; &quot;)&quot;<br />
<br />
ErrMessage1 = Space(30)<br />
ReportName = &quot;tdsst940211000&quot;<br />
DeviceName = &quot;HP8000DN&quot;<br />
BaanObj.ParseExecFunction &quot;ottstpapihand&quot;, &quot;stpapi.continue.process(&quot; &amp; Chr(34) &amp; SessionName &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; ErrMessage1 &amp; Chr(34) &amp; &quot;)&quot;<br />
BaanObj.ParseExecFunction &quot;ottstpapihand&quot;, &quot;stpapi.set.report(&quot; &amp; Chr(34) &amp; SessionName &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; ReportName &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; DeviceName &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; ErrMessage1 &amp; Chr(34) &amp; &quot;)&quot;<br />
BaanObj.ParseExecFunction &quot;ottstpapihand&quot;, &quot;stpapi.print.report(&quot; &amp; Chr(34) &amp; SessionName &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; ErrMessage1 &amp; Chr(34) &amp; &quot;)&quot;<br />
BaanObj.ParseExecFunction &quot;ottstpapihand&quot;, &quot;stpapi.end.session(&quot; &amp; Chr(34) &amp; SessionName &amp; Chr(34) &amp; &quot;)&quot;<br />
BaanObj.Quit<br />
<br />
<br />
End<br />
<br />
<br />
i cannot see anything different between my code and your(mark_h) sample code in another thread.  I am almost there, but not yet...Thanks for your help.<br />
<br />
Matt</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">23rd April 2002, 17:41</div></div><div class="posttext">First thing I noticed is that the stpapi.set.report needs to go before the stpapi.continue.  I would also comment out the stpapi.print.report command.  In doing my function servers I usually use the set.report and continue, then end the session.  Only once I have I used the set.report and the print.report command. But you may have to try different variations to get it to work.<br />
<br />
Also I am more familiar with the Baan coding than with the VB coding.  The VB code I got to work was mainly with Gordon's help.  I have not moved that stuff into production just yet.<br />
<br />
Mark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">gfasbender</div><div class="date">23rd April 2002, 17:49</div></div><div class="posttext">ReportName = &quot;rtdsst940211000&quot; <br />
<br />
Call stpapi.set.report() before using the stpapi.print.report() or stpapi.continue.process() call!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">lehighwiz</div><div class="date">23rd April 2002, 17:52</div></div><div class="posttext">THANK YOU...it works.<br />
<br />
Matt</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Kingsto88</div><div class="date">11th August 2006, 11:12</div></div><div class="posttext">Hello all experts,<br />
<br />
1) Is AFS available in Baan 4c2??<br />
2) If AFS is not available in baan4c2, can i upgrade only the tools to baan4c4 and leave the application in baan4c2?<br />
<br />
Thanks n regards,</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">11th August 2006, 15:17</div></div><div class="posttext">Yes - it is available in 4c2.  Just jump out an look for ottstpapihand in your tools directory.  You may need to make sure you have the latest patches for 4c2.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Kingsto88</div><div class="date">8th September 2006, 10:51</div></div><div class="posttext">hi mark,<br />
you say api works in c2.<br />
i tried but failed, this message appears &quot;dynamic link library to tc.ignore.process&quot;<br />
<br />
what must i do to get api to work in c2??<br />
<br />
thanks n regards,</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">10th September 2006, 01:15</div></div><div class="posttext">I recommend contacting Baan and getting the latest libraries or stpapi update.</div></div><hr />



</div>
</body>
</html>