<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="OLE Zugriff von MS Word auf Baan Daten, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] OLE Zugriff von MS Word auf Baan Daten Deutsches Forum" />
	
	<title>OLE Zugriff von MS Word auf Baan Daten [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="../index.html">Newbaanboard</a> &gt; <a href="../index.html">BB Language Forums</a> &gt; <a href="../index.html">Deutsches Forum</a> &gt; OLE Zugriff von MS Word auf Baan Daten</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">Locher</div><div class="date">20th April 2006, 16:49</div></div><div class="posttext">Hallo und guten Tag!<br />
<br />
<br />
Ich möchte aus MS Word heraus Kundenadressen mittels Eingabe der Kunden-Nr. von BaaN holen.<br />
<br />
[Läuft seit Jahren mit Lotus Wordpro.]<br />
<br />
Unter Win XP Version 2002 SP 2 bekomme ich bei <br />
<br />
Set BaanObj = CreateObject(&quot;Baan4.Application&quot;)<br />
<br />
Zwar eine Verbindung zu Baan (Option Dialog), aber gleichzeitig folgende BW Messages: &quot; LoadTypeLib failed, error = -2147312566 &quot;<br />
<br />
Bei Win 2000 funktioniert es soweit ohne Probleme.<br />
<br />
Meine Frage: <br />
Benötigt man für Win XP Sp2 andere DLL's, und wenn ja woher kann man die bekommen?<br />
<br />
(Arbeite mit BaaN4 SP19 und dem 79er Client)<br />
<br />
Vielen Dank im Voraus!<br />
<br />
Gruß Locher</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Locher</div><div class="date">25th April 2006, 17:21</div></div><div class="posttext">Ist ja komisch, dass hierauf keine Antwort erfolgt?<br />
<br />
Werden in anderen Firmen keine Kundenadressen oder Artikeltexte in der Textverarbeitungssoftware benötigt?<br />
<br />
LG<br />
Locher</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Martin Jung</div><div class="date">27th April 2006, 09:42</div></div><div class="posttext">Ist ja komisch, dass hierauf keine Antwort erfolgt?<br />
<br />
Werden in anderen Firmen keine Kundenadressen oder Artikeltexte in der Textverarbeitungssoftware benötigt?<br />
<br />
LG<br />
Locher<br />
<br />
Doch schon, aber wir verwenden ein anderes (geeigneteres?) Tool... sorry.<br />
<br />
Gruss<br />
<br />
Martin Jung</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Locher</div><div class="date">2nd May 2006, 09:51</div></div><div class="posttext">Hallo Herr Jung,<br />
<br />
danke für die Antwort!<br />
<br />
Welches Tool meinen Sie denn?<br />
<br />
Es ist mir nicht bekannt, dass es ein Tool gibt, welches es dem Nutzer erlaubt<br />
innerhalb von MS Word auf ein icon zu klicken, den Key einzugeben und<br />
an der Einfügemarke die formatierte Anschrift ,den Artikeltext oder auch <br />
ausgesuchte Informationen  mehrerer Tabellen aus Baan zu erhalten.<br />
<br />
Viele Grüße<br />
<br />
H.Locher</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Martin Jung</div><div class="date">2nd May 2006, 09:56</div></div><div class="posttext">Hallo Herr Locher,<br />
<br />
Sie haben schon recht so komfortabel geht es bei uns nicht zu. Für solche Art von Dokumenten verwenden wir (wie auch für alle anderen speziellen Auswertungen aus der Baan DB) Crystal Reports. Ist auch nicht Tagesgeschäft sondern eher die Ausnahme.<br />
<br />
Gruss<br />
<br />
Martin Jung</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Seidel</div><div class="date">12th May 2006, 12:36</div></div><div class="posttext">Hallo Herr Locher,<br />
<br />
ich habe derzeit ein neues Projekt im Auge: Ich war mal in einer BaaN Consulting Firma angestellt und soll jetzt für eine andere Firma eine Schnittstelle zwischen BaaN und einer anderen Software bauen.<br />
<br />
Damals nutzte ich auch die COM-DLL von der Sie sprachen, um Daten z.B. von Outlook nach BaaN zu übertragen. Leider habe ich derzeit kein Zugriff auf diese DLL und würde Sie gerne bitten, mir die Funktionsdefinitionen dieser DLL bereitzustellen, da ich natürlich keine Doku mehr besitze.<br />
<br />
Wäre Toll wenn Sie mir weiterhelfen könnten.<br />
<br />
P.S. Im Visual Basic Editor in Word gibt es ja in der Symbolleiste den Objektkatalog. Vielleicht könnten Sie mir davon einen Screenshot machen?<br />
<br />
MfG Joachim Seidel</div></div><hr />


<div class="post"><div class="posttop"><div class="username">csecgn</div><div class="date">12th May 2006, 16:58</div></div><div class="posttext">Hallo,<br />
<br />
die &quot;Doku&quot; zur COM-Dll ist beim Baan Client unter \samples in form von Exceldateien dabei. Die Dll wird zusammen mit dem Client vom Client installiert (zumindest bei Baan IV. LN ist da aber soweit ich gesehen habe gleich).<br />
<br />
Gruß<br />
csecgn</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Locher</div><div class="date">15th May 2006, 10:26</div></div><div class="posttext">Guten Tag Herr Seidel,<br />
<br />
hier das Macro wordseitig:<br />
<br />
<br />
*************************************************<br />
'Funktion starten (dyn.SQL wird initialisiert)<br />
    <br />
    BaanObj.ParseExecFunction B_DLL, B_Function<br />
    <br />
    <br />
    'einenSatz übertragen<br />
    <br />
    B_Func = &quot;fetch.query.result()&quot;<br />
    <br />
     <br />
    ' 1.Ergebnis wird gelesen<br />
    BaanObj.ParseExecFunction B_DLL, B_Func<br />
    <br />
    'Abfrage auf Fehlercode<br />
    <br />
    B_Error = BaanObj.Error<br />
    <br />
    'zuweisen des Rückgabewertes<br />
    <br />
    B_Return = BaanObj.Returnvalue<br />
    <br />
    dll_dsca = B_Return<br />
    <br />
    'Auslesen der Schleifenbedingung<br />
    <br />
    B_err = Mid(dll_dsca, 298, 3)<br />
    <br />
    If B_err = &quot;err&quot; Then<br />
        <br />
        MsgBox (&quot;Lieferantennummer bei Huttenlocher nicht gefunden!&quot;)<br />
        <br />
              <br />
    Else<br />
        <br />
       <br />
        Selection.InsertAfter Mid(dll_dsca, 1, 35)            'N1         Einfügen der Returnvariable an Kurserposition<br />
        <br />
        <br />
        Selection.InsertAfter Chr(13)    ' Leerzeile<br />
        If Mid(dll_dsca, 36, 30) &lt;&gt; &quot;                              &quot; Then<br />
            Selection.InsertAfter Mid(dll_dsca, 36, 30)      'N2<br />
            Selection.InsertAfter Chr(13)    ' Leerzeile<br />
        End If<br />
        Selection.InsertAfter Mid(dll_dsca, 66, 30)      'Str1<br />
      Selection.InsertAfter Chr(13)    ' Leerzeile<br />
        If Mid(dll_dsca, 96, 30) &lt;&gt; &quot;                              &quot; Then<br />
            Selection.InsertAfter Mid(dll_dsca, 96, 30)      'Str2<br />
          Selection.InsertAfter Chr(13)    ' Leerzeile<br />
        End If<br />
      Selection.InsertAfter Chr(13)    ' Leerzeile<br />
      <br />
        Selection.InsertAfter Mid(dll_dsca, 126, 30)     'PLZ+Ort1<br />
       Selection.InsertAfter Chr(13)    ' Leerzeile<br />
        <br />
        If Mid(dll_dsca, 156, 30) &lt;&gt; &quot;                              &quot; Then<br />
            Selection.InsertAfter Mid(dll_dsca, 156, 30)     'Ort2<br />
           Selection.InsertAfter Chr(13)    ' Leerzeile<br />
        End If<br />
        <br />
        If Mid(dll_dsca, 186, 30) &lt;&gt; &quot;DEUTSCHLAND                   &quot; Then<br />
            Selection.InsertAfter Mid(dll_dsca, 186, 30)     'Land<br />
            Selection.InsertAfter Chr(13)    ' Leerzeile<br />
        End If<br />
        <br />
        <br />
    'Selection.InsertAfter Chr(13)<br />
        Selection.Collapse wdCollapseEnd<br />
        <br />
        <br />
        'Nach Übergabe der Daten Aufheben der Verbindung zu Baan<br />
        <br />
        BaanObj.Quit                'Verbindung zu Baan beenden<br />
        Set BaanObj = Nothing       'Verbindung zu Baan beenden<br />
            <br />
    End If<br />
    <br />
    <br />
End Sub<br />
Sub Terminate()<br />
    <br />
    BaanObj.Quit                        'Verbindung zu Baan beenden<br />
    Set BaanObj = Nothing       'Verbindung zu Baan beenden<br />
    <br />
End Sub<br />
Sub Initialize()<br />
    Set BaanObj = CreateObject(&quot;Baan4.Application&quot;)<br />
End Sub<br />
********************************************************<br />
<br />
... und hier die doku des Clients C:\Programme\baan\samples<br />
<br />
This readme.txt file contains additional information about the Excel<br />
spreadsheets installed in the samples directory.<br />
<br />
<br />
Object Linking and Embedding (OLE) can be used to exchange data between BAAN IV<br />
and Microsoft Excel. This is only possible if BAAN IV is running in the BAAN<br />
Windows environment. Consequently, OLE cannot be used in the BX and BA<br />
environments. To demonstrate the functionality of OLE, a number of spreadsheets<br />
have been created by means of which Excel data can be loaded into BAAN IV. No<br />
spreadsheets are available to demonstrate how BAAN IV data can be loaded into<br />
Excel.<br />
<br />
For the OLE integration between Microsoft Excel and BAAN IV, several<br />
combinations of spreadsheets and DLLs (dynamic-link library) are used as<br />
specified in the table below. The last column in this table specifies the<br />
session code of the BAAN session in which the changes which have occurred as a<br />
result of the OLE data exchange can be viewed.<br />
<br />
Package		Excel Spreadsheet	BAAN IV DLL		BAAN IV Session<br />
-------		-----------------	-----------		---------------<br />
Manufacturing	mpsole.xls		timpsole3280		timps3101m000<br />
Distribution	slsbudg.xls		tdsstole0250		tdsst0250m000<br />
Finance		finbudg.xls		tffbsole0300		tffbs1101m000<br />
<br />
At the bottom of these spreadsheets, at least two tabs are available which can<br />
be used to toggle between worksheets. If the OleBaan tab is selected, the<br />
script which is linked to this spreadsheet is displayed. This script is<br />
referred to as the Visual Basic Module and can be modified if desired. The<br />
scripts behind the BAAN DLLs can only be accessed from within the spreadsheet.<br />
The remaining tab(s) give(s) access to regular worksheets from which data can<br />
be loaded into BAAN IV.<br />
<br />
In these spreadsheets, the following steps must be executed to load data into<br />
BAAN IV:<br />
<br />
The mpsole.xls spreadsheet:<br />
Enter the forecast data. Make sure that such data as plan code <br />
is available in BAAN IV. Use the mouse to select the forecast which<br />
must be loaded. Use the Baan Logo button to Download to BAAN button.<br />
<br />
The slsbudg.xls spreadsheet:<br />
Enter the budget data. Make sure that such data as sort code, year, and<br />
year part are available in BAAN IV.<br />
Use the mouse to select the budget data which must be loaded, highlight only <br />
that data which you wish to update. Use the Baan Logo button<br />
to Download to BAAN button.<br />
Note: If, for example, the Quantity(Inventory Units) in period one <br />
needs to be changed that field is selected.  If you need to change<br />
data for that period on all the worksheets the data in those columns <br />
will also need to be highlighted.<br />
<br />
The finbudg.xls spreadsheet:<br />
Enter the financial data. Make sure that such data as company, budget,<br />
and year are available in BAAN IV. Use the Baan Logo button to Download to BAAN button.<br />
Note: Select all data that needs to be updated.<br />
<br />
<br />
In Excel, it is possible to make several independent multiple selections<br />
by simultaneously pressing the mouse and the &lt;Ctrl&gt; key. However, to<br />
correctly load the data into BAAN, the selection should be limited to<br />
one multi selection of rows and columns.<br />
<br />
By default, the spreadsheets are stored in the c:\baan\samples directory.<br />
If desired, they can be stored in another directory.<br />
<br />
If desired, the spreadsheets can be modified. However, any modifications to<br />
the spreadsheets must be supported by the Visual Basic script and the<br />
related DLL. For example, if any rows or columns are added or inserted and<br />
the data in these rows or columns is loaded into BAAN by means of the<br />
Download to BAAN button, this data is either not loaded or be placed in the<br />
wrong rows or columns because the structure of the modified spreadsheet does<br />
not match the structure in the BAAN database. Consequently, all scripts and<br />
spreadsheets must be tuned to the DLLs and the BAAN IV database structure.<br />
<br />
Within BAAN IV, information can be retrieved regarding OLE Automation by<br />
selecting one of the BAAN IV Tools options in the menu browser and selecting<br />
the Contents option form the Help menu to display the general index. Next,<br />
select the OLE Automation category to display OLE information. Press the<br />
Relations button to display additional information. Such BAAN IV categories<br />
as OLE Automation Server and Limitations are listed under the Subfunctions<br />
heading.<br />
<br />
<br />
***********************************************<br />
<br />
<br />
Was für eine Verbindung zu Baan soll den bei Ihnen hergestellt werden?<br />
<br />
<br />
Gruß<br />
H.Locher</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Locher</div><div class="date">15th May 2006, 10:32</div></div><div class="posttext">Dim BaanObj As Object<br />
Dim B_DLL As String<br />
Dim B_Function As String<br />
Dim B_Func As String<br />
Dim B_Return As String<br />
Dim B_err As String<br />
Dim dll_bran As Variant     'zu Übergabergebende des Key für Baan-Tabelle<br />
Dim seq As String * 6        'zur Anpassung des Key an Baan, Begrenzung auf 6 Zeichen<br />
Dim seq_length As Single    'zur Anpassung des Key an Baan<br />
Dim dll_dsca As String      'Rückgabestring von Baan-dll an VBA Script<br />
Dim a As Long<br />
Dim b As Long<br />
Dim c As Long<br />
'Dim x As Long (nicht für MS Word)<br />
'Dim y As Long (nicht für MS Word)<br />
<br />
<br />
'Private Sub CommandButton1_Click()<br />
<br />
Sub Main()<br />
<br />
   ' Verbindung zu Baan IV herstellen wenn nicht aktiv<br />
   <br />
    If BaanObj Is Nothing Then<br />
   <br />
       Set BaanObj = CreateObject(&quot;Baan4.Application&quot;)<br />
       <br />
    End If<br />
    <br />
   <br />
    'zu adressierende DLL auf Baan-Seite<br />
    <br />
    B_DLL = &quot;otccomdll0010&quot;      'Kundenadresse HULO selektieren für MS Word<br />
    <br />
    'Eingabe des zu suchenden Wertes<br />
    '----------------------------------------------------------<br />
    seq = Mid(seq, 1, 6)<br />
    seq = (InputBox$(&quot;Kunden-Nr. HULO eingeben&quot;, &quot;Kundenadresse HULO aus BaanIV lesen&quot;))<br />
    <br />
       <br />
    seq_length = Len(seq)                   'Länge ermitteln<br />
    dll_bran = String((6 - seq_length), &quot; &quot;) &amp; seq 'Eingabewert übergeben mit führenden Blanks<br />
    <br />
    '---------------------------------------------------------<br />
    'aufzurufende Funktion innerhalb der DLL<br />
       <br />
    B_Function = &quot;get.dscr(&quot;&quot;&quot; &amp; dll_bran &amp; &quot;&quot;&quot; )&quot;<br />
    <br />
    'Funktion starten (dyn.SQL wird initialisiert)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DFisch</div><div class="date">28th May 2006, 21:32</div></div><div class="posttext">Hallo Joachim,<br />
schick mir doch kurz Deine aktuelle Mailadresse.<br />
Wenn ich richtig suche, finde ich die Sachen von damals noch...<br />
Gruß Dirk</div></div><hr />



</div>
</body>
</html>