<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="Visual Basic und Baan-DLL's, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] Visual Basic und Baan-DLL's Deutsches Forum" />
	
	<title>Visual Basic und Baan-DLL's [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="../index.html">Newbaanboard</a> &gt; <a href="../index.html">BB Language Forums</a> &gt; <a href="../index.html">Deutsches Forum</a> &gt; Visual Basic und Baan-DLL's</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">Kai's Forum Users</div><div class="date">6th February 2001, 01:00</div></div><div class="posttext">&gt;Die DLL wird über OLE aufgerufen und ist gedacht um Datensätze zu konvertieren, da konzerneinheitliche Artikelnummern etc. verwendet werden sollen.Ich würde die API-DLL nicht direkt über OLE verwenden. Kannst Du nicht eine <br />
eigene DLL in Baan schreiben, die ein ganz einfaches Interface für Dein VB-<br />
Programm bereitstellt, und diese DLL dann die ganze Kommunikation mit der API-<br />
<br />
DLL machen lassen (Fassade-Pattern?)<br />
Also<br />
       VB                 DLL4711                          ttstpapidll<br />
       ||     tuwas()       |                                    |<br />
       || -----------------&gt;||  stpapi.put.field (feld1, wert1)  |<br />
       ||                   ||----------------------------------&gt;||<br />
       ||                   ||                                   |<br />
       ||                   ||  stpapi.put.field (feld2, wert2)  |<br />
       ||                   ||----------------------------------&gt;||<br />
       ||                   ||                                   |<br />
       ||&lt; - - - - - - - - -||                                   |<br />
<br />
       ||                   |                                    |<br />
Dann kannst Du auch getrennt testen: Die DLL4711 muss unter <br />
Baan alleine auch funktionieren. Dann kannst Du zumindest den <br />
<br />
Debugger verwenden...<br />
Uli</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Kai's Forum Users</div><div class="date">6th February 2001, 01:00</div></div><div class="posttext">Die DLL wird über OLE aufgerufen und ist gedacht um Datensätze zu konvertieren, da konzerneinheitliche Artikelnummern etc. verwendet werden sollen.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Kai's Forum Users</div><div class="date">6th February 2001, 01:00</div></div><div class="posttext">Hallo,<br />
kann mir jemand helfen?Ich weiß, daß es möglich ist mit Visual Basic Baan-Sessions aufzurufen und Daten zu ändern bzw. neu einzugeben. Die DLL dafür ist &quot;ottstpapihand&quot; ich habe auch die entsprechenden Funktionen mit bic_info6.1 ermittelt, aber irgenwie funktioniert das ganze noch nicht so richtig.<br />
<br />
Hat irgendjemand eine Dokumentation wie das ganze funktioniert?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Kai's Forum Users</div><div class="date">6th February 2001, 01:00</div></div><div class="posttext">Hi Volker!Wie rufst Du die DLL denn über Visual-Basic auf?<br />
<br />
Mit OLE?Denn primär kann man Baan DLLs nur aus Baan heraus<br />
verwenden - es sei denn, wie gesagt, über OLE<br />
(oder indem man das ganze durch den C- oder Java-Stub<br />
Compiler jagt, aber dann kannst Du mit VB nur schwer<br />
<br />
zugreifen). Ich hab mit der API-DLL mal etwas experimentiert,<br />
allerdings nur Baan-seitig (aus einer Baan-Session raus<br />
andere &quot;fernsteuern&quot;. Das klappt zwar im Prinzip, ist aber <br />
<br />
eine Geschichte, bei der man lange Zähne kriegen kann.(Das war, notabene, eine Debitoren-OP-Übernahme. Die Zähne<br />
waren zwar lang, aber ich war trotzdem dreimal schneller <br />
fertig als beim &quot;üblichen&quot; Verfahren, die Daten über <br />
<br />
Exchange und Integrationsschnittstelle in die Fibu zu pumpen!)<br />
Ausserdem läuft das ganze (unter IVc4) nicht allzu stabil.<br />
Soviel ich weiss, ist unter Baan IV das API auch noch kein<br />
<br />
&quot;offizielles&quot; Feature. <br />
Wenn Du näheres postest, kann ich Dir wahrscheinlich<br />
<br />
weiterhelfen.Servus,<br />
<br />
Uli</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Kai's Forum Users</div><div class="date">8th February 2001, 01:00</div></div><div class="posttext">Da es der erste Datensatz war konnte er die Gruppe nicht finden. Daher habe ich jetzt einen ersten Datensatz manuell angelegt.<br />
Aber jetzt erhalte ich die Fehlermeldung, daß er die Artikelnummer nicht kennt.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Kai's Forum Users</div><div class="date">8th February 2001, 01:00</div></div><div class="posttext">Kann es sein, dass Du noch nicht auf der Gruppe &quot;stehst&quot;?<br />
<br />
(stpapi.change.view)<br />
Anbei ein Zitat aus einem Posting in baanfans, das<br />
<br />
Dir dann vielleicht helfen könnte.<br />
Uli<br />
----------------------------------------<br />
: Hi,<br />
<br />
: Can someone confirm if my thinking is correct?<br />
: stpapi.browse.set performs the same functions as the toolbar icons that look like |<br />
: stpapi.change.view performs toolbar icon &gt;|<br />
: stpapi.browse.view performs toolbar icons |: Thanks,<br />
<br />
: Al.<br />
<br />
is comes from the api document I have. I believe it confirms your thinking. Sorry bout the formatting.3.10 Browse Session Records<br />
SYNTAX<br />
long stpapi.browse.set(string session, string option)<br />
ARGUMENTS<br />
session Name of the session this command is executed on.<br />
option This parameter indicates what type of browse action is required. The possible values are first.set, next.set, prev.set and last.set corresponding to the browse actions first record, next record, previous record and last record respectively.<br />
DESCRIPTION<br />
This executes the specified browse action against the indicated session. The resulting record is set as current.<br />
RETURN VALUES<br />
0 No record found<br />
<br />
1 Record found3.11 Set Current View for Session<br />
SYNTAX<br />
long stpapi.change.view(string session)<br />
ARGUMENTS<br />
session Name of the session this command is executed on.<br />
DESCRIPTION<br />
This sets the current view for sessions using forms of type 3 (multiple occurrence plus view). The field values of the view fields must be set prior to calling this function.<br />
RETURN VALUES<br />
0 No view found<br />
1 View found<br />
<br />
2 Another view found3.12 Browse Session Views<br />
SYNTAX<br />
long stpapi.browse.view(string session, string option)<br />
ARGUMENTS<br />
session Name of the session this command is executed on.<br />
option This parameter indicates what type of browse action is required. The possible values are first.view, next.view, prev.view and last.view corresponding to the browse actions first view, next view, previous view and last view respectively.<br />
DESCRIPTION<br />
This executes the specified browse action against the indicated session. The resulting record is set as current.<br />
RETURN VALUES<br />
0 No view found<br />
<br />
1 View found</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Kai's Forum Users</div><div class="date">8th February 2001, 01:00</div></div><div class="posttext">&gt;&gt;Die DLL wird über OLE aufgerufen und ist gedacht um Datensätze zu konvertieren, da konzerneinheitliche Artikelnummern etc. verwendet werden sollen.<br />
&gt;Ich würde die API-DLL nicht direkt über OLE verwenden. Kannst Du nicht eine <br />
&gt;eigene DLL in Baan schreiben, die ein ganz einfaches Interface für Dein VB-<br />
&gt;Programm bereitstellt, und diese DLL dann die ganze Kommunikation mit der API-<br />
&gt;DLL machen lassen (Fassade-Pattern?)<br />
&gt;Also<br />
&gt;<br />
&gt;       VB                 DLL4711                          ttstpapidll<br />
&gt;       ||     tuwas()       |                                    |<br />
&gt;       || -----------------&gt;||  stpapi.put.field (feld1, wert1)  |<br />
&gt;       ||                   ||----------------------------------&gt;||<br />
&gt;       ||                   ||                                   |<br />
&gt;       ||                   ||  stpapi.put.field (feld2, wert2)  |<br />
&gt;       ||                   ||----------------------------------&gt;||<br />
&gt;       ||                   ||                                   |<br />
&gt;       ||&lt; - - - - - - - - -||                                   |<br />
&gt;       ||                   |                                    |<br />
&gt;<br />
&gt;Dann kannst Du auch getrennt testen: Die DLL4711 muss unter <br />
&gt;Baan alleine auch funktionieren. Dann kannst Du zumindest den <br />
&gt;Debugger verwenden...<br />
<br />
&gt;Uli<br />
Das funktioniert prima aber nur bei Sessions mit Form Typ 1 und 2 nicht bei Sessions mit Form Typ 3.<br />
Besipiel:stapi.put.field(&quot;tiitm0112m000&quot;,&quot;tiitm012.citt&quot;,value)<br />
stapi.put.field(&quot;tiitm0112m000&quot;,&quot;tiitm012.item&quot;,value)<br />
stapi.put.field(&quot;tiitm0112m000&quot;,&quot;tiitm012.aitc&quot;,value)<br />
<br />
stapi.insert(&quot;tiitm0112m000&quot;,do.update,err.mess)<br />
Hier erhalte ich dann die Fehlermeldung, &quot;Codierungssystem nicht vorhanden&quot;, obwohl das Codierungssystem angelegt ist.Volker</div></div><hr />



</div>
</body>
</html>