<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="CUrioso problema con función AFS find, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] CUrioso problema con función AFS find Forum español" />
	
	<title>CUrioso problema con función AFS find [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="../index.html">Newbaanboard</a> &gt; <a href="../index.html">BB Language Forums</a> &gt; <a href="../index.html">Forum español</a> &gt; CUrioso problema con función AFS find</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">fbernaus</div><div class="date">14th July 2004, 19:34</div></div><div class="posttext">Hemos automatizado  con las funciones AFS la sesión &quot;tdinv1101m000&quot; para realizar traspasos entre almacenes. Ahora, tenemos un problema muy curioso. Imaginaros que queremos realizar un traspaso del artículo 1234567 del almacén 111 al almacén 222. Pues bien, la primera vez que se intenta este traspaso la función AFS &quot;find&quot; devuelve un -1, es decir, no encuentra el artículo. Sin embargo, el artículo existe!<br />
Lo curioso está en que las sucesivas veces que hacemos el mismo traspaso si se encuentra el articulo. Es justo en la primera cuando no lo encuentra!!! <br />
<br />
¿Os ha pasado alguna vez algo parecido? Por favor, ayuda!! No sabemos en absoluto que es lo que está pasando para que pase eso tan raro. Muchas gracias por adelantado!!!  ;) <br />
<br />
A continuación, pongo el código que utilizamos hasta lo que es la localización del artículo:<br />
<br />
Dim baanobj As Object=CreateObject(&quot;Baan4.Application.baanivc4&quot;) '501<br />
Dim sesion_baan As String = &quot;tdinv1101m000&quot; 'SESION: Introducir transacciones de stock por artículo<br />
<br />
stpapi.put.field(sesion_baan,&quot;tdinv100.item&quot;,codigo_articulo) //El codigo existe<br />
stpapi.put.field(sesion_baan,&quot;tdinv100.cwar&quot;,almacen origen)//el almacen que en el ejemplo llamo 111.<br />
stpapi.find(sesion_baan)&lt;&lt;&lt;&lt;----- Aquí devuelve un -1 de artículo no encontrado!!  :confused:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dorleta</div><div class="date">20th July 2004, 10:36</div></div><div class="posttext">¿has probado a metrle una fecha ? el campo fecha forma parte también del indice e incluso no estaría de más ponerle un número a la secuencia ( que podría ser un 1 ) a ver que pasa.<br />
<br />
Suerte</div></div><hr />


<div class="post"><div class="posttop"><div class="username">gget79</div><div class="date">3rd October 2007, 17:11</div></div><div class="posttext">Podría ser que el campo item pertenece a un ámbito segmentado, y puede ser que en la primera ejecución la variable que toma el código del item no este formateado acorde al ámbito segmentado, te recomiento que realices un debbuger bajando a variables los datos y verificando que los espacios a la izquierda o la derecha sean igual que por el código que estan preguntando en el AFS.</div></div><hr />



</div>
</body>
</html>