<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="Importar datos desde Excel a BaanIVc4, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] Importar datos desde Excel a BaanIVc4 Forum español" />
	
	<title>Importar datos desde Excel a BaanIVc4 [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="../index.html">Newbaanboard</a> &gt; <a href="../index.html">BB Language Forums</a> &gt; <a href="../index.html">Forum español</a> &gt; Importar datos desde Excel a BaanIVc4</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">rotiak</div><div class="date">23rd January 2007, 14:20</div></div><div class="posttext">Hola a todos,<br />
<br />
Estaba interesado en crear un procedimiento periódico (bastante frecuente) en el cual pueda importar datos de una hoja de cálculo Excel a dos tablas de Baan, para quitar carga de trabajo al departamento de compras. <br />
<br />
En Excel tendríamos unos registros devididos en columnas, p.e. nº proyecto, código de artículo, descripción, referencia, cantidad y los queremos insertar en la tabla tipcs021... todos los demás campos de la tabla podrían ser por defecto siempre los mismos (en caso de que algo variara se cambiaría a mano en la sesión...). Y también a la tabla tipcs022 (en este caso nos encontramos con bastantes menos campos).<br />
<br />
¿Qué posibilidades habría?<br />
¿Pueda dar problemas a posteriori?<br />
<br />
Muchas gracias de antemano.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">dorleta</div><div class="date">24th January 2007, 12:52</div></div><div class="posttext">Yo usaría AFS para asegurarme que las actualizaciones de las tablas mueven exactamente los mismos campos que moverían si realizases la actualización por la sesión. A partir de ahí puedes lanzar estas AFS desde la hoja de excel utilizando el OLE automation server o pasar la hoja de excel a fichero .csv y que una sesión de baan tome el fichero de texto y lanze la AFS.<br />
<br />
Te adjunto la ayuda de baan. Y en uno de los directorios del cliente tienes unos ejemplos de unas hojas excel que te pueden servir de indicación<br />
<br />
Suerte</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ecarceller</div><div class="date">30th January 2007, 17:59</div></div><div class="posttext">Hola a todos,<br />
<br />
Estaba interesado en crear un procedimiento periódico (bastante frecuente) en el cual pueda importar datos de una hoja de cálculo Excel a dos tablas de Baan, para quitar carga de trabajo al departamento de compras. <br />
<br />
En Excel tendríamos unos registros devididos en columnas, p.e. nº proyecto, código de artículo, descripción, referencia, cantidad y los queremos insertar en la tabla tipcs021... todos los demás campos de la tabla podrían ser por defecto siempre los mismos (en caso de que algo variara se cambiaría a mano en la sesión...). Y también a la tabla tipcs022 (en este caso nos encontramos con bastantes menos campos).<br />
<br />
¿Qué posibilidades habría?<br />
¿Pueda dar problemas a posteriori?<br />
<br />
Muchas gracias de antemano.<br />
<br />
Baan Exchange puede hacer el trabajo que describís y te garantiza integridad referencial. Lo que Exchange no va a garantizar es que los datos tengan sentido desde el punto de vista funcional y de negocio. A menos que incluyas la lógica que verifica la coherencia funcional de los datos en las condiciones usadas por tu esquema de Exchange.<br />
El formato de los archivos necesitará ser csv para poder usar Exchange<br />
<br />
Exchange funciona bien pero si el volumen de datos es grande puede ser lento. Si se trata sólo de una planilla de excel a la vez entonces no deberías tener problemas.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rotiak</div><div class="date">27th February 2007, 13:36</div></div><div class="posttext">Estoy haciendo diferentes pruebas y me falla... al intentar importar me dice que no puede abrir el archivo d:\importar\prueba/10.o (error 2) ... cuando el archivo se llama prueba.csv ...tengo que hacer más pruebas...<br />
<br />
De todos modos, estaría muy agradecido en conseguir cualquier información sobre este módulo y aún mejor sería algún ejemplo práctico...<br />
<br />
Muchas gracias de antemano!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ecarceller</div><div class="date">27th February 2007, 17:19</div></div><div class="posttext">Creo que lo que el sistema no encuentra es el objeto. Antes de poder usar tu esquema de exchange necesitas compilarlo. <br />
Para el módulo de importación usa:<br />
<br />
&quot;Create Import Script&quot; tuxch0227m000<br />
<br />
Y para el de exportación:<br />
<br />
&quot;Create Export Script&quot; tuxch0228m000<br />
<br />
Probá y contame.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rotiak</div><div class="date">28th February 2007, 17:33</div></div><div class="posttext">Gracias era eso, lo compilo y me crea un objeto &quot;10.o&quot;, ya no me sale ese error, pero ahora...<br />
...creo que estoy peor porque no me da ningún error pero no me lo hace, voy a importar desde &quot;Importar datos (no regularmente)&quot; y al final pone &quot;preparado&quot; pero no se importa nada a la tabla tipcs021. Me crea otro archivo en el directorio cada vez que lo hago &quot;log.10.2.1&quot;, así correlativamente, pero nada. <br />
La cuestión es que la tabla tipcs021 es una tabla con muchos campos... y yo lo que quiero importar es un archivo prueba.csv con solo tres campos, el resto lo he definido como valor fijo en &quot;Mantener relaciones de campos (Importación)&quot;  (bien insertando un determinado valor o bien dejandolo en blanco para que lo deje vacío). <br />
<br />
¿?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ecarceller</div><div class="date">1st March 2007, 18:23</div></div><div class="posttext">Busca en los logs de Baan tal vez tengas errores de referencia o restricciones de dominios</div></div><hr />


<div class="post"><div class="posttop"><div class="username">moianix</div><div class="date">5th March 2007, 17:16</div></div><div class="posttext">Hola<br />
<br />
pues yo hago algo similar utilizando directamente desde Excel.<br />
<br />
Puedes crear una o mas tablas de apoyo con los campos que quieres importar.<br />
En los campos de las nuevas tablas no les ponga ninguna referencia.<br />
En excel escribas algo de similar para insertar datos en la tabla/tablas<br />
<br />
    COMP = &quot;123&quot;    ' Company number<br />
    oConn.CursorLocation = adUseServer<br />
    <br />
    oConn.Open &quot;Provider=msdaora;&quot; &amp; _<br />
           &quot;Data Source=your_oracle_sid;&quot; &amp; _<br />
           &quot;User Id=oracle_user;&quot; &amp; _<br />
           &quot;Password=pwd_for_oracle_user&quot;<br />
    <br />
    Set rs = New Recordset<br />
    With rs<br />
        Data1 = Format(Cells(rigaP, 13), &quot;dd/mm/yyyy&quot;)<br />
        Data2 = Format(Cells(rigaP, 14), &quot;dd/mm/yyyy&quot;)<br />
        StrSql = &quot;INSERT INTO baan.ttdpur971&quot; + COMP + &quot; &quot;<br />
        StrSql = StrSql + &quot;( baan.ttdpur971&quot; + COMP + &quot;.t$suno,baan.ttdpur971&quot; + COMP + &quot;.t$item, &quot;<br />
        StrSql = StrSql + &quot;baan.ttdpur971&quot; + COMP + &quot;.t$qanp,baan.ttdpur971&quot; + COMP + &quot;.t$stdt, &quot;<br />
        StrSql = StrSql + &quot;baan.ttdpur971&quot; + COMP + &quot;.t$tdat,baan.ttdpur971&quot; + COMP + &quot;.t$pric, &quot;<br />
        StrSql = StrSql + &quot;baan.ttdpur971&quot; + COMP + &quot;.t$cder, &quot;<br />
        StrSql = StrSql + &quot;baan.ttdpur971&quot; + COMP + &quot;.t$refcntd,baan.ttdpur971&quot; + COMP + &quot;.t$refcntu) &quot;<br />
        StrSql = StrSql + &quot;VALUES ('&quot; + suno + &quot;','&quot; + codice + &quot;', &quot;<br />
        StrSql = StrSql + Replace(Format(Cells(rigaP, 11), &quot;#######0.0000&quot;), &quot;,&quot;, &quot;.&quot;) + &quot;, &quot;<br />
        StrSql = StrSql + &quot;to_date('&quot; + Data1 + &quot;','DD/MM/SYYYY'), &quot;<br />
        StrSql = StrSql + &quot;to_date('&quot; + Data2 + &quot;','DD/MM/SYYYY'), &quot;<br />
        StrSql = StrSql + Replace(Format(Cells(rigaP, 12), &quot;#######0.0000&quot;), &quot;,&quot;, &quot;.&quot;) + &quot;,&quot;<br />
        StrSql = StrSql + &quot; '0','0','0' ) &quot;<br />
  <br />
        .CursorLocation = adUseClient<br />
        .CursorType = adOpenStatic<br />
        .LockType = adLockReadOnly<br />
        .Open StrSql, oConn<br />
    End With<br />
<br />
Luego escribas un sencillo programa en BaaN para leer las tablas de apoyo  insertar los datos en las tablas corecta<br />
<br />
Asi no tengo problemas.</div></div><hr />



</div>
</body>
</html>