<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="Approval Process in Baan V, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] Approval Process in Baan V AFS/DDC/OLE: Function servers" />
	
	<title>Approval Process in Baan V [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="index.html">Newbaanboard</a> &gt; <a href="index.html">Baan SIGs</a> &gt; <a href="index.html">AFS/DDC/OLE: Function servers</a> &gt; Approval Process in Baan V</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">tomlbacon</div><div class="date">4th January 2012, 00:04</div></div><div class="posttext">I'm trying to do Stpapi command for session whinh3522m000 and whinh3122s000 to update the Approvals in table whinh211 in Baan V.  I have a form and require the Order, set and position number to find the records that I want to process.  Program goes thru the stpapi command and all err.msg's are ok but doesn't update the Records with new values.  Would like any help can get.<br />
<br />
Thanks,  Code of stpapi is below<br />
<br />
do.update = 1<br />
do.save = 1<br />
<br />
	stpapi.put.field( &quot;whinh3522m000&quot;, &quot;whinh211.orno&quot;, orno.f )<br />
	stpapi.put.field( &quot;whinh3522m000&quot;, &quot;whinh211.oset&quot;, str$(whinh211.oset) )<br />
	stpapi.put.field( &quot;whinh3522m000&quot;, &quot;whinh211.pono&quot;, str$(whinh211.pono) )<br />
	stpapi.put.field( &quot;whinh3522m000&quot;, &quot;whinh211.seqn&quot;, str$(whinh211.seqn) )<br />
	stpapi.put.field( &quot;whinh3522m000&quot;, &quot;whinh211.sern&quot;, str$(whinh211.sern) )<br />
	stpapi.put.field( &quot;whinh3522m000&quot;, &quot;whinh211.apnr&quot;, str$(whinh211.apun) )<br />
	stpapi.put.field( &quot;whinh3522m000&quot;, &quot;whinh211.cwar&quot;, str$(whinh211.cwar) )<br />
	stpapi.put.field( &quot;whinh3522m000&quot;, &quot;whinh211.loca&quot;, str$(whinh211.loca) )<br />
	stpapi.put.field( &quot;whinh3522m000&quot;, &quot;whinh211.stra&quot;, str$(whinh211.stkt) )	       |* Approved Inventory<br />
	stpapi.put.field( &quot;whinh3522m000&quot;, &quot;whinh211.strr&quot;, str$(whinh211.strr) )	       |* Rejected Inventory<br />
	stpapi.put.field( &quot;whinh3122s000&quot;, &quot;whinh211.oorg&quot;, str$(whinh211.oorg))               |* Order Origin<br />
 	stpapi.put.field( &quot;whinh3122s000&quot;, &quot;whinh211.orno&quot;, orno.f )		               |* Order Number <br />
	stpapi.put.field( &quot;whinh3122s000&quot;, &quot;whinh211.oset&quot;, str$(whinh211.oset) )   	       |* Order Set<br />
	stpapi.put.field( &quot;whinh3122s000&quot;, &quot;whinh211.pono&quot;, str$(whinh211.pono) )	       |* Position Number<br />
 	stpapi.put.field( &quot;whinh3122s000&quot;, &quot;whinh211.seqn&quot;, str$(whinh211.seqn) )	       |* Seqence Number<br />
 	stpapi.put.field( &quot;whinh3122s000&quot;, &quot;whinh211.sern&quot;, str$(whinh211.sern) )	       |* Advice Number		<br />
 	stpapi.put.field( &quot;whinh3122s000&quot;, &quot;whinh211.apun&quot;, whinh211.apun )		       |* Approval UOM<br />
 	stpapi.put.field( &quot;whinh3122s000&quot;, &quot;whinh211.stra&quot;, str$(whinh211.stkt) )	       |* Approved Inventory	<br />
 	stpapi.put.field( &quot;whinh3122s000&quot;, &quot;whinh211.rjun&quot;, whinh211.rjun )		       |* Rejected UOM<br />
 	stpapi.put.field( &quot;whinh3122s000&quot;, &quot;whinh211.strr&quot;, str$(whinh211.strr) )	       |* Rejected Inventory	<br />
 	stpapi.put.field( &quot;whinh3122s000&quot;, &quot;whinh211.resn&quot;, &quot;&quot; )	 	               |* Reason Code<br />
	stpapi.mark( &quot;whinh3522m000&quot; ) <br />
	stpapi.synchronize.dialog(&quot;whinh3522m000&quot;, &quot;modify&quot; , err.msg)<br />
	stpapi.update( &quot;whinh3122s000&quot;, do.update, err.msg )   <br />
 	stpapi.save( &quot;whinh3122s000&quot;, err.msg )<br />
	stpapi.handle.subproc( &quot;whinh3522m000&quot;, &quot;whinh3122s000&quot;, &quot;modify&quot; )<br />
	stpapi.update( &quot;whinh3522m000&quot;, do.save, err.msg )<br />
	stpapi.save( &quot;whinh3522m000&quot;, err.msg ) <br />
	stpapi.end.session( &quot;whinh3522m000&quot; ) <br />
	stpapi.end.session( &quot;whinh3122s000&quot; )</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">4th January 2012, 01:47</div></div><div class="posttext">See the sticky thread at the top of this forum.  This code does not look like what I would expect using the synchronize.dialog statement.<br />
<br />
<br />
stpapi.put.field(&quot;dtfsa1501m000&quot;, &quot;dtfsa101.seno&quot;, str$(i.seno))<br />
ret = stpapi.find(&quot;dtfsa1501m000&quot;, error.msg)<br />
if ret then		<br />
       ret = stpapi.synchronize.dialog(&quot;dtfsa1501m000&quot;, &quot;modify&quot;, error.msg)<br />
       if ret then<br />
               stpapi.put.field(&quot;dtfsa1101s000&quot;, &quot;dtfsa101.name&quot;, new.name) <br />
	            ret = stpapi.update(&quot;dtfsa1501m000&quot;, true, error.msg)<br />
       endif<br />
endif<br />
<br />
<br />
Using the above sample I would expect to see a few puts on the main session, then a find on the main session, then the sync dialog statement, then a put to the subsession, then a update or insert on the main session.  That is the flow I would expect to see based of the documentation.  Since I do not really use LN or this session I can not really assist too much, but just speculate on what I see.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">tomlbacon</div><div class="date">4th January 2012, 22:27</div></div><div class="posttext">Mark,<br />
   Thanks for your help. Changed the code to this:<br />
<br />
  do.update = 1<br />
	do.save = 1<br />
<br />
	stpapi.put.field( &quot;whinh3522m000&quot;, &quot;whinh211.orno&quot;, orno.f )<br />
	stpapi.put.field( &quot;whinh3522m000&quot;, &quot;whinh211.oset&quot;, str$(whinh211.oset) )<br />
	stpapi.put.field( &quot;whinh3522m000&quot;, &quot;whinh211.pono&quot;, str$(whinh211.pono) )<br />
	stpapi.put.field( &quot;whinh3522m000&quot;, &quot;whinh211.seqn&quot;, str$(whinh211.seqn) )<br />
	stpapi.put.field( &quot;whinh3522m000&quot;, &quot;whinh211.sern&quot;, str$(whinh211.sern) )<br />
	stpapi.put.field( &quot;whinh3522m000&quot;, &quot;whinh211.apnr&quot;, str$(whinh211.apun) )<br />
	stpapi.put.field( &quot;whinh3522m000&quot;, &quot;whinh211.cwar&quot;, str$(whinh211.cwar) )<br />
	stpapi.put.field( &quot;whinh3522m000&quot;, &quot;whinh211.loca&quot;, str$(whinh211.loca) )<br />
	ret = stpapi.find( &quot;whinh3522m000&quot;, err.msg)<br />
	if ret then<br />
	    ret = stpapi.synchronize.dialog(&quot;whinh3522m000&quot;, &quot;modify&quot; , err.msg)<br />
	    if ret then<br />
 		stpapi.put.field( &quot;whinh3122s000&quot;, &quot;whinh211.orno&quot;, orno.f )		               |* Order Number <br />
		stpapi.put.field( &quot;whinh3122s000&quot;, &quot;whinh211.oset&quot;, str$(whinh211.oset) )   	       |* Order Set<br />
		stpapi.put.field( &quot;whinh3122s000&quot;, &quot;whinh211.pono&quot;, str$(whinh211.pono) )	       |* Position Number<br />
 		stpapi.put.field( &quot;whinh3122s000&quot;, &quot;whinh211.seqn&quot;, str$(whinh211.seqn) )	       |* Seqence Number<br />
 		stpapi.put.field( &quot;whinh3122s000&quot;, &quot;whinh211.sern&quot;, str$(whinh211.sern) )	       |* Advice Number		<br />
 		stpapi.put.field( &quot;whinh3122s000&quot;, &quot;whinh211.stra&quot;, str$(approved.qty) )	       |* Approved Inventory<br />
		stpapi.put.field( &quot;whinh3122s000&quot;, &quot;whinh211.stkt&quot;, str$(0))                           |* To be Inspected Qty	<br />
		ret = stpapi.update( &quot;whinh3522m000&quot;, do.save, err.msg )<br />
	    endif	<br />
	endif<br />
<br />
	stpapi.end.session( &quot;whinh3122s000&quot; )<br />
	stpapi.end.session( &quot;whinh3522m000&quot; )</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">5th January 2012, 15:56</div></div><div class="posttext">Does that mean it worked? At least I hope so.</div></div><hr />



</div>
</body>
</html>