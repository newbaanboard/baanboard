<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="AFS for Session tfgld1101m000, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] AFS for Session tfgld1101m000 AFS/DDC/OLE: Function servers" />
	
	<title>AFS for Session tfgld1101m000 [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="index.html">Newbaanboard</a> &gt; <a href="index.html">Baan SIGs</a> &gt; <a href="index.html">AFS/DDC/OLE: Function servers</a> &gt; AFS for Session tfgld1101m000</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">baan.tools</div><div class="date">7th September 2007, 07:07</div></div><div class="posttext">Hello All,<br />
<br />
I have created a session for writing AFS for the session tfgld1101m000 and facing problem. I am getting an error &quot;Journal not Authorise&quot;<br />
<br />
Can anyone help me out.<br />
<br />
FYI i am writing AFS in Baan 5.<br />
<br />
Thanks in Advance....<br />
<br />
Regards,<br />
Baan Tools</div></div><hr />


<div class="post"><div class="posttop"><div class="username">george7a</div><div class="date">7th September 2007, 10:35</div></div><div class="posttext">Hi,<br />
<br />
I have moved your thread to the right forum.<br />
<br />
Can you please post your code?<br />
<br />
- George</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bigjack</div><div class="date">7th September 2007, 13:06</div></div><div class="posttext">What happens when you actually try and maintain record in session tfgld1101m000(not thru AFS) ? Do you get the same error ? If yes, then the problem is functional than technical .</div></div><hr />


<div class="post"><div class="posttop"><div class="username">baan.tools</div><div class="date">10th September 2007, 13:11</div></div><div class="posttext">Sorry for late reply... The problem which i was getting was sloved and i am getting another error mentioned at the end of my code...<br />
<br />
Please find below the code<br />
<br />
	stpapi.put.field(&quot;tfgld1101m000&quot;,&quot;tedt.f&quot;,str$(date.num()))<br />
	stpapi.put.field(&quot;tfgld1101m000&quot;,&quot;tfgld101.year&quot;,str$(2007))<br />
	stpapi.put.field( &quot;tfgld1101m000&quot;, &quot;tfgld101.btno&quot;, str$(00))<br />
	stpapi.put.field(&quot;tfgld1101m000&quot;,&quot;bref.f&quot;,str$(&quot;Test&quot;))<br />
	stpapi.put.field(&quot;tfgld1101m000&quot;,&quot;fprd.f&quot;,str$(09))<br />
	stpapi.put.field(&quot;tfgld1101m000&quot;,&quot;rprd.f&quot;,str$(03))<br />
	stpapi.put.field(&quot;tfgld1101m000&quot;,&quot;vyer.f&quot;,str$(2007))<br />
	stpapi.put.field(&quot;tfgld1101m000&quot;,&quot;vprd.f&quot;,str$(09))<br />
	rc = stpapi.change.view(&quot;tfgld1101m000&quot;,errmsg)<br />
	stpapi.put.field(&quot;tfgld1101m000&quot;,&quot;tfgld101.ttyp&quot;,&quot;O99&quot;)<br />
	rc = stpapi.insert(&quot;tfgld1101m000&quot;, true, errmsg)<br />
	stpapi.get.field(&quot;tfgld1101m000&quot;,&quot;tfgld101.btno&quot;,errmsg)<br />
	batch.number = val(errmsg)<br />
	stpapi.end.session(&quot;tfgld1101m000&quot;,errmsg)<br />
	rc = stpapi.browse.set(&quot;tfgld1101m000&quot;, &quot;last.set&quot;, w.err.msg)<br />
	stpapi.put.field(&quot;tfgld1101m000&quot;, &quot;tfgld101.year&quot;, str$(2007))<br />
	stpapi.put.field(&quot;tfgld1101m000&quot;, &quot;tfgld101.btno&quot;, str$(batch.number))<br />
	stpapi.put.field(&quot;tfgld1101m000&quot;, &quot;tfgld101.ttyp&quot;, str$(&quot;O99&quot;))<br />
	ret = stpapi.find(&quot;tfgld1101m000&quot;, error.msg)<br />
	<br />
	if rc &lt;&gt; 0 then<br />
		rc = stpapi.mark(&quot;tfgld1101m000&quot;, w.err.msg)<br />
	endif<br />
	<br />
	if rc &lt;&gt; 0 then<br />
		stpapi.form.command(&quot;tfgld1101m000&quot;, 5, &quot;exec.cont.process&quot;,error.msg)<br />
	endif<br />
<br />
	if isspace(w.err.msg) then<br />
		stpapi.put.field(&quot;tfgld1114s000&quot;, &quot;tfgld102.docn&quot;, str$(123456))<br />
		stpapi.put.field(&quot;tfgld1114s000&quot;, &quot;dcdt.f&quot;, str$(date.num()))<br />
		stpapi.put.field(&quot;tfgld1114s000&quot;, &quot;ccur.f&quot;, str$(&quot;EUR&quot;))<br />
		stpapi.put.field(&quot;tfgld1114s000&quot;, &quot;tfgld102.tcom&quot;, str$(360))<br />
		stpapi.put.field(&quot;tfgld1114s000&quot;, &quot;tfgld102.leac&quot;, str$(&quot;70199999&quot;))<br />
		stpapi.put.field(&quot;tfgld1114s000&quot;, &quot;form.amnt&quot;, str$(50))<br />
		stpapi.put.field(&quot;tfgld1114s000&quot;, &quot;dbcr&quot;, str$(etol(tfgld.dbcr.debit)))<br />
		stpapi.put.field(&quot;tfgld1114s000&quot;, &quot;refr&quot;, str$(&quot;Interface Payee&quot;))<br />
		rc = stpapi.insert(&quot;tfgld1114s000&quot;,true, e.msg)<br />
		if rc = 0 then<br />
			rc = stpapi.recover(&quot;tfgld1114s000&quot;, w.err.msg)<br />
		endif<br />
	endif<br />
	stpapi.end.session(&quot;tfgld1114s000&quot;,e.msg)<br />
	stpapi.end.session(&quot;tfgld1101m000&quot;,e.msg)<br />
<br />
<br />
Here i am getting another error The indicator of counted double for the account general is not authorized here when saving the session tfgld1114s000.<br />
<br />
Please help me regarding this..</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mojo1980</div><div class="date">29th November 2007, 20:53</div></div><div class="posttext">Hi,<br />
<br />
I'm trying to do a very similar thing, and I'm running into a problem. I'm using baanIV. When running the script with debug mode, when reaching stpapi.continue.process, it gets stuck at that point.<br />
<br />
Any idea what's going on?<br />
<br />
Thanks<br />
<br />
if rc &lt;&gt; 0 then                                        &#9474;<br />
&#9474; 0068:                         |stpapi.form.command(&quot;tfgld1101m000&quot;, 5, &quot;exec.&#9474;<br />
&#9474; 0069:                         stpapi.continue.process(&quot;tfgld1101m000&quot;, error.&#9474;<br />
&#9474; 0070:                 endif</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">29th November 2007, 21:34</div></div><div class="posttext">Post your code so we can see what it is doing.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mojo1980</div><div class="date">30th November 2007, 15:11</div></div><div class="posttext">Hi, I actually found some code in another thread, it works, but now I'm trying to create more than 1 transaction withnin the same Batch. The message error (code in RED) gives me: Batch/Transaction Type Already used.<br />
<br />
If I change view, I get a new batch number. And that's not what I want.<br />
<br />
Sorry if I don't use all the correct terms, I'm a newbie with baan.<br />
<br />
Thanks for help.<br />
<br />
CODE<br />
<br />
| Switch the view<br />
        if stpapi.change.view(&quot;tfgld1101m000&quot;, error.msg) &gt; 0 then<br />
                stpapi.put.field(&quot;tfgld1101m000&quot;, &quot;tfgld101.ttyp&quot; , &quot;JIN&quot;)<br />
                stpapi.put.field(&quot;tfgld1101m000&quot;, &quot;tfgld101.amnt&quot; , str$(0.00))<br />
| Insert Transaction<br />
                ret = stpapi.insert(&quot;tfgld1101m000&quot;, 1, error.msg)<br />
                if not ret then<br />
                        message(&quot;Insert Error for PM1 = %s &quot;, error.msg)<br />
                        ret2 = stpapi.recover(&quot;tfgld1101m000&quot;, error.msg)<br />
                endif<br />
                ret = stpapi.save(&quot;tfgld1101m000&quot;, error.msg)<br />
                if not ret then<br />
                        message(&quot;Save Error for PM1 = %s &quot;, error.msg)<br />
                        ret2 = stpapi.recover(&quot;tfgld1101m000&quot;, error.msg)<br />
                endif<br />
<br />
                stpapi.put.field(&quot;tfgld1101m000&quot;, &quot;tfgld101.ttyp&quot; , &quot;JEM&quot;)<br />
                stpapi.put.field(&quot;tfgld1101m000&quot;, &quot;tfgld101.amnt&quot; , str$(0.00))<br />
                ret = stpapi.insert(&quot;tfgld1101m000&quot;, 1, error.msg)<br />
                if not ret then<br />
                        message(&quot;Insert Error for PM1 = %s &quot;, error.msg)<br />
                        ret2 = stpapi.recover(&quot;tfgld1101m000&quot;, error.msg)<br />
                endif<br />
                ret = stpapi.save(&quot;tfgld1101m000&quot;, error.msg)<br />
                if not ret then<br />
                        message(&quot;Save Error for PM1 = %s &quot;, error.msg)<br />
                        ret2 = stpapi.recover(&quot;tfgld1101m000&quot;, error.msg)<br />
                endif<br />
        endif<br />
<br />
        RET = stpapi.browse.set(&quot;tfgld1101m000&quot;, &quot;last.set&quot;)<br />
<br />
        ret = stpapi.mark(&quot;tfgld1101m000&quot;, error.msg)<br />
<br />
        stpapi.handle.subproc(&quot;tfgld1101m000&quot;, &quot;tfgld1103s000&quot;, &quot;add&quot;)<br />
        stpapi.continue.process(&quot;tfgld1101m000&quot;, error.msg)<br />
        if stpapi.change.view(&quot;tfgld1103s000&quot;, error.msg) &gt; 0 then<br />
                stpapi.put.field(&quot;tfgld1103s000&quot;, &quot;tfgld102.ttyp&quot;, str$(&quot;JIN&quot;))<br />
                stpapi.put.field(&quot;tfgld1103s000&quot;, &quot;tfgld102.docn&quot;, str$(28))<br />
                stpapi.put.field(&quot;tfgld1103s000&quot;, &quot;ccur.d&quot;, str$(&quot;CAD&quot;))<br />
                stpapi.put.field(&quot;tfgld1103s000&quot;, &quot;ccty.f&quot;, str$(&quot;CAN&quot;))<br />
                stpapi.put.field(&quot;tfgld1103s000&quot;, &quot;dcdt.f&quot;, str$(date.num()))<br />
                stpapi.put.field(&quot;tfgld1103s000&quot;, &quot;rate.f&quot;, str$(1.000000))<br />
                stpapi.put.field(&quot;tfgld1103s000&quot;, &quot;vyer.f&quot;,str$(2008))<br />
                stpapi.put.field(&quot;tfgld1103s000&quot;, &quot;vprd.f&quot;,str$(08))<br />
                stpapi.put.field(&quot;tfgld1103s000&quot;, &quot;tfgld102.lino&quot;, str$(1))<br />
                stpapi.put.field(&quot;tfgld1103s000&quot;, &quot;tfgld102.tcom&quot;, str$(300))<br />
                stpapi.put.field(&quot;tfgld1103s000&quot;, &quot;tfgld102.leac&quot;, str$(1234567))<br />
                stpapi.put.field(&quot;tfgld1103s000&quot;, &quot;tfgld102.dim2&quot;, str$(&quot;1234&quot;))<br />
                stpapi.put.field(&quot;tfgld1103s000&quot;, &quot;form.amnt&quot;, str$(150.00))<br />
                stpapi.put.field(&quot;tfgld1103s000&quot;, &quot;tfgld102.dbcr&quot;, str$(etol(tfgld.dbcr.debit)))<br />
                stpapi.put.field(&quot;tfgld1103s000&quot;, &quot;tfgld102.refr&quot;, str$(&quot;TESTER&quot;))<br />
                rc = stpapi.insert(&quot;tfgld1103s000&quot;, 1, e.msg)<br />
                if rc = 0 then<br />
                        rc = stpapi.recover(&quot;tfgld1103s000&quot;, w.err.msg)<br />
                endif<br />
                stpapi.put.field(&quot;tfgld1103s000&quot;, &quot;tfgld102.ttyp&quot;, str$(&quot;JIN&quot;))<br />
                stpapi.put.field(&quot;tfgld1103s000&quot;, &quot;tfgld102.docn&quot;, str$(28))<br />
                stpapi.put.field(&quot;tfgld1103s000&quot;, &quot;ccur.d&quot;, str$(&quot;CAD&quot;))<br />
                stpapi.put.field(&quot;tfgld1103s000&quot;, &quot;ccty.f&quot;, str$(&quot;CAN&quot;))<br />
                stpapi.put.field(&quot;tfgld1103s000&quot;, &quot;dcdt.f&quot;, str$(date.num()))<br />
                stpapi.put.field(&quot;tfgld1103s000&quot;, &quot;rate.f&quot;, str$(1.000000))<br />
                stpapi.put.field(&quot;tfgld1103s000&quot;, &quot;vyer.f&quot;,str$(2008))<br />
                stpapi.put.field(&quot;tfgld1103s000&quot;, &quot;vprd.f&quot;,str$(08))<br />
                stpapi.put.field(&quot;tfgld1103s000&quot;, &quot;tfgld102.lino&quot;, str$(2))<br />
                stpapi.put.field(&quot;tfgld1103s000&quot;, &quot;tfgld102.tcom&quot;, str$(300))<br />
                stpapi.put.field(&quot;tfgld1103s000&quot;, &quot;tfgld102.leac&quot;, str$(1234567))<br />
                stpapi.put.field(&quot;tfgld1103s000&quot;, &quot;tfgld102.dim2&quot;, str$(&quot;1234&quot;))<br />
                stpapi.put.field(&quot;tfgld1103s000&quot;, &quot;form.amnt&quot;, str$(150.00))<br />
                stpapi.put.field(&quot;tfgld1103s000&quot;, &quot;tfgld102.dbcr&quot;, str$(etol(tfgld.dbcr.credit)))<br />
                stpapi.put.field(&quot;tfgld1103s000&quot;, &quot;tfgld102.refr&quot;, str$(&quot;TESTER&quot;))<br />
                rc = stpapi.insert(&quot;tfgld1103s000&quot;, 1, e.msg)<br />
        endif<br />
        stpapi.end.session(&quot;tfgld1103s000&quot;)<br />
<br />
        RET = stpapi.browse.set(&quot;tfgld1101m000&quot;, &quot;first.set&quot;)<br />
        ret = stpapi.mark(&quot;tfgld1101m000&quot;, error.msg)<br />
<br />
        stpapi.handle.subproc(&quot;tfgld1101m000&quot;, &quot;tfgld1103s000&quot;, &quot;add&quot;)<br />
        stpapi.continue.process(&quot;tfgld1101m000&quot;, error.msg)<br />
        if stpapi.change.view(&quot;tfgld1103s000&quot;, error.msg) &gt; 0 then<br />
                stpapi.put.field(&quot;tfgld1103s000&quot;, &quot;tfgld102.ttyp&quot;, str$(&quot;JIN&quot;))<br />
                stpapi.put.field(&quot;tfgld1103s000&quot;, &quot;tfgld102.docn&quot;, str$(28))<br />
                stpapi.put.field(&quot;tfgld1103s000&quot;, &quot;ccur.d&quot;, str$(&quot;CAD&quot;))<br />
                stpapi.put.field(&quot;tfgld1103s000&quot;, &quot;ccty.f&quot;, str$(&quot;CAN&quot;))<br />
                stpapi.put.field(&quot;tfgld1103s000&quot;, &quot;dcdt.f&quot;, str$(date.num()))<br />
                stpapi.put.field(&quot;tfgld1103s000&quot;, &quot;rate.f&quot;, str$(1.000000))<br />
                stpapi.put.field(&quot;tfgld1103s000&quot;, &quot;vyer.f&quot;,str$(2008))<br />
                stpapi.put.field(&quot;tfgld1103s000&quot;, &quot;vprd.f&quot;,str$(08))<br />
                stpapi.put.field(&quot;tfgld1103s000&quot;, &quot;tfgld102.lino&quot;, str$(1))<br />
                stpapi.put.field(&quot;tfgld1103s000&quot;, &quot;tfgld102.tcom&quot;, str$(300))<br />
                stpapi.put.field(&quot;tfgld1103s000&quot;, &quot;tfgld102.leac&quot;, str$(1234567))<br />
                stpapi.put.field(&quot;tfgld1103s000&quot;, &quot;tfgld102.dim2&quot;, str$(&quot;1234&quot;))<br />
                stpapi.put.field(&quot;tfgld1103s000&quot;, &quot;form.amnt&quot;, str$(90.00))<br />
                stpapi.put.field(&quot;tfgld1103s000&quot;, &quot;tfgld102.dbcr&quot;, str$(etol(tfgld.dbcr.debit)))<br />
                stpapi.put.field(&quot;tfgld1103s000&quot;, &quot;tfgld102.refr&quot;, str$(&quot;TESTER&quot;))<br />
                rc = stpapi.insert(&quot;tfgld1103s000&quot;, 1, e.msg)<br />
                if rc = 0 then<br />
                        rc = stpapi.recover(&quot;tfgld1103s000&quot;, w.err.msg)<br />
                endif<br />
                stpapi.put.field(&quot;tfgld1103s000&quot;, &quot;tfgld102.ttyp&quot;, str$(&quot;JIN&quot;))<br />
                stpapi.put.field(&quot;tfgld1103s000&quot;, &quot;tfgld102.docn&quot;, str$(28))<br />
                stpapi.put.field(&quot;tfgld1103s000&quot;, &quot;ccur.d&quot;, str$(&quot;CAD&quot;))<br />
                stpapi.put.field(&quot;tfgld1103s000&quot;, &quot;ccty.f&quot;, str$(&quot;CAN&quot;))<br />
                stpapi.put.field(&quot;tfgld1103s000&quot;, &quot;dcdt.f&quot;, str$(date.num()))<br />
                stpapi.put.field(&quot;tfgld1103s000&quot;, &quot;rate.f&quot;, str$(1.000000))<br />
                stpapi.put.field(&quot;tfgld1103s000&quot;, &quot;vyer.f&quot;,str$(2008))<br />
                stpapi.put.field(&quot;tfgld1103s000&quot;, &quot;vprd.f&quot;,str$(08))<br />
                stpapi.put.field(&quot;tfgld1103s000&quot;, &quot;tfgld102.lino&quot;, str$(2))<br />
                stpapi.put.field(&quot;tfgld1103s000&quot;, &quot;tfgld102.tcom&quot;, str$(300))<br />
                stpapi.put.field(&quot;tfgld1103s000&quot;, &quot;tfgld102.leac&quot;, str$(1234567))<br />
                stpapi.put.field(&quot;tfgld1103s000&quot;, &quot;tfgld102.dim2&quot;, str$(&quot;1234&quot;))<br />
                stpapi.put.field(&quot;tfgld1103s000&quot;, &quot;form.amnt&quot;, str$(90.00))<br />
                stpapi.put.field(&quot;tfgld1103s000&quot;, &quot;tfgld102.dbcr&quot;, str$(etol(tfgld.dbcr.credit)))<br />
                stpapi.put.field(&quot;tfgld1103s000&quot;, &quot;tfgld102.refr&quot;, str$(&quot;TESTER&quot;))<br />
                rc = stpapi.insert(&quot;tfgld1103s000&quot;, 1, e.msg)<br />
                if rc = 0 then<br />
                        rc = stpapi.recover(&quot;tfgld1103s000&quot;, w.err.msg)<br />
                endif<br />
        endif<br />
        stpapi.end.session(&quot;tfgld1103s000&quot;)<br />
        stpapi.end.session(&quot;tfgld1101m000&quot;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">30th November 2007, 16:01</div></div><div class="posttext">Have your tried another         if stpapi.change.view(&quot;tfgld1101m000&quot;, error.msg) &gt; 0 then before doing the second insert?  I do not think I have ever tried to create two transactions.  Another thing is to remove the save between the inserts - just to see what happens.  I do not have a save in my code.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mojo1980</div><div class="date">30th November 2007, 17:24</div></div><div class="posttext">Thanks Mark,<br />
<br />
my error was related to the type, I actually used the same type twice (not in the present code). Also I did remove the save.<br />
<br />
It works fine now.<br />
<br />
Thanks again.</div></div><hr />



</div>
</body>
</html>