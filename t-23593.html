<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="ASP.NET and OLE, Can't get a connection, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] ASP.NET and OLE, Can't get a connection AFS/DDC/OLE: Function servers" />
	
	<title>ASP.NET and OLE, Can't get a connection [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="index.html">Newbaanboard</a> &gt; <a href="index.html">Baan SIGs</a> &gt; <a href="index.html">AFS/DDC/OLE: Function servers</a> &gt; ASP.NET and OLE, Can't get a connection</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">wmickey</div><div class="date">2nd April 2005, 07:43</div></div><div class="posttext">This is my first attempt at doing OLE and ASP.NET.  We are runnning Baan IVc4 Service Pack 16 with BW Client BaanIVc4.66.<br />
<br />
I'm using Microsoft Visual Studio .NET 2003.   I'm coding in the codebehind with VB.NET.<br />
<br />
I can't seem to get a connection to the bshell.  I have tested the samples that is installed with the BW Client and they work fine.  I did setup an impersonate user line in my web.config.<br />
<br />
Here is my error:<br />
<br />
[Exception: Cannot create ActiveX component.]<br />
   Microsoft.VisualBasic.Interaction.CreateObject(String ProgId, String ServerName)<br />
   BaanWeb.BaanUsers.GetBaanUsers() in C:\WEBDEV\BaanCall\BaanWeb\BaanUsers.aspx.vb:60<br />
   BaanWeb.BaanUsers.btnGetUsers_Click(Object sender, EventArgs e) in C:\WEBDEV\BaanCall\BaanWeb\BaanUsers.aspx.vb:31<br />
   System.Web.UI.WebControls.Button.OnClick(EventArgs e)<br />
   System.Web.UI.WebControls.Button.System.Web.UI.IPostBackEventHandler.RaisePostBackEvent(String eventArgument)<br />
   System.Web.UI.Page.RaisePostBackEvent(IPostBackEventHandler sourceControl, String eventArgument)<br />
   System.Web.UI.Page.RaisePostBackEvent(NameValueCollection postData)<br />
   System.Web.UI.Page.ProcessRequestMain()<br />
<br />
<br />
This is the code that's failing:<br />
<br />
Sub GetBaanUsers()<br />
        Dim BaanObj As Object<br />
        Dim B_function As String<br />
        Dim B_function2 As String<br />
        Dim Query As String<br />
        Dim user As String<br />
        Dim temp_string As String<br />
        Dim query_id As Long<br />
        Dim RetVal As Long<br />
        'On Error GoTo CannotCreateBaan<br />
<br />
        'run Baan Application<br />
        BaanObj = CreateObject(&quot;Baan4.Application&quot;)<br />
        BaanObj.Timeout = 10<br />
<br />
End Sub<br />
<br />
Does anyone have any working examples that they could share with ASP.NET?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">6th April 2005, 16:04</div></div><div class="posttext">Have you seen this thread (http://www.baanboard.com/baanboard/showthread.php?t=23253&amp;highlight=impersonate)?  Not sure if it helps or not.  Maybe you can get a conversation going with sandycrum.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">wmickey</div><div class="date">6th April 2005, 16:13</div></div><div class="posttext">Thanks Mark,  I had checked out that post and tried to make the adjustments to my web.config,etc.  So far still no go.  I'm not sure if Baan Support would give me any help or not.  It sounds like OLE is not officially supported anymore from some of the reading I've done.<br />
<br />
Thanks for your help.<br />
Bill</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">6th April 2005, 16:51</div></div><div class="posttext">I would give them a call.  Some others have reported that it is supported, but I was told &quot;no longer supported&quot; start using Openworld.  One of the reasons I never fully explored OLE. I did use it, but only for my use, never for users and a production environment.</div></div><hr />



</div>
</body>
</html>