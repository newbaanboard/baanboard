<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="Help! AFS with session whltc1100m000, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] Help! AFS with session whltc1100m000 AFS/DDC/OLE: Function servers" />
	
	<title>Help! AFS with session whltc1100m000 [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="index.html">Newbaanboard</a> &gt; <a href="index.html">Baan SIGs</a> &gt; <a href="index.html">AFS/DDC/OLE: Function servers</a> &gt; Help! AFS with session whltc1100m000</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">kevinwangsct</div><div class="date">29th October 2008, 14:49</div></div><div class="posttext">I am trying to create some item lot with the AFS, session whltc1100m000. But I am always getting the message &quot;Enter a value for a item field&quot;. <br />
<br />
on.choice:<br />
{	<br />
<br />
										<br />
	string value(47)<br />
	long ret <br />
<br />
<br />
	stpapi.put.field(&quot;whltc1100m000&quot;,&quot;whltc100.item&quot;,&quot;         8002071C                              &quot;)<br />
<br />
	stpapi.find(&quot;whltc1100m000&quot;)<br />
	stpapi.get.field(&quot;whltc1100m000&quot;,&quot;whltc100.bfbp&quot;,value )<br />
	stpapi.get.field(&quot;whltc1100m000&quot;,&quot;whltc100.clot&quot;,value)<br />
<br />
	ret = stpapi.change.view(&quot;whltc1100m000&quot; ,value)	  <br />
	stpapi.synchronize.dialog(&quot;whltc1100m000&quot;,&quot;ADD&quot;,value)	  <br />
	<br />
	stpapi.put.field(&quot;whltc1100m000&quot;,&quot;whltc100.item&quot;,&quot;         8002071C                              &quot;)<br />
	stpapi.put.field(&quot;whltc1100m000&quot;,&quot;whltc100.clot&quot;,&quot;C22178421296-1&quot;)<br />
<br />
	stpapi.put.field(&quot;whltc1100m000&quot;,&quot;whltc100.bfbp&quot;,&quot;100001059&quot;)<br />
<br />
	stpapi.get.field(&quot;whltc1100m000&quot;,&quot;whltc100.item&quot;,value )<br />
	stpapi.get.field(&quot;whltc1100m000&quot;,&quot;whltc100.bfbp&quot;,value )<br />
	stpapi.get.field(&quot;whltc1100m000&quot;,&quot;whltc100.clot&quot;,value)<br />
<br />
	stpapi.insert(&quot;whltc1100m000&quot;,false, value)<br />
<br />
	stpapi.save(&quot;whltc1100m000&quot;,value)<br />
	stpapi.end.session(&quot;whltc1100m000&quot;,value)<br />
Also,please refer to the attached screen snaps for the debugger. <br />
<br />
Your help will be greatly appreciated.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kevinwangsct</div><div class="date">29th October 2008, 15:29</div></div><div class="posttext">i got the AFS log. Thanks.<br />
<br />
81serv&lt;-4gl (init.ready)<br />
whltc1100m000(81)-RUNNING:<br />
LOGGING STARTED<br />
2008-10-29<br />
&gt;whltc1100m000(81) put.field:whltc100.item          8002071C                              <br />
&gt;whltc1100m000(81) put.field:whltc100.item.segment.1          <br />
&gt;whltc1100m000(81) put.field:whltc100.item.segment.2 8002071C                              <br />
&gt;whltc1100m000 Find<br />
79dll-&gt;serv (def.find81)<br />
whltc1100m000(81)-RUNNING:def.find<br />
81serv&lt;-4gl (def.find01)<br />
whltc1100m000(81)-RUNNING:<br />
&lt;whltc1100m000 record found (1)<br />
&gt;whltc1100m000 get.field:whltc100.bfbp<br />
&lt;whltc1100m000(81) get.field:whltc100.bfbp=<br />
&gt;whltc1100m000 get.field:whltc100.clot<br />
&lt;whltc1100m000(81) get.field:whltc100.clot=C22178421296<br />
&gt;whltc1100m000 change.view<br />
79dll-&gt;serv (start.set81)<br />
whltc1100m000(81)-RUNNING:start.set<br />
81serv&lt;-4gl (start.set01)<br />
whltc1100m000(81)-RUNNING:<br />
&lt;whltc1100m000 1 view found<br />
79dll-&gt;serv (startwhltc1100m0001whltc1100m000114)<br />
83serv&lt;-4gl (init.ready)<br />
whltc1100m000(83)-RUNNING:<br />
79dll-&gt;serv (syncADD81)<br />
whltc1100m000(81)-RUNNING:syncADD<br />
81serv&lt;-4gl (syncADD0)<br />
whltc1100m000(81)-RUNNING:<br />
&gt;whltc1100m000(81) put.field:whltc100.item          8002071C                              <br />
&gt;whltc1100m000(81) put.field:whltc100.item.segment.1          <br />
&gt;whltc1100m000(81) put.field:whltc100.item.segment.2 8002071C                              <br />
&gt;whltc1100m000(81) put.field:whltc100.clot C22178421296-1<br />
&gt;whltc1100m000(81) put.field:whltc100.bfbp 100001059<br />
&gt;whltc1100m000 insert<br />
79dll-&gt;serv (add.set83)<br />
whltc1100m000(83)-RUNNING:add.set<br />
83serv&lt;-4gl (add.set10)<br />
whltc1100m000(83)-RUNNING:<br />
&lt;whltc1100m000 Enter a value for the item field.<br />
&gt;whltc1100m000 save<br />
79dll-&gt;serv (update.db83)<br />
whltc1100m000(83)-RUNNING:update.db<br />
83serv&lt;-4gl (update.db0)<br />
whltc1100m000(83)-RUNNING:<br />
&lt;whltc1100m000 <br />
&gt;whltc1100m000 end.session<br />
79dll-&gt;serv (end.program81)<br />
whltc1100m000(81)-RUNNING:end.program<br />
whltc1100m000(83)-RUNNING:end.program<br />
81serv&lt;-4gl (end.program0)<br />
whltc1100m000(81)-RUNNING:<br />
81dll-&gt;serv (whltc1100m000: exit(81))<br />
83dll-&gt;serv (whltc1100m000: exit(83))<br />
79dll-&gt;serv (afsscript: exit(79))</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kevinwangsct</div><div class="date">29th October 2008, 15:31</div></div><div class="posttext">debugger snaps</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">29th October 2008, 15:36</div></div><div class="posttext">Is this a segmented item?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kevinwangsct</div><div class="date">30th October 2008, 02:07</div></div><div class="posttext">Yes, it should be a segemented item. <br />
I have changed the code. But the same error occurs. <br />
<br />
hltc1100m000(81)-RUNNING:syncADD<br />
81serv&lt;-4gl (syncADD0)<br />
whltc1100m000(81)-RUNNING:<br />
&gt;whltc1100m000(81) put.field:whltc100.item          8002071C                              <br />
&gt;whltc1100m000(81) put.field:whltc100.item.segment.1          <br />
&gt;whltc1100m000(81) put.field:whltc100.item.segment.2 8002071C                              <br />
&gt;whltc1100m000(81) put.field:whltc100.clot C22178421296-1<br />
&gt;whltc1100m000(81) put.field:whltc100.bfbp 100001059<br />
&gt;whltc1100m000 insert<br />
79dll-&gt;serv (add.set83)<br />
whltc1100m000(83)-RUNNING:add.set<br />
83serv&lt;-4gl (add.set10)<br />
whltc1100m000(83)-RUNNING:<br />
&lt;whltc1100m000 Enter a value for the item field.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">30th October 2008, 14:06</div></div><div class="posttext">At this point I recommend looking at the session code to see what is happening after the fields are put - I take it when you do the stpapi.get the values are still set to what you put?  Do you have session code?<br />
<br />
Also according to one thread I read the stpapi.synchronize.dialog(&quot;whltc1100m000&quot;,&quot;add&quot;,value) - should have a lower case add.  I do not know if this is still true or not.<br />
<br />
Also they say do not use afs MMT sessions.  They also recommend using DAL2 functionality, but since I am on 4c4 I can not answer these questions.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">_Ralph_</div><div class="date">30th October 2008, 20:17</div></div><div class="posttext">Here is the code we use. It works well.<br />
<br />
The functions you can create using ttstpcreatdll session<br />
<br />
=)<br />
<br />
<br />
function long insert.lote.afs.o()<br />
{<br />
		long		ret_find<br />
		long		ret_insert	<br />
	domain 	whltc.olot 	olot.o<br />
	domain	tcmcs.str100	error.msg.o<br />
	<br />
	olot.o = whltc.olot.prod<br />
	<br />
	whltc1100m000f.put.Item(tiaun994.mitm.o)	<br />
	ret_find = whltc1100m000f.find(error.msg.o)<br />
	if ret_find = 1 then<br />
		whltc1100m000f.synchronize.dialog(&quot;add&quot;, error.msg.o)<br />
		whltc1100m000f.put.Item(tiaun994.mitm.o)	<br />
		whltc1100m000f.put.Lot(tiaun994.ltif.o)<br />
		whltc1100m000f.put.Tipo_de_lote(olot.o)<br />
		ret_insert = whltc1100m000f.insert(true, error.msg.o)<br />
		if ret_insert &lt;&gt; 1 then<br />
			whltc1100m000f.recover(error.msg.o)<br />
			whltc1100m000f.end(error.msg.o)<br />
			return(false)<br />
		endif<br />
	else<br />
		whltc1100m000f.set.view(error.msg.o)<br />
		whltc1100m000f.put.Item(tiaun994.mitm.o)	<br />
		whltc1100m000f.put.Lot(tiaun994.ltif.o)<br />
		whltc1100m000f.put.Tipo_de_lote(olot.o)<br />
		ret_insert = whltc1100m000f.insert(true, error.msg.o)<br />
		if ret_insert &lt;&gt; 1 then<br />
			whltc1100m000f.recover(error.msg.o)<br />
			whltc1100m000f.end(error.msg.o)<br />
			return(false)<br />
		endif<br />
	endif<br />
	<br />
	whltc1100m000f.end(error.msg.o)<br />
	return(true)<br />
}</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kevinwangsct</div><div class="date">4th November 2008, 15:35</div></div><div class="posttext">Thanks, all. <br />
<br />
Will try the code Ralph provied and come back to you.<br />
<br />
<br />
Here is the code we use. It works well.<br />
<br />
The functions you can create using ttstpcreatdll session<br />
<br />
=)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kathuria</div><div class="date">11th November 2008, 22:02</div></div><div class="posttext">Hi,<br />
I think you need very small change in your AFS. Replace your line<br />
<br />
stpapi.put.field(&quot;whltc1100m000&quot;,&quot;whltc100.item&quot;,&quot;         8002071    &quot;)<br />
<br />
<br />
with <br />
<br />
stpapi.put.field(&quot;whltc1100m000&quot;,&quot;whltc100.item.sgement.1&quot;,&quot;&quot;)<br />
stpapi.put.field(&quot;whltc1100m000&quot;,&quot;whltc100.item.sgement.2&quot;,&quot;800207&quot;)<br />
<br />
I am sure it will work.<br />
<br />
Regards,<br />
Sanjay Kathuria</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kevinwangsct</div><div class="date">12th November 2008, 07:17</div></div><div class="posttext">Thanks,Sanjay. Have tried that way, but it didn't help. I have realized the function by the DAL. <br />
<br />
Hi,<br />
I think you need very small change in your AFS. Replace your line<br />
<br />
stpapi.put.field(&quot;whltc1100m000&quot;,&quot;whltc100.item&quot;,&quot;         8002071    &quot;)<br />
<br />
<br />
with <br />
<br />
stpapi.put.field(&quot;whltc1100m000&quot;,&quot;whltc100.item.sgement.1&quot;,&quot;&quot;)<br />
stpapi.put.field(&quot;whltc1100m000&quot;,&quot;whltc100.item.sgement.2&quot;,&quot;800207&quot;)<br />
<br />
I am sure it will work.<br />
<br />
Regards,<br />
Sanjay Kathuria</div></div><hr />


<div class="post"><div class="posttop"><div class="username">cyrilchacko</div><div class="date">15th November 2008, 14:16</div></div><div class="posttext">The change may not be that small.<br />
<br />
I have used the AFS for Item Lot...<br />
<br />
One thing is the segmented item in LN...<br />
Another is that after putting the item (both segments), you need to change the view.<br />
<br />
then start the synchronised dialog for the session.<br />
<br />
and then follow the insertion procedure for the a new record...<br />
<br />
However, there may be a problem with inserting a new item with find as the item need not exist. Setting the view is a getter option.<br />
<br />
Hope this helps.<br />
<br />
Regards<br />
Cyril Chacko</div></div><hr />



</div>
</body>
</html>