<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="[AFS] report doesn't show up when putting values before printing, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] [AFS] report doesn't show up when putting values before printing AFS/DDC/OLE: Function servers" />
	
	<title>[AFS] report doesn't show up when putting values before printing [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="index.html">Newbaanboard</a> &gt; <a href="index.html">Baan SIGs</a> &gt; <a href="index.html">AFS/DDC/OLE: Function servers</a> &gt; [AFS] report doesn't show up when putting values before printing</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">tmannais</div><div class="date">20th March 2018, 11:51</div></div><div class="posttext">Hi,<br />
<br />
I am trying to print a report using AFS in LN 10.5.<br />
This is what works for me for when the user wants to print all the data, which is likely never going to happen.<br />
<br />
stpapi.set.report(&quot;tdsls4409m000&quot;, &quot;rtdsls440901300&quot;, &quot;PDF&quot;, error.msg)<br />
message(&quot;Set Report: &quot; &amp; error.msg)<br />
if isspace(error.msg) then<br />
	stpapi.form.command(&quot;tdsls4409m000&quot;, 5, &quot;print.data&quot;, error.msg)<br />
	message(&quot;Print Report: &quot; &amp; error.msg)<br />
endif<br />
stpapi.end.session(&quot;tdsls4409m000&quot;, error.msg)<br />
<br />
<br />
This is the code when I tried to put some values into the report before printing it. (The only field I put to is Sales Order for both from and to).<br />
<br />
stpapi.put.field(&quot;tdsls4409m000&quot;, &quot;ddta.f&quot;, &quot;&quot;)<br />
stpapi.put.field(&quot;tdsls4409m000&quot;, &quot;ddta.f.time&quot;, &quot;&quot;)<br />
stpapi.put.field(&quot;tdsls4409m000&quot;, &quot;ddta.t&quot;, &quot;03/20/2018&quot;)<br />
stpapi.put.field(&quot;tdsls4409m000&quot;, &quot;ddta.t.time&quot;, &quot;&quot;)<br />
stpapi.put.field(&quot;tdsls4409m000&quot;, &quot;cofc.f&quot;, &quot;&quot;)<br />
stpapi.put.field(&quot;tdsls4409m000&quot;, &quot;cofc.t&quot;, &quot;ZZZZZZ&quot;)<br />
stpapi.put.field(&quot;tdsls4409m000&quot;, &quot;ofbp.f&quot;, &quot;&quot;)<br />
stpapi.put.field(&quot;tdsls4409m000&quot;, &quot;ofbp.t&quot;, &quot;ZZZZZZZZZ&quot;)<br />
stpapi.put.field(&quot;tdsls4409m000&quot;, &quot;orno.f&quot;, &quot;CSO001911&quot;)<br />
stpapi.put.field(&quot;tdsls4409m000&quot;, &quot;orno.t&quot;, &quot;CSO001911&quot;)<br />
stpapi.put.field(&quot;tdsls4409m000&quot;, &quot;pono.f&quot;, &quot;&quot;)<br />
stpapi.put.field(&quot;tdsls4409m000&quot;, &quot;pono.t&quot;, &quot;9999&quot;)<br />
stpapi.put.field(&quot;tdsls4409m000&quot;, &quot;crep.f&quot;, &quot;&quot;)<br />
stpapi.put.field(&quot;tdsls4409m000&quot;, &quot;crep.t&quot;, &quot;ZZZZZZZZZ&quot;)<br />
stpapi.put.field(&quot;tdsls4409m000&quot;, &quot;ccur.f&quot;, &quot;&quot;)<br />
stpapi.put.field(&quot;tdsls4409m000&quot;, &quot;ccur.t&quot;, &quot;ZZZ&quot;)<br />
stpapi.put.field(&quot;tdsls4409m000&quot;, &quot;cofc.f&quot;, &quot;&quot;)<br />
stpapi.put.field(&quot;tdsls4409m000&quot;, &quot;cofc.t&quot;, &quot;ZZZZZZ&quot;)<br />
stpapi.put.field(&quot;tdsls4409m000&quot;, &quot;dltp.f&quot;, str$(etol(tdsls.dltp.not.applicable)))<br />
stpapi.put.field(&quot;tdsls4409m000&quot;, &quot;dltp.t&quot;, str$(etol(tdsls.dltp.production)))<br />
stpapi.put.field(&quot;tdsls4409m000&quot;, &quot;cprj.f&quot;, &quot;&quot;)<br />
stpapi.put.field(&quot;tdsls4409m000&quot;, &quot;cprj.t&quot;, &quot;ZZZZZZZZZ&quot;)<br />
stpapi.put.field(&quot;tdsls4409m000&quot;, &quot;cmnf.f&quot;, &quot;&quot;)<br />
stpapi.put.field(&quot;tdsls4409m000&quot;, &quot;cmnf.t&quot;, &quot;ZZZZZZ&quot;)<br />
stpapi.put.field(&quot;tdsls4409m000&quot;, &quot;cpln.f&quot;, &quot;&quot;)<br />
stpapi.put.field(&quot;tdsls4409m000&quot;, &quot;cpln.t&quot;, &quot;ZZZZZZ&quot;)<br />
stpapi.put.field(&quot;tdsls4409m000&quot;, &quot;cpcl.f&quot;, &quot;&quot;)<br />
stpapi.put.field(&quot;tdsls4409m000&quot;, &quot;cpcl.t&quot;, &quot;ZZZZZZ&quot;)<br />
stpapi.put.field(&quot;tdsls4409m000&quot;, &quot;creg.f&quot;, &quot;&quot;)<br />
stpapi.put.field(&quot;tdsls4409m000&quot;, &quot;creg.t&quot;, &quot;ZZZ&quot;)<br />
stpapi.put.field(&quot;tdsls4409m000&quot;, &quot;item.f.segment.1&quot;, &quot;&quot;)<br />
stpapi.put.field(&quot;tdsls4409m000&quot;, &quot;item.f.segment.2&quot;, &quot;&quot;)<br />
stpapi.put.field(&quot;tdsls4409m000&quot;, &quot;item.t.segment.1&quot;, &quot;ZZZZZZZZZ&quot;)<br />
stpapi.put.field(&quot;tdsls4409m000&quot;, &quot;item.t.segment.2&quot;, &quot;ZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZ&quot;)<br />
stpapi.set.report(&quot;tdsls4409m000&quot;, &quot;rtdsls440901300&quot;, &quot;PDF&quot;, error.msg)<br />
message(&quot;Set Report: &quot; &amp; error.msg)<br />
if isspace(error.msg) then<br />
	stpapi.form.command(&quot;tdsls4409m000&quot;, 5, &quot;print.data&quot;, error.msg)<br />
	message(&quot;Print Report: &quot; &amp; error.msg)<br />
endif<br />
stpapi.end.session(&quot;tdsls4409m000&quot;, error.msg)<br />
<br />
<br />
I tried setting only the Sales Order fields in from and to, and I also tried setting all of the fields like the code above. Both cases do not work.<br />
There is no error whatsoever in the whole process but the report just does not show up/ save to file. I tried device &quot;D&quot; and &quot;PDF&quot; both have the same effect.<br />
<br />
I just want to print using specific values in general because I will use in other reports too, not only Sales Order.<br />
<br />
Regards,<br />
Thana</div></div><hr />


<div class="post"><div class="posttop"><div class="username">tmannais</div><div class="date">21st March 2018, 06:23</div></div><div class="posttext">I figured it out. The problem is that the fields it takes for Sales Order are orno.f.segment.1 and orno.t.segment.1 instead of just orno.f and orno.t<br />
like so<br />
<br />
<br />
stpapi.put.field(&quot;tdsls4409m000&quot;, &quot;orno.f.segment.1&quot;, str$(i.tdcrm411.orno))<br />
stpapi.put.field(&quot;tdsls4409m000&quot;, &quot;orno.t.segment.1&quot;, str$(i.tdcrm411.orno))<br />
stpapi.set.report(&quot;tdsls4409m000&quot;, &quot;rtdsls440901300&quot;, &quot;PDF&quot;, error.msg)<br />
message(&quot;Set Report: &quot; &amp; error.msg)<br />
if isspace(error.msg) then<br />
	stpapi.form.command(&quot;tdsls4409m000&quot;, 5, &quot;print.data&quot;, error.msg)<br />
	message(&quot;Print Report: &quot; &amp; error.msg)<br />
endif<br />
stpapi.end.session(&quot;tdsls4409m000&quot;, error.msg)<br />
<br />
As a result, the report is printed correctly (PDF in this case).<br />
<br />
However, this is somehow not yet generalized because I tried using similar code to this (changing only session code and fields) with other session that has many reports for user to select in order to print, but it just does not work. It returns no error but the report is not printed.<br />
The problem, in my opinion, is on the report selection for the case when the print session has more than one report for the user to choose.<br />
Is there a way for AFS to select a report out of it since the window for report selection does not have session code? I really have no idea how to tackle that with AFS.<br />
See the attached image for the report selection window.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">21st March 2018, 14:15</div></div><div class="posttext">The problem is you can out pick one report.  So you use the stpapi.set.report pick one and run the session.  On some in 4c4 if it generates 2 reports it might not work or even lock up.  I think what I do for something like outbound I will generate the error report, then run the print outbound session to get a listing.  We do that in several cases.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">tmannais</div><div class="date">22nd March 2018, 03:33</div></div><div class="posttext">But I have already used stpapi.set.report as you can see in the code, and it is not working. I tried printing in the session myself manually and it prints only 1 report.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">22nd March 2018, 14:52</div></div><div class="posttext">Have you tried a continue instead of print.data? you may also want to try the screen instead of the pdf device.  The set command looks correct to me, which leads me to believe it could be something in one of the fields getting put to the screen.  I am not on ln so I can't help a whole lot.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">tmannais</div><div class="date">23rd March 2018, 05:39</div></div><div class="posttext">I have tried cont.process and exec.cont.process but no luck. I have also tried device D instead of PDF. Still, does not work. <br />
In this session, I only put 2 fields similar to the code in #2 but they are Warehousing Orders instead, and that the session has many reports.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">giggty</div><div class="date">23rd March 2018, 09:08</div></div><div class="posttext">tmannais, how come my whinh4460m000 has only one report (whinh446011000 Outbound Advice by Run)? Have you customized this session?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">tmannais</div><div class="date">23rd March 2018, 12:08</div></div><div class="posttext">giggty, the session has been customized but it's not my doing. It just has the reports added in it, it seems. That's why it has many reports to select, and I still don't know if it is causing the issue.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">giggty</div><div class="date">23rd March 2018, 13:37</div></div><div class="posttext">Ok, I've found another print session with two reports (whinh4478m000) and this code prints both reports:<br />
<br />
        stpapi.put.field(&quot;whinh4478m000&quot;, &quot;all.orders&quot;, str$(tcyesno.yes))<br />
        stpapi.set.report(&quot;whinh4478m000&quot;, &quot;rwhinh447811000&quot;, &quot;D&quot;, error.msg)<br />
        message(&quot;Set Report: &quot; &amp; error.msg)<br />
        if isspace(error.msg) then<br />
        	stpapi.form.command(&quot;whinh4478m000&quot;, 5, &quot;exec.cont.process&quot;, error.msg)<br />
        	message(&quot;Print Report1: &quot; &amp; error.msg)<br />
        endif<br />
        stpapi.set.report(&quot;whinh4478m000&quot;, &quot;rwhinh447812000&quot;, &quot;D&quot;, error.msg)<br />
        message(&quot;Set Report: &quot; &amp; error.msg)<br />
        if isspace(error.msg) then<br />
        	stpapi.form.command(&quot;whinh4478m000&quot;, 5, &quot;exec.cont.process&quot;, error.msg)<br />
        	message(&quot;Print Report2: &quot; &amp; error.msg)<br />
        endif<br />
        stpapi.end.session(&quot;whinh4478m000&quot;, error.msg)<br />
<br />
So your code seems to be perfectly valid. Try &quot;exec.print.data&quot; instead of &quot;print.data&quot;, may be?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">giggty</div><div class="date">23rd March 2018, 14:37</div></div><div class="posttext">I've generated the dll for whinh4460m000 in ttstpcreatdll. And for printing it uses stpapi.print.report(), and it works, I tested it :) stpapi.form.command() doesn't work probably because whinh4460m000 does not have a form command defined (whinh4478m000 has exec.cont.process which is why stpapi.form.command works for whinh4478m000), at least none of cont.process/print.data/exec/etc arguments I tried worked for me.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">tmannais</div><div class="date">30th March 2018, 07:00</div></div><div class="posttext">Thank you for your help, giggty. I will try it out and will respond back if it works for me.</div></div><hr />



</div>
</body>
</html>