<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="stpapi function, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] stpapi function AFS/DDC/OLE: Function servers" />
	
	<title>stpapi function [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="index.html">Newbaanboard</a> &gt; <a href="index.html">Baan SIGs</a> &gt; <a href="index.html">AFS/DDC/OLE: Function servers</a> &gt; stpapi function</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">mig28mx</div><div class="date">2nd October 2013, 01:10</div></div><div class="posttext">Hi,<br />
I want to use API functions to fill a customized table using the maintenance session for it.<br />
My code looks like the following:<br />
<br />
	error = false<br />
<br />
	stpapi.put.field(&quot;tfcmg9167m000&quot;, &quot;tfcmg967.date&quot;, &quot;27092013&quot;)		| Fecha<br />
	stpapi.put.field(&quot;tfcmg9167m000&quot;, &quot;tfcmg967.year&quot;, &quot;2013&quot;) 		| Año<br />
	stpapi.put.field(&quot;tfcmg9167m000&quot;, &quot;tfcmg967.fprd&quot;, &quot;9&quot;)		| P fiscal<br />
	stpapi.put.field(&quot;tfcmg9167m000&quot;, &quot;tfcmg967.rprd&quot;, &quot;9&quot;)		| P listado	<br />
	stpapi.put.field(&quot;tfcmg9167m000&quot;, &quot;tfcmg967.vyer&quot;, &quot;2013&quot;)		| Año iva<br />
	stpapi.put.field(&quot;tfcmg9167m000&quot;, &quot;tfcmg967.vprd&quot;, &quot;9&quot;)		| P iva<br />
	stpapi.put.field(&quot;tfcmg9167m000&quot;, &quot;tfcmg967.ttyp&quot;, &quot;180&quot;)		| Tipo transaccion<br />
	stpapi.put.field(&quot;tfcmg9167m000&quot;, &quot;tfcmg967.dsrn&quot;, &quot;10&quot;)		| Serie<br />
	stpapi.put.field(&quot;tfcmg9167m000&quot;, &quot;tfcmg967.docn&quot;, str$(next.sec))<br />
	stpapi.put.field(&quot;tfcmg9167m000&quot;, &quot;tfcmg967.info&quot;, &quot;2013_180_00000004&quot;)<br />
	stpapi.put.field(&quot;tfcmg9167m000&quot;, &quot;tfcmg967.emno&quot;, &quot;4645&quot;)		| Empleado<br />
	stpapi.put.field(&quot;tfcmg9167m000&quot;, &quot;tfcmg967.amnt&quot;, &quot;500&quot;)		| Importe<br />
	stpapi.put.field(&quot;tfcmg9167m000&quot;, &quot;tfcmg967.dscr&quot;, &quot;informe gtos 1&quot;)		| Descripcion informe<br />
	stpapi.put.field(&quot;tfcmg9167m000&quot;, &quot;tfcmg967.ccur&quot;, &quot;PES&quot;)		| divisa<br />
	stpapi.put.field(&quot;tfcmg9167m000&quot;, &quot;tfcmg967.tcur&quot;, &quot;PES&quot;)<br />
	stpapi.put.field(&quot;tfcmg9167m000&quot;, &quot;tfcmg967.ctra&quot;, &quot;ASM029&quot;)		| Codigo gasto<br />
	stpapi.put.field(&quot;tfcmg9167m000&quot;, &quot;tfcmg967.dig1&quot;, &quot;IC146&quot;)		| dim1<br />
	stpapi.put.field(&quot;tfcmg9167m000&quot;, &quot;tfcmg967.dig2&quot;, &quot;155021&quot;)		| dim2<br />
	stpapi.put.field(&quot;tfcmg9167m000&quot;, &quot;tfcmg967.dig3&quot;, &quot;39099&quot;)		| dim3<br />
	stpapi.put.field(&quot;tfcmg9167m000&quot;, &quot;tfcmg967.dig4&quot;, &quot;&quot;)<br />
	stpapi.put.field(&quot;tfcmg9167m000&quot;, &quot;tfcmg967.dig5&quot;, &quot;&quot;)<br />
	stpapi.put.field(&quot;tfcmg9167m000&quot;, &quot;tfcmg967.leac&quot;, &quot;110110110101&quot;)		| cuenta abono<br />
	stpapi.put.field(&quot;tfcmg9167m000&quot;, &quot;tfcmg967.dim1&quot;, &quot;&quot;)<br />
	stpapi.put.field(&quot;tfcmg9167m000&quot;, &quot;tfcmg967.dim2&quot;, &quot;&quot;)<br />
	stpapi.put.field(&quot;tfcmg9167m000&quot;, &quot;tfcmg967.dim3&quot;, &quot;&quot;)<br />
	stpapi.put.field(&quot;tfcmg9167m000&quot;, &quot;tfcmg967.dim4&quot;, &quot;&quot;)<br />
	stpapi.put.field(&quot;tfcmg9167m000&quot;, &quot;tfcmg967.dim5&quot;, &quot;&quot;)<br />
	stpapi.put.field(&quot;tfcmg9167m000&quot;, &quot;tfcmg967.user&quot;, logname$)<br />
	stpapi.put.field(&quot;tfcmg9167m000&quot;, &quot;tfcmg967.btno&quot;, &quot;0&quot;)<br />
	stpapi.put.field(&quot;tfcmg9167m000&quot;, &quot;tfcmg967.datc&quot;, &quot;&quot;)<br />
	stpapi.put.field(&quot;tfcmg9167m000&quot;, &quot;tfcmg967.anti&quot;, &quot;0&quot;)<br />
	stpapi.put.field(&quot;tfcmg9167m000&quot;, &quot;tfcmg967.rate&quot;, &quot;1&quot;)	<br />
	stpapi.put.field(&quot;tfcmg9167m000&quot;, &quot;tfcmg967.pedi&quot;, &quot;&quot;)<br />
	stpapi.put.field(&quot;tfcmg9167m000&quot;, &quot;tfcmg967.anti&quot;, &quot;0.0&quot;)<br />
<br />
	ret = stpapi.insert(&quot;tfcmg9167m000&quot;, true, mensaje)<br />
	if ret = 1 then<br />
		stpapi.get.field(&quot;tfcmg9167m000&quot;, &quot;tfcmg967.info&quot;, info.nuevo)<br />
		mensaje = sprintf$(&quot;Se creó el informe de gastos %s&quot;, info.nuevo)<br />
		rprt_send()<br />
		tipo = 1<br />
		proce = 3<br />
		stpapi.end.session(&quot;tfcmg9167m000&quot;)<br />
		mensaje = &quot;&quot;<br />
<br />
	else<br />
		tipo = 2<br />
		proce = 3<br />
		ret = stpapi.recover(&quot;tfcmg9167m000&quot;, mensaje)<br />
		stpapi.end.session(&quot;tfcmg9167m000&quot;)<br />
		reg.erroneos = reg.erroneos + 1<br />
		error = true<br />
	endif<br />
}<br />
<br />
<br />
I´m filling all the fields of the table due to I can´t solve the error message: Value can´t be zero obtained on the sentence stpapi.insert<br />
<br />
Any ideas about how to solve?<br />
<br />
Thank you in advance.<br />
Miguel.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mig28mx</div><div class="date">2nd October 2013, 02:27</div></div><div class="posttext">Hi,<br />
After posting, I realized that I was missing the date translation.<br />
<br />
Miguel.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">2nd October 2013, 04:28</div></div><div class="posttext">Thanks for the follow up.  This is the correct forum for AFS type posts.</div></div><hr />



</div>
</body>
</html>