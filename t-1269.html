<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="Another problem with print with visual basic, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] Another problem with print with visual basic AFS/DDC/OLE: Function servers" />
	
	<title>Another problem with print with visual basic [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="index.html">Newbaanboard</a> &gt; <a href="index.html">Baan SIGs</a> &gt; <a href="index.html">AFS/DDC/OLE: Function servers</a> &gt; Another problem with print with visual basic</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">tbrault</div><div class="date">6th March 2002, 15:55</div></div><div class="posttext">Hi<br />
Firstly : thanks mark for the last post, that's help me much.  :D<br />
I have another pb (that is probably the last (I hope))?<br />
I want to run the session &quot;tisfc0204m000&quot; (Release Production Order). But, the program in vb that I've created don't walk. (the order stay with the statut : printed order)<br />
Help please<br />
It's my program :<br />
&quot;&quot;<br />
Public Function Lancement_OF()<br />
        '--&gt; Nouveau parametre, d√©claration---------------------------------------<br />
            '----&gt; Declaration Session<br />
        Dim SessionLancement As String<br />
        Dim RapportImpression As String<br />
        Dim ErrMessage1 As String<br />
            '---&gt; Declaration Champs<br />
        Dim OfKey1 As String<br />
        Dim OfKey2 As String<br />
        Dim DateDebutKey As String<br />
        Dim DateFinKey As String<br />
        Dim CodeImprimante As String<br />
            '----&gt; Declaration variable<br />
        Dim OfKeyValue1 As String<br />
        Dim OfKeyValue2 As String<br />
        Dim DateDebutKeyValue As String<br />
        Dim DateFinKeyValue As String<br />
        '-------------------------------------------------------------------------<br />
        '--&gt; Definition parametre-------------------------------------------------<br />
            '----&gt; Definition Session<br />
        SessionLancement = &quot;tisfc0204m000&quot;<br />
        RapportImpression = &quot;rtisfc020401000&quot;<br />
        ErrMessage1 = Space(30)<br />
            '----&gt; Definition champs<br />
        OfKey1 = &quot;pdno.f&quot;<br />
        OfKey2 = &quot;pdno.t&quot;<br />
        DateDebutKey = &quot;prdt.f&quot;<br />
        DateFinKey = &quot;prdt.t&quot;<br />
        CodeImprimante = &quot;CANON5000&quot;<br />
            '----&gt; Definition variable<br />
        OfKeyValue1 = &quot;140399&quot;<br />
        OfKeyValue2 = &quot;140399&quot;<br />
        DateDebutKeyValue = Format(&quot;26/03/01&quot;, &quot;mmddyyyy&quot;)<br />
        DateFinKeyValue = Format(&quot;26/03/03&quot;, &quot;mmddyyyy&quot;)<br />
        '--------------------------------------------------------------------------<br />
    Set BaanObj = CreateObject(&quot;Baan4.Application&quot;)<br />
<br />
BaanObj.ParseExecFunction &quot;ottstpapihand&quot;, &quot;stpapi.put.field(&quot; &amp; Chr(34) &amp; SessionLancement &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; OfKey1 &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; OfKeyValue1 &amp; Chr(34) &amp; &quot;)&quot;<br />
BaanObj.ParseExecFunction &quot;ottstpapihand&quot;, &quot;stpapi.put.field(&quot; &amp; Chr(34) &amp; SessionLancement &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; OfKey2 &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; OfKeyValue2 &amp; Chr(34) &amp; &quot;)&quot;<br />
BaanObj.ParseExecFunction &quot;ottstpapihand&quot;, &quot;stpapi.put.field(&quot; &amp; Chr(34) &amp; SessionLancement &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; DateDebutKey &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; DateDebutKeyValue &amp; Chr(34) &amp; &quot;)&quot;<br />
BaanObj.ParseExecFunction &quot;ottstpapihand&quot;, &quot;stpapi.put.field(&quot; &amp; Chr(34) &amp; SessionLancement &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; DateFinKey &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; DateFinKeyValue &amp; Chr(34) &amp; &quot;)&quot;<br />
BaanObj.ParseExecFunction &quot;ottstpapihand&quot;, &quot;stpapi.set.report(&quot; &amp; Chr(34) &amp; SessionLancement &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; RapportImpression &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; CodeImprimante &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; ErrMessage1 &amp; Chr(34) &amp; &quot;)&quot;<br />
BaanObj.ParseExecFunction &quot;ottstpapihand&quot;, &quot;stpapi.continue.process(&quot; &amp; Chr(34) &amp; SessionLancement &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; ErrMessage1 &amp; Chr(34) &amp; &quot;)&quot;<br />
End Function</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">6th March 2002, 16:52</div></div><div class="posttext">The coding looks fine, so my first guess would be the dates.  I have not really tried using date fields.  I have not done this but you could try doing a get.field to see what the date looks like. The one time I used a date I did this to it:<br />
    date_t = Format(date_t, &quot;yyyy,m,d&quot;)<br />
    date_f = Format(date_f, &quot;yyyy,m,d&quot;)<br />
Then I executed this (only part of the query)<br />
Query = &quot;select tisfc902.*, tisfc001.mitm&quot; &amp; _<br />
        &quot; from tisfc902,tisfc001&quot; &amp; _<br />
        &quot; where tisfc902.date inrange date.to.num(&quot; &amp; date_f &amp; &quot;) and&quot; &amp; _<br />
<br />
So I just do not feel comfortable with you passing what are date variables as strings.  BUT you could be right.  Just a guess.<br />
<br />
Mark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">tbrault</div><div class="date">6th March 2002, 17:24</div></div><div class="posttext">OK, thanks. I modify my program by deleting the started date and the program run now.<br />
For information, with stpapi, date format is mmddyyyy.<br />
Thanks for all! :cool:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">6th March 2002, 20:24</div></div><div class="posttext">Merged the threads wrong and could not get it fixed.  Big Sigh...<br />
<br />
Mark</div></div><hr />



</div>
</body>
</html>