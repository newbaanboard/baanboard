<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="How to: Logos / Preprinted Forms printing, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] How to: Logos / Preprinted Forms printing Code &amp; Utilities" />
	
	<title>How to: Logos / Preprinted Forms printing [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="index.html">Newbaanboard</a> &gt; <a href="index.html">Baan SIGs</a> &gt; <a href="index.html">Code &amp; Utilities</a> &gt; How to: Logos / Preprinted Forms printing</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">~Vamsi</div><div class="date">10th October 2002, 23:36</div></div><div class="posttext">Logos / Preprinted Forms in Baan<br />
<br />
Complexity = High<br />
This Project is Abandonware. Use at your own risk!<br />
While a few people have been able to make it work and use it, many have questions that do not receive answers. So do not proceed any further unless you are brave.<br />
<br />
Note that this will work only in the following environment:<br />
 Baan installed on Unix<br />
 HP or compatible printers (most laser printers are!)<br />
<br />
<br />
Old Chinese proverb:<br />
&quot;Give a man a fish, and you feed him for a day.<br />
Teach a man to fish, and you feed him for life.&quot;<br />
<br />
So here are the various resources that help you catch your own fish :)<br />
 Peter Hamilton (http://www.hamil.org/pcl/)'s HP PCL Laser Overlay creation utility<br />
 This (http://www.hamil.org/pcl/ovl.zip) is the software that I used from the above site<br />
 Improved (http://www.shady.com/downloads/pcloverlay/) version of Peter Hamilton's software. No binaries - you will need a compiler<br />
 In trying to write this document, I hit upon a goldmine. Click here (http://www.hpdevelopersolutions.com), to join hpdevelopersolutions program as an affiliate member (for free ;-) Then go to developer kits, laserjets, printer languages, PCL 5 to download technical manuals<br />
<br />
Steps to follow:<br />
 Download Peter Hamilton's program<br />
 Unzip contents into a single folder<br />
 Install a printer with following settings<br />
 Local Printer<br />
 Port = File<br />
 Manufacturer = HP<br />
 Printer = HP Laserjet III<br />
 Name = Overlay Printer<br />
 Set as Default = No<br />
 Create the letterhead / form in your favourite Windows program<br />
 Print to &quot;Overlay Printer&quot;.<br />
 Save the output to &quot;logo.prn&quot; in the same directory that you unzipped the contents of Peter Hamilton's software<br />
 Open a MSDOS shell. Navigate to the directory where the program and logo.prn are located<br />
 execute the command &quot;ovl logo.prn logo.ovl&quot;<br />
 Open LOGO.OVL in a hex editor and traverse to the end of the file. Find the string &quot;&amp;f1s1x10x4X&quot;. In that string replace the last small 'x' with a capital 'X'. And the '4X' with NULs (ascii zero). So the final string should look like &quot;&amp;f1s1x10X&lt;00&gt;&lt;00&gt;&quot;<br />
 put LOGO.OVL on your Baan server, say in ${BSE}/lib/barcode/font folder<br />
 Modify the printer driver associated with your printers to include the following line<br />
pfont14=\E&amp;f0s1y2x1S,<br />
 The 1 in the 1y is the macro number, which is an option that one can specify when using ovl. The default is 1. If you choose to use a different number, make sure they are in sync<br />
 Do not forget the comma at the end of the line. This is very important<br />
 In the report that you need the logo in put the below code in the report.script<br />
before.program:<br />
	long	ret<br />
	ret = run.prog(&quot;/usr/bin/lp&quot;, &quot;-d&quot; &amp; tolower$(spool.device) &amp; <br />
		&quot; -oraw -s ${BSE}/lib/barcode/font/LOGO.OVL&quot;, RP_WAIT)<br />
 Create a field on the report with print expression of &quot; &quot;, domain tcmcs.str1 and user font 14<br />
<br />
<br />
If you are still with us at this point, a report you print to the printer should have a logo on it.<br />
<br />
Known issues:<br />
At this point this does not correctly get the linespacing. I am assuming that there are linespacing commands in the generated OVL file or that it resetting the existing values to some arbitrary value. Please update this thread on how to fix that.<br />
<br />
If you find this too complex, then go for a forms package. There are plenty of them out there. I use Streamserve (http://www.streamserve.com). Other options like Jetform exist. The above process can be made easy by buying tools to create and generate the PCL overlay. Please use your good friend Google (http://www.google.com) for that.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">lvdvelde</div><div class="date">5th August 2003, 14:58</div></div><div class="posttext">Hey Vamsi,<br />
<br />
I have this all working perfectly - different overlays for the first page and every next page, including logo's, header and footer.<br />
Except for the linespacing - the Baan report has only 42 lines.<br />
<br />
Did you learn anything yet on how to fix that?<br />
<br />
Greetings, Lex</div></div><hr />


<div class="post"><div class="posttop"><div class="username">lvdvelde</div><div class="date">5th August 2003, 16:08</div></div><div class="posttext">Hi again,<br />
<br />
just found out how to get the right linespacing.<br />
<br />
In the beginning of the generated OVL file, you will find the following escape sequence:<br />
<br />
\E&amp;l 4d 1e (HEX 1B 26 6C 34 64 31 45)<br />
<br />
This says: 4 lines per inch, top margin of 1 line.<br />
<br />
When you change that to - say - 7 lines per inch, it looks a lot more like a Baan report. <br />
<br />
\E&amp;l 4d 1e (HEX 1B 26 6C 37 64 31 45)<br />
<br />
Have fun!<br />
<br />
Lex</div></div><hr />


<div class="post"><div class="posttop"><div class="username">~Vamsi</div><div class="date">5th August 2003, 17:18</div></div><div class="posttext">Lex,<br />
<br />
I am glad someone is using the solution. This is one thread that I contributed to Code &amp; Utilities that never got any response :).<br />
<br />
Could you post a sample pdf document for people to see what is possible without investing big dollars.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">lvdvelde</div><div class="date">6th August 2003, 21:28</div></div><div class="posttext">dumdumdum...<br />
<br />
the escape sequence for the correct linespacing should look like:<br />
<br />
\E&amp;l 7d 1E (HEX 1B 26 6C 37 64 31 45)<br />
<br />
you can view the attached PDF for the result.<br />
Header and footer including text and logos are the overlay macro, the printed data (customer address, items amounts etc.) is the Baan report data.<br />
<br />
-- off the record - I had to construct the PDF in MS Word, because the overlay is printed as a file directly to any HP printer..... not to something like a PDF printer. But I swear our Baan output looks  exactly the same! :-)<br />
<br />
Lex</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rupertb</div><div class="date">7th August 2003, 11:43</div></div><div class="posttext">Vamsi sometimes you've just got to modify those proverbs...<br />
<br />
Old Chinese proverb:<br />
&quot;Give a man a fish, and you feed him for a day.<br />
Teach a man to fish, and you feed him for life.&quot;<br />
 <br />
<br />
<br />
New Chinese proverb:<br />
&quot;Give a man a fish, and you feed him for a day.<br />
Teach a man to fish, and you feed him for life - <br />
Give him a rotten fish and he'll probably never bother <br />
you again!&quot;<br />
<br />
<br />
Great solution - now I've got to find an application for those overlays...<br />
<br />
Regards,<br />
Rupert</div></div><hr />


<div class="post"><div class="posttop"><div class="username">baanbab</div><div class="date">20th August 2003, 17:56</div></div><div class="posttext">Hi <br />
<br />
I tried the print a report based on vamsi's posting. It worked but I still had the line spacing problem after changing the escape sequence in OVL file. <br />
<br />
Can you please post the OVL file which has printed with proper lince spacing. <br />
<br />
Thanks,<br />
Babu</div></div><hr />


<div class="post"><div class="posttop"><div class="username">~Vamsi</div><div class="date">25th August 2003, 18:00</div></div><div class="posttext">Babu,<br />
<br />
Please post your OVL file.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sant123</div><div class="date">28th October 2003, 06:18</div></div><div class="posttext">Vamsi,<br />
<br />
I went through the same steps described in your posting, still having no luck getting it to work. one thing I noticed was I got the the error when I tried to run the statement lp -dprintque -oraw -s ${BSE}/lib/barcode/font/logo.ovl from unix shell, I got the error, I wish I could connect to office and give you the right error message, I would try that tomorrow.<br />
<br />
we have IBM unix AIX4.3.3. Baan4c4.<br />
<br />
all I need is to print logo on the sales invoice, your complex idea looks really good ( since i don't have to mess around with the client PCS).<br />
<br />
One other thing, there was no folder by name fonts underneath barcode folder, all the printer drive files are under $BSE/lib/printinf/h(for hp)/ folder.<br />
<br />
Help.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">~Vamsi</div><div class="date">28th October 2003, 20:16</div></div><div class="posttext">lp -dprintque -oraw -s ${BSE}/lib/barcode/font/logo.ovl <br />
<br />
That command sends the overlay to the printer. If are going to run it at the command prompt you will have to expand the environment variable ${BSE}. Make sure that the lp command for you os is what you have quoted.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sant123</div><div class="date">3rd November 2003, 23:46</div></div><div class="posttext">Vamsi,<br />
<br />
This is what I am trying to do. I would like to print invoice with the company logo on it and email it to the customers. <br />
<br />
we have the Novell Groupwise email system, I have problem using mailx or sendmail command from AIX4.3.3 ( this is where Baan 4c4 is installed), so I gaveup on the email part. now I want atleast have the logo printed on the invoice and send the report to the Microsoft word ( Baan standard soln) and save the report on the client pc and manually e-mail it to the customer as the attachement.<br />
<br />
I tried all the three types:<br />
<br />
1. html format, it changes the page length, but I could use it.<br />
2. Client side solution, ( create font and open it in BWprint ) the problem how would I email it ?? so this is not the solution.<br />
3. your solution seems the good one, where I don't need to do anything on the client side, but if I send it to the word document does it still add the logo to the report.<br />
<br />
Thanks for any help.<br />
<br />
also the error I get when I do lp -d the error is as follows.<br />
<br />
0782-040 Cannot open print file.<br />
           The file name is raw<br />
           The errno (error number) from the open system call is 2<br />
         Check the file name specified with your print request.<br />
&lt;EOT&gt;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">~Vamsi</div><div class="date">4th November 2003, 00:27</div></div><div class="posttext">You left me boggled. I am not sure I understand if you want to print the invoice or email it.<br />
<br />
This solution works as follows:<br />
- An overlay of the logo is created<br />
- This is then transferred to the printer<br />
- A standard Baan report is printed to this printer with code to activate the overlay. In effect printing the logo on the invoice.<br />
<br />
You can then *mail* this invoice to the customer, but not *email* it.<br />
<br />
What part of the above is causing a problem? If you want to talk about this solution send me an email and I will send you my phone number.<br />
<br />
If you are creative you can use the Vanilla PDF solution I posted in this forum to generate PDF, overlay a logo on each page and email the resulting file. Sounds complex - perhaps it is. <br />
<br />
For an out of box solution to add a logo to an invoice and then email it in a single step, look to www.nazdaq.co.il.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sant123</div><div class="date">4th November 2003, 05:20</div></div><div class="posttext">I tried to give as much details possible and made it quite complicated.<br />
<br />
I understand your solution creates the print file with the overlay logo, but could not be used as the attachement that could be sent as an email.<br />
<br />
I would try to look into the PDF creation tool. <br />
<br />
I would still email you to get the overlay print problem solved. I didn't get the logo printed, I used the User Font 13 in my case since 14 is already used for some other report. couldn't get it to work.<br />
<br />
Thanks.<br />
Sant.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">shah_bs</div><div class="date">18th March 2004, 19:50</div></div><div class="posttext">Hello people.<br />
<br />
This is under BAAN IVc3 and HPUX: I found that, the command as suggested for the report script does not expand the ${BSE}. So, here is what I did:<br />
<br />
<br />
before.program:<br />
        domain  tcmcs.long      p.ret.c<br />
        domain  tcstr.128.c     p.command.c<br />
<br />
        p.command.c = &quot;-d&quot;<br />
                      &amp; tolower$(spool.device)<br />
                      &amp; &quot; -oraw -s &quot;<br />
                      &amp; bse.dir$()<br />
                      &amp; &quot;/lib/barcode/font/LOGO.OVL&quot;<br />
<br />
        p.ret.c = run.prog(<br />
                        &quot;/usr/bin/lp&quot;,<br />
                        p.command.c,<br />
                        RP_WAIT)<br />
<br />
<br />
<br />
<br />
And that worked.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">~Vamsi</div><div class="date">18th March 2004, 22:14</div></div><div class="posttext">Shah could you please improve the documentation based on your experience. Either use this thread or start your own in Wiki.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">shah_bs</div><div class="date">19th March 2004, 01:24</div></div><div class="posttext">Vamsi,<br />
<br />
You are assuming I am the expert. All I did was follow the steps you outlined, with some tweaking to make things work.<br />
<br />
I will try collect the whole process again into a single 'document', but you will have to be patient.<br />
<br />
Regards</div></div><hr />


<div class="post"><div class="posttop"><div class="username">shah_bs</div><div class="date">22nd March 2004, 18:51</div></div><div class="posttext">The user (bless his soul) is not satisfied with the black-and-white logo.<br />
<br />
So, what could be the incantations that need to be invoked to make it print on the color printer.<br />
<br />
So far, simply directing the output to the HP Color Laserjet 4500 has not worked - the logo does not print at all, not even as black-and-white.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">~Vamsi</div><div class="date">22nd March 2004, 21:22</div></div><div class="posttext">Send Lex a PM. His sample has color in it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">shah_bs</div><div class="date">28th April 2004, 17:31</div></div><div class="posttext">I started to put together a new version of the documentation, but after reviewing what I did and comparing with Vamsi's first post, I find that his version still works. The only differences are as follows:<br />
<br />
a. I did NOT do the following step, as I found that the logo prints without doing this. [But does not seem to be a problem to do it anyways]:<br />
<br />
<br />
    Open LOGO.OVL in a hex editor and traverse to the end of the file. Find the string &quot;&amp;f1s1x10x4X&quot;. In that string replace the last small 'x' with a capital 'X'. And the '4X' with NULs (ascii zero). So the final string should look like &quot;&amp;f1s1x10X&lt;00&gt;&lt;00&gt;&quot;<br />
<br />
<br />
b. Used bse.dir$() function instead of {$BSE} in the script.<br />
<br />
<br />
So, I think I will avoid confounding the issue by 're-documenting'.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">maximus</div><div class="date">23rd July 2004, 18:39</div></div><div class="posttext">Hi,<br />
<br />
I did all the steps as listed in the post, and also tried to print the ovl from the command line, but with no luck,<br />
<br />
I am attaching the ovl and the printer driver file. Need some advice guys.<br />
<br />
Thanks &amp; Regards<br />
Max</div></div><hr />


<div class="post"><div class="posttop"><div class="username">~Vamsi</div><div class="date">9th September 2004, 20:13</div></div><div class="posttext">Max,<br />
<br />
Are you still interested in solving this problem? I issued a print command as follows from my command line:<br />
copy logo.ovl \\myprintserver\myprinter /b<br />
<br />
and I got a one page printout with the number 4 at the top left corner of the page. Is that what the contents of the page are? Can you make the same appear when you print from within Baan?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">maximus</div><div class="date">9th September 2004, 20:16</div></div><div class="posttext">Hey,<br />
<br />
Thank you for the input, let me try it out and get back to with the results.<br />
<br />
Regards<br />
Max</div></div><hr />


<div class="post"><div class="posttop"><div class="username">crdeshpande</div><div class="date">14th February 2005, 05:41</div></div><div class="posttext">Hi vasmi<br />
<br />
How to combine your Both solutions i.e Overlay printing and Vanilla PDF?<br />
<br />
how to use HP drivers to divert printer O/P to xyz file?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">phr024</div><div class="date">23rd February 2005, 11:16</div></div><div class="posttext">Very nice solution,<br />
<br />
but on every second (and following) page, all text output by Baan is printed itallic... !?<br />
<br />
So, it looks like the first logo pages somehow leaves the printer in an &quot;italic mode&quot;.<br />
<br />
Does anyone have an idea on how to reset this?<br />
<br />
Kind regards,<br />
<br />
Patrick Harder.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">alibaba</div><div class="date">24th March 2005, 12:59</div></div><div class="posttext">sorry I dont understand behind step-add command line to local .inf/reg or add command lime to device queue in baan?<br />
My server is UNIX but I want print to local windows printer...<br />
<br />
<br />
<br />
 Modify the printer driver associated with your printers to include the following line<br />
pfont14=\E&amp;f0s1y2x1S,</div></div><hr />


<div class="post"><div class="posttop"><div class="username">~Vamsi</div><div class="date">24th March 2005, 17:33</div></div><div class="posttext">Device          : MYPRINT<br />
Device Type     : Direct<br />
Driver          : hp_lj4<br />
Description     : HP4<br />
System Queue    : /usr/bin/lp -dmyprint -s -c -n%d %s -oBSDh<br />
Paper Type      : LETTER  Letter Format<br />
Page Length     :    0<br />
Left Margin     :   0<br />
Path            :<br />
Change allowed  :<br />
4GL Program     :<br />
Argument        :<br />
Form Feed       :<br />
Locale          : ISO-8859-1<br />
<br />
You should have a printer defined as above in Baan. This is a direct printer and can be only be created with Baan running on Unix. Now the hp_lj4 is a driver that resides on the Baan server. You will have to make a change to it or a copy of it - that is what is described.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">alibaba</div><div class="date">25th March 2005, 06:15</div></div><div class="posttext">thank you very much Vamsi , I understand now.<br />
But I want print report to windows printer via local BWPrint,this solution can do it ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">~Vamsi</div><div class="date">25th March 2005, 17:10</div></div><div class="posttext">No. If you need logos using BWPrint, look at this solution:<br />
http://www.baanboard.com/baanboard/showthread.php?t=1194</div></div><hr />


<div class="post"><div class="posttop"><div class="username">alibaba</div><div class="date">26th March 2005, 05:15</div></div><div class="posttext">I was Printed it successful!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">muzzle</div><div class="date">22nd April 2005, 16:31</div></div><div class="posttext">Hi,<br />
I would like to print packing slips with the company logo on it but with no luck.<br />
We have AIX4.3 BaanIVc4<br />
I tried to run the statement &quot;lp -dprintque -oraw -s ${BSE}/local/ABBSA.OVL&quot; from unix shell and I got this error message :<br />
<br />
 &lt;root@obelix:/&gt; lp -dx61 -oraw -s /baanIV/bse/local/ABBSA.OVL<br />
&lt;root@obelix:/&gt; <br />
Message from root on obelix (UNKNOWN) [Fri Apr 22 13:22:04 BST 2005] ...<br />
Message from queueing system:<br />
=====&gt; MESSAGE FROM PRINT JOB 363765 (/baanIV/bse/local/ABBSA.OVL) &lt;=====<br />
0782-040 Cannot open print file.<br />
           The file name is raw<br />
           The errno (error number) from the open system call is 2<br />
         Check the file name specified with your print request.<br />
&lt;EOT&gt;<br />
<br />
What's and how to solve this problem?<br />
<br />
Thanks in anticipation<br />
Muzzle</div></div><hr />


<div class="post"><div class="posttop"><div class="username">günther</div><div class="date">25th April 2005, 16:18</div></div><div class="posttext">AIX is sligthly different to UNIX ;-). I haven't been using it for over 8 years now. So I checked the internet and I found at http://dbforums.com/showthread.php?p=3710798#post3710798:<br />
<br />
&gt; lp -o lan -c -dcrud -s /etc/motd<br />
&gt; Same problem -o commands not defined for AIX virtual printer.<br />
&gt; Use sysV if you want to use. <br />
&gt; Can change /usr/bin/lp to a shell script and have it call enq. <br />
<br />
Günther</div></div><hr />


<div class="post"><div class="posttop"><div class="username">teddybear</div><div class="date">4th November 2005, 09:40</div></div><div class="posttext">Although spend some time, I manage to print the logo. Thanks to those who contribute to this thread, especially Vamsi.<br />
<br />
Just like phr024, I have this &quot;side effect&quot; after printing the logo. I notice all the text after the printing of the logo are printed in italic.<br />
<br />
Suggestion to this problem are approciate.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">8th November 2005, 19:11</div></div><div class="posttext">Just saw this - I did not have this problem.  I do know I made changes to the ovl file so it ended like with an escape sequence.  See attached.  Not sure if this is your problem, but probably just need to reset the printer.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">gprince</div><div class="date">18th November 2005, 23:37</div></div><div class="posttext">Hello everyone,<br />
I hope you can help me out.  I am having a problem with my AP checks being double and trippled spaced when merged with the overlay.  <br />
<br />
Thanks for your help!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">21st November 2005, 14:06</div></div><div class="posttext">You probably just need to play with some of the pre/post escape sequences for your printers.  I did not have the problem you described, but I did make some changes to get it to come out okay.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">gprince</div><div class="date">21st November 2005, 15:17</div></div><div class="posttext">Hello Mark,<br />
<br />
Thanks for information.  Right after I posted the question, we were able to adjust some pre escape sequences and got it to work.  <br />
<br />
Thanks again for you suggestion!<br />
Garry</div></div><hr />


<div class="post"><div class="posttop"><div class="username">awassif</div><div class="date">24th February 2006, 20:25</div></div><div class="posttext">Although spend some time, I manage to print the logo. Thanks to those who contribute to this thread, especially Vamsi.<br />
<br />
Just like phr024, I have this &quot;side effect&quot; after printing the logo. I notice all the text after the printing of the logo are printed in italic.<br />
<br />
Suggestion to this problem are approciate.<br />
Many thanks for all of you who contributed to this issue.<br />
All worked OK with the exception of the font of Baan reports. All came out as Italic. Teddybear reported the same problem on Nov 05. Anyone was able to solve the issue.<br />
Thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">24th February 2006, 21:34</div></div><div class="posttext">Have you tried playing with the pre/post escape sequences as I suggested above?  Not sure if that is actually your problem but it did takes some changes to get it to work for me.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">awassif</div><div class="date">24th February 2006, 22:32</div></div><div class="posttext">Hello Mark,<br />
The &quot;post&quot; escape sequence matches mine. But the &quot;pre&quot; is different. I spent a few hours trying to get to work but unfortunately all my trials did not get me a reasonable result. <br />
Any suggestions as of what part exactly changes the style from Italic to Upright on the &quot;post&quot; escape sequence.<br />
<br />
Thanks again for your reply,<br />
- Ameen</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">24th February 2006, 22:37</div></div><div class="posttext">Try adding Esc(s0S as one of the end escape sequences.  This sets it back to upright. Got this escape sequence from an old laser jet manual.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">awassif</div><div class="date">24th February 2006, 23:02</div></div><div class="posttext">Excellent, it worked!<br />
I added Esc(s0S to pfont14 in my printinf file. <br />
Changed the line from:<br />
pfont14=\E&amp;f0s1y2x1S,<br />
to<br />
pfont14=\E&amp;f0s1y2x1S\E(s0S,<br />
Result: upright font on the overlay form.<br />
<br />
Thanks again for your time Mark!<br />
- Ameen</div></div><hr />


<div class="post"><div class="posttop"><div class="username">phr024</div><div class="date">2nd May 2006, 09:56</div></div><div class="posttext">Thank's this solution works fine with me....<br />
<br />
Thank's a lot Awassif!!<br />
<br />
Kind regards,<br />
<br />
Patrick Harder.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rjohmit</div><div class="date">12th May 2006, 18:51</div></div><div class="posttext">Little late to the game here but I'm attempting to set this up.<br />
<br />
When I try to print a report using the new device, I get an error message.  It has &quot;ttadv31809&quot; in the title bar.  The error text is:<br />
<br />
/usr/bin/lp  -dmyprint -s -c -n1 /baan/bse/tmp/tmp056401200  -oBSDh<br />
<br />
<br />
(Error 1)<br />
<br />
<br />
Anyone have any ideas?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">14th May 2006, 17:15</div></div><div class="posttext">Are you trying to print the overlay or the baan report itself?  Because the lp command inside the report should be trying to print the overlay so I would not expect a /baan/bse/tmp directory. If this is the command in the report then replace the file to be printed with the full path to the ovl file.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rjohmit</div><div class="date">15th May 2006, 16:55</div></div><div class="posttext">This error occurs when I try to print the report (including the code to print the overlay) from the Baan session.<br />
<br />
Despite receiving this error, it sometimes prints the report including the logo.  However, the logo is very pixelated  and doesn't look good at all.<br />
<br />
I'll keep working on it.  Thanks!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sigmabaani</div><div class="date">21st June 2006, 10:54</div></div><div class="posttext">Hi experts,<br />
<br />
I found the solution for printing a Logo. It works with my generated OVL-file. But the Logo is centered in the page, when its printed. Now i need to find a way how to set the logo an arbitrary position.<br />
Changes in the reportfield and its position have no results. Is the problem in the OVL-file? I have printed the bitmap on the Overlay Printer with Microsoft Paint.<br />
Who has a solution?<br />
<br />
Greetings</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">21st June 2006, 14:21</div></div><div class="posttext">Check your overlay file I believe that is where the problem is.  At the start of the file are some escape sequences break them down to see if any are causing the problem.  I never really had this problem, but I did play with a few of the escape sequences at the start to make it look better.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">~Vamsi</div><div class="date">21st June 2006, 16:14</div></div><div class="posttext">Try creating your OVL file from a page based software, for eg. Microsoft Word.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bartman</div><div class="date">20th October 2006, 14:01</div></div><div class="posttext">Hi friends,<br />
yet another problem with our company logo. I've created the logo.prn from an PDF File, converted to ovl with described tool and hex modified the last row in the ovl. My outgoing A4-PDF file contains of a company logo on the top and some text on the footer of the page. When launching report, the logo with footer is printed fine, but the BaaN report data ist just printed on the next site (without logo) and the caracters are unreadable.<br />
Anyone some ideas?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">norwim</div><div class="date">10th January 2007, 17:10</div></div><div class="posttext">Hi Vamsi,<br />
<br />
this was very helpfull indeed.<br />
I fiddled around with the layout of a report the whole day, but to add the logo didn't even take an hour.<br />
One important hint should be added though:<br />
&quot;  ... tolower$(spool.device) ... &quot; doesn't work, if the printer in unix has a different name than the device in Baan. As we use different &quot;Baan-Printers&quot; for example to adress different paper trays of one printer in unix, this is the case here.<br />
But of course it is quite trivial to fetch the system name of the printer from ttaad300. <br />
Thanks to all other contributors too of course.<br />
<br />
regards<br />
<br />
Norbert</div></div><hr />


<div class="post"><div class="posttop"><div class="username">tM2006</div><div class="date">22nd September 2007, 15:23</div></div><div class="posttext">for vamsi solution <br />
can we use in window server 2003<br />
if not please advise us which kind of method we can use in order to print the logo on the report <br />
<br />
thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">~Vamsi</div><div class="date">1st October 2007, 06:21</div></div><div class="posttext">for vamsi solution <br />
can we use in window server 2003<br />
if not please advise us which kind of method we can use in order to print the logo on the report <br />
<br />
thanks<br />
<br />
You cannot use this solution on servers that are not Unix based. Alternatives abound. Please use search. Try logo.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kazasaritha</div><div class="date">23rd November 2007, 12:45</div></div><div class="posttext">Dear Mr.Vamsi,<br />
<br />
I Did the entire process. But, could not succeed. I doubt that printer driver editing is some thing wrong. Could you please let me know what is the file excactly i should edit to put  &quot;   pfont14=\E&amp;f0s1y2x1S,   &quot;.<br />
<br />
Thanks and Regards,<br />
<br />
Saritha</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">24th November 2007, 01:35</div></div><div class="posttext">It goes in the print driver file for the printer.  For example if you are printing on a HP 5 laser Jet - the printer probably has a print driver like HP_LJ5.  You are printing on a UNIX platform?  This only works for the UNIX platform.  Anyway - you then locate the print driver under $BSE/lib/printinf/h - I think, not at work to check.  Then you just vi the file, locate pfont14 and put it there.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">kazasaritha</div><div class="date">26th November 2007, 06:03</div></div><div class="posttext">Even now after doing the said changes also I am not getting. Attaching the .ovl file. <br />
<br />
Regards,<br />
<br />
Saritha</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rduncan10</div><div class="date">22nd April 2008, 19:34</div></div><div class="posttext">Hi,<br />
<br />
I've been testing this method with some success, but I have a few issues.<br />
<br />
First, I cannot get the line spacing to work, despite changing the PCL commands in the OVL file. I notice the line spacing starts to double wherever I put the empty User14 text field on the report.  I'm not sure if this is the same problem everyone else had (nobody really describes the line spacing issue).<br />
<br />
Second, a thick gray line appears down the right side of the overlay. I originally created the overlay by scanning the letterhead to PDF and printing from that. I then tried recreating it from scratch in Word. Both versions have the gray line. <br />
<br />
I am using Linux and CUPS for printing (the printers are setup as raw LPD Printers). I don't know if this would affect the way this works or if anyone else has got this to work with CUPs. <br />
<br />
I attach my overlay.<br />
<br />
Thanks for any help,<br />
Rob</div></div><hr />


<div class="post"><div class="posttop"><div class="username">rivern</div><div class="date">10th July 2008, 10:03</div></div><div class="posttext">Hi guy:<br />
    I'm not successful. if anyone make a PPT demo for this topic.It's very useful.<br />
Best Regards<br />
Rivern</div></div><hr />


<div class="post"><div class="posttop"><div class="username">GROENZ</div><div class="date">29th July 2010, 11:02</div></div><div class="posttext">Hi, I am in the process of following this method to get our company logo to print on the invoice supplied by Vamsi http://www.baanboard.com/baanboard/showthread.php?t=7119 <br />
<br />
However I am stuck where I need to modify the printer driver. Can anyone please tell me how to do this?<br />
<br />
Also the script, I am not sure where to add this in as I am not really 100% sure how to write scripts. Here is what our script looks like at the moment:<br />
<br />
|*** program *****************************************************************<br />
		<br />
before.program:<br />
	tcmcs.dll0095.read.parm(&quot;tdpcg000&quot;)<br />
	tcmcs.dll0095.read.parm(&quot;tdpur000&quot;)<br />
	itccom0000.get.multi.currency.data(get.compnr())<br />
	date = utc.num()<br />
	g.project = &quot;&quot;<br />
	array.length = tdpur.dll0022.array.length()<br />
	rdi.domain(&quot;tcdisc&quot;, disc.difo, g.dummy.string,<br />
			g.dummy.string, g.dummy.long,<br />
			g.dummy.string, g.dummy.long)<br />
	rdi.domain(&quot;tcpric&quot;, pric.difo, g.dummy.string,<br />
			g.dummy.string, g.dummy.long,<br />
			g.dummy.string, g.dummy.long)<br />
	lattr.textexpand = TRUE<br />
	print.header.text = TRUE<br />
<br />
|*** fields ******************************************************************<br />
<br />
Would appreciate it if anyone can please help me to add the script in vamsi's post to our script<br />
<br />
And lastly how to create a field on the report?<br />
<br />
Thank you very much in advance</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">29th July 2010, 14:04</div></div><div class="posttext">First note that this will only work on BaaN on UNIX.  You profile says your OS is vista.<br />
If you are not familiar with  coding scripts I recommend using a tool fromhttp://www.nazdaq.co.il..  I have not used the tool myself, but heard it is easy to use.<br />
<br />
The print driver on our UNIX systems is $BSE/lib/printinf.  You would need to look at your device to see what the name is.  Then there are sub directories to find the actual print driver file.  For example h would have our hp drivers(all we use).  Follow first ~vamsi thread through one step at a time. I still do not think this is something a novice should try.  It will walk you through creating the overlay - but be prepared to play with the settings and using the hex editor to change.  It will show you the font to setup in the print driver and how to set-it up.  It will also explain how to get the overlay(logo) to appear on the report when it prints.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">GROENZ</div><div class="date">30th July 2010, 07:49</div></div><div class="posttext">Hi Mark,<br />
<br />
Thank you for your reply. We are running LN FP3 on a Linux server. My OS is vista. Will have a crack at it again and see how I go.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pbenven</div><div class="date">21st March 2011, 20:35</div></div><div class="posttext">This is a bit of an old one, but I would like to express my thanks to all who posted their tips. Here are a couple of my own:<br />
<br />
- Printing multi-page reports showed an incorrect offset on page length. At the top of the OVL file, I changed the margin value to 2 - so &quot;4d2E&quot; instead of &quot;4d1E&quot;. <br />
- My Canon IR's did not require me to modify the end of the OVL files.<br />
- I had to create new MK printers and new UNIX queues so that the 2 would match (thanks norwim).<br />
- I learned (the hard way) to flush the PCL portion of the printer's hard disk in between tests. Good way to lose your mind, that.<br />
- Since I am using MK, &quot;run.prog&quot; and subsequently &quot;RP_WAIT&quot; are not available, so I used &quot;shell&quot; instead:<br />
<br />
        domain  tcmcs.long      p.ret.c<br />
        domain  tcmcs.str128    p.command.c<br />
<br />
<br />
        p.command.c = &quot;-d&quot;<br />
        &amp; (spool.device)<br />
        &amp; &quot; -oraw -s &quot;<br />
        &amp; &quot;/opt/mk/bse6.0/lib/barcode/hp_barcode/QCCPOv2.OVL&quot;<br />
<br />
        p.ret.c = shell(<br />
                        &quot;/usr/bin/lp &quot;<br />
                        &amp; p.command.c,<br />
                        0)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pbenven</div><div class="date">12th May 2011, 17:45</div></div><div class="posttext">Changed the code around to satisfy the possibility of having multiple overlays depending on company number:<br />
<br />
|*** Begin Print Overlay *************<br />
<br />
        domain  tcmcs.long      p.ret.c<br />
        domain  tcmcs.str128    p.command.c<br />
        domain  tcmcs.str128    ovlfile<br />
        domain  tcmcs.str3      company<br />
<br />
        company = str$(get.compnr())<br />
<br />
        ovlfile = &quot;/opt/mk/bse6.0/lib/ovl/invoice&quot;<br />
                &amp; company<br />
                &amp; &quot;.ovl&quot;<br />
<br />
        p.command.c = &quot;-d&quot;<br />
                &amp; (spool.device)<br />
                &amp; &quot; -oraw -s &quot;<br />
                &amp; ovlfile<br />
<br />
        p.ret.c = shell(<br />
                &quot;/usr/bin/lp &quot;<br />
                &amp; p.command.c,<br />
                0)<br />
<br />
|*** End Print Overlay ************</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pbenven</div><div class="date">18th May 2011, 22:23</div></div><div class="posttext">One interesting problem...<br />
<br />
Suppliers are tied to specific languages, 2 and 4 in my case. Language 2 suppliers get their reports in language 2, language 4 suppliers in language 4 (duh).<br />
<br />
I have modified both the 2 and 4 Purchase Order Reports with the code in my previous posts and everything seems to be working fine - except...<br />
<br />
If I send a batch of Purchase Orders to be printed, and the batch contains orders for both language 2 and 4 based suppliers, only the language 2's will print with overlays.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">19th May 2011, 22:33</div></div><div class="posttext">Been a long time since I looked at this and I never used multiple languages.  Is it possible that each time the language changes you need to resend the overlay?  I am not sure how the languages interact with the printer and I wonder if switch languages causes something to happen to the overlay in memory.  Not really sure about this and just speculating.</div></div><hr />



</div>
</body>
</html>