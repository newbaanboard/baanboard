<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="Calling tipcs2232m000, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] Calling tipcs2232m000 AFS/DDC/OLE: Function servers" />
	
	<title>Calling tipcs2232m000 [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="index.html">Newbaanboard</a> &gt; <a href="index.html">Baan SIGs</a> &gt; <a href="index.html">AFS/DDC/OLE: Function servers</a> &gt; Calling tipcs2232m000</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">Gerrit</div><div class="date">22nd November 2004, 14:57</div></div><div class="posttext">Hello,<br />
<br />
Maybe some of you can help me.<br />
<br />
I programmed some functionality using the AFS. For a range of customerspecific items tipcs2232m000 (Copy Customized Product Structure to Standard) has to be run. I did this by making a query with easy-sql on tipcs021 and programming the functionality in the reportscript. THe code is put below this :<br />
<br />
<br />
declaration:<br />
        extern  domain  tcmcs.str50     err.mesg<br />
        extern  domain  tcmcs.long      print.regel<br />
        long                            ret<br />
<br />
        #pragma used dll ottstpapihand<br />
<br />
detail.1:<br />
before.layout:<br />
        err.mesg = &quot;&quot;<br />
        stpapi.put.field(&quot;tipcs2232m000&quot;,&quot;orig.cprj&quot;,tipcs021.cprj)<br />
        stpapi.put.field(&quot;tipcs2232m000&quot;,&quot;orig.item&quot;,tipcs021.item)<br />
        stpapi.put.field(&quot;tipcs2232m000&quot;,&quot;copy.item&quot;,tipcs021.item)<br />
        stpapi.put.field(&quot;tipcs2232m000&quot;,&quot;cust.rc&quot;,&quot;&quot;)<br />
        stpapi.put.field(&quot;tipcs2232m000&quot;,&quot;cust.code.dsca&quot;,&quot;&quot;)<br />
        stpapi.put.field(&quot;tipcs2232m000&quot;,&quot;copy.structure&quot;,&quot;1&quot;)<br />
        stpapi.put.field(&quot;tipcs2232m000&quot;,&quot;copy.erela&quot;,str$(etol(tcyesno.no)))<br />
        stpapi.continue.process(&quot;tipcs2232m000&quot;,err.mesg)<br />
        stpapi.end.session(&quot;tipcs2232m000&quot;)<br />
<br />
What happens. It looks like that it works. Only the variable err.mesg is filled with the message &quot;Mainitem not allowed&quot;. And I don't know why.<br />
<br />
Does anyone of you knows.<br />
<br />
Regards,<br />
Gerrit</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">22nd November 2004, 15:54</div></div><div class="posttext">Do you have source for this session?  This is pure speculation since I know nothing about the session, but it sounds like one of the field events sets this &quot;mainitem&quot;.  With source you could debug the script and find out what you need to do to get it to work.  With out source you can try this, but no promises that it will work - run ttstpcreatdll.  Create a DLL for this session and see what is in it.  You may find a put field that may not be on the form.  You can try filling it with a put. I never really tried this but it might work.<br />
<br />
You can also try a save or update to see if this fills the &quot;mainitem&quot; before doing the continue.  Just a couple of things I have had to do to get API funtion servers to work.<br />
<br />
Mark</div></div><hr />



</div>
</body>
</html>