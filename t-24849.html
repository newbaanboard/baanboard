<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="Creating Baan Clients from VB, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] Creating Baan Clients from VB AFS/DDC/OLE: Function servers" />
	
	<title>Creating Baan Clients from VB [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="index.html">Newbaanboard</a> &gt; <a href="index.html">Baan SIGs</a> &gt; <a href="index.html">AFS/DDC/OLE: Function servers</a> &gt; Creating Baan Clients from VB</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">santana</div><div class="date">17th August 2005, 14:38</div></div><div class="posttext">Hi all, i am triyng to create baan clients ( tccom010 ) whith VB aplication using this function in baan DLL:<br />
<br />
All of them return 0 but the client is not inserted in the table, can anynone give me a clue ?<br />
Thanks<br />
<br />
<br />
PS - Bellow the Baan DLL called<br />
<br />
<br />
function extern void tccom1101m000f.put.cliente( const domain tccuno vcuno, const domain tcnama vnama,<br />
const domain tcnamc vnamc,const domain tcpstc vpstc,const domain tcccty vccty,<br />
const domain tctelp vtelp,const domain tctelx vtelx)<br />
{<br />
DLLUSAGE<br />
	Function to set Customer, name and other required and user definable fields<br />
ENDDLLUSAGE<br />
	stpapi.put.field( &quot;tccom1101m000&quot;, &quot;tccom010.cuno&quot;, vcuno )<br />
	stpapi.put.field( &quot;tccom1101m000&quot;, &quot;tccom010.nama&quot;, vnama )<br />
	stpapi.put.field( &quot;tccom1101m000&quot;, &quot;tccom010.namc&quot;, vnamc )<br />
	stpapi.put.field( &quot;tccom1101m000&quot;, &quot;tccom010.pstc&quot;, vpstc )<br />
	stpapi.put.field( &quot;tccom1101m000&quot;, &quot;tccom010.ccty&quot;, vccty )<br />
	stpapi.put.field( &quot;tccom1101m000&quot;, &quot;tccom010.telp&quot;, vtelp )<br />
	stpapi.put.field( &quot;tccom1101m000&quot;, &quot;tccom010.telx&quot;, vtelx )<br />
}<br />
<br />
function extern void tccom1101m000f.put.cliente_def( )<br />
{<br />
DLLUSAGE<br />
	Function to set Customer default data for non inputable fields<br />
ENDDLLUSAGE<br />
	stpapi.put.field( &quot;tccom1101m000&quot;, &quot;tccom010.comp&quot;, &quot;941&quot; )<br />
	stpapi.put.field( &quot;tccom1101m000&quot;, &quot;tccom010.crep&quot;, &quot;0&quot; )<br />
	stpapi.put.field( &quot;tccom1101m000&quot;, &quot;tccom010.clan&quot;, &quot;PT&quot; )<br />
	stpapi.put.field( &quot;tccom1101m000&quot;, &quot;tccom010.ccur&quot;, &quot;EUR&quot; )<br />
	stpapi.put.field( &quot;tccom1101m000&quot;, &quot;tccom010.cvyn&quot;, &quot;2&quot; )<br />
	stpapi.put.field( &quot;tccom1101m000&quot;, &quot;tccom010.crlr&quot;, &quot;0&quot; )<br />
	stpapi.put.field( &quot;tccom1101m000&quot;, &quot;tccom010.clin&quot;, &quot;0&quot; )<br />
	stpapi.put.field( &quot;tccom1101m000&quot;, &quot;tccom010.eded&quot;, &quot;0&quot; )<br />
	stpapi.put.field( &quot;tccom1101m000&quot;, &quot;tccom010.cnpa&quot;, &quot;1&quot; )<br />
	stpapi.put.field( &quot;tccom1101m000&quot;, &quot;tccom010.itpr&quot;, &quot;2&quot; )<br />
	stpapi.put.field( &quot;tccom1101m000&quot;, &quot;tccom010.ncin&quot;, &quot;0&quot; )<br />
	stpapi.put.field( &quot;tccom1101m000&quot;, &quot;tccom010.lidt&quot;, &quot;0&quot; )<br />
	stpapi.put.field( &quot;tccom1101m000&quot;, &quot;tccom010.back&quot;, &quot;1&quot; )<br />
	stpapi.put.field( &quot;tccom1101m000&quot;, &quot;tccom010.scom&quot;, &quot;2&quot; )<br />
	stpapi.put.field( &quot;tccom1101m000&quot;, &quot;tccom010.cfcg&quot;, &quot;001&quot; )<br />
	stpapi.put.field( &quot;tccom1101m000&quot;, &quot;tccom010.odis&quot;, &quot;0&quot; )<br />
	stpapi.put.field( &quot;tccom1101m000&quot;, &quot;tccom010.prio&quot;, &quot;99&quot; )<br />
	stpapi.put.field( &quot;tccom1101m000&quot;, &quot;tccom010.ackx&quot;, &quot;2&quot; )<br />
	stpapi.put.field( &quot;tccom1101m000&quot;, &quot;tccom010.ccra&quot;, &quot;0&quot; )<br />
}<br />
<br />
function extern long tccom1101m000f.insert( long do.update, ref string error )<br />
{<br />
DLLUSAGE<br />
	Function to insert a record in session tccom1101m000<br />
	Fields must be put before calling this function<br />
ENDDLLUSAGE<br />
	return( stpapi.insert( &quot;tccom1101m000&quot;, do.update, error ) )<br />
}<br />
function extern long tccom1101m000f.save( ref string error )<br />
{<br />
DLLUSAGE<br />
	Function to save an update/insert/delete in session tccom1101m000<br />
ENDDLLUSAGE<br />
	return( stpapi.save( &quot;tccom1101m000&quot;, error ) )<br />
}<br />
function extern void tccom1101m000f.end([string error(500)])<br />
{<br />
DLLUSAGE<br />
	Function to end connection to session tccom1101m000<br />
ENDDLLUSAGE<br />
	if get.argc() = 0 then<br />
		stpapi.end.session( &quot;tccom1101m000&quot; ) <br />
	else<br />
		error = get.string.arg(1)<br />
		stpapi.end.session( &quot;tccom1101m000&quot; , error  )<br />
		put.string.arg(1, error)<br />
	endif</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">17th August 2005, 15:30</div></div><div class="posttext">I take it your VB code calls things in this order:<br />
<br />
tccom1101m000f.put.cliente<br />
tccom1101m000f.put.cliente_def<br />
tccom1101m000f.insert<br />
<br />
Is this correct?  You probably should post your VB code - that way someone who knows VB might see a problem.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">santana</div><div class="date">17th August 2005, 17:19</div></div><div class="posttext">Thanks for the reply! here's a portion of the code. &quot;Cliente&quot; and &quot;Cliente_def&quot; are new functions that &quot;put&quot; a group of fields at a time.<br />
BtnInsertGlobal_Click is the button that trigers the &quot;add customer&quot;.<br />
Thanks in Advance!<br />
<br />
		private void EscreveLog(string msg)<br />
		{<br />
			lstBoxLog.Items.Add(System.DateTime.Now.ToString(&quot;HH:mm:ss:fffff&quot;) + &quot; \t &quot; + msg);<br />
<br />
		}<br />
<br />
		private void btnInsertGlobal_Click(object sender, System.EventArgs e)<br />
		{<br />
		<br />
<br />
			Baan4.Baan4Class baanObject = null;<br />
			int resultado=0;<br />
			string operacao = &quot;&quot;;<br />
			<br />
			try<br />
			{<br />
				baanObject = new Baan4Class();<br />
			}<br />
			catch(System.Exception ex)<br />
			{<br />
				EscreveLog(&quot;Erro: Deu erro a instanciar o objecto baan : &quot; + ex.Message);<br />
				MessageBox.Show(&quot;Deu erro a instanciar o objecto baan : &quot; + ex.ToString());<br />
			}			<br />
			<br />
<br />
			try<br />
			{<br />
				operacao = txtFuntion.Text + &quot;.put.cliente(\&quot;&quot; + txtCuno.Text + &quot;\&quot;, \&quot;&quot; + txtNama.Text + &quot;\&quot;, \&quot;&quot; + txtlNamc.Text + &quot;\&quot;, \&quot;&quot; +  txtPstc.Text + &quot;\&quot;, \&quot;&quot; + txtCcty.Text + &quot;\&quot;, \&quot;&quot; + txtTelp.Text + &quot;\&quot;, \&quot;&quot; + txtTelx.Text + &quot;\&quot;)&quot;;<br />
				resultado = baanObject.ParseExecFunction(txtSession.Text, operacao);<br />
			}<br />
			catch(System.Exception ex)<br />
			{<br />
				EscreveLog(&quot;Erro: Deu erro a executar operacao : &quot; + operacao + &quot;    -----    &quot; + ex.Message);<br />
				MessageBox.Show(&quot;Deu erro a executar operacao : &quot; + operacao + &quot;    -----    &quot; + ex.ToString());<br />
			}<br />
			EscreveLog(&quot;Resultado Baan : &quot; + operacao + &quot;  ----  &quot; + baanObject.ReturnValue + &quot;     ----- &quot; + resultado.ToString());<br />
<br />
<br />
			try<br />
			{<br />
				operacao = txtFuntion.Text + &quot;.put.cliente_def()&quot;;<br />
				resultado = baanObject.ParseExecFunction(txtSession.Text, operacao);<br />
			}<br />
			catch(System.Exception ex)<br />
			{<br />
				EscreveLog(&quot;Erro: Deu erro a executar operacao : &quot; + operacao + &quot;    -----    &quot; + ex.Message);<br />
				MessageBox.Show(&quot;Deu erro a executar operacao : &quot; + operacao + &quot;    -----    &quot; + ex.ToString());<br />
			}<br />
			EscreveLog(&quot;Resultado Baan : &quot; + operacao + &quot;  ----  &quot; + baanObject.ReturnValue + &quot;     ----- &quot; + resultado.ToString());<br />
<br />
<br />
<br />
			try<br />
			{<br />
				operacao = txtFuntion.Text + &quot;.insert(1,\&quot;&quot; + String.Empty.PadLeft(500, &quot; &quot;.ToCharArray()[0]) + &quot;\&quot;)&quot;;<br />
				// MessageBox.Show(operacao);<br />
				resultado = baanObject.ParseExecFunction(txtSession.Text, operacao);<br />
			}<br />
			catch(System.Exception ex)<br />
			{<br />
				EscreveLog(&quot;Erro: Deu erro a executar operacao : &quot; + operacao + &quot;    -----    &quot; + ex.Message);<br />
				MessageBox.Show(&quot;Deu erro a executar operacao : &quot; + operacao + &quot;    -----    &quot; + ex.ToString());<br />
			}<br />
			EscreveLog(&quot;Resultado Baan : &quot; + operacao + &quot;  ----  &quot; + baanObject.ReturnValue + &quot;     ----- &quot; + resultado.ToString());<br />
<br />
			try<br />
			{<br />
				operacao = txtFuntion.Text + &quot;.save(\&quot;&quot; + String.Empty.PadLeft(500, &quot; &quot;.ToCharArray()[0]) + &quot;\&quot;)&quot;;<br />
				resultado = baanObject.ParseExecFunction(txtSession.Text, operacao);<br />
			}<br />
			catch(System.Exception ex)<br />
			{<br />
				EscreveLog(&quot;Erro: Deu erro a executar operacao : &quot; + operacao + &quot;    -----    &quot; + ex.Message);<br />
				MessageBox.Show(&quot;Deu erro a executar operacao : &quot; + operacao + &quot;    -----    &quot; + ex.ToString());<br />
			}<br />
			EscreveLog(&quot;Resultado Baan : &quot; + operacao + &quot;  ----  &quot; + baanObject.ReturnValue + &quot;     ----- &quot; + resultado.ToString());<br />
<br />
<br />
			try<br />
			{<br />
				operacao = txtFuntion.Text + &quot;.end(\&quot;&quot; + String.Empty.PadLeft(500, &quot; &quot;.ToCharArray()[0]) + &quot;\&quot;)&quot;;<br />
				resultado = baanObject.ParseExecFunction(txtSession.Text, operacao);<br />
			}<br />
			catch(System.Exception ex)<br />
			{<br />
				EscreveLog(&quot;Erro: Deu erro a executar operacao : &quot; + operacao + &quot;    -----    &quot; + ex.Message);<br />
				MessageBox.Show(&quot;Deu erro a executar operacao : &quot; + operacao + &quot;    -----    &quot; + ex.ToString());<br />
			}<br />
			EscreveLog(&quot;Resultado Baan : &quot; + operacao + &quot;  ----  &quot; + baanObject.ReturnValue + &quot;     ----- &quot; + resultado.ToString());<br />
<br />
			baanObject.Quit();<br />
			<br />
			baanObject = null;<br />
<br />
<br />
		}</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">17th August 2005, 20:15</div></div><div class="posttext">The VB code is beyond my skills, but you should be able to put your library in debug mode.  Then as the code executes you can watch what happens in the library.  You could check the library and make sure no errors are being returned.<br />
<br />
Also try inserting one by hand(using only the fields in your function server) to make sure all the mandatory fields are included.  Our system forces terms of payment to be entered and I did not see that in your list.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">monica23</div><div class="date">14th December 2007, 15:53</div></div><div class="posttext">Hi,<br />
anybody can help me...i want to connect Baan through VB is this code is ok...??after object creation its get hang....when i try to close VB application its give error application is running...anybody can help <br />
<br />
code :<br />
<br />
Private Sub Command1_Click()<br />
Set BaanObj = CreateObject(&quot;baan4.application&quot;)<br />
BaanObj.timeout = 10<br />
On Error GoTo BaanAutomationError<br />
<br />
B_function = &quot;start.session(&quot; &amp; Chr(34) &amp; &quot;tiitm0101m000&quot; &amp; Chr(34) &amp; &quot;)&quot;<br />
BaanObj.ParseExecFunction &quot;otccomdllbaan&quot;, B_function<br />
Exit Sub<br />
BaanAutomationError:<br />
MsgBox &quot;Baan IV automation error: &quot; &amp; BaanObj.Error<br />
MsgBox &quot;Return value function: &quot; &amp; B_function &amp; &quot; &quot; &amp; BaanObj.ReturnValue<br />
BaanObj.Quit<br />
Set BaanObj = Nothing<br />
Exit Sub<br />
<br />
End Sub<br />
<br />
Private Sub Command2_Click()<br />
BaanObj.Quit<br />
Set BaanObj = Nothing<br />
<br />
End Sub</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">14th December 2007, 16:22</div></div><div class="posttext">Are you connecting to Baan 4 or 5?  On which line does it hang?  Do you actually get connected to Baan - do you see the option dialog box? What is in the tccomdllbaan?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">14th December 2007, 16:42</div></div><div class="posttext">You might want to review this thread (http://www.baanboard.com/baanboard/showthread.php?t=8929&amp;highlight=call.session) also.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">monica23</div><div class="date">17th December 2007, 07:01</div></div><div class="posttext">thanks for reply mark...i try to connect baan 5.... yeah i can see dialogue box....</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">17th December 2007, 17:54</div></div><div class="posttext">What is in tccomdllbaan?  Post the code that you use.  I know the thread I posted contains a sample dll that I know works for Baan IV, but I do not know about Baan 5.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">monica23</div><div class="date">18th December 2007, 15:47</div></div><div class="posttext">right now i try for baan 4</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">18th December 2007, 20:17</div></div><div class="posttext">Here is what works for me on baan 4:<br />
<br />
This code is in the library tdapidllrecpt<br />
<br />
| Used this from excel to call some of my sessions.<br />
function extern call.session(const string sessname())<br />
{<br />
	zoom.to$(sessname,Z.SESSION, &quot;&quot;, &quot;&quot;, 0)<br />
}<br />
<br />
<br />
<br />
Excel VB code to call the above library and launch a given session.<br />
<br />
Sub test1()<br />
    Set BaanObj = CreateObject(&quot;Baan4.Application&quot;)<br />
    ThisWorkbook.Sheets(&quot;Performance&quot;).Activate<br />
    BaanObj.Timeout = 10<br />
    On Error GoTo BaanAutomationError<br />
    <br />
    B_function = &quot;call.session(&quot; &amp; Chr(34) &amp; &quot;tiitm0101m000&quot; &amp; Chr(34) &amp; &quot;)&quot;<br />
    BaanObj.ParseExecFunction &quot;otdapidllrecpt&quot;, B_function<br />
    <br />
    BaanObj.Quit<br />
    Set BaanObj = Nothing<br />
' error handling<br />
    Exit Sub<br />
    <br />
BaanAutomationError:<br />
    MsgBox &quot;Baan IV automation error: &quot; &amp; BaanObj.Error<br />
    MsgBox &quot;Return value function: &quot; &amp; B_function &amp; &quot;  &quot; &amp; BaanObj.ReturnValue<br />
    BaanObj.Quit<br />
    Set BaanObj = Nothing<br />
    Exit Sub<br />
<br />
End Sub<br />
<br />
<br />
Good luck!</div></div><hr />



</div>
</body>
</html>