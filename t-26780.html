<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="Problem inserting in &quot;Maintain Lots&quot; tdltc0101m000 (AFS), baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] Problem inserting in &quot;Maintain Lots&quot; tdltc0101m000 (AFS) AFS/DDC/OLE: Function servers" />
	
	<title>Problem inserting in &quot;Maintain Lots&quot; tdltc0101m000 (AFS) [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="index.html">Newbaanboard</a> &gt; <a href="index.html">Baan SIGs</a> &gt; <a href="index.html">AFS/DDC/OLE: Function servers</a> &gt; Problem inserting in &quot;Maintain Lots&quot; tdltc0101m000 (AFS)</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">Jaroslaw</div><div class="date">31st March 2006, 19:55</div></div><div class="posttext">Hi,<br />
I am trying to insert a new lot through AFS using session tdltc0101m000 but every time it fails with message &quot;Manufactured Item not allowed&quot;. <br />
When I insert exactly the same item manually it saves without a problem.<br />
Here is the code:<br />
<br />
item = &quot;1000-00556&quot;<br />
olot = tdltc.olot.prod<br />
stpapi.put.field(&quot;tdltc0101m000&quot;, &quot;tdltc001.item&quot;, item)<br />
stpapi.put.field(&quot;tdltc0101m000&quot;, &quot;tdltc001.olot&quot;, str$(olot))<br />
stpapi.insert(&quot;tdltc0101m000&quot;, true, error)<br />
<br />
I tried the following:<br />
- using different items<br />
- changing the item type in Maintain Item Data to Purchased<br />
- changing variable olot to tdltc.olot.purch<br />
- filling all fields on the form (using function stpapi.put.field) even though I want to accept the defaults for everything exept tiitm001.item and tiitm001.olot<br />
In all cases, inserting manually works fine but using AFS fails with message &quot;Manufactured Item not allowed&quot;:confused: <br />
<br />
Any comments would be appreciated,<br />
Jaroslaw</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">31st March 2006, 20:54</div></div><div class="posttext">Here is my routine to insert a lot:<br />
<br />
<br />
function extern create_lot(	domain	tcitem		purchase.item,<br />
				domain	tdltc.clot	purchase.lot,<br />
				domain	tcdate		purchaselot.date,<br />
				domain	tcsuno		supplier.number,<br />
				ref     string          msg())<br />
{<br />
	msg = &quot;&quot;<br />
	stpapi.put.field(&quot;tdltc0101m000&quot;,&quot;tdltc001.item&quot;,purchase.item)<br />
	stpapi.put.field(&quot;tdltc0101m000&quot;,&quot;tdltc001.clot&quot;,purchase.lot)<br />
	stpapi.put.field(&quot;tdltc0101m000&quot;,&quot;tdltc001.olot&quot;,str$(tdltc.olot.purch))<br />
	stpapi.put.field(&quot;tdltc0101m000&quot;,&quot;tdltc001.suno&quot;,supplier.number)<br />
	stpapi.put.field(&quot;tdltc0101m000&quot;,&quot;tdltc001.oudt&quot;,str$(purchaselot.date))<br />
	rc = stpapi.insert(&quot;tdltc0101m000&quot;,1,msg)<br />
 	stpapi.end.session(&quot;tdltc0101m000&quot;)<br />
}<br />
<br />
<br />
We are on 4c4 and service pack 18(I think).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Jaroslaw</div><div class="date">31st March 2006, 22:42</div></div><div class="posttext">Thanks for replying mark_h<br />
<br />
I created a function almost exactly the same as your code with hard coded values (just for testing); here it is:<br />
<br />
function test()<br />
{<br />
long ret<br />
string error(500)<br />
<br />
stpapi.put.field(&quot;tdltc0101m000&quot;, &quot;tdltc001.item&quot;, &quot;2000-00005&quot;)<br />
stpapi.put.field(&quot;tdltc0101m000&quot;, &quot;tdltc001.olot&quot;, str$(tdltc.olot.purch))<br />
stpapi.put.field(&quot;tdltc0101m000&quot;, &quot;tdltc001.suno&quot;, &quot;MAKSTE&quot;)<br />
stpapi.put.field(&quot;tdltc0101m000&quot;, &quot;tdltc001.oudt&quot;, str$(date.num()))<br />
ret = stpapi.insert(&quot;tdltc0101m000&quot;, true, error)<br />
if ret &lt;&gt; 1 then<br />
 message(error)<br />
endif<br />
stpapi.end.session(&quot;tdltc0101m000&quot;)<br />
}<br />
<br />
The only difference is that I am not filling field tdltc001.clot because in our case it is generated by the system in main.table.io-&gt;before.write (of session tdltc0101m000). <br />
When I run this code stpapi.insert comes back with exactly the same error:<br />
&quot;Manufactured Item not allowed&quot;<br />
This makes no sense because this time it is not even a manufactured item.<br />
<br />
Any more suggestions ?<br />
<br />
Jaroslaw</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">31st March 2006, 23:29</div></div><div class="posttext">Now I see - we do not create manufactured parts that are lot controlled.  At least not on purpose. :)<br />
<br />
Do you own source code?  If so you can put it in debug and see what is causing the problem.<br />
<br />
No promises that these would work for you.  In the past sometimes I had to do the following to get some sessions to work:<br />
<br />
(a) save followed by insert.<br />
(b) update (can try both 0 and 1 in save parameter) followed by insert.<br />
<br />
And sometimes I actually use Qkey to modify the session to get it to behave in the correct fashion.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Jaroslaw</div><div class="date">3rd April 2006, 21:21</div></div><div class="posttext">We have figured out what the problem was:<br />
In the past a third form was attached to this session (by us). This form contained field tibom010.mitm &quot;Manufactured Item&quot; which was of type &quot;input&quot; (obviously wrong). As soon as I removed the form from the session, everything worked as expected.<br />
<br />
Thanks for your help mark_h<br />
<br />
Jaroslaw</div></div><hr />



</div>
</body>
</html>