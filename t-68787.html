<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="AFS for tihra1101m000 in baan4, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] AFS for tihra1101m000 in baan4 AFS/DDC/OLE: Function servers" />
	
	<title>AFS for tihra1101m000 in baan4 [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="index.html">Newbaanboard</a> &gt; <a href="index.html">Baan SIGs</a> &gt; <a href="index.html">AFS/DDC/OLE: Function servers</a> &gt; AFS for tihra1101m000 in baan4</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">alokdixt</div><div class="date">5th April 2016, 18:27</div></div><div class="posttext">Hi,<br />
I  am trying to create an AFS script for Hours accounting session but getting error &quot;Start date must be entered&quot;. I am getting this error only when tihra100.cwtt = &quot;&quot; otherwise it is going well. please help me here <br />
<br />
Below is the script<br />
<br />
<br />
<br />
stpapi.put.field(&quot;tihra1101m000&quot;, &quot;tihra100.year&quot;, str$(year.al))<br />
	stpapi.put.field(&quot;tihra1101m000&quot;, &quot;tihra100.week&quot;, str$(week.al))<br />
	stpapi.put.field(&quot;tihra1101m000&quot;, &quot;tihra100.emno&quot;, str$(emno.al))<br />
	ret.val = stpapi.find(&quot;tihra1101m000&quot;,gapi.error.code)<br />
	<br />
	stpapi.get.field(&quot;tihra1101m000&quot;, &quot;tihra100.year&quot;, year.p)<br />
	stpapi.get.field(&quot;tihra1101m000&quot;, &quot;tihra100.week&quot;, week.p)<br />
	stpapi.get.field(&quot;tihra1101m000&quot;, &quot;tihra100.emno&quot;, emno.p)<br />
	<br />
	stpapi.put.field(&quot;tihra1101m000&quot;, &quot;tihra100.hrdt&quot;, str$(hrdt.al))<br />
	stpapi.put.field(&quot;tihra1101m000&quot;, &quot;tihra100.dayn&quot;, str$(etol(dayn.al)))<br />
	stpapi.put.field(&quot;tihra1101m000&quot;, &quot;tihra100.koht&quot;, str$(etol(koht.al)))<br />
	stpapi.put.field(&quot;tihra1101m000&quot;, &quot;tihra100.cprj&quot;, str$(cprj.al))<br />
	stpapi.put.field(&quot;tihra1101m000&quot;, &quot;tihra100.pdno&quot;, str$(pdno.al))<br />
	stpapi.put.field(&quot;tihra1101m000&quot;, &quot;tihra100.opno&quot;, str$(opno.al))<br />
	stpapi.put.field(&quot;tihra1101m000&quot;, &quot;tihra100.cact&quot;, str$(cact.al))<br />
	stpapi.put.field(&quot;tihra1101m000&quot;, &quot;tihra100.tano&quot;, str$(tano.al))<br />
	stpapi.put.field(&quot;tihra1101m000&quot;, &quot;tihra100.cwoc&quot;, str$(cwoc.al))<br />
	stpapi.put.field(&quot;tihra1101m000&quot;, &quot;tihra100.cwtt&quot;, str$(cwtt.al))<br />
	stpapi.put.field(&quot;tihra1101m000&quot;, &quot;tihra100.stdy&quot;, str$(etol(stdy.al)))<br />
	stpapi.put.field(&quot;tihra1101m000&quot;, &quot;tihra100.sttm&quot;, str$(sttm.al))	<br />
	stpapi.put.field(&quot;tihra1101m000&quot;, &quot;tihra100.endy&quot;, str$(etol(endy.al)))<br />
	stpapi.put.field(&quot;tihra1101m000&quot;, &quot;tihra100.entm&quot;, str$(entm.al))<br />
	stpapi.put.field(&quot;tihra1101m000&quot;, &quot;tihra100.hrea&quot;, str$((hrea.al * -1)))<br />
<br />
	stpapi.put.field(&quot;tihra1101m000&quot;, &quot;tihra100.ckow&quot;, str$(ckow.al))<br />
	stpapi.put.field(&quot;tihra1101m000&quot;, &quot;tihra100.htst&quot;, str$(etol(htst.al)))<br />
	stpapi.put.field(&quot;tihra1101m000&quot;, &quot;tihra100.pccp&quot;, str$(pccp.al))<br />
	stpapi.enum.answer(&quot;tihra1101m000&quot;, &quot;tihras0029&quot;, tcyesno.no)<br />
	inserted  = stpapi.insert(&quot;tihra1101m000&quot;, 1, gapi.error.code)<br />
	<br />
	if not inserted then<br />
		while true<br />
			error.code = stpapi.get.mess.code(&quot;tihra1101m000&quot;, gapi.error.code)<br />
			if (isspace(gapi.error.code)) then<br />
				break<br />
			endif<br />
			message(gapi.error.code)<br />
			ret = stpapi.recover(&quot;tihra1101m000&quot;, dummy.msg)<br />
		endwhile									<br />
	else<br />
	endif<br />
// Again putting dayn value as it was returning zero after insert//<br />
	<br />
	stpapi.put.field(&quot;tihra1101m000&quot;, &quot;tihra100.dayn&quot;, str$(etol(dayn.al)))<br />
	stpapi.put.field(&quot;tihra1101m000&quot;, &quot;tihra100.stdy&quot;, str$(etol(stdy.al)))	<br />
	stpapi.put.field(&quot;tihra1101m000&quot;, &quot;tihra100.endy&quot;, str$(etol(endy.al)))<br />
	<br />
	<br />
	if not stpapi.save(&quot;tihra1101m000&quot;, gapi.error.code) then<br />
		stpapi.get.field(&quot;tihra1101m000&quot;, &quot;tihra100.dayn&quot;, dayn.al.p)<br />
		  while true<br />
			error.code = stpapi.get.mess.code(&quot;tihra1101m000&quot;, gapi.error.code)<br />
			if (isspace(gapi.error.code)) then<br />
				break<br />
			endif<br />
			message(gapi.error.code)<br />
		endwhile<br />
		ret = stpapi.recover(&quot;tihra1101m000&quot;, dummy.msg)<br />
		stpapi.end.session(&quot;tihra1101m000&quot;)<br />
		return(false)<br />
	else<br />
		stpapi.get.field(&quot;tihra1101m000&quot;, &quot;tihra100.dayn&quot;, dayn.al.p)<br />
<br />
	<br />
	 endif <br />
	<br />
	stpapi.end.session(&quot;tihra1101m000&quot;)<br />
	 return(true)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">5th April 2016, 22:53</div></div><div class="posttext">You can search for other threads in this forum - there are several and this is just one http://www.baanboard.com/baanboard/showthread.php?t=5800.  Now maybe is cwtt is always set, but other threads exist.  Do you own source code to tihra1101 where you can debug it to see what is happening?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Ajesh</div><div class="date">8th April 2016, 20:50</div></div><div class="posttext">Looks like cwtt is a mandatory field if cwtt is indeed the &quot;Start date&quot;.</div></div><hr />



</div>
</body>
</html>