<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="AFS - tdilc4201m000, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] AFS - tdilc4201m000 AFS/DDC/OLE: Function servers" />
	
	<title>AFS - tdilc4201m000 [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="index.html">Newbaanboard</a> &gt; <a href="index.html">Baan SIGs</a> &gt; <a href="index.html">AFS/DDC/OLE: Function servers</a> &gt; AFS - tdilc4201m000</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">Jothilingam</div><div class="date">4th March 2004, 14:04</div></div><div class="posttext">Dear Friends<br />
<br />
Had written AFS codes for the session tdilc4201m000, the codes are working fine but cannot able to print out (ASCIF) the data.<br />
|For Session tdilc4201m000 (Generate Out bound Advice)<br />
stpapi.put.field( &quot;tdilc4201m000&quot;, &quot;runnumber&quot;, str$(10))<br />
<br />
stpapi.put.field( &quot;tdilc4201m000&quot;, &quot;koor.f&quot;, str$(etol(tdilc.koob.act.rpl)))<br />
<br />
stpapi.put.field( &quot;tdilc4201m000&quot;, &quot;koor.t&quot;, str$(etol(tdilc.koob.act.rpl)))<br />
<br />
stpapi.put.field( &quot;tdilc4201m000&quot;, &quot;cuno.f&quot;, &quot;&quot; )<br />
stpapi.put.field( &quot;tdilc4201m000&quot;, &quot;cuno.t&quot;, &quot;ZZZZZZ&quot; )<br />
stpapi.put.field( &quot;tdilc4201m000&quot;, &quot;orno.f&quot;, str$(0))<br />
stpapi.put.field( &quot;tdilc4201m000&quot;, &quot;orno.t&quot;, str$(999999))<br />
stpapi.put.field( &quot;tdilc4201m000&quot;, &quot;opno.f&quot;, str$(0))<br />
stpapi.put.field( &quot;tdilc4201m000&quot;, &quot;opno.t&quot;, str$(999))<br />
stpapi.put.field( &quot;tdilc4201m000&quot;, &quot;prdt.t&quot;, str$(prodt))<br />
stpapi.put.field( &quot;tdilc4201m000&quot;, &quot;ddat.f&quot;, &quot;&quot;)<br />
stpapi.put.field( &quot;tdilc4201m000&quot;, &quot;ddat.t&quot;, str$(prodt))<br />
stpapi.put.field( &quot;tdilc4201m000&quot;, &quot;cprj.f&quot;, &quot;&quot;)<br />
stpapi.put.field( &quot;tdilc4201m000&quot;, &quot;cprj.t&quot;, &quot;ZZZZZZ&quot;)<br />
stpapi.put.field( &quot;tdilc4201m000&quot;, &quot;item.f&quot;, &quot;                &quot;)<br />
stpapi.put.field( &quot;tdilc4201m000&quot;, &quot;item.t&quot;, &quot;ZZZZZZZZZZZZZZZZ&quot;)<br />
stpapi.put.field( &quot;tdilc4201m000&quot;, &quot;cntr.f&quot;, &quot;&quot;)<br />
stpapi.put.field( &quot;tdilc4201m000&quot;, &quot;cntr.t&quot;, &quot;ZZZ&quot;)<br />
stpapi.put.field( &quot;tdilc4201m000&quot;, &quot;cwar.f&quot;, &quot;&quot;)<br />
stpapi.put.field( &quot;tdilc4201m000&quot;, &quot;cwar.t&quot;, &quot;ZZZ&quot;)<br />
stpapi.put.field( &quot;tdilc4201m000&quot;, &quot;crte.f&quot;, &quot;&quot;)<br />
stpapi.put.field( &quot;tdilc4201m000&quot;, &quot;crte.t&quot;, &quot;ZZZZZ&quot;)<br />
stpapi.put.field( &quot;tdilc4201m000&quot;, &quot;print.recom&quot;, str$(etol(tcyesno.yes)))<br />
stpapi.put.field( &quot;tdilc4201m000&quot;, &quot;prnt.shortage&quot;,str$(etol(tcyesno.no)))<br />
stpapi.put.field( &quot;tdilc4201m000&quot;, &quot;order.prio&quot;,str$(etol(tdilc.koob.act.sls)))<br />
stpapi.put.field( &quot;tdilc4201m000&quot;, &quot;order.prio&quot;,str$(etol(tdilc.koob.act.sfc)),2)<br />
stpapi.put.field( &quot;tdilc4201m000&quot;, &quot;order.prio&quot;,str$(etol(tdilc.koob.pcs.wrh)),3)<br />
stpapi.put.field( &quot;tdilc4201m000&quot;, &quot;order.prio&quot;,str$(etol(tdilc.koob.act.sma)),4)<br />
stpapi.put.field( &quot;tdilc4201m000&quot;, &quot;order.prio&quot;,str$(etol(tdilc.koob.act.rpl)),5)<br />
stpapi.put.field( &quot;tdilc4201m000&quot;, &quot;order.prio&quot;,str$(etol(tdilc.koob.act.pmg)),7)<br />
stpapi.put.field( &quot;tdilc4201m000&quot;, &quot;reportgrp&quot;,&quot;1&quot;)<br />
stpapi.put.field(&quot;tdilc4201m000&quot;, &quot;spool.fileout&quot;, &quot;c:\goba.txt&quot;)<br />
stpapi.set.report(&quot;tdilc4201m000&quot;, &quot;rtdilc420101000&quot;,&quot;ASCIF&quot;,w.err.msg)<br />
if isspace(w.err.msg) then<br />
  stpapi.continue.process(&quot;tdilc4201m000&quot;,w.err.msg)<br />
|else<br />
|stpapi.recover(&quot;tdilc4201m000&quot;, recover.msg)<br />
endif<br />
stpapi.end.session(&quot;tdilc4201m000&quot;)<br />
<br />
Had written code is working fine because the functionality of the session tdilc4201m000 is working, tested too.  <br />
No error occured while debugging. But cant able to take print out.<br />
Can some one help me.<br />
<br />
Rgds</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">4th March 2004, 15:34</div></div><div class="posttext">I do not put these fields:<br />
stpapi.put.field( &quot;tdilc4201m000&quot;, &quot;reportgrp&quot;,&quot;1&quot;)<br />
stpapi.put.field(&quot;tdilc4201m000&quot;, &quot;spool.fileout&quot;, &quot;c:\goba.txt&quot;)<br />
<br />
I would comment out those lines and just use:<br />
<br />
spool.fileout = &quot;c:\goba.txt&quot;<br />
<br />
<br />
Mark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Jothilingam</div><div class="date">4th March 2004, 17:14</div></div><div class="posttext">Mark<br />
<br />
Tried even comment these lines but still could not able to print<br />
<br />
Rgds</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">4th March 2004, 18:20</div></div><div class="posttext">Have you tried sending this to the display?  Below is my code for inbound.  This code works and creates files out in the $BSE/tmp environment.<br />
<br />
Mark<br />
Calling Code:<br />
<br />
		spool.device = &quot;ASCIF&quot;<br />
		spool.fileout = creat.tmp.file$(bse.tmp.dir$())<br />
		generate_inbound(in.emno,<br />
			in.reno,<br />
			in.order,<br />
			tdpur041.cwar,<br />
			errmsg)<br />
		if not isspace(errmsg) then<br />
			message(errmsg)<br />
			choice.again()<br />
		endif<br />
	endselect<br />
<br />
<br />
<br />
Subroutine:<br />
<br />
function extern generate_inbound(	domain	tcmcs.str12	runnumber,<br />
					domain	tcrcno		receipt.number,<br />
					domain  tcorno		purchase.order,<br />
					domain	tccwar		purchase.cwar,<br />
					ref     string          msg())<br />
{<br />
	msg = &quot;&quot;<br />
	stpapi.put.field(&quot;tdilc4203m000&quot;,&quot;runnumber&quot;,runnumber)<br />
	stpapi.put.field(&quot;tdilc4203m000&quot;,&quot;koor.t&quot;,str$(tdilc.kooa.act.pmg))<br />
	stpapi.put.field(&quot;tdilc4203m000&quot;,&quot;reno.f&quot;,str$(receipt.number))<br />
	stpapi.put.field(&quot;tdilc4203m000&quot;,&quot;reno.t&quot;,str$(receipt.number))<br />
	stpapi.put.field(&quot;tdilc4203m000&quot;,&quot;cwar.f&quot;,purchase.cwar)<br />
	stpapi.put.field(&quot;tdilc4203m000&quot;,&quot;cwar.t&quot;,purchase.cwar)<br />
	stpapi.put.field(&quot;tdilc4203m000&quot;,&quot;orno.f&quot;,str$(purchase.order))<br />
	stpapi.put.field(&quot;tdilc4203m000&quot;,&quot;orno.t&quot;,str$(purchase.order))<br />
	stpapi.put.field(&quot;tdilc4203m000&quot;,&quot;print.recom&quot;,str$(tcyesno.yes))<br />
	stpapi.set.report(&quot;tdilc4203m000&quot;,&quot;rtdilc420301000&quot;,spool.device,msg)<br />
	if isspace(msg) then<br />
		stpapi.continue.process(&quot;tdilc4203m000&quot;,msg)<br />
		stpapi.get.mess.code(&quot;tdilc4203m000&quot;,msg)<br />
	endif<br />
	stpapi.end.session(&quot;tdilc4203m000&quot;)<br />
}</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Jothilingam</div><div class="date">5th March 2004, 08:19</div></div><div class="posttext">I tried like this... but still I was not able to get the output<br />
thru afs log, I confirmed the values which I passed to the session fields are correct, I doubt on report group, this session as two groups, one for shortage and for advice, if the reports are controlled on the program script, I thinks its difficult to have control through AFS.<br />
<br />
spool.device = &quot;ASCIF&quot;<br />
spool.fileout = creat.tmp.file$(bse.tmp.dir$())<br />
stpapi.put.field( &quot;tdilc4201m000&quot;, &quot;runnumber&quot;, str$(10))<br />
stpapi.put.field( &quot;tdilc4201m000&quot;, &quot;koor.f&quot;, str$(etol(tdilc.koob.act.sls)))<br />
stpapi.put.field( &quot;tdilc4201m000&quot;, &quot;koor.t&quot;, str$(etol(tdilc.koob.act.pmg)))<br />
stpapi.put.field( &quot;tdilc4201m000&quot;, &quot;cuno.f&quot;, &quot;&quot; )<br />
stpapi.put.field( &quot;tdilc4201m000&quot;, &quot;cuno.t&quot;, &quot;ZZZZZZ&quot; )<br />
stpapi.put.field( &quot;tdilc4201m000&quot;, &quot;orno.f&quot;, str$(0))<br />
stpapi.put.field( &quot;tdilc4201m000&quot;, &quot;orno.t&quot;, str$(999999))<br />
stpapi.put.field( &quot;tdilc4201m000&quot;, &quot;opno.f&quot;, str$(0))<br />
stpapi.put.field( &quot;tdilc4201m000&quot;, &quot;opno.t&quot;, str$(999))<br />
stpapi.put.field( &quot;tdilc4201m000&quot;, &quot;prdt.t&quot;, str$(prodt))<br />
stpapi.put.field( &quot;tdilc4201m000&quot;, &quot;ddat.f&quot;, &quot;&quot;)<br />
stpapi.put.field( &quot;tdilc4201m000&quot;, &quot;ddat.t&quot;, str$(prodt))<br />
stpapi.put.field( &quot;tdilc4201m000&quot;, &quot;cprj.f&quot;, &quot;&quot;)<br />
stpapi.put.field( &quot;tdilc4201m000&quot;, &quot;cprj.t&quot;, &quot;ZZZZZZ&quot;)<br />
stpapi.put.field( &quot;tdilc4201m000&quot;, &quot;item.f&quot;, &quot;                &quot;)<br />
stpapi.put.field( &quot;tdilc4201m000&quot;, &quot;item.t&quot;, &quot;ZZZZZZZZZZZZZZZZ&quot;)<br />
stpapi.put.field( &quot;tdilc4201m000&quot;, &quot;cntr.f&quot;, &quot;&quot;)<br />
stpapi.put.field( &quot;tdilc4201m000&quot;, &quot;cntr.t&quot;, &quot;ZZZ&quot;)<br />
stpapi.put.field( &quot;tdilc4201m000&quot;, &quot;cwar.f&quot;, &quot;&quot;)<br />
stpapi.put.field( &quot;tdilc4201m000&quot;, &quot;cwar.t&quot;, &quot;ZZZ&quot;)<br />
stpapi.put.field( &quot;tdilc4201m000&quot;, &quot;crte.f&quot;, &quot;&quot;)<br />
stpapi.put.field( &quot;tdilc4201m000&quot;, &quot;crte.t&quot;, &quot;ZZZZZ&quot;)<br />
stpapi.put.field( &quot;tdilc4201m000&quot;, &quot;print.recom&quot;, str$(etol(tcyesno.no)))<br />
stpapi.put.field( &quot;tdilc4201m000&quot;, &quot;prnt.shortage&quot;,str$(etol(tcyesno.yes)))<br />
stpapi.put.field( &quot;tdilc4201m000&quot;, &quot;order.prio&quot;,str$(etol(tdilc.koob.act.sls)))<br />
stpapi.put.field( &quot;tdilc4201m000&quot;, &quot;order.prio&quot;,str$(etol(tdilc.koob.act.sfc)),2)<br />
stpapi.put.field( &quot;tdilc4201m000&quot;, &quot;order.prio&quot;,str$(etol(tdilc.koob.pcs.wrh)),3)<br />
stpapi.put.field( &quot;tdilc4201m000&quot;, &quot;order.prio&quot;,str$(etol(tdilc.koob.act.sma)),4)<br />
stpapi.put.field( &quot;tdilc4201m000&quot;, &quot;order.prio&quot;,str$(etol(tdilc.koob.act.rpl)),5)<br />
stpapi.put.field( &quot;tdilc4201m000&quot;, &quot;order.prio&quot;,str$(etol(tdilc.koob.act.pmg)),7)<br />
stpapi.set.report(&quot;tdilc4201m000&quot;, &quot;rtdilc420101000&quot;,spool.device,w.err.msg)<br />
if isspace(w.err.msg) then<br />
 stpapi.continue.process(&quot;tdilc4201m000&quot;,w.err.msg)<br />
|else<br />
|	stpapi.recover(&quot;tdilc4201m000&quot;, recover.msg)<br />
endif<br />
stpapi.end.session(&quot;tdilc4201m000&quot;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">5th March 2004, 15:35</div></div><div class="posttext">I did just notice that you have print.recom set to no and prnt.shortage to yes.  Yet you set the report to &quot;rtdilc420101000&quot;, wouldn't the shortage report really be &quot;rtdilc420102000&quot;.  Not sure if that will fix your problem.<br />
<br />
I have had problems with sessions that print multiple reports before. Do you own source code? If so you could probably fix the Baan code using &quot;if api.mode then&quot; type statements.<br />
<br />
I think the next set of code I will be working on is the outbound session, probably in the next month or so.  Not sure yet.<br />
<br />
<br />
Mark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Jothilingam</div><div class="date">8th March 2004, 10:23</div></div><div class="posttext">Mark<br />
<br />
I had did the testing of keeping print.recome/prnt.shorage - yes as well as no but it was not of use, yeah we own source code, I already gone through but could able to fix it, once again I will go through.<br />
<br />
Rgds</div></div><hr />



</div>
</body>
</html>