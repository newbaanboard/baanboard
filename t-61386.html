<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="AFS: Session not available, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] AFS: Session not available AFS/DDC/OLE: Function servers" />
	
	<title>AFS: Session not available [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="index.html">Newbaanboard</a> &gt; <a href="index.html">Baan SIGs</a> &gt; <a href="index.html">AFS/DDC/OLE: Function servers</a> &gt; AFS: Session not available</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">Nicole</div><div class="date">26th October 2011, 12:10</div></div><div class="posttext">Hi all,<br />
<br />
I try the following statement:<br />
<br />
        stpapi.put.field (&quot;tswty3102m000&quot;, &quot;tswty102.nlhl&quot;, e.nlhl)<br />
        stpapi.put.field (&quot;tswty3102m000&quot;, &quot;tswty102.idat&quot;, str$(e.idat))<br />
        stpapi.put.field (&quot;tswty3102m000&quot;, &quot;tswty102.ddat&quot;, str$(e.idat))<br />
        stpapi.put.field (&quot;tswty3102m000&quot;, &quot;tswty102.cins&quot;, e.cins)<br />
        stpapi.put.field (&quot;tswty3102m000&quot;, &quot;tswty102.clot&quot;, e.cins)<br />
        stpapi.put.field (&quot;tswty3102m000&quot;, &quot;tswty102.ctyp&quot;, tswty102.citg)<br />
        stpapi.put.field (&quot;tswty3102m000&quot;, &quot;tswty102.cloc&quot;, e.cloc)<br />
        stpapi.put.field (&quot;tswty3102m000&quot;, &quot;tswty102.ilog&quot;, logname$)<br />
        stpapi.put.field (&quot;tswty3102m000&quot;, &quot;tswty102.iidt&quot;, str$(date.num()))<br />
        stpapi.put.field (&quot;tswty3102m000&quot;, &quot;tswty102.iitm&quot;, str$(time.num()))<br />
        retval1 = stpapi.insert (&quot;tswty3102m000&quot;, true, err.msg)<br />
        if not retval1 then<br />
                retval2 = stpapi.recover (&quot;tswty3102m000&quot;, rec.msg)<br />
        endif<br />
<br />
        stpapi.end.session (&quot;tswty3102m000&quot;)<br />
<br />
<br />
<br />
Variable err.msg contains the message &quot;Session not available&quot;. No record was inserted. What can be the reason for this message?<br />
<br />
Thanks.<br />
<br />
Nicole</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">26th October 2011, 15:44</div></div><div class="posttext">It looks simple enough and there can be multiple reasons that &quot;Session not available&quot; pops up.  Also make sure all the input fields are strings - usually something like ctyp is an enumerated domain.  So you can use str$(tcyesno.yes) or str$(tswty102.citg) on something like it.<br />
<br />
If the above does not work and this is a session you developed or one you have source code for.  What I would recommend is putting tswty3102m000 in debug mode.  The very first stpapi.put should start the session in debug mode.  You can step thru both the session and the stpapi code to see where the issue is.</div></div><hr />



</div>
</body>
</html>