<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="Not able to start tdinv3220m000 through AFS, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] Not able to start tdinv3220m000 through AFS AFS/DDC/OLE: Function servers" />
	
	<title>Not able to start tdinv3220m000 through AFS [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="index.html">Newbaanboard</a> &gt; <a href="index.html">Baan SIGs</a> &gt; <a href="index.html">AFS/DDC/OLE: Function servers</a> &gt; Not able to start tdinv3220m000 through AFS</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">prademaker</div><div class="date">25th November 2008, 15:23</div></div><div class="posttext">Try to start session tdinv3220m000 using AFS.<br />
<br />
After the stapi.continue.process I get an error &quot;Process is gone&quot;.<br />
<br />
Here's the code I use, anyone an idea what goes wrong?<br />
<br />
function auto.fiatteer( domain tcsuno i.suno, domain tcmcs.str16 i.queu )<br />
{	<br />
	string	msg(80)<br />
	stpapi.put.field( &quot;tdinv3220m000&quot;, &quot;orno.f&quot;, &quot;0&quot;)<br />
	stpapi.put.field( &quot;tdinv3220m000&quot;, &quot;orno.t&quot;, &quot;999999&quot;)<br />
	stpapi.put.field( &quot;tdinv3220m000&quot;, &quot;item.f&quot;, &quot;                &quot;)<br />
	stpapi.put.field( &quot;tdinv3220m000&quot;, &quot;item.t&quot;, &quot;ZZZZZZZZZZZZZZZZ&quot;)<br />
	stpapi.put.field( &quot;tdinv3220m000&quot;, &quot;cntr.f&quot;, &quot;   &quot;)<br />
	stpapi.put.field( &quot;tdinv3220m000&quot;, &quot;cntr.t&quot;, &quot;ZZZ&quot;)<br />
	stpapi.put.field( &quot;tdinv3220m000&quot;, &quot;citg.f&quot;, &quot;      &quot;)<br />
	stpapi.put.field( &quot;tdinv3220m000&quot;, &quot;citg.t&quot;, &quot;ZZZZZZ&quot;)<br />
	stpapi.put.field( &quot;tdinv3220m000&quot;, &quot;cwar.f&quot;, &quot;   &quot;)<br />
	stpapi.put.field( &quot;tdinv3220m000&quot;, &quot;cwar.t&quot;, &quot;ZZZ&quot;)<br />
	stpapi.put.field( &quot;tdinv3220m000&quot;, &quot;suno.f&quot;, i.suno )<br />
	stpapi.put.field( &quot;tdinv3220m000&quot;, &quot;suno.t&quot;, i.suno )<br />
	stpapi.put.field( &quot;tdinv3220m000&quot;, &quot;buyr.f&quot;, &quot;0&quot;)<br />
	stpapi.put.field( &quot;tdinv3220m000&quot;, &quot;buyr.t&quot;, &quot;999999&quot;)<br />
	stpapi.put.field( &quot;tdinv3220m000&quot;, &quot;cplb.f&quot;, &quot;0&quot;)<br />
	stpapi.put.field( &quot;tdinv3220m000&quot;, &quot;cplb.t&quot;, &quot;999999&quot;)<br />
	stpapi.put.field( &quot;tdinv3220m000&quot;, &quot;ncmp.f&quot;, &quot;0&quot;)<br />
	stpapi.put.field( &quot;tdinv3220m000&quot;, &quot;ncmp.t&quot;, &quot;999&quot;)<br />
	stpapi.put.field( &quot;tdinv3220m000&quot;, &quot;sorn.f&quot;, &quot;0&quot;)<br />
	stpapi.put.field( &quot;tdinv3220m000&quot;, &quot;sorn.t&quot;, &quot;999999&quot;)<br />
	stpapi.put.field( &quot;tdinv3220m000&quot;, &quot;srvo.f&quot;, &quot;0&quot;)<br />
	stpapi.put.field( &quot;tdinv3220m000&quot;, &quot;srvo.t&quot;, &quot;999999&quot;)<br />
 	stpapi.put.field( &quot;tdinv3220m000&quot;, &quot;tdinv310.orno&quot;, &quot;0&quot;)<br />
	stpapi.set.report(&quot;tdinv3220m000&quot;, &quot;rtdinv322001000&quot;, i.queu, msg )<br />
 <br />
	if strip$(msg) &gt; &quot;&quot; then<br />
		message(msg &amp; &quot; na set report &quot;)<br />
	endif<br />
		stpapi.continue.process(&quot;tdinv3220m000&quot;,msg)<br />
 	if strip$(msg) &gt; &quot;&quot; then<br />
		message(msg &amp; &quot; na continue.process&quot;)<br />
	endif<br />
	stpapi.end.session(&quot;tdinv3220m000&quot;)	<br />
}<br />
<br />
Your help is much appreciated!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">_Ralph_</div><div class="date">25th November 2008, 17:16</div></div><div class="posttext">not sure about what the cont.process of this session do, but maybe a stpapi.handle.subproc can solve the problem.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">26th November 2008, 02:29</div></div><div class="posttext">The most important question is - do you get the report?  If the session works then ignore the message.  What exactly does the session do?  When running the session does it zoom or anything to another session?  From what you posted it looks like a simple report session, but becuse of the 2 in the session name it makes me think it does something else.  The session bombs the minute I try to run it on our system.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">prademaker</div><div class="date">26th November 2008, 08:48</div></div><div class="posttext">Ignoring the message is the thing to do!<br />
<br />
Session is a standard Baan session, approving planned purchase requests.<br />
The report is an exception report, so usually no output.<br />
However I checked and the purchase requests did get approved.<br />
The session exits automatically. So my guess is that the message after the continue.process is because of this exit.<br />
<br />
Thansk for you input.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">26th November 2008, 18:02</div></div><div class="posttext">Ignoring the message is the thing to do!<br />
<br />
Session is a standard Baan session, approving planned purchase requests.<br />
The report is an exception report, so usually no output.<br />
However I checked and the purchase requests did get approved.<br />
The session exits automatically. So my guess is that the message after the continue.process is because of this exit.<br />
<br />
Thansk for you input.<br />
<br />
Now that makes sense.  I have a couple of sessions that end automatically and I get the same type error.  I had to code around.  Glad it is working.</div></div><hr />



</div>
</body>
</html>