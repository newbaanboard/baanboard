<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="AFS for session tfcmg2120s000 error -  &quot;Insert not allowed for this group&quot;, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] AFS for session tfcmg2120s000 error -  &quot;Insert not allowed for this group&quot; AFS/DDC/OLE: Function servers" />
	
	<title>AFS for session tfcmg2120s000 error -  &quot;Insert not allowed for this group&quot; [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="index.html">Newbaanboard</a> &gt; <a href="index.html">Baan SIGs</a> &gt; <a href="index.html">AFS/DDC/OLE: Function servers</a> &gt; AFS for session tfcmg2120s000 error -  &quot;Insert not allowed for this group&quot;</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">sandeepsharma</div><div class="date">15th April 2009, 09:09</div></div><div class="posttext">Hi friends,<br />
<br />
I am getting an error &quot;Insert not allowed for this group&quot; while inserting the data through afs.<br />
I am using the following code:<br />
<br />
	stpapi.put.field( &quot;tfcmg2120s000&quot;, &quot;tfgld102.cono&quot;, str$(comp) ) <br />
	stpapi.put.field( &quot;tfcmg2120s000&quot;, &quot;tfgld102.year&quot;, str$(yr) )<br />
	stpapi.put.field( &quot;tfcmg2120s000&quot;, &quot;tfgld102.btno&quot;, str$(btno) )<br />
	stpapi.put.field( &quot;tfcmg2120s000&quot;, &quot;tfgld102.ttyp&quot;, ttyp )<br />
	stpapi.put.field( &quot;tfcmg2120s000&quot;, &quot;tfgld102.docn&quot;, str$(docn) )   <br />
	stpapi.put.field( &quot;tfcmg2120s000&quot;, &quot;tfgld102.lino&quot;, str$(1) ) <br />
	stpapi.put.field( &quot;tfcmg2120s000&quot;, &quot;tfgld102.serl&quot;, str$(1) ) <br />
	stpapi.put.field( &quot;tfcmg2120s000&quot;, &quot;tfgld102.srno&quot;, str$(1) )<br />
	stpapi.put.field( &quot;tfcmg2120s000&quot;, &quot;tfgld102.tcom&quot;, str$(comp) )<br />
	stpapi.put.field( &quot;tfcmg2120s000&quot;, &quot;tfgld102.leac&quot;, tficc962.leac )<br />
	stpapi.put.field( &quot;tfcmg2120s000&quot;, &quot;tfgld102.dim1&quot;, tficc962.dim1 )<br />
	stpapi.put.field( &quot;tfcmg2120s000&quot;, &quot;tfgld102.dim2&quot;, tficc962.dim2 )<br />
	stpapi.put.field( &quot;tfcmg2120s000&quot;, &quot;tfgld102.dim3&quot;, tficc962.dim3 )<br />
	stpapi.put.field( &quot;tfcmg2120s000&quot;, &quot;tfgld102.amnt&quot;, str$(tficc962.amnt) )<br />
	stpapi.put.field( &quot;tfcmg2120s000&quot;, &quot;tfgld102.dbcr&quot;, str$(etol(tficc962.dbcr) ))<br />
	stpapi.put.field( &quot;tfcmg2120s000&quot;, &quot;tfgld102.fyer&quot;, str$(yr) )<br />
	stpapi.put.field( &quot;tfcmg2120s000&quot;, &quot;tfgld102.fprd&quot;, str$(period) )<br />
	stpapi.put.field( &quot;tfcmg2120s000&quot;, &quot;tfgld102.vyer&quot;, str$(yr) )<br />
	stpapi.put.field( &quot;tfcmg2120s000&quot;, &quot;tfgld102.vprd&quot;, str$(tax.period) )<br />
	stpapi.put.field( &quot;tfcmg2120s000&quot;, &quot;tfgld102.refr&quot;, str$(tficc962.refr) )<br />
	ret = stpapi.insert( &quot;tfcmg2120s000&quot;, do.update, error )<br />
	if isspace(error) then<br />
		ret = stpapi.save( &quot;tfcmg2120s000&quot;, error )<br />
	else<br />
		message(&quot;%s&quot;,error)<br />
	endif	<br />
	stpapi.end.session( &quot;tfcmg2120s000&quot; )<br />
<br />
<br />
<br />
<br />
regards,<br />
Sandeep</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">15th April 2009, 15:11</div></div><div class="posttext">Are you calling this session directly or through a main session? Can you get the message number and maybe track it to a specific field? I am just wondering if cono, year and btno are needed - should come from the main session.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sandeepsharma</div><div class="date">16th April 2009, 07:00</div></div><div class="posttext">Hi,<br />
<br />
Yeah  i am calling this session from session tfcmg2100s000 which in turn is called from tfgld1101m000.<br />
<br />
<br />
Sandeep</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">17th April 2009, 23:06</div></div><div class="posttext">What happens if you remove those fields?  Have you tracked the error to one specific field on the form?  I see nothing else out of the ordinary.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sandeepsharma</div><div class="date">18th April 2009, 10:15</div></div><div class="posttext">Hi Mark,<br />
<br />
Actually i am facing a different issue now. AFS recognises TAB command, but in tfcmg2100s000 we need to do a mouse click if we want to generate new document in the same batch.<br />
<br />
  Is this possible?????<br />
<br />
<br />
thanks<br />
Sandeep</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">21st April 2009, 15:52</div></div><div class="posttext">As far as I know AFS does not recognize a tab command. There is not a api command to simulate tab - so you can't enter a field and execute a tab.  Certain events are just not processed in AFS.  As for &quot;a mouse click&quot; - are you clicking a button? If you click on a button then you should be able to activate that button with an API command or in some cases just a continue.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sandeepsharma</div><div class="date">22nd April 2009, 06:58</div></div><div class="posttext">Hi,<br />
<br />
By recognisation of TAB, i mean to say that we can only fill all those fields through AFS which we TAB through while navigating through a session .<br />
<br />
Now in tfcmg2100s000, when i want to enter a new document in the same batch in order to get the new document number  i have to go to field Document(tfcmg204.docn) and do a mouse click over there otherwise the session by default gives me the 2nd line of the previous document of the same batch.<br />
<br />
<br />
Please suggest is there a way to do this through AFS?<br />
<br />
<br />
Thanks<br />
Sandeep</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">22nd April 2009, 16:56</div></div><div class="posttext">Lots of things to try, but without know the session I am not sure what will help. First only put those fields that you would normally put. docn will be generated. After putting the fields try the insert. If that does not work try update, followed by a save. If you have source it makes it easier since you can debug the session to see which command would work.  In my case I just play with the various commands until I figure out the correct sequence.</div></div><hr />



</div>
</body>
</html>