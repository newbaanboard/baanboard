<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="Sales Forecast, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] Sales Forecast AFS/DDC/OLE: Function servers" />
	
	<title>Sales Forecast [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="index.html">Newbaanboard</a> &gt; <a href="index.html">Baan SIGs</a> &gt; <a href="index.html">AFS/DDC/OLE: Function servers</a> &gt; Sales Forecast</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">cherokee</div><div class="date">21st January 2005, 21:31</div></div><div class="posttext">Hello everyone,<br />
<br />
I am haveing problems with this session timrp1101m000, even the record key does not exits(item,date), it gives back error &quot;Record already exist&quot; and does saves.<br />
<br />
<br />
stpapi.put.field(&quot;timrp1101m000&quot;,&quot;timrp001.item&quot;,t.item)<br />
		stpapi.put.field(&quot;timrp1101m000&quot;,&quot;timrp001.cntr&quot;,dummy.cuni)<br />
		stpapi.put.field(&quot;timrp1101m000&quot;,&quot;timrp001.fdat&quot;,str$(t.date))<br />
		stpapi.put.field(&quot;timrp1101m000&quot;,&quot;timrp001.fqan&quot;,str$(fqan))<br />
		stpapi.insert(&quot;timrp1101m000&quot;,true,error)<br />
		if not isspace(error) then<br />
			stpapi.recover(&quot;tiitm1101m000&quot;,error)<br />
		endif<br />
		stpapi.end.session(&quot;timrp1101m000&quot;)<br />
<br />
Can you see any problem with this coding?<br />
<br />
Thanks in advance,<br />
<br />
Carlos</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">21st January 2005, 22:49</div></div><div class="posttext">Try this before your code:<br />
<br />
<br />
	stpapi.put.field(&quot;timrp1101m000&quot;,&quot;timrp001.item&quot;,t.item)<br />
	stpapi.put.field(&quot;timrp1101m000&quot;,&quot;timrp001.cntr&quot;,&quot;&quot;)<br />
	stpapi.change.view( &quot;timrp1101m000&quot; )<br />
<br />
<br />
This is how I typically do these type multi-occurance sessions.  This is based off my system where item and cuni are the view fields.<br />
<br />
<br />
Mark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">cherokee</div><div class="date">24th January 2005, 15:52</div></div><div class="posttext">Mark,<br />
<br />
Thanks it does work perfectly!.<br />
<br />
Carlos</div></div><hr />



</div>
</body>
</html>