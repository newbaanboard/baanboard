<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="Wrong document number, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] Wrong document number AFS/DDC/OLE: Function servers" />
	
	<title>Wrong document number [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="index.html">Newbaanboard</a> &gt; <a href="index.html">Baan SIGs</a> &gt; <a href="index.html">AFS/DDC/OLE: Function servers</a> &gt; Wrong document number</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">PeterH</div><div class="date">15th July 2005, 15:39</div></div><div class="posttext">Hello all, <br />
<br />
Thanx to Marc_h script, I've created a script to insert sales invoices, tfacr1110s000 followed by tfacr1111s000 and tpppc3101m000. If i use a transactiontype with documents in fixed sequence is no, and use the following script, then I get documentnumber 1 from BaaN back instead off the value for fact.nr.<br />
<br />
	stpapi.handle.subproc(&quot;tfgld1101m000&quot;, &quot;tfacr1110s000&quot;, &quot;add&quot;) <br />
	stpapi.continue.process(&quot;tfgld1101m000&quot;, errmsg) <br />
	stpapi.put.field(&quot;tfacr1110s000&quot;, &quot;tfacr200.cuno&quot;, str$(fact.cuno)) <br />
	|stpapi.put.field(&quot;tfacr1110s000&quot;, &quot;tfacr200.ttyp&quot;, &quot;VKT&quot;) <br />
	stpapi.put.field(&quot;tfacr1110s000&quot;, &quot;tfacr200.ttyp&quot;, &quot;VKA&quot;)<br />
	stpapi.put.field(&quot;tfacr1110s000&quot;, &quot;tfacr200.nivn&quot;, str$(fact.nr))	<br />
	stpapi.put.field(&quot;tfacr1110s000&quot;, &quot;screen.amnt&quot;, str$(fact.brto)) <br />
	value = &quot;TOS &quot; &amp; str$(fact.nr) <br />
	stpapi.put.field(&quot;tfacr1110s000&quot;, &quot;tfacr200.refr&quot;, value) <br />
	stpapi.put.field(&quot;tfacr1110s000&quot;, &quot;tfacr200.cvat&quot;, str$(fact.cvat))<br />
	stpapi.put.field(&quot;tfacr1110s000&quot;, &quot;tfacr200.proj&quot;, str$(fact.cprj))<br />
	ret = stpapi.insert(&quot;tfacr1110s000&quot;, false, errmsg) <br />
	if ret = 1 then<br />
		e = stpapi.save(&quot;tfacr1110s000&quot;, errmsg)<br />
		|*<br />
		|* mutaties Verkoopfacturen muteren<br />
		|*<br />
		fact.leac = &quot;380200&quot;<br />
		  stpapi.handle.subproc  (&quot;tfacr1110s000&quot;, &quot;tfacr1111s000&quot;, &quot;add&quot;) <br />
		stpapi.put.field(&quot;tfacr1111s000&quot;, &quot;tfgld102.leac&quot;, str$(fact.leac))<br />
	<br />
<br />
Is there somebody out there who faced a similar problem and solved it???<br />
<br />
THANX<br />
Peter.</div></div><hr />



</div>
</body>
</html>