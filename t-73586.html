<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="VBA NO RESPONSE tipcs2150m000, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] VBA NO RESPONSE tipcs2150m000 AFS/DDC/OLE: Function servers" />
	
	<title>VBA NO RESPONSE tipcs2150m000 [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="index.html">Newbaanboard</a> &gt; <a href="index.html">Baan SIGs</a> &gt; <a href="index.html">AFS/DDC/OLE: Function servers</a> &gt; VBA NO RESPONSE tipcs2150m000</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">hariharan_94</div><div class="date">1st December 2020, 16:00</div></div><div class="posttext">Hi <br />
I am trying to automate the BOM Customization, i am new to BAAN OLE <br />
i write below codes , I have no problem to opening session &quot;tipcs2150m000&quot; but when i try to find a particular project there is no response  from the VBA.<br />
<br />
can anyone help me to solve problem ?<br />
I am using BaaN IV<br />
Here is my code,<br />
<br />
Set BaanObj = CreateObject(&quot;Baan4.Application.Baan&quot;)<br />
BaanObj.Timeout = 2<br />
On Error GoTo BaanAutomationError<br />
i = 2<br />
j = 1<br />
BaanObj.ParseExecFunction &quot;ottstpstandard&quot;, &quot;zoom.to.menu(&quot; &amp; Chr(34) &amp; &quot;tipcs2150m000&quot; &amp; Chr(34) &amp; &quot;,2,&quot; &amp; Chr(34) &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; Chr(34) &amp; &quot;,0,0)&quot;<br />
BaanObj.ParseExecFunction &quot;ottstpapihand&quot;, &quot;stpapi.put.field(&quot; &amp; Chr(34) &amp; &quot;tipcs2150m000&quot; &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; &quot;tipcs022.cprj&quot; &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; &quot;ZB0002&quot; &amp; Chr(34) &amp; &quot;)&quot;<br />
BaanObj.ParseExecFunction &quot;ottstpapihand&quot;, &quot;stpapi.put.field(&quot; &amp; Chr(34) &amp; &quot;tipcs2150m000&quot; &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; &quot;tipcs022.mitm&quot; &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; &quot;TEST&quot; &amp; Chr(34) &amp; &quot;)&quot;<br />
BaanObj.ParseExecFunction &quot;ottstpapihand&quot;, &quot;stpapi.put.field(&quot; &amp; Chr(34) &amp; &quot;tipcs2150m000&quot; &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; &quot;tipcs022.pono&quot; &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; &quot; &quot; &amp; Chr(34) &amp; &quot;)&quot;<br />
BaanObj.ParseExecFunction &quot;ottstpapihand&quot;, &quot;stpapi.find(&quot; &amp; Chr(34) &amp; &quot;tipcs2150m000&quot; &amp; Chr(34) &amp; &quot;)&quot;<br />
<br />
<br />
Thanks in Advance !!!!<br />
Hari</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">1st December 2020, 18:58</div></div><div class="posttext">About the only time I tested this is in this thread http://www.baanboard.com/baanboard/showthread.php?t=70381&amp;highlight=OLE+stpapi.find.  Not sure why you zoom.to.menu I don't recall having to do anything like that.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">vinceco252</div><div class="date">1st December 2020, 21:56</div></div><div class="posttext">I found the best way to use the OLE stuff was to write a custom session to call from VBA that has relatively simple function calls (i.e., pass x number of arguments), then do the more complex processing within the custom sesssion/Baan.<br />
<br />
Vince</div></div><hr />


<div class="post"><div class="posttop"><div class="username">hariharan_94</div><div class="date">10th December 2020, 14:52</div></div><div class="posttext">About the only time I tested this is in this thread http://www.baanboard.com/baanboard/showthread.php?t=70381&amp;highlight=OLE+stpapi.find.  Not sure why you zoom.to.menu I don't recall having to do anything like that.<br />
<br />
Thank you Mark !!<br />
<br />
I have go through with your example. but there is no reponse from the BaaN. I think i am using the wrong DLL name. I don't know how the get the DLL name for this Session.<br />
<br />
Please check my code:<br />
<br />
Set BaanObj = CreateObject(&quot;Baan4.Application.Baan&quot;)<br />
BaanObj.Timeout = 5<br />
On Error GoTo BaanAutomationError<br />
SessionName$ = &quot;tipcs2150m000&quot;<br />
Commessa$ = &quot;tipcs022.cprj&quot;<br />
Commessavalue$ = &quot;ZB0002&quot;<br />
Fathercode$ = &quot;tipcs022.mitm&quot;<br />
Fathercodevalue$ = &quot;TEST&quot;<br />
Position$ = &quot;tipcs022.pono&quot;<br />
Positionvalue$ = &quot;10&quot;<br />
BaanObj.ParseExecFunction &quot;ottstpapihand&quot;, &quot;stpapi.put.field(&quot; &amp; Chr(34) &amp; SessionName$ &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; Commessa$ &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; Commessavalue$ &amp; Chr(34) &amp; &quot;)&quot;<br />
BaanObj.ParseExecFunction &quot;ottstpapihand&quot;, &quot;stpapi.put.field(&quot; &amp; Chr(34) &amp; SessionName$ &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; Fathercode$ &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; Fathercodevalue$ &amp; Chr(34) &amp; &quot;)&quot;<br />
BaanObj.ParseExecFunction &quot;ottstpapihand&quot;, &quot;stpapi.put.field(&quot; &amp; Chr(34) &amp; SessionName$ &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; Position$ &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; Positionvalue$ &amp; Chr(34) &amp; &quot;)&quot;<br />
BaanObj.ParseExecFunction &quot;ottstpapihand&quot;, &quot;stpapi.find(&quot; &amp; Chr(34) &amp; SessionName$ &amp; Chr(34) &amp; &quot;)&quot;<br />
BaanAutomationError:<br />
MsgBox &quot;Baan IV automation error: &quot; &amp; BaanObj.Error<br />
BaanObj.Quit<br />
Set BaanObj = Nothing<br />
Exit Sub<br />
<br />
<br />
Please help me to solve this issue. I am very new to Baan.<br />
<br />
Thanks in Advance</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">10th December 2020, 15:58</div></div><div class="posttext">I am not sure there would be a response. If you look at my sample right after I do a find I basically just get a field.  I never really used this method but just played with it a bit - I found it slow and not something my customers could really use with out me doing a whole lot of support. You can try searching excel and ole on this forum to see what others have done in the past.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">hariharan_94</div><div class="date">10th December 2020, 18:31</div></div><div class="posttext">I found the best way to use the OLE stuff was to write a custom session to call from VBA that has relatively simple function calls (i.e., pass x number of arguments), then do the more complex processing within the custom sesssion/Baan.<br />
<br />
Vince<br />
<br />
Hi Vince,<br />
<br />
Thanks for your Advice. <br />
<br />
Can you please give me any example code for calling custom session ?<br />
I am new to BaaN please help me to understand the concept.<br />
<br />
Thanks<br />
Hari</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">10th December 2020, 21:32</div></div><div class="posttext">See this thread http://www.baanboard.com/baanboard/showthread.php?t=774&amp;highlight=ole+automation - I posted a sample that calls a baan dll.<br />
<br />
The dll it calls is this - it basically ran AFS code on a home grown session. This was all tried back in the early 2000's but never used.<br />
<br />
|******************************************************************************<br />
|* psfc9475  0  VRC B40C c3 dev <br />
|* Generate Production Hours by Peg by Month<br />
|* hollandv<br />
|* 08-24-99 [07:53]<br />
|******************************************************************************<br />
|* Script Type: 4<br />
|******************************************************************************<br />
|****************************** DECLARATION SECTION ***************************<br />
| Declare api - not needed, just testing.<br />
        #pragma used dll ottstpapihand<br />
        #pragma nowarnings<br />
        #include &lt;bic_tt&gt;       |include tools functions<br />
	table	ttirou001<br />
	table	tticrp901<br />
<br />
| Script Fields<br />
	extern	string	tmp.file.name(1024)	| Temp file for input reading.<br />
	extern	string	tmp.rpt.name(1024)	| Temp file for output.<br />
	extern	long    inputfile		| File handler for inputfile<br />
	extern	long	rpt.temp.file		| Temp. report file before download to client<br />
        extern	long    rc			| return code/value<br />
        extern	long    reof			| return end of file<br />
        extern	long    rec.count		| Count records<br />
        extern	long    scan.ret		| Return from scan<br />
        extern	string  buff(32)		| Record buffer<br />
	extern	string	errmsg(100)<br />
<br />
| Fields to read into program.<br />
        extern  string  read.cprj(10),read.prog(10),read.cspa(10)<br />
<br />
| Project, program and CCN to run report by.<br />
	extern	domain	tppdm.cprj	find.cprj<br />
	extern	domain	tiprog.a	find.prog<br />
	extern	domain	tppdm.cspa	find.cspa<br />
<br />
	extern	domain	tcyrno		year.f <br />
	extern	domain	tcyrno		year.t<br />
	extern	domain	tcweek		date.f<br />
	extern 	domain	tcweek		date.t<br />
	extern	domain	tiperc		effi.rate<br />
	extern	domain	tisfc.dayp	salary.perc<br />
<br />
function extern domain tcbool sfcdll9475.process.records(<br />
				domain	tuole.data	comp,<br />
				domain	tccwoc		main.f, <br />
				domain	tccwoc		main.t,<br />
				domain	tccwoc		sub.f, <br />
				domain	tccwoc		sub.t,<br />
				domain	tcyrno		year.f,<br />
				domain	tcyrno		year.t,<br />
				domain	tcweek		date.f,<br />
				domain	tcweek		date.t,<br />
				domain	tiqbm2		effi.rate,<br />
				domain	tisfc.dayp	salary.perc,<br />
					string		input.file(1024),<br />
					string		report.file.name(1024),<br />
			ref	domain	tuole.data	commmsg)<br />
{<br />
	rc = switch.to.company(lval(comp))<br />
	input.file = strip$(input.file)<br />
	report.file.name = strip$(report.file.name)<br />
|Open input and log files - remember default is the home directory.<br />
        if(open_files(input.file)) then<br />
		return(true)<br />
        endif<br />
| set the parameters<br />
	spool.device = &quot;ASCIT&quot;  | Append to file<br />
        spool.fileout = tmp.rpt.name<br />
|Initialize cound<br />
	rec.count = 0<br />
        read.a.record()<br />
| Init Variables<br />
        while reof=0<br />
| Set error and read record.<br />
		scan.ret = string.scan(buff,<br />
                                        &quot;(%s,%s,%s)&quot;,<br />
                read.cprj,<br />
                read.prog,<br />
		read.cspa)                <br />
                if(scan.ret &lt;&gt; 3) then<br />
		        read.a.record()<br />
			continue<br />
                endif<br />
		rc = tt.align.according.domain(shiftl$(shiftr$(read.cprj)),find.cprj,&quot;tppdm.cprj&quot;)<br />
		rc = tt.align.according.domain(shiftl$(shiftr$(read.prog)),find.prog,&quot;tiprog.a&quot;)<br />
		rc = tt.align.according.domain(shiftl$(shiftr$(read.cspa)),find.cspa,&quot;tppdm.cspa&quot;)<br />
<br />
| Put Data for WC<br />
		f9415m000.put.main.f(main.f)<br />
		f9415m000.put.main.t(main.t)<br />
		f9415m000.put.sub.f(sub.f)<br />
		f9415m000.put.sub.t(sub.t)<br />
| Put date range<br />
		f9415m000.put.prnt.mnth(tcyesno.yes)<br />
		f9415m000.put.year.f(year.f)<br />
		f9415m000.put.week.f(date.f)<br />
		f9415m000.put.year.t(year.t)<br />
		f9415m000.put.week.t(date.t)<br />
| Put efficiency data<br />
		f9415m000.put.effi.rate(effi.rate/100)<br />
<br />
| Put to and from project<br />
		f9415m000.put.cprj.from(find.cprj)<br />
		f9415m000.put.cprj.to(find.cprj)<br />
<br />
| Put to and from CCN<br />
		f9415m000.put.cspa.from(find.cspa)<br />
		f9415m000.put.cspa.to(find.cspa)<br />
| To and From program<br />
		f9415m000.put.prog.from(find.prog)<br />
		f9415m000.put.prog.to(find.prog)<br />
		f9415m000.put.salary.perc(salary.perc)<br />
| Continue and init sub-session.<br />
                stpapi.set.report(&quot;tisfc9415m000&quot;,&quot;rtisfc941502220&quot;,spool.device,errmsg)<br />
                if(strip$(errmsg)&lt;&gt;&quot;&quot;) then<br />
		        read.a.record()<br />
			continue<br />
                endif<br />
                f9415m000.continue(errmsg)<br />
		if(strip$(errmsg)&lt;&gt;&quot;&quot;) then<br />
			commmsg = &quot;commmsg:&quot; &amp; errmsg<br />
       			f9415m000.end()<br />
			return(true)<br />
		endif<br />
|  Go get next record - if it exists<br />
	        read.a.record()<br />
        endwhile<br />
        rc = server2client(tmp.rpt.name, report.file.name,1)<br />
	if(rc) then<br />
		commmsg = &quot;commmsg:Bad destination txt file or location.&quot;<br />
	else<br />
		commmsg=&quot;commmsg:Done&quot;<br />
	endif<br />
	seq.unlink(tmp.rpt.name)<br />
	seq.unlink(tmp.file.name)<br />
| Stop and kill subsessions if they exist<br />
       	f9415m000.end()<br />
	return(true)<br />
}<br />
Function read.a.record()<br />
{<br />
        reof = 0<br />
        reof = seq.gets(buff,30,inputfile)<br />
	rec.count = rec.count + 1<br />
}<br />
<br />
function domain tcbool open_files(	string  input.file(1024))<br />
{<br />
<br />
        inputfile = seq.open(input.file,&quot;r&quot;)<br />
<br />
| Open PC file to make sure it exists.<br />
        inputfile = seq.open.local(input.file,&quot;r&quot;,0)<br />
        if(inputfile&lt;0) then<br />
| Remove our work file<br />
		return(true)<br />
        endif<br />
       	seq.close.local(inputfile)<br />
<br />
| Create temporary file to copy the PC file into.<br />
	tmp.file.name = creat.tmp.file$(bse.tmp.dir$())<br />
        tmp.file.name = strip$(tmp.file.name)<br />
<br />
| Copy PC file to server<br />
	rc = client2server(input.file,tmp.file.name,0)<br />
<br />
| Open Server file for processing.<br />
        inputfile = seq.open(tmp.file.name,&quot;r&quot;)<br />
        if(inputfile&lt;0) then<br />
		seq.unlink(tmp.file.name)<br />
		return(true)<br />
        endif<br />
<br />
<br />
| Open err file.<br />
| Create temporary file for report.<br />
	tmp.rpt.name = creat.tmp.file$(bse.tmp.dir$())<br />
        tmp.rpt.name = strip$(tmp.rpt.name)<br />
	return(false)<br />
}</div></div><hr />



</div>
</body>
</html>