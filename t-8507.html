<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="AFS - cisli2520m000, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] AFS - cisli2520m000 AFS/DDC/OLE: Function servers" />
	
	<title>AFS - cisli2520m000 [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="index.html">Newbaanboard</a> &gt; <a href="index.html">Baan SIGs</a> &gt; <a href="index.html">AFS/DDC/OLE: Function servers</a> &gt; AFS - cisli2520m000</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">vsevilla</div><div class="date">20th January 2003, 21:20</div></div><div class="posttext">Hi all<br />
<br />
I have a problem when i try insert a record the message that appear is &quot;Command Disabled&quot;.<br />
<br />
Baan Vc<br />
W2000<br />
SQLServer<br />
<br />
I have installed the latest solution of tools.<br />
<br />
Could you help me please<br />
<br />
This is my code<br />
<br />
<br />
      ret.code = stpapi.synchronize.dialog(&quot;cisli2520m000&quot;,&quot;add&quot;, err)<br />
      if ret.code then<br />
         stpapi.put.field(&quot;cisli2120s000&quot;, &quot;cisli220.sfcp&quot;, &quot;100&quot;)<br />
         stpapi.put.field(&quot;cisli2120s000&quot;, &quot;cisli220.scmp&quot;, &quot;100&quot;)<br />
         stpapi.put.field(&quot;cisli2120s000&quot;, &quot;cisli220.cofc&quot;, cofc)<br />
         stpapi.put.field(&quot;cisli2120s000&quot;, &quot;cisli220.date&quot;, str$(work.date))<br />
         stpapi.put.field(&quot;cisli2120s000&quot;, &quot;cisli220.refa&quot;, refa)<br />
         stpapi.put.field(&quot;cisli2120s000&quot;, &quot;cisli220.ofbp&quot;, ofbp)<br />
         stpapi.put.field(&quot;cisli2120s000&quot;, &quot;cisli220.itbp&quot;, ofbp)<br />
         stpapi.put.field(&quot;cisli2120s000&quot;, &quot;cisli220.pfbp&quot;, ofbp)<br />
         stpapi.put.field(&quot;cisli2120s000&quot;, &quot;cisli220.itoa&quot;, itoa)<br />
         stpapi.put.field(&quot;cisli2120s000&quot;, &quot;cisli220.stoa&quot;, itoa)<br />
         stpapi.put.field(&quot;cisli2120s000&quot;, &quot;cisli220.fcrt&quot;, &quot;6&quot;)<br />
         stpapi.put.field(&quot;cisli2120s000&quot;, &quot;cisli220.ratd&quot;, str$(work.date))<br />
         stpapi.put.field(&quot;cisli2120s000&quot;, &quot;cisli220.rate&quot;, &quot;1&quot;)<br />
         stpapi.put.field(&quot;cisli2120s000&quot;, &quot;cisli220.ratf&quot;, &quot;1&quot;)<br />
         stpapi.put.field(&quot;cisli2120s000&quot;, &quot;cisli220.rtyp&quot;, &quot;SLS&quot;)<br />
         stpapi.put.field(&quot;cisli2120s000&quot;, &quot;cisli220.ccur&quot;, &quot;ECU&quot;)<br />
         stpapi.put.field(&quot;cisli2120s000&quot;, &quot;cisli220.paym&quot;, &quot;CHD&quot;)<br />
         stpapi.put.field(&quot;cisli2120s000&quot;, &quot;cisli220.cpay&quot;, &quot;001&quot;)<br />
         stpapi.put.field(&quot;cisli2120s000&quot;, &quot;cisli220.ctyn&quot;, &quot;1&quot;)<br />
         stpapi.put.field(&quot;cisli2120s000&quot;, &quot;cisli220.subc&quot;, &quot;2&quot;)<br />
         ret.code = stpapi.insert(&quot;cisli2520m000&quot;, false, err)<br />
         if ret.code then<br />
            ret.code = stpapi.save(&quot;cisli2520m000&quot;,err)<br />
            if ret.code then<br />
            else<br />
               while true<br />
                  field = stpapi.get.mess.code(&quot;cisli2520m000&quot;, err)<br />
                  if isspace(err) then<br />
                     break<br />
                  endif<br />
               endwhile<br />
               ret.code = stpapi.recover(&quot;cisli2120s000&quot;,err)<br />
               err = err &amp; &quot; No se puede crear la Cabecera&quot;<br />
               write.err.record()<br />
            endif<br />
         else<br />
            while true<br />
               field = stpapi.get.mess.code(&quot;cisli2520m000&quot;, err)<br />
               if isspace(err) then<br />
                  break<br />
               endif<br />
            endwhile<br />
<br />
            ret.code = stpapi.recover(&quot;cisli2120s000&quot;,err)<br />
            err = err &amp; &quot; No se puede crear la Cabecera&quot;<br />
            write.err.record()<br />
         endif<br />
      endif<br />
   stpapi.end.session( &quot;cisli2520m000&quot; )<br />
<br />
<br />
Regards</div></div><hr />


<div class="post"><div class="posttop"><div class="username">lbencic</div><div class="date">20th January 2003, 23:15</div></div><div class="posttext">Can you say at which point the 'err' gets filled with that message?  Also, if you could update your post to show baan code, the formatting would take:<br />
<br />
like '' at the beginning and '' at the end.<br />
<br />
OOoo..I can't put it in without formatting!  Check the 'vB Code' help for how to format your code using the code=baan command in brackets at the top, and the /code command in brackets at the bottom.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">20th January 2003, 23:31</div></div><div class="posttext">I added the codes statements to the post - vsevilla should be able to edit his post and see my changes.<br />
<br />
I was just wondering if there was any code before the stpapi.synchronize.dialog box or can you just start out with this?  Anyway it seems to me that I have seen this in a couple of cases - the first was we needed an updated tools set. The second was when one session did not like insert, but was more than happy with just a save.  I am not sure if these apply since we are 4c3, but thought I would mention this.<br />
<br />
Mark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">vsevilla</div><div class="date">20th January 2003, 23:31</div></div><div class="posttext">the error appear at the insert line<br />
<br />
<br />
<br />
      ret.code = stpapi.synchronize.dialog(&quot;cisli2520m000&quot;,&quot;add&quot;, err)<br />
      if ret.code then<br />
         stpapi.clear(&quot;cisli2120s000&quot;)<br />
         stpapi.get.field(&quot;cisli2120s000&quot;, &quot;cisli220.msid&quot;, field)<br />
         stpapi.put.field(&quot;cisli2120s000&quot;, &quot;cisli220.sfcp&quot;, &quot;100&quot;)<br />
         stpapi.put.field(&quot;cisli2120s000&quot;, &quot;cisli220.scmp&quot;, &quot;100&quot;)<br />
         stpapi.put.field(&quot;cisli2120s000&quot;, &quot;cisli220.msid&quot;, &quot;11&quot;)<br />
         stpapi.put.field(&quot;cisli2120s000&quot;, &quot;cisli220.cofc&quot;, cofc)<br />
         stpapi.put.field(&quot;cisli2120s000&quot;, &quot;cisli220.date&quot;, str$(work.date))<br />
         stpapi.put.field(&quot;cisli2120s000&quot;, &quot;cisli220.refa&quot;, refa)<br />
         stpapi.put.field(&quot;cisli2120s000&quot;, &quot;cisli220.ofbp&quot;, ofbp)<br />
         stpapi.put.field(&quot;cisli2120s000&quot;, &quot;cisli220.itbp&quot;, ofbp)<br />
         stpapi.put.field(&quot;cisli2120s000&quot;, &quot;cisli220.pfbp&quot;, ofbp)<br />
         stpapi.put.field(&quot;cisli2120s000&quot;, &quot;cisli220.itoa&quot;, itoa)<br />
         stpapi.put.field(&quot;cisli2120s000&quot;, &quot;cisli220.stoa&quot;, itoa)<br />
         stpapi.put.field(&quot;cisli2120s000&quot;, &quot;cisli220.fcrt&quot;, &quot;6&quot;)<br />
         stpapi.put.field(&quot;cisli2120s000&quot;, &quot;cisli220.ratd&quot;, str$(work.date))<br />
         stpapi.put.field(&quot;cisli2120s000&quot;, &quot;cisli220.rate&quot;, &quot;1&quot;)<br />
         stpapi.put.field(&quot;cisli2120s000&quot;, &quot;cisli220.ratf&quot;, &quot;1&quot;)<br />
         stpapi.put.field(&quot;cisli2120s000&quot;, &quot;cisli220.rtyp&quot;, &quot;SLS&quot;)<br />
         stpapi.put.field(&quot;cisli2120s000&quot;, &quot;cisli220.ccur&quot;, &quot;ECU&quot;)<br />
         stpapi.put.field(&quot;cisli2120s000&quot;, &quot;cisli220.paym&quot;, &quot;CHD&quot;)<br />
         stpapi.put.field(&quot;cisli2120s000&quot;, &quot;cisli220.cpay&quot;, &quot;001&quot;)<br />
         stpapi.put.field(&quot;cisli2120s000&quot;, &quot;cisli220.ctyn&quot;, &quot;1&quot;)<br />
         stpapi.put.field(&quot;cisli2120s000&quot;, &quot;cisli220.subc&quot;, &quot;2&quot;)<br />
         ret.code = stpapi.insert(&quot;cisli2520m000&quot;, false, err)<br />
         if ret.code then<br />
            ret.code = stpapi.save(&quot;cisli2520m000&quot;,err)<br />
            if ret.code then<br />
            else<br />
               while true<br />
                  field = stpapi.get.mess.code(&quot;cisli2520m000&quot;, err)<br />
                  if isspace(err) then<br />
                     break<br />
                  endif<br />
               endwhile<br />
               ret.code = stpapi.recover(&quot;cisli2120s000&quot;,err)<br />
               err = err &amp; &quot; No se puede crear la Cabecera&quot;<br />
               write.err.record()<br />
            endif<br />
         else<br />
            while true<br />
               field = stpapi.get.mess.code(&quot;cisli2520m000&quot;, err)<br />
               if isspace(err) then<br />
                  break<br />
               endif<br />
            endwhile<br />
<br />
            ret.code = stpapi.recover(&quot;cisli2120s000&quot;,err)<br />
            err = err &amp; &quot; No se puede crear la Cabecera&quot;<br />
            write.err.record()<br />
         endif<br />
      endif<br />
   endif<br />
   stpapi.end.session( &quot;cisli2520m000&quot; )</div></div><hr />


<div class="post"><div class="posttop"><div class="username">lbencic</div><div class="date">20th January 2003, 23:36</div></div><div class="posttext">I don't see the 'stpapi.clear' command in my manual...perhaps it's been 'disabled'.   Or maybe it's new and I don't have it documented yet.  Try without it.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">vsevilla</div><div class="date">20th January 2003, 23:48</div></div><div class="posttext">Hi<br />
<br />
I cann't any code before stpapi.synchronize.dialog, and i was trying only with stpapi.save and not work.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">vsevilla</div><div class="date">20th January 2003, 23:50</div></div><div class="posttext">i delete the stpapi.clear line, i have the latest solutions of tools.<br />
not working yet</div></div><hr />


<div class="post"><div class="posttop"><div class="username">lbencic</div><div class="date">20th January 2003, 23:56</div></div><div class="posttext">I think I see.  Issue the insert, save and related commands to the sub session, not the main.  I think you are issueing the insert command to the display session, where it's disabled.<br />
<br />
Make sure to end the sub session, and then the main.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Paul P</div><div class="date">21st January 2003, 03:38</div></div><div class="posttext">Dear all,<br />
<br />
During quick scanning, the only thing missing from the original code is closing cisli2120s000. This must be done before closing cisli2520m000. It is OK, Mark, to start coding with synchronization since cisli2520m000 is a type 2 session (no group). Also, lbencic, vsevilla is correct in performing the insert and save to the main session, while recover to the subsession. This is the way it's supposed to be done according to manual<br />
<br />
The only thing to observe now is the behaviour of cisli2520m000 &amp; cisli2120s000 combo. I'm not so familiar with these 2, so I'll explore it later when I have free time<br />
<br />
Rgds,<br />
Paul</div></div><hr />


<div class="post"><div class="posttop"><div class="username">lbencic</div><div class="date">21st January 2003, 17:49</div></div><div class="posttext">Paul &amp; All -<br />
100% correct, my bad, you need to issue the insert to the main session in Baan V.  Hey..it does look like he's following the example from the Developer's Guide for Baan V updates, which does not issue the stpapi.end.session to the single occurance session either :rolleyes: <br />
<br />
Still, he gets the error on the insert, so I don't think the close is the whole problem...right?  <br />
<br />
Do you have source to debug the cisli2520 / cisli2120 sessions?  As Paul mentioned, sometime the problem is in the source itself, and the sessions may not be api friendly.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">vsevilla</div><div class="date">21st January 2003, 20:16</div></div><div class="posttext">Hi<br />
<br />
I don't have the source code, but i think that the variable update.status does not equal to ADD.SET or something like that.<br />
<br />
If somebody have the source code please help me!!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">maxime</div><div class="date">5th February 2003, 19:46</div></div><div class="posttext">According to me, the problem area is:<br />
<br />
stpapi.put.field(&quot;cisli2120s000&quot;, &quot;cisli220.sfcp&quot;, &quot;100&quot;).<br />
stpapi.put.field(&quot;cisli2120s000&quot;, &quot;cisli220.msid&quot;, &quot;11&quot;)<br />
<br />
<br />
The cisli200.sfcp  and cisli220.msid should should be stpapi.get.field(&quot;cisli2120s000&quot;....). <br />
<br />
Please check this out.<br />
<br />
Maxime.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mostrightfuture</div><div class="date">30th June 2004, 15:59</div></div><div class="posttext">hi vsevilla and others,<br />
<br />
vsevilla, I am facing the same problem, how u resolved that. Please tell me briefly.<br />
<br />
Also maxime, what do you mean that is should be the stpapi.get.field() instead of stpapi.put.field(),  I mean we have to put the field in the session not to get those fields from the session.<br />
<br />
Thanks in Advance<br />
Mahmood</div></div><hr />


<div class="post"><div class="posttop"><div class="username">vsevilla</div><div class="date">30th June 2004, 17:39</div></div><div class="posttext">Hello Mahmood<br />
<br />
Really i don't know where is the problem, may be the header session are not AFS compliant<br />
<br />
To solve the problem, i did a mix program. to create de header i used the standard development.<br />
<br />
and for the the lines i did a AFS function.<br />
<br />
regards<br />
<br />
Vinicio</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mostrightfuture</div><div class="date">30th June 2004, 17:46</div></div><div class="posttext">hi vsevilla,<br />
<br />
Thanks for quick reply. Please if you find some time then check my post. May be u can give any suggestion. Here is the link<br />
<br />
Link to My Post... (http://www.baanboard.com/baanboard/showthread.php?p=60124#post60124)<br />
<br />
Thanks in advance<br />
Mahmood</div></div><hr />



</div>
</body>
</html>