<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="How to create an AFS, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] How to create an AFS AFS/DDC/OLE: Function servers" />
	
	<title>How to create an AFS [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="index.html">Newbaanboard</a> &gt; <a href="index.html">Baan SIGs</a> &gt; <a href="index.html">AFS/DDC/OLE: Function servers</a> &gt; How to create an AFS</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">pralash</div><div class="date">10th October 2018, 11:02</div></div><div class="posttext">Hi,<br />
<br />
Can anybody explain how to create an new AFS please?<br />
Thanks in Advance...<br />
Regards,<br />
Pralash</div></div><hr />


<div class="post"><div class="posttop"><div class="username">VishalMistry</div><div class="date">10th October 2018, 11:30</div></div><div class="posttext">Hi Pralash,<br />
<br />
In Baan IV, go to File-&gt;Run, then in the run dialogue box provide ttstpcreatdll as session name.<br />
<br />
It will open a session where you can provide the session name for which you want to create dll (AFS). See attached screen shot for ref. I think process is same for Infor Ln.<br />
<br />
After following the above steps, you can open Libraries session to view dll (in this case, tcmcsf0123m000).<br />
<br />
Hope this helps.<br />
Vishal</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pralash</div><div class="date">10th October 2018, 14:33</div></div><div class="posttext">Hi Vishal Mistry,<br />
<br />
Thanks a lot for your guidance... As you suggested, I've created an AFS...<br />
Regards,<br />
Pralash</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pralash</div><div class="date">10th October 2018, 15:06</div></div><div class="posttext">Hi Vishalmistry,<br />
As you suggested, I've created the following AFS for a particular session...<br />
But I got an error while compiling the AFS. Please advise me that what is the exact issue by referring the attachment...<br />
Thanks in advance,<br />
Regards,<br />
Pralash<br />
|------------------------------------------------------------------------------<br />
| File created by ttstpcreatdll, Date: 03/10/18<br />
| Created for session: tcemp1503m000<br />
|------------------------------------------------------------------------------<br />
<br />
#pragma used dll ottstpapihand<br />
<br />
function extern void tcempf1503m000.put.Roll_No( const domain tcncmp value )<br />
{<br />
DLLUSAGE<br />
	Function to set Roll No ( tcemp103.roll ) in session tcemp1503m000<br />
	arg: - value to put in Roll No<br />
ENDDLLUSAGE<br />
	stpapi.put.field( &quot;tcemp1503m000&quot;, &quot;tcemp103.roll&quot;, str$(value) )<br />
}<br />
<br />
function extern domain tcncmp tcempf1503m000.get.Roll_No( )<br />
{<br />
DLLUSAGE<br />
	Function to get Roll No ( tcemp103.roll ) from session tcemp1503m000<br />
	return: - value of Roll No<br />
ENDDLLUSAGE<br />
	string value(5)<br />
	stpapi.get.field( &quot;tcemp1503m000&quot;, &quot;tcemp103.roll&quot;, &quot;1000&quot; )<br />
	return( lval(value) )<br />
}<br />
<br />
function extern void tcempf1503m000.put.Mark_1( const domain tcncmp value )<br />
{<br />
DLLUSAGE<br />
	Function to set Mark 1 ( tcemp103.mar1 ) in session tcemp1503m000<br />
	arg: - value to put in Mark 1<br />
ENDDLLUSAGE<br />
	stpapi.put.field( &quot;tcemp1503m000&quot;, &quot;tcemp103.mar1&quot;, str$(value) )<br />
}<br />
<br />
function extern domain tcncmp tcempf1503m000.get.Mark_1( )<br />
{<br />
DLLUSAGE<br />
	Function to get Mark 1 ( tcemp103.mar1 ) from session tcemp1503m000<br />
	return: - value of Mark 1<br />
ENDDLLUSAGE<br />
	string value(5)<br />
	stpapi.get.field( &quot;tcemp1503m000&quot;, &quot;tcemp103.mar1&quot;, &quot;200&quot;)<br />
	return( lval(value) )<br />
}<br />
<br />
function extern void tcempf1503m000.put.Mark_2( const domain tcncmp value )<br />
{<br />
DLLUSAGE<br />
	Function to set Mark 2 ( tcemp103.mar2 ) in session tcemp1503m000<br />
	arg: - value to put in Mark 2<br />
ENDDLLUSAGE<br />
	stpapi.put.field( &quot;tcemp1503m000&quot;, &quot;tcemp103.mar2&quot;, str$(value) )<br />
}<br />
<br />
function extern domain tcncmp tcempf1503m000.get.Mark_2( )<br />
{<br />
DLLUSAGE<br />
	Function to get Mark 2 ( tcemp103.mar2 ) from session tcemp1503m000<br />
	return: - value of Mark 2<br />
ENDDLLUSAGE<br />
	string value(5)<br />
	stpapi.get.field( &quot;tcemp1503m000&quot;, &quot;tcemp103.mar2&quot;, &quot;300&quot; )<br />
	return( lval(value) )<br />
}<br />
<br />
function extern void tcempf1503m000.put.Mark_3( const domain tcncmp value )<br />
{<br />
DLLUSAGE<br />
	Function to set Mark 3 ( tcemp103.mar3 ) in session tcemp1503m000<br />
	arg: - value to put in Mark 3<br />
ENDDLLUSAGE<br />
	stpapi.put.field( &quot;tcemp1503m000&quot;, &quot;tcemp103.mar3&quot;, str$(value) )<br />
}<br />
<br />
function extern domain tcncmp tcempf1503m000.get.Mark_3( )<br />
{<br />
DLLUSAGE<br />
	Function to get Mark 3 ( tcemp103.mar3 ) from session tcemp1503m000<br />
	return: - value of Mark 3<br />
ENDDLLUSAGE<br />
	string value(5)<br />
	stpapi.get.field( &quot;tcemp1503m000&quot;, &quot;tcemp103.mar3&quot;, &quot;400&quot; )<br />
	return( lval(value) )<br />
}<br />
<br />
function extern void tcempf1503m000.put.Total( const domain tcncmp value )<br />
{<br />
DLLUSAGE<br />
	Function to set Total ( tcemp103.tota ) in session tcemp1503m000<br />
	arg: - value to put in Total<br />
ENDDLLUSAGE<br />
	stpapi.put.field( &quot;tcemp1503m000&quot;, &quot;tcemp103.tota&quot;, str$(value) )<br />
}<br />
<br />
function extern domain tcncmp tcempf1503m000.get.Total( )<br />
{<br />
DLLUSAGE<br />
	Function to get Total ( tcemp103.tota ) from session tcemp1503m000<br />
	return: - value of Total<br />
ENDDLLUSAGE<br />
	string value(5)<br />
	stpapi.get.field( &quot;tcemp1503m000&quot;, &quot;tcemp103.tota&quot;, &quot;900&quot; )<br />
	return( lval(value) )<br />
}<br />
<br />
function extern void tcempf1503m000.end([string error(500)])<br />
{<br />
DLLUSAGE<br />
	Function to end connection to session tcemp1503m000<br />
ENDDLLUSAGE<br />
	if get.argc() = 0 then<br />
		stpapi.end.session( &quot;tcemp1503m000&quot; ) <br />
	else<br />
		error = get.string.arg(1)<br />
		stpapi.end.session( &quot;tcemp1503m000&quot; , error  )<br />
		put.string.arg(1, error)<br />
	endif<br />
}<br />
<br />
function extern long tcempf1503m000.insert( long do.update, ref string error )<br />
{<br />
DLLUSAGE<br />
	Function to insert a record in session tcemp1503m000<br />
	Fields must be put before calling this function<br />
ENDDLLUSAGE<br />
	return( stpapi.insert( &quot;tcemp1503m000&quot;, do.update, error ) )<br />
}<br />
<br />
function extern long tcempf1503m000.update( long do.update, ref string error )<br />
{<br />
DLLUSAGE<br />
	Function to update a record in session tcemp1503m000<br />
	Record must be made current and fields to be changed before calling<br />
	this function<br />
ENDDLLUSAGE<br />
	return( stpapi.update( &quot;tcemp1503m000&quot;, do.update, error ) )<br />
}<br />
<br />
function extern long tcempf1503m000.delete( long do.update, ref string error )<br />
{<br />
DLLUSAGE<br />
	Function to delete a record in session tcemp1503m000<br />
	Record must be made current before calling this function<br />
ENDDLLUSAGE<br />
	return( stpapi.delete( &quot;tcemp1503m000&quot;, do.update, error ) )<br />
}<br />
<br />
function extern long tcempf1503m000.mark([string error (500)])<br />
{<br />
DLLUSAGE<br />
	Function to mark the current record in session tcemp1503m000<br />
ENDDLLUSAGE<br />
	long ret<br />
	if get.argc() = 0 then<br />
		return( stpapi.mark( &quot;tcemp1503m000&quot; ) ) <br />
	else<br />
		error = get.string.arg(1)<br />
		ret =  stpapi.mark( &quot;tcemp1503m000&quot; , error  )<br />
		put.string.arg(1, error)<br />
		return( ret ) <br />
	endif<br />
}<br />
<br />
function extern long tcempf1503m000.recover( ref string error )<br />
{<br />
DLLUSAGE<br />
	Function to undo an update/insert/delete in session tcemp1503m000<br />
ENDDLLUSAGE<br />
	return( stpapi.recover( &quot;tcemp1503m000&quot;, error ) )<br />
}<br />
<br />
function extern long tcempf1503m000.save( ref string error )<br />
{<br />
DLLUSAGE<br />
	Function to save an update/insert/delete in session tcemp1503m000<br />
ENDDLLUSAGE<br />
	return( stpapi.save( &quot;tcemp1503m000&quot;, error ) )<br />
}<br />
<br />
function extern long tcempf1503m000.find( [string error(500)] )<br />
{<br />
DLLUSAGE<br />
	Function to find a record in session tcemp1503m000<br />
	Search fields must be put before calling this function<br />
ENDDLLUSAGE<br />
	long ret<br />
	if get.argc() = 0 then<br />
		return( stpapi.find( &quot;tcemp1503m000&quot;  ) )<br />
	else<br />
		error = get.string.arg(1)<br />
		ret =  stpapi.find( &quot;tcemp1503m000&quot; , error  )<br />
		put.string.arg(1, error)<br />
		return( ret ) <br />
	endif<br />
}<br />
<br />
function extern long tcempf1503m000.synchronize.dialog( string mode(8), ref string err.mesg)<br />
{<br />
DLLUSAGE<br />
	Function to set up a synchronized dialog between multi-occurrence<br />
	and single-occurrence session<br />
ENDDLLUSAGE<br />
	return( stpapi.synchronize.dialog(&quot;tcemp1503m000&quot;, mode , err.mesg) )<br />
}<br />
<br />
function extern void tcempf1503m000.clear( )<br />
{<br />
DLLUSAGE<br />
	Function to clear the current record in session tcemp1503m000<br />
ENDDLLUSAGE<br />
	stpapi.clear( &quot;tcemp1503m000&quot; )<br />
}<br />
<br />
function extern void tcempf1503m000.print( ref string error )<br />
{<br />
DLLUSAGE<br />
	Function to start the print option in session tcemp1503m000<br />
ENDDLLUSAGE<br />
	stpapi.print.report( &quot;tcemp1503m000&quot;, error )<br />
}<br />
<br />
function extern void tcempf1503m000.set.report( const string reportname, const string device, ref string error )<br />
{<br />
DLLUSAGE<br />
	Function to set report name and device for a subsequent print action<br />
	in session tcemp1503m000<br />
ENDDLLUSAGE<br />
	stpapi.set.report( &quot;tcemp1503m000&quot;, reportname, device, error )<br />
}<br />
<br />
function extern long tcempf1503m000.first([string error(500)] )<br />
{<br />
DLLUSAGE<br />
	Function to find the first record in session tcemp1503m000<br />
ENDDLLUSAGE<br />
	long ret<br />
	if get.argc() = 0 then<br />
		return( stpapi.browse.set( &quot;tcemp1503m000&quot;, &quot;first.set&quot; ) )<br />
	else<br />
		error = get.string.arg(1)<br />
		ret = stpapi.browse.set( &quot;tcemp1503m000&quot;, &quot;first.set&quot; , error )<br />
		put.string.arg(1, error)<br />
		return( ret )<br />
	endif<br />
}<br />
<br />
function extern long tcempf1503m000.next([string error(500)] )<br />
{<br />
DLLUSAGE<br />
	Function to find the next record in session tcemp1503m000<br />
ENDDLLUSAGE<br />
	long ret<br />
	if get.argc() = 0 then<br />
		return( stpapi.browse.set( &quot;tcemp1503m000&quot;, &quot;next.set&quot; ) )<br />
	else<br />
		error = get.string.arg(1)<br />
		ret = stpapi.browse.set( &quot;tcemp1503m000&quot;, &quot;next.set&quot; , error )<br />
		put.string.arg(1, error)<br />
		return( ret )<br />
	endif<br />
}<br />
<br />
function extern long tcempf1503m000.previous([string error(500)] )<br />
{<br />
DLLUSAGE<br />
	Function to find the previous record in session tcemp1503m000<br />
ENDDLLUSAGE<br />
	long ret<br />
	if get.argc() = 0 then<br />
		return( stpapi.browse.set( &quot;tcemp1503m000&quot;, &quot;prev.set&quot; ) )<br />
	else<br />
		error = get.string.arg(1)<br />
		ret = stpapi.browse.set( &quot;tcemp1503m000&quot;, &quot;prev.set&quot; , error )<br />
		put.string.arg(1, error)<br />
		return( ret )<br />
	endif<br />
}<br />
<br />
function extern long tcempf1503m000.last([string error(500)] )<br />
{<br />
DLLUSAGE<br />
	Function to find the last record in session tcemp1503m000<br />
ENDDLLUSAGE<br />
	long ret<br />
	if get.argc() = 0 then<br />
		return( stpapi.browse.set( &quot;tcemp1503m000&quot;, &quot;last.set&quot; ) )<br />
	else<br />
		error = get.string.arg(1)<br />
		ret = stpapi.browse.set( &quot;tcemp1503m000&quot;, &quot;last.set&quot; , error )<br />
		put.string.arg(1, error)<br />
		return( ret )<br />
	endif<br />
}<br />
<br />
function extern long tcempf1503m000.set.view( [string error(500)] )<br />
{<br />
DLLUSAGE<br />
	Function to define another view in session tcemp1503m000<br />
ENDDLLUSAGE<br />
	long ret<br />
	if get.argc() = 0 then<br />
		return( stpapi.change.view( &quot;tcemp1503m000&quot; ) )<br />
	else<br />
		error = get.string.arg(1)<br />
		ret = stpapi.change.view( &quot;tcemp1503m000&quot;,  error )<br />
		put.string.arg(1, error)<br />
		return( ret )<br />
	endif<br />
}<br />
<br />
function extern long tcempf1503m000.first.view([string error(500)] )<br />
{<br />
DLLUSAGE<br />
	Function to read the first view in session tcemp1503m000<br />
ENDDLLUSAGE<br />
	long ret<br />
	if get.argc() = 0 then<br />
		return( stpapi.browse.view( &quot;tcemp1503m000&quot; , &quot;first.view&quot; ) )<br />
	else<br />
		error = get.string.arg(1)<br />
		ret = stpapi.browse.view( &quot;tcemp1503m000&quot;, &quot;first.view&quot;, error )<br />
		put.string.arg(1, error)<br />
		return( ret )<br />
	endif<br />
}<br />
<br />
function extern long tcempf1503m000.next.view([string error(500)] )<br />
{<br />
DLLUSAGE<br />
	Function to read the next view in session tcemp1503m000<br />
ENDDLLUSAGE<br />
	long ret<br />
	if get.argc() = 0 then<br />
		return( stpapi.browse.view( &quot;tcemp1503m000&quot; , &quot;next.view&quot; ) )<br />
	else<br />
		error = get.string.arg(1)<br />
		ret = stpapi.browse.view( &quot;tcemp1503m000&quot;, &quot;next.view&quot;, error )<br />
		put.string.arg(1, error)<br />
		return( ret )<br />
	endif<br />
}<br />
<br />
function extern long tcempf1503m000.previous.view([string error(500)] )<br />
{<br />
DLLUSAGE<br />
	Function to read the previous view in session tcemp1503m000<br />
ENDDLLUSAGE<br />
	long ret<br />
	if get.argc() = 0 then<br />
		return( stpapi.browse.view( &quot;tcemp1503m000&quot; , &quot;prev.view&quot; ) )<br />
	else<br />
		error = get.string.arg(1)<br />
		ret = stpapi.browse.view( &quot;tcemp1503m000&quot;, &quot;prev.view&quot;, error )<br />
		put.string.arg(1, error)<br />
		return( ret )<br />
	endif<br />
}<br />
<br />
function extern long tcempf1503m000.last.view([string error(500)] )<br />
{<br />
DLLUSAGE<br />
	Function to read the last view in session tcemp1503m000<br />
ENDDLLUSAGE<br />
	long ret<br />
	if get.argc() = 0 then<br />
		return( stpapi.browse.view( &quot;tcemp1503m000&quot; , &quot;last.view&quot; ) )<br />
	else<br />
		error = get.string.arg(1)<br />
		ret = stpapi.browse.view( &quot;tcemp1503m000&quot;, &quot;last.view&quot;, error )<br />
		put.string.arg(1, error)<br />
		return( ret )<br />
	endif<br />
}<br />
<br />
function extern string tcempf1503m000.get.last.message.code([string error(500)])<br />
{<br />
DLLUSAGE<br />
	Function to get the code of the message which occurred on <br />
	the last insert/update/delete/save/recover action in session tcemp1503m000<br />
ENDDLLUSAGE<br />
	string ret(20)<br />
	if get.argc() = 0 then<br />
		return( stpapi.get.mess.code( &quot;tcemp1503m000&quot; ) )<br />
	else<br />
		error = get.string.arg(1)<br />
		ret = stpapi.get.mess.code( &quot;tcemp1503m000&quot;, error )<br />
		put.string.arg(1, error)<br />
		return( ret )<br />
	endif<br />
}<br />
<br />
function extern string tcempf1503m000.get.last.error( )<br />
{<br />
DLLUSAGE<br />
	Function to get the error message which occurred on <br />
	the last action in the Function Server<br />
ENDDLLUSAGE<br />
	return( stpapi.get.error( ) )<br />
}<br />
<br />
function extern void tcempf1503m000.handle.sub.process( const string sub.process, const string action )<br />
{<br />
DLLUSAGE<br />
	Function to define an action when a sub process is started.<br />
	Possible actions are: add/send/ignore/kill <br />
		add     - add child session to internal structure, <br />
				session dll of child can be used<br />
		send    - send all api calls to child instead of parent<br />
		ignore  - child process is ignored, parent will wait<br />
				until child exits (for background processes)<br />
		kill    - child process is killed immediately<br />
ENDDLLUSAGE<br />
	stpapi.handle.subproc( &quot;tcemp1503m000&quot;, sub.process, action )<br />
}<br />
<br />
function extern void tcempf1503m000.define.enum.answer( const string question, bset answer )<br />
{<br />
DLLUSAGE<br />
	Function to define an answer on a question, when the default answer should not be taken.<br />
ENDDLLUSAGE<br />
	stpapi.enum.answer( &quot;tcemp1503m000&quot;, question, answer )<br />
}</div></div><hr />


<div class="post"><div class="posttop"><div class="username">VishalMistry</div><div class="date">11th October 2018, 08:33</div></div><div class="posttext">Hello Pralash,<br />
<br />
Looking at one of the get function in your attached code:<br />
function extern domain tcncmp tcempf1503m000.get.Roll_No( )<br />
{<br />
DLLUSAGE<br />
Function to get Roll No ( tcemp103.roll ) from session tcemp1503m000<br />
return: - value of Roll No<br />
ENDDLLUSAGE<br />
string value(5)<br />
stpapi.get.field( &quot;tcemp1503m000&quot;, &quot;tcemp103.roll&quot;, &quot;1000&quot; )<br />
return( lval(value) )<br />
}<br />
<br />
The third argument should not be a string constant but a variable as given in the attached AFS DLL for session tcmcs0123m000. <br />
Please replace below statement:<br />
stpapi.get.field( &quot;tcemp1503m000&quot;, &quot;tcemp103.roll&quot;, &quot;1000&quot; )<br />
with<br />
stpapi.get.field( &quot;tcemp1503m000&quot;, &quot;tcemp103.roll&quot;, value ) as the function is returning the value of variable &quot;value&quot;. Make this change is every get function and it should resolve the issue.<br />
<br />
Vishal</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pralash</div><div class="date">11th October 2018, 14:08</div></div><div class="posttext">Hi Vishalmistry,<br />
<br />
As per your ideas, I resolved the issue and successfully compiled the AFS. But I don't know that how to execute this AFS. Hence pls let me know that how to execute the AFS...<br />
<br />
Thanks in advance,<br />
Pralash</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">11th October 2018, 17:01</div></div><div class="posttext">There is documentation pinned to the top of this forum where I moved this post.  It is http://www.baanboard.com/baanboard/showthread.php?t=7251 this post.<br />
<br />
So far it looks like all you did was create a library with calls to a session.  Now you actually create a new session to call the library to drive the standard baan session.  I used to create libraries with ttstpcreate, but no longer do.  You might try searching on you session in question to see if someone else has posted code.  If you do not find it there are plenty of other examples of what people have to done.  Basically a lot of times I take an input file, upload it to the server, process the data using AFS code and generate a report.  So poke around and read some in this forum to get started.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">pralash</div><div class="date">11th October 2018, 17:13</div></div><div class="posttext">Hi Mark,<br />
<br />
Thank so much for your guidance... I will go through the document...<br />
<br />
Regards,<br />
Pralash</div></div><hr />



</div>
</body>
</html>