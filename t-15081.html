<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="stpapi.put.field in tcibd0101s000, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] stpapi.put.field in tcibd0101s000 AFS/DDC/OLE: Function servers" />
	
	<title>stpapi.put.field in tcibd0101s000 [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="index.html">Newbaanboard</a> &gt; <a href="index.html">Baan SIGs</a> &gt; <a href="index.html">AFS/DDC/OLE: Function servers</a> &gt; stpapi.put.field in tcibd0101s000</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">sujoy.sen</div><div class="date">20th April 2004, 00:30</div></div><div class="posttext">I am trying to insert a new record into tcibd0501m000 / tcibd0101s000 using AFS. A portion of the code is as follows:<br />
<br />
<br />
ret1 = stpapi.synchronize.dialog(&quot;tcibd0501m000&quot;, &quot;add&quot;, error_msg1)<br />
	if ret1 then<br />
		stpapi.put.field(&quot;tcibd0101s000&quot;, &quot;tcibd001.item.segment.1&quot;, tcibd920.item(1; 9))<br />
		stpapi.put.field(&quot;tcibd0101s000&quot;, &quot;tcibd001.item.segment.2&quot;, tcibd920.item(10; 38))<br />
		stpapi.put.field(&quot;tcibd0101s000&quot;, &quot;tcibd001.dsca&quot;, tcibd920.dsca)<br />
		stpapi.put.field(&quot;tcibd0101s000&quot;, &quot;tcibd001.kitm&quot;, str$(etol(tcibd920.kitm)))<br />
		stpapi.put.field(&quot;tcibd0101s000&quot;, &quot;tcibd001.citg&quot;, tcibd920.citg)<br />
		stpapi.put.field(&quot;tcibd0101s000&quot;, &quot;tcibd001.uset&quot;, &quot;300&quot;)<br />
		stpapi.put.field(&quot;tcibd0101s000&quot;, &quot;tcibd001.cuni&quot;, &quot;ea&quot;)<br />
		stpapi.put.field(&quot;tcibd0101s000&quot;, &quot;tcibd001.cwun&quot;, &quot;kg&quot;)<br />
		stpapi.put.field(&quot;tcibd0101s000&quot;, &quot;tcibd001.wght&quot;, str$(wght.in.kg))<br />
		stpapi.put.field(&quot;tcibd0101s000&quot;, &quot;tcibd001.cwar&quot;, &quot;145&quot;)<br />
		stpapi.put.field(&quot;tcibd0101s000&quot;, &quot;tcibd001.kltc&quot;, str$(etol(tckltc.batch)))<br />
		stpapi.put.field(&quot;tcibd0101s000&quot;, &quot;tcibd001.seak&quot;, toupper$(tcibd920.dsca))<br />
		stpapi.put.field(&quot;tcibd0101s000&quot;, &quot;tcibd001.seab&quot;, tcibd920.seab)<br />
		stpapi.put.field(&quot;tcibd0101s000&quot;, &quot;tcibd001.dscb&quot;, tcibd920.dscb)<br />
		stpapi.put.field(&quot;tcibd0101s000&quot;, &quot;tcbid001.dscc&quot;, &quot;A1&quot;)<br />
		stpapi.put.field(&quot;tcibd0101s000&quot;, &quot;tcibd001.dscd&quot;, str$(wght.in.lbs)) <br />
		stpapi.put.field(&quot;tcibd0101s000&quot;, &quot;tcbid001.cpcl&quot;, &quot;A60&quot;)<br />
		stpapi.put.field(&quot;tcibd0101s000&quot;, &quot;tcibd001.cmnf&quot;, hold.cmnf)	<br />
		ret2 = stpapi.insert(&quot;tcibd0501m000&quot;, true, error_msg2)<br />
		if not ret2 then<br />
			handle.error(&quot;tcibd0101s000&quot;, error_msg2)<br />
			ret3 = stpapi.recover(&quot;tcibd0101s000&quot;, error_msg3)<br />
		endif<br />
	else<br />
		handle.error(&quot;tcibd0501m000&quot;, error_msg1)<br />
	endif<br />
	stpapi.end.session(&quot;tcibd0501m000&quot;, error_msg4)<br />
<br />
<br />
For the most part everything works fine. Almost all the field values get set right and the record gets inserted. There are no errors. However, for some reason, I can't seem to update the values for the fields tcibd001.dscc and tcibd001.cpcl. Has anyone ever run into a situation like this? Any ideas on what may be causing this problem and how it could be resolved?<br />
<br />
Thanks,<br />
Sujoy.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">20th April 2004, 04:47</div></div><div class="posttext">I have run into a situation where I had to do an insert first.  Then find and update a couple of fields on the session.  There are some posts about something like this in this forum.  I will try to see if I can find them.<br />
<br />
Mark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">20th April 2004, 04:53</div></div><div class="posttext">Here is one link  (http://www.baanboard.com/baanboard/showthread.php?s=&amp;threadid=5800&amp;highlight=insert+and+update) and I know there are others.  This was just the first I ran into.<br />
<br />
Mark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Paul P</div><div class="date">20th April 2004, 07:06</div></div><div class="posttext">Dear Sujoy,<br />
<br />
By looking at the script, it should've worked. I assumed you've defined product class A60 in the master data, right? It's indeed funny that tcibd001.dscc wouldn't even port in<br />
<br />
Rgds,<br />
Paul</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sujoy.sen</div><div class="date">20th April 2004, 17:25</div></div><div class="posttext">Mark,<br />
<br />
I tried out your idea. I did an insert followed by a stpapi.end.session call. And then did a find to look up the record that I'd inserted and called stpapi.put.field for both the fields I was having problems with. I finished up with a stpapi.update and a stpapi.end.session. This did not fix the problem. Somehow those two fields just won't get updated. They remain blank. I updated one of the other fields I'd inserted (tcibd001.dscb) and that worked fine.<br />
<br />
Paul,<br />
<br />
Yes, A60 is defined as a Product Class in the master data. In fact, I can go into tcibd0501m000/tcibd0101s000 and manually change the values to A1 for tcibd001.dscc and A60 for tcibd001.cpcl and that works.<br />
<br />
Thanks,<br />
Sujoy.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">20th April 2004, 18:48</div></div><div class="posttext">Are the domains correct for the fields?  Sorry but I do not have these tables on our system to check.  Just wondering if &quot;A1&quot; should be &quot; A1&quot; or something like that.<br />
<br />
Do you have source code for the session so you could debug it?  Also I almost always recommend getting the latest and greatest patches for the session and stpapi commands.<br />
<br />
Mark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sujoy.sen</div><div class="date">20th April 2004, 20:12</div></div><div class="posttext">I checked the domains for both fields and padded extra trailing spaces in my input strings (&quot;A60   &quot;, etc.) so that they would be equal to the lengths of the domains. I'd tried that before my first post. That didn't work. <br />
<br />
Unfortunately, we don't have source code for tcibd0101s000. That would have been very helpful.<br />
<br />
We recently put in Service Pack 15 which I think is the most current service pack for B50B and we're within two solutions (142503 and 142808) of being current on our standard programs (ttstpapihand, ttstpstandard, etc.). I'm always afraid we're going to break something when we put in those standard solutions (it has happened!). It's just very vexing that a simple stpapi.put.field in a simple insert won't work when I have much more complicated AFS functionality working without problems! <br />
<br />
Thanks,<br />
Sujoy.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">20th April 2004, 21:22</div></div><div class="posttext">Yes - I do agree with you on how vexing a simple put can be.  One other thing I have done is actually do the insert using the session.  Then actually go and update fields directly on the table itself.  I had one session that would not update an information field no matter what I did, so I just did a select and update.<br />
<br />
Mark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">lbencic</div><div class="date">20th April 2004, 21:28</div></div><div class="posttext">Hi Sujoy - <br />
I took a peek at some of the Baan 5b code.  Is the item by chance a STO Item (tcibd001.stoi = yes)?<br />
<br />
It does some fun enable and disable's on both of those fields if it is, among other fields.  It could be that it is not handled so hot as the api, but better in the sessions.  I have found since they place these at 'non-linear' points in the code that the api's don't have the best of luck with them.  In Baan IV, they put the input check almost always in the 'before.input' section of the field.  In Baan V they are all spread out.<br />
<br />
Both fields will also get updated whenever the Item Group or the Item Type is changed.  I would not think this is the problem, but it's the only other reference to that field I see.  Could always be in a DAL or other library somewhere.  Neither field is mentioned in the main tcibd001 DAL. <br />
<br />
Hope that helps, good luck.<br />
<br />
Just saw Mark's post.   I agree, and if you have to update the table direct, there is very little validation to be concerned with on those fields that I could see.  As I saw, not even a section for them in the DAL.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sujoy.sen</div><div class="date">20th April 2004, 23:21</div></div><div class="posttext">Lisa / Mark,<br />
<br />
tcibd001.stoi is getting set to no for the item I'm inserting. I am not setting that field through my afs script so it's  probably some default setting. <br />
<br />
Thanks for looking through the code. I was going to copy the form to my development VRC and see if I could fiddle around with it, but at this point I don't think it would be of much use. <br />
<br />
I was going to resist the temptation of doing a direct table update on those two fields for a little while longer, but you guys have sold me on it ;) . It would've been nice to keep this script 'pure' in terms of its use of AFS for carrying out the updates ... oh well.<br />
<br />
Thanks again for all your help.<br />
Sujoy.</div></div><hr />



</div>
</body>
</html>