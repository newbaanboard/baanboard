<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="Creating a PDF INVOICE to disk with Invoice number in the file name for archiving pur, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] Creating a PDF INVOICE to disk with Invoice number in the file name for archiving pur Blogs and Web links" />
	
	<title>Creating a PDF INVOICE to disk with Invoice number in the file name for archiving pur [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="../index.html">Newbaanboard</a> &gt; <a href="../index.html">CMS - Forum Integration</a> &gt; <a href="../index.html">Blogs and Web links</a> &gt; Creating a PDF INVOICE to disk with Invoice number in the file name for archiving pur</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">genehunter</div><div class="date">14th July 2009, 18:32</div></div><div class="posttext">A new blog entry has been added:<br />
<br />
Creating a PDF INVOICE to disk with Invoice number in the file name for archiving purposes.<br />
<br />
I have been working on a way to archive invoices and to automatically label the file name with the invoice number. This is the code I have so far. It uses Ghost script pdf converter and it seems to work. If you have questions send me an email at ghunter@immucor.com<br />
  <br />
 This is the print driver. the code near the middle (findstr) is what finds the string with the INVOICE number and labels the pdf file.Â <br />
  <br />
 gswin32c -q -dNOPAUSE -dBATCH -sPAPERSIZE=a4 -sDEVICE=pdfwrite -sOutputFile=e:\baan\tmp\archive_pdf.pdf e:\baan\tmp\archive_pdf.txt<br />
 copy e:\baan\tmp\archive_pdf.pdf e:\archive_invoice\archive_pdf.pdf<br />
copy e:\baan\tmp\archive_pdf.txt e:\archive_invoice\archive_pdf.txt<br />
rem -- ren e:\archive_invoice\archive_pdf.pdf invoice%date:~4,2%%date:~7,2%%date:~10,4%%time:~1,1%h%time:~3,2%m%time:~6,2%s%.pdf<br />
findstr /C:&quot;45 444&quot; archive_pdf.txt &gt;e:\archive_invoice\results.txt<br />
set /P test=&lt;e:\archive_invoice\results.txt<br />
ren e:\archive_invoice\archive_pdf.pdf invoice-%test:~49,3%-%test:~72,8%.pdf<br />
del e:\archive_invoice\results.txt<br />
 :end</div></div><hr />



</div>
</body>
</html>