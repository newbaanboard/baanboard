<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="Tips for Multi-company / Calculated items in MS SQL query, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] Tips for Multi-company / Calculated items in MS SQL query Blogs and Web links" />
	
	<title>Tips for Multi-company / Calculated items in MS SQL query [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="../index.html">Newbaanboard</a> &gt; <a href="../index.html">CMS - Forum Integration</a> &gt; <a href="../index.html">Blogs and Web links</a> &gt; Tips for Multi-company / Calculated items in MS SQL query</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">Hitesh Shah</div><div class="date">23rd May 2009, 13:18</div></div><div class="posttext">A new blog entry has been added:<br />
<br />
Tips for Multi-company / Calculated items in MS SQL query<br />
<br />
Tips for Multi-company / Calculated items in MS SQL query<br />
<br />
 If one is using SQL 2000/2005 and one wants to access the same from outside (say MS Excel or .net application or any other application) , one can use the SQL client in conjunction with  following SQL tips.<br />
  <br />
 <br />
<br />
 Multi-company query<br />
<br />
 Though baan driver let’s user access data from same table from multiple companies using compnr specification, in the MS SQL backend the tables are separate with company suffix . If one is to combine the data from multiple companies for same table, Union operator is SQL query is the key. Using this operator also one may need to know from which company the data has originated . In Baan 4GL one can get this with ._compnr field selected . In MS SQL one needs to  hard code the company constant expression in each SQL  query  combined with UNION operator . An example will illustrate this clearly.<br />
  <br />
 Select t_leac as Ledger ,t_dbcr ‘Debit/Credit’,t_year as Year ,t_fprd as Period, t_amth as Amount , ‘300’ as company – Constant for company <br />
 From ttfgld106300<br />
 UNION <br />
 Select t_leac as Ledger ,t_dbcr ‘Debit/Credit’,t_year as Year ,t_fprd as Period, t_amth as Amount, ‘301’ as company – Constant for company <br />
 From ttfgld106301<br />
  <br />
 This example will select data from tfgld106 of 300 and 301 company.</div></div><hr />



</div>
</body>
</html>