<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="AFS problem, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] AFS problem AFS/DDC/OLE: Function servers" />
	
	<title>AFS problem [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="index.html">Newbaanboard</a> &gt; <a href="index.html">Baan SIGs</a> &gt; <a href="index.html">AFS/DDC/OLE: Function servers</a> &gt; AFS problem</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">help_ln</div><div class="date">23rd February 2007, 10:30</div></div><div class="posttext">Hi,<br />
<br />
I am trying to find an Item through AFS in Maintain Lots session.<br />
If the item does not exist, i dont't get an find error message, instead it goes to the next record.<br />
<br />
How to resove this ????<br />
<br />
Thanks in advance.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jp.aalders</div><div class="date">23rd February 2007, 10:53</div></div><div class="posttext">Check the item you're looking for with the item found by AFS. If they are not the same you don't have a &quot;match&quot; en you can execute further actions.<br />
<br />
Good Luck!:)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">help_ln</div><div class="date">23rd February 2007, 11:09</div></div><div class="posttext">Hi,<br />
<br />
So when there is no match, there is no error msg coming which should be coming.<br />
<br />
Could u also tell how to insert Group through AFS.<br />
<br />
Thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">george7a</div><div class="date">23rd February 2007, 13:06</div></div><div class="posttext">Hi,<br />
<br />
You can also check if the item exists using regular SQL syntax.<br />
<br />
- George</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">23rd February 2007, 14:12</div></div><div class="posttext">Is you are using stpapi.find just check the return code - 0 means no record found and 2 means a record other than the one requested was returned.  So if it does not equal 1 you did not find a record.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">help_ln</div><div class="date">23rd February 2007, 14:47</div></div><div class="posttext">Yes.. i checked thru regular SQL syntax that the item does not exits as well as through the return value.<br />
<br />
Now i have to insert the this item which does not exists .<br />
Not able to find how to insert a group through AFS.<br />
<br />
Pls help<br />
<br />
Thanks</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">23rd February 2007, 14:56</div></div><div class="posttext">Here is a simple little example:<br />
<br />
function add.builditem()<br />
{<br />
	stpapi.put.field( &quot;tipgc8100m00b&quot;, &quot;tipgc800.cprj&quot;, project )<br />
	e = stpapi.change.view( &quot;tipgc8100m00b&quot; )<br />
	stpapi.put.field( &quot;tipgc8100m00b&quot;, &quot;tipgc800.cprj&quot;, project )<br />
	stpapi.put.field( &quot;tipgc8100m00b&quot;, &quot;tipgc800.butm&quot;, builditem )<br />
	stpapi.put.field( &quot;tipgc8100m00b&quot;, &quot;tipgc800.dsca&quot;, description )<br />
	stpapi.insert( &quot;tipgc8100m00b&quot;, 1, errmsg)<br />
|021902 Skip records already exist.  This means the build item<br />
| was already added.<br />
	if(strip$(errmsg)&lt;&gt;&quot;&quot; and pos(errmsg,&quot;Record already exists&quot;)=0) then<br />
		mess.1= &quot;1.&quot; &amp; builditem &amp; &quot; &quot; &amp; errmsg<br />
		write.error(mess.1)<br />
	else<br />
		mess.1=&quot;1. Build item added. &quot; &amp; builditem<br />
	endif<br />
	display(&quot;mess.1&quot;)<br />
	stpapi.end.session( &quot;tipgc8100m00b&quot; )<br />
}<br />
<br />
In this case I do not if check to see if the group(or view fields) exists.  I just insert the record and ignore error where it says duplicates exists.  As a matter of fact I could completely remove the error checks in this routine. If this is related to the find question you may want to try change.view command first and see what it returns.  Which session are you working with?  I am on 4c4 and your profile says LN and there can be differences.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ahmer91</div><div class="date">24th February 2007, 09:12</div></div><div class="posttext">i have got Complete AFS Guide , if you require please send me email to faisaljk@hotmail.com</div></div><hr />



</div>
</body>
</html>