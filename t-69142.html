<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="Add new address with telephone duplicate, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] Add new address with telephone duplicate AFS/DDC/OLE: Function servers" />
	
	<title>Add new address with telephone duplicate [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="index.html">Newbaanboard</a> &gt; <a href="index.html">Baan SIGs</a> &gt; <a href="index.html">AFS/DDC/OLE: Function servers</a> &gt; Add new address with telephone duplicate</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">heartbeat</div><div class="date">5th August 2016, 06:07</div></div><div class="posttext">stpapi.put.field(&quot;tccom4130s000&quot;,&quot;tccom130.cadr&quot;,str$(p.cadr))<br />
stpapi.put.field(&quot;tccom4130s000&quot;,&quot;tccom130.nama&quot;,str$(f.addr.nama))<br />
stpapi.put.field(&quot;tccom4130s000&quot;,&quot;tccom130.ccty&quot;,str$(f.ccty))<br />
stpapi.put.field(&quot;tccom4130s000&quot;,&quot;tccom130.pstc&quot;,str$(f.pstc))<br />
stpapi.put.field(&quot;tccom4130s000&quot;,&quot;tccom130.cste&quot;,str$(f.cste))<br />
stpapi.put.field(&quot;tccom4130s000&quot;,&quot;tccom130.ccit&quot;,str$(f.ccit))<br />
stpapi.put.field(&quot;tccom4130s000&quot;,&quot;tccom130.tzid&quot;,str$(f.tzid))<br />
stpapi.put.field(&quot;tccom4130s000&quot;,&quot;tccom130.telp&quot;,str$(f.telp))<br />
stpapi.put.field(&quot;tccom4130s000&quot;,&quot;tccom130.tefx&quot;,str$(f.tefx))<br />
stpapi.put.field(&quot;tccom4130s000&quot;,&quot;tccom130.vatl&quot;,str$(f.vatl))<br />
stpapi.put.field(&quot;tccom4130s000&quot;,&quot;tccom130.coaf&quot;,str$(f.coaf))<br />
stpapi.put.field(&quot;tccom4130s000&quot;,&quot;tccom130.ln01&quot;,str$(f.ln01))<br />
stpapi.put.field(&quot;tccom4130s000&quot;,&quot;tccom130.ln02&quot;,str$(f.ln02))<br />
stpapi.put.field(&quot;tccom4130s000&quot;,&quot;tccom130.ln03&quot;,str$(f.ln03))<br />
stpapi.put.field(&quot;tccom4130s000&quot;,&quot;tccom130.ln04&quot;,str$(f.ln04))<br />
stpapi.put.field(&quot;tccom4130s000&quot;,&quot;tccom130.ln05&quot;,str$(f.ln05))<br />
stpapi.put.field(&quot;tccom4130s000&quot;,&quot;tccom130.ln06&quot;,str$(f.ln06))<br />
result = stpapi.insert(&quot;tccom4130s000&quot;,true,error.msg)<br />
if result = 1 then<br />
	result = stpapi.enum.answer(&quot;tccom4130s000&quot;,&quot;tccom4130.1&quot;,tcyesno.yes)<br />
else<br />
	result = stpapi.recover(&quot;tccom4130s000&quot;,error.msg)<br />
endif<br />
<br />
<br />
I want to add new address but the telephone is duplicate. Please recommend click ok for dailog.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bhushanchanda</div><div class="date">5th August 2016, 14:42</div></div><div class="posttext">Hi,<br />
<br />
Try DAL wherever possible -&gt;<br />
<br />
 <br />
        dal.new.object(&quot;tccom130&quot;)<br />
	dal.set.field(&quot;tccom130.cadr&quot;,str$(p.cadr))<br />
	dal.set.field(&quot;tccom130.nama&quot;,str$(f.addr.nama))<br />
	dal.set.field(&quot;tccom130.ccty&quot;,str$(f.ccty))<br />
	dal.set.field(&quot;tccom130.pstc&quot;,str$(f.pstc))<br />
	dal.set.field(&quot;tccom130.cste&quot;,str$(f.cste))<br />
	dal.set.field(&quot;tccom130.ccit&quot;,str$(f.ccit))<br />
	dal.set.field(&quot;tccom130.tzid&quot;,str$(f.tzid))<br />
	dal.set.field(&quot;tccom130.telp&quot;,str$(f.telp))<br />
	dal.set.field(&quot;tccom130.tefx&quot;,str$(f.tefx))<br />
	dal.set.field(&quot;tccom130.vatl&quot;,str$(f.vatl))<br />
	dal.set.field(&quot;tccom130.coaf&quot;,str$(f.coaf))<br />
	dal.set.field(&quot;tccom130.ln01&quot;,str$(f.ln01))<br />
	dal.set.field(&quot;tccom130.ln02&quot;,str$(f.ln02))<br />
	dal.set.field(&quot;tccom130.ln03&quot;,str$(f.ln03))<br />
	dal.set.field(&quot;tccom130.ln04&quot;,str$(f.ln04))<br />
	dal.set.field(&quot;tccom130.ln05&quot;,str$(f.ln05))<br />
	dal.set.field(&quot;tccom130.ln06&quot;,str$(f.ln06))<br />
	<br />
        ret = dal.save.object(&quot;tccom130&quot;)<br />
	if ret = 0 then<br />
		commit.transaction()<br />
	else<br />
		dal.get.error.message(error.msg)<br />
		abort.transaction()<br />
	endif</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bhushanchanda</div><div class="date">5th August 2016, 15:12</div></div><div class="posttext">And, in case if you need to have AFS, you need to trick the session script to go with DAL flow. To do that, just answer the question before putting any fields and use a second insert if the first one fails-&gt;<br />
<br />
stpapi.enum.answer(&quot;tccom4130s000&quot;,&quot;tccom4130.1&quot;,tcyesno.yes)<br />
stpapi.put.field(&quot;tccom4130s000&quot;,&quot;tccom130.cadr&quot;,str$(p.cadr))<br />
stpapi.put.field(&quot;tccom4130s000&quot;,&quot;tccom130.nama&quot;,str$(f.addr.nama))<br />
stpapi.put.field(&quot;tccom4130s000&quot;,&quot;tccom130.ccty&quot;,str$(f.ccty))<br />
stpapi.put.field(&quot;tccom4130s000&quot;,&quot;tccom130.pstc&quot;,str$(f.pstc))<br />
stpapi.put.field(&quot;tccom4130s000&quot;,&quot;tccom130.cste&quot;,str$(f.cste))<br />
stpapi.put.field(&quot;tccom4130s000&quot;,&quot;tccom130.ccit&quot;,str$(f.ccit))<br />
stpapi.put.field(&quot;tccom4130s000&quot;,&quot;tccom130.tzid&quot;,str$(f.tzid))<br />
stpapi.put.field(&quot;tccom4130s000&quot;,&quot;tccom130.telp&quot;,str$(f.telp))<br />
stpapi.put.field(&quot;tccom4130s000&quot;,&quot;tccom130.tefx&quot;,str$(f.tefx))<br />
stpapi.put.field(&quot;tccom4130s000&quot;,&quot;tccom130.vatl&quot;,str$(f.vatl))<br />
stpapi.put.field(&quot;tccom4130s000&quot;,&quot;tccom130.coaf&quot;,str$(f.coaf))<br />
stpapi.put.field(&quot;tccom4130s000&quot;,&quot;tccom130.ln01&quot;,str$(f.ln01))<br />
stpapi.put.field(&quot;tccom4130s000&quot;,&quot;tccom130.ln02&quot;,str$(f.ln02))<br />
stpapi.put.field(&quot;tccom4130s000&quot;,&quot;tccom130.ln03&quot;,str$(f.ln03))<br />
stpapi.put.field(&quot;tccom4130s000&quot;,&quot;tccom130.ln04&quot;,str$(f.ln04))<br />
stpapi.put.field(&quot;tccom4130s000&quot;,&quot;tccom130.ln05&quot;,str$(f.ln05))<br />
stpapi.put.field(&quot;tccom4130s000&quot;,&quot;tccom130.ln06&quot;,str$(f.ln06))<br />
error.msg = &quot;&quot;<br />
<br />
result = stpapi.insert(&quot;tccom4130s000&quot;,true,error.msg)<br />
if not isspace(error.msg) then<br />
    result = stpapi.insert(&quot;tccom4130s000&quot;,true,error.msg)<br />
endif<br />
<br />
if result = 1 then<br />
	result = stpapi.end.session(&quot;tccom4130s000&quot;,error.msg)<br />
else<br />
	result = stpapi.recover(&quot;tccom4130s000&quot;,error.msg)<br />
endif</div></div><hr />


<div class="post"><div class="posttop"><div class="username">heartbeat</div><div class="date">8th August 2016, 10:38</div></div><div class="posttext">Hi,<br />
<br />
Try DAL wherever possible -&gt;<br />
<br />
 <br />
        dal.new.object(&quot;tccom130&quot;)<br />
	dal.set.field(&quot;tccom130.cadr&quot;,str$(p.cadr))<br />
	dal.set.field(&quot;tccom130.nama&quot;,str$(f.addr.nama))<br />
	dal.set.field(&quot;tccom130.ccty&quot;,str$(f.ccty))<br />
	dal.set.field(&quot;tccom130.pstc&quot;,str$(f.pstc))<br />
	dal.set.field(&quot;tccom130.cste&quot;,str$(f.cste))<br />
	dal.set.field(&quot;tccom130.ccit&quot;,str$(f.ccit))<br />
	dal.set.field(&quot;tccom130.tzid&quot;,str$(f.tzid))<br />
	dal.set.field(&quot;tccom130.telp&quot;,str$(f.telp))<br />
	dal.set.field(&quot;tccom130.tefx&quot;,str$(f.tefx))<br />
	dal.set.field(&quot;tccom130.vatl&quot;,str$(f.vatl))<br />
	dal.set.field(&quot;tccom130.coaf&quot;,str$(f.coaf))<br />
	dal.set.field(&quot;tccom130.ln01&quot;,str$(f.ln01))<br />
	dal.set.field(&quot;tccom130.ln02&quot;,str$(f.ln02))<br />
	dal.set.field(&quot;tccom130.ln03&quot;,str$(f.ln03))<br />
	dal.set.field(&quot;tccom130.ln04&quot;,str$(f.ln04))<br />
	dal.set.field(&quot;tccom130.ln05&quot;,str$(f.ln05))<br />
	dal.set.field(&quot;tccom130.ln06&quot;,str$(f.ln06))<br />
	<br />
        ret = dal.save.object(&quot;tccom130&quot;)<br />
	if ret = 0 then<br />
		commit.transaction()<br />
	else<br />
		dal.get.error.message(error.msg)<br />
		abort.transaction()<br />
	endif<br />
<br />
Thank you very much.</div></div><hr />



</div>
</body>
</html>