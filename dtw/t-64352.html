<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="Block sales within a report script, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] Block sales within a report script Distribution, Transportation &amp; Warehousing" />
	
	<title>Block sales within a report script [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="../index.html">Newbaanboard</a> &gt; <a href="../index.html">Baan Quick Support: Functional &amp; Technical</a> &gt; <a href="../index.html">Distribution, Transportation &amp; Warehousing</a> &gt; Block sales within a report script</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">drcelus</div><div class="date">24th July 2013, 11:30</div></div><div class="posttext">Is it possible to block a sales order from within a report script ?<br />
We have a trivial requirement where we have to check whether some SO addresses match and if not, ideally block or warn the user about it.<br />
<br />
No dev license here so I can only customize report scripts, that's why I was wondering if there is a function for blocking that I could use within a report.<br />
<br />
Regards.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bhushanchanda</div><div class="date">24th July 2013, 11:43</div></div><div class="posttext">Hi,<br />
<br />
From your profile, I will assume you are on LN. So, you can go for DAL to do this. We use DAL to block users while entering the records i.e. if some condition is not met, users are not allowed to enter the record. You can use dal for blocking SO approval as well. Its not necessary to use the report script and anyway, the report is printed after the record is saved.<br />
<br />
In case, if you want to warn users, this can be done through DAL as well.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">drcelus</div><div class="date">24th July 2013, 12:19</div></div><div class="posttext">Thanks Bhushan, but please note that I do not have a dev license at the moment so I can't touch DAL, since AFAIK you do need it to compile DAL objects.<br />
<br />
Please correct me if I am wrong.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bhushanchanda</div><div class="date">24th July 2013, 12:43</div></div><div class="posttext">Does that mean you can't create your own scripts and customization's? I guess, you can create your own scripts and compile them and you cant modify or view the standard scripts. Right? So, you just need to add a DAL for the standard table and put the locks in there. If you want to know how, I can give you an example for that. But, let me know first, if you can create your scripts and compile them or not?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">drcelus</div><div class="date">26th July 2013, 11:35</div></div><div class="posttext">No, I can't compile anything other than report scripts.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">vamsi_gujjula</div><div class="date">26th July 2013, 12:49</div></div><div class="posttext">ttstpbaandoc  run this for the documentation of dlls and objects.  may b you can get a extern function to suffice your requirement</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bhushanchanda</div><div class="date">26th July 2013, 13:02</div></div><div class="posttext">Pheww..<br />
<br />
I can't imagine a life without customizations ;) That might be hec.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">vamsi_gujjula</div><div class="date">26th July 2013, 13:08</div></div><div class="posttext">But Bhushan  there might b Admin(application and DB) part still with out customization..<br />
<br />
<br />
anyway i got one dll tdslsdll0091</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">26th July 2013, 16:58</div></div><div class="posttext">You would be amazed at what you can do in report scripts.  I build several tables alone in report scripts.  As a matter of fact I have used the reports from SQL queries to actually fix/update/delete problem records.  So my answer to the original question is yes - what I can't do is give any code since this is ln and we don't use sales table so I do not know how to block an order.  As a matter of fact I used to run AFS code(don't really recommend it) in a report to build some JV transactions from a summary report.  They decided they wanted to review them first - so I pulled the code and now write to a table.  <br />
<br />
Bottom line is you can do I whole lot in a report script - I don't know about calling something in DAL, but you can call libraries.  I do not know if LN is different or if our development license grants us more permissions.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bhushanchanda</div><div class="date">26th July 2013, 18:46</div></div><div class="posttext">Ok,<br />
<br />
I just tried to use DAL within report script but its not possible. And, as drcelus said, he cant create scripts hence, he wont be able to create libraries (DLL's) as well. Right? So, calling a customized library is not an option. <br />
<br />
Now, blocking sales order within report script will again depend on the parameter setup done by the functional people, like before approval of SO, the SO should be printed. Well, in our case, if SO is created no report is printed, the second is Approval where no report is printed and then its released to warehouse. And I guess, it will be too late to block it until then. So, first thing required will be to set the correct parameters for doing this.<br />
<br />
The second way can be by Table data authorization. Like you can set conditions on tdsls400 table. I am not sure, what exactly is the requirement. Where should the block be applied?<br />
<br />
Mark, correct me if I am wrong in assuming the above things. I am not aware of the dev licence thing so don't know how much work can be done and how it can be done.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">abattoir</div><div class="date">26th July 2013, 18:54</div></div><div class="posttext">Hi,<br />
<br />
You can use User exit DLL, assuming that when you say &quot;you dont have development license&quot; you actually mean that you cannot compile or change any standard scripts, DLL's, DAL's. But you can create your own customize Session, Script right? If that is the case, then blocking sales order can easily be done using UE DLL. Check programmers guide for its overview.<br />
<br />
&quot;A User Exit DLL (UEDLL) is a DLL that will reside outside the standard software. It will have the same name as a standard DAL with the extension 'ue' (for 'user exit'). E.g. 'whinh200ue' for table whinh200. Customers can implement a UEDLL in order to be able to define extra business logic before and after the standard 'before' and 'after' handling of saves and deletes, by means of specific hooks that will be executed by the 4GL engine and/or DAL Engine. In this way it is possible to e.g. conditionally publish data changes to the outside world.&quot;<br />
<br />
Regards,<br />
Ankur</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bhushanchanda</div><div class="date">26th July 2013, 19:22</div></div><div class="posttext">Hi Abattoir,<br />
<br />
I already gave that option but, as he said,<br />
<br />
<br />
Drcelus Said:<br />
<br />
No, I can't compile anything other than report scripts.<br />
<br />
I don't think he can create any scripts.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">27th July 2013, 00:09</div></div><div class="posttext">In the dev/test company in the report script you could just try something like this:<br />
<br />
<br />
                db.retry.point()<br />
                select tppss990.*<br />
                from      tppss990 for update<br />
                where   tppss990.code &lt;&gt;&quot;      &quot;<br />
                selectdo<br />
                                tppss990.code = &quot; &quot;<br />
                                db.update(ttppss990,db.retry)<br />
                                commit.transaction()<br />
                endselect<br />
<br />
<br />
Here is something else you can try:<br />
<br />
|******************************************************************************<br />
declaration:<br />
                long       count, up.error<br />
                string    error.msg(120)<br />
                #pragma used    dll     ottstpapihand<br />
<br />
before.program:<br />
                count = get.compnr()<br />
                testit()<br />
                <br />
functions:<br />
function testit()<br />
{<br />
                stpapi.put.field(&quot;tccom1101m000&quot;,&quot;tccom010.cuno&quot;,&quot;SOMECUST&quot;)<br />
                count = stpapi.find(&quot;tccom1101m000&quot;,error.msg)<br />
                if count = 1 then<br />
                                message(&quot; Record Found &quot;)<br />
                                stpapi.put.field(&quot;tccom1101m000&quot;,&quot;tccom010.nama&quot;,&quot;Cust Name1&quot;)<br />
                                stpapi.put.field(&quot;tccom1101m000&quot;,&quot;tccom010.ccur&quot;,&quot;USD&quot;)<br />
                                up.error = 0<br />
                                up.error = stpapi.update(&quot;tccom1101m000&quot;,true,error.msg)<br />
                                message(&quot;%s error.msg &quot;,error.msg)<br />
                endif<br />
                stpapi.end.session(&quot;tccom1101m000&quot;)<br />
}<br />
<br />
<br />
I mean the only true way to figure out what you can and can't do is try it.  So for example if you passed production order number to print in the detail layout - then in the before or after layout section you could select tisfc001.* for the production order number and update the record for what ever reason.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">vamsi_gujjula</div><div class="date">27th July 2013, 09:22</div></div><div class="posttext">I do agree.....with mark....one can play around with it..... and coming back to blocking thing.....I hope he has done it.......after all these alternatives.. :p</div></div><hr />


<div class="post"><div class="posttop"><div class="username">vahdani</div><div class="date">27th July 2013, 12:47</div></div><div class="posttext">Hi drcelus,<br />
<br />
you have to fill tdsls420 using DAL in LN-FP8.<br />
<br />
Use something like the following in your report script:<br />
<br />
<br />
declaration:<br />
	long	g.ret<br />
	domain tcmcs.str132m	g.emsg<br />
#include &lt;bic_dam&gt;<br />
<br />
before.xyz.1:<br />
before.layout:<br />
	|block your order using tdsls420 DAL<br />
	db.retry.point()<br />
	g.emsg = &quot;&quot;<br />
	<br />
	select	tdsls420.*<br />
	from	tdsls420<br />
	where	tdsls420.orno = :your.order.number<br />
	selectdo<br />
	selectempty<br />
		dal.new.object(&quot;tdsls420&quot;)<br />
		dal.set.field(&quot;tdsls420.orno&quot;, your.order.number)<br />
		dal.set.field(&quot;tdsls420.hrea&quot;, your.reason.code)<br />
		|... fill other fields if required<br />
		g.ret = dal.save.object(&quot;tdsls420&quot;)<br />
		if g.ret &lt;&gt; 0 then<br />
			abort.transaction()<br />
			dal.get.error.message(g.emsg)<br />
		endif<br />
	endselect<br />
	commit.transaction()</div></div><hr />


<div class="post"><div class="posttop"><div class="username">bhushanchanda</div><div class="date">28th July 2013, 07:16</div></div><div class="posttext">Oh, it was bic_dam. I was trying bic_dal and was not allowing me. Learnt something new. Never knew, bic_dam can be used for DAL functions. I thought it was just for the progress indicators.<br />
<br />
When writing a Data Access Layer, you must include bic_dal. To use progress indicators and Data Access Methods in your UI, you must include bic_dam.<br />
<br />
This is what I found the the manual's.<br />
<br />
So, this means, its a Data Access Method and not Data Access Layer.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">drcelus</div><div class="date">9th September 2013, 15:43</div></div><div class="posttext">Hi drcelus,<br />
<br />
you have to fill tdsls420 using DAL in LN-FP8.<br />
<br />
Use something like the following in your report script:<br />
<br />
<br />
declaration:<br />
	long	g.ret<br />
	domain tcmcs.str132m	g.emsg<br />
#include &lt;bic_dam&gt;<br />
<br />
before.xyz.1:<br />
before.layout:<br />
	|block your order using tdsls420 DAL<br />
	db.retry.point()<br />
	g.emsg = &quot;&quot;<br />
	<br />
	select	tdsls420.*<br />
	from	tdsls420<br />
	where	tdsls420.orno = :your.order.number<br />
	selectdo<br />
	selectempty<br />
		dal.new.object(&quot;tdsls420&quot;)<br />
		dal.set.field(&quot;tdsls420.orno&quot;, your.order.number)<br />
		dal.set.field(&quot;tdsls420.hrea&quot;, your.reason.code)<br />
		|... fill other fields if required<br />
		g.ret = dal.save.object(&quot;tdsls420&quot;)<br />
		if g.ret &lt;&gt; 0 then<br />
			abort.transaction()<br />
			dal.get.error.message(g.emsg)<br />
		endif<br />
	endselect<br />
	commit.transaction()<br />
<br />
<br />
Sorry for the late answer.<br />
This works also for LN FP5, thank you vahdani .<br />
I will have to check error reporting for those DAL functions but this is definitely the way to go.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sona@-@</div><div class="date">13th October 2013, 14:20</div></div><div class="posttext">Thanks for sharing.</div></div><hr />



</div>
</body>
</html>