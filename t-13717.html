<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="keywords" content="inport data with OLE in tfacp1100m000, baan,baanerp,erp,forum,discussion,bulletin board" />
	<meta name="description" content="[Archive] inport data with OLE in tfacp1100m000 AFS/DDC/OLE: Function servers" />
	
	<title>inport data with OLE in tfacp1100m000 [Archive]  - Baanboard.com</title>
	<link rel="stylesheet" type="text/css" href="../styles.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="index.html">Newbaanboard</a> &gt; <a href="index.html">Baan SIGs</a> &gt; <a href="index.html">AFS/DDC/OLE: Function servers</a> &gt; inport data with OLE in tfacp1100m000</div>
<hr />
<div class="pda"></div>

<hr />

<div class="post"><div class="posttop"><div class="username">zamarlab</div><div class="date">25th November 2003, 12:10</div></div><div class="posttext">Yesterday I saw this forum and I'm wondering if I can write data directlly into Baan with OLE in visual basic.<br />
<br />
If is it possible I will be happy is someone writes same examples :D</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">25th November 2003, 15:55</div></div><div class="posttext">Sure you can. Look at this search (http://www.baanboard.com/baanboard/search.php?s=&amp;action=showresults&amp;searchid=179847&amp;sortby=lastpost&amp;sortorder=descending).  Not sure if it will come out, but it was a search on EXCEL and STPAPI.  You can write STPAPI code to run Baan sessions from Excel.  I have only played with this and not really done it.  If I was to actually do something like this I would probably write everything in a Baan DLL.  Then just call this DLL from Excel.  Just my thoughts.<br />
<br />
Good Luck!<br />
<br />
Mark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">zamarlab</div><div class="date">25th November 2003, 16:09</div></div><div class="posttext">I played with this examples and I have allready read data with vb from this session but now I have to insert data into baan.<br />
(session tfacp1100m000) <br />
I don't understand the examples in excel (function where parameters are dllname and dllfunction). I don't know witch dll I have to use for this session.<br />
<br />
please help, :(</div></div><hr />


<div class="post"><div class="posttop"><div class="username">mark_h</div><div class="date">25th November 2003, 18:54</div></div><div class="posttext">This thread (http://www.baanboard.com/baanboard/showthread.php?s=&amp;threadid=1997&amp;highlight=EXCEL+and+STPAPI) contains an example of calling a Baan dll.  What I stated was that you would need to write this DLL.  That is how I would do it, BUT if you have already written VB code to read data from the session, then you could write to the session.  Of course I am assuming you used stpapi calls to read the data.  If you developed those calls then you can also use the commands that would allow you to put fields and control the session.  I am not familiar with the session so I do not know how complicated it is.<br />
<br />
Mark</div></div><hr />


<div class="post"><div class="posttop"><div class="username">zamarlab</div><div class="date">26th November 2003, 13:28</div></div><div class="posttext">Thanks, for this example.<br />
But I still have some questions:<br />
If I understand this example, I have to write some code in Baan.<br />
Because I don't have baan permissions for writing code, I just have WinBaan and permissions to insert data into session.<br />
<br />
Is it possible to create insertation in that way.<br />
<br />
If is not, where I can write code in BAAN (I will try to get the permissions) and how ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Al Smith</div><div class="date">26th November 2003, 16:22</div></div><div class="posttext">Hi,<br />
Here's a VB example that will insert a record into tfacp1100m000.<br />
Of course you'll have to change the supplier code (tfaco100.suno) to a valid one for your business.<br />
I hope this helps,<br />
Al.<br />
<br />
Dim BaanObj As Baan4.Baan4<br />
<br />
Sub Main()<br />
Set BaanObj = CreateObject(&quot;Baan4.Application&quot;)<br />
BaanObj.ParseExecFunction &quot;ottstpapihand&quot;, &quot;stpapi.put.field(&quot; &amp; Chr(34) &amp; &quot;tfacp1100m000&quot; &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; &quot;tfacp100.suno&quot; &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; &quot;123456&quot; &amp; Chr(34) &amp; &quot;)&quot;<br />
BaanObj.ParseExecFunction &quot;ottstpapihand&quot;, &quot;stpapi.put.field(&quot; &amp; Chr(34) &amp; &quot;tfacp1100m000&quot; &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; &quot;tfacp100.invd&quot; &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; CLng(Date) + 693594 &amp; Chr(34) &amp; &quot;)&quot;<br />
BaanObj.ParseExecFunction &quot;ottstpapihand&quot;, &quot;stpapi.put.field(&quot; &amp; Chr(34) &amp; &quot;tfacp1100m000&quot; &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; &quot;tfacp100.ccur&quot; &amp; Chr(34) &amp; &quot;,&quot; &amp; Chr(34) &amp; &quot;USD&quot; &amp; Chr(34) &amp; &quot;)&quot;<br />
BaanObj.ParseExecFunction &quot;ottstpapihand&quot;, &quot;stpapi.insert(&quot; &amp; Chr(34) &amp; &quot;tfacp1100m000&quot; &amp; Chr(34) &amp; &quot;,1,&quot; &amp; Chr(34) &amp; Space(50) &amp; Chr(34) &amp; &quot;)&quot;<br />
BaanObj.ParseExecFunction &quot;ottstpapihand&quot;, &quot;stpapi.end.session(&quot; &amp; Chr(34) &amp; &quot;tfacp1100m000&quot; &amp; Chr(34) &amp; &quot;)&quot;<br />
BaanObj.Quit<br />
Set BaanObj = Nothing<br />
End Sub</div></div><hr />


<div class="post"><div class="posttop"><div class="username">zamarlab</div><div class="date">26th November 2003, 17:10</div></div><div class="posttext">This is realy great.<br />
<br />
But I stil have question:<br />
How to get errors witch can invoke after input wrong input.<br />
<br />
example: If you input wrong supplier code, it should get an error<br />
with this error.<br />
<br />
Thank You very much</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Al Smith</div><div class="date">26th November 2003, 18:09</div></div><div class="posttext">Hi,<br />
Errors will show up in the BaanObj.FunctionCall.<br />
For example, if you put &quot;Debug.Print BaanObj.FunctionCall&quot; after the stpapi.insert statement you'll see stpapi.insert(&quot;tfacp1100m000&quot;,0,&quot;Supplier not found&quot;).<br />
By the way, have you downloaded the AFS documentation.<br />
Al.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">zamarlab</div><div class="date">27th November 2003, 13:16</div></div><div class="posttext">Everything is working fine, but I still not satisfied.<br />
<br />
I gave You an example for wrong Supplier code. In this case I got an error message, but In case if I put in filed for supplier bill number a number witch allready exists I don't get a message.<br />
<br />
And another question:<br />
How to insert data if you have a multi session input. <br />
(main and sub sessions)<br />
tfgld1101m000 and then subsessions tfacp1110s000 and tfacp1210s000<br />
<br />
thank You</div></div><hr />


<div class="post"><div class="posttop"><div class="username">zamarlab</div><div class="date">28th November 2003, 14:26</div></div><div class="posttext">I found how You can check the validation of the field.<br />
But this AFS code I have to put in VBA. <br />
I tried but It don't work.<br />
<br />
I would be happy If someone could help me how I can write this AFS code in VB.<br />
<br />
tufncgendll_launch(check.input.tdsls040.orno).<br />
<br />
by</div></div><hr />



</div>
</body>
</html>